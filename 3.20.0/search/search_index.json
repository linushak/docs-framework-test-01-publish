{"config":{"lang":["en"],"separator":"[\\s\\-]+"},"docs":[{"title":"Gravitee API Reference index","text":"","location":"api-reference-index/","tags":["API Reference","APIM","AM"]},{"title":"API Management (APIM) API reference","text":"<p>See APIM REST API Reference for an overview of APIM REST APIs. The sub-sections below provide links to the list of API reference documentation for supported APIM versions.</p>","location":"api-reference-index/#api-management-apim-api-reference","tags":["API Reference","APIM","AM"]},{"title":"APIM 3.x Management Console API reference","text":"<p>Latest version:</p> <ul> <li>Version 3.20</li> </ul> <p>Older versions:</p> <ul> <li>Version 3.0</li> <li>Version 3.1</li> <li>Version 3.2</li> <li>Version 3.3</li> <li>Version 3.4</li> <li>Version 3.5</li> <li>Version 3.6</li> <li>Version 3.7</li> <li>Version 3.8</li> <li>Version 3.9</li> <li>Version 3.10</li> <li>Version 3.11</li> <li>Version 3.12</li> <li>Version 3.13</li> <li>Version 3.14</li> <li>Version 3.15</li> <li>Version 3.16</li> <li>Version 3.17</li> <li>Version 3.18</li> <li>Version 3.19</li> </ul>","location":"api-reference-index/#apim-3x-management-console-api-reference","tags":["API Reference","APIM","AM"]},{"title":"APIM 3.x Portal API reference","text":"<p>Latest version:</p> <ul> <li>Version 3.20</li> </ul> <p>Older versions:</p> <ul> <li>Version 3.0</li> <li>Version 3.1</li> <li>Version 3.2</li> <li>Version 3.3</li> <li>Version 3.4</li> <li>Version 3.5</li> <li>Version 3.6</li> <li>Version 3.7</li> <li>Version 3.8</li> <li>Version 3.9</li> <li>Version 3.10</li> <li>Version 3.11</li> <li>Version 3.12</li> <li>Version 3.13</li> <li>Version 3.14</li> <li>Version 3.15</li> <li>Version 3.16</li> <li>Version 3.17</li> <li>Version 3.18</li> <li>Version 3.19</li> </ul>","location":"api-reference-index/#apim-3x-portal-api-reference","tags":["API Reference","APIM","AM"]},{"title":"Access Management API reference","text":"<p>The sub-sections below provide links to the list of API reference documentation for supported AM versions.</p>","location":"api-reference-index/#access-management-api-reference","tags":["API Reference","APIM","AM"]},{"title":"AM 3.x Management Console API reference","text":"<p>Latest version:</p> <ul> <li>Version 3.20</li> </ul> <p>Older versions:</p> <ul> <li>Version 3.0</li> <li>Version 3.1</li> <li>Version 3.2</li> <li>Version 3.3</li> <li>Version 3.4</li> <li>Version 3.5</li> <li>Version 3.6</li> <li>Version 3.7</li> <li>Version 3.8</li> <li>Version 3.9</li> <li>Version 3.10</li> <li>Version 3.11</li> <li>Version 3.12</li> <li>Version 3.13</li> <li>Version 3.14</li> <li>Version 3.15</li> <li>Version 3.16</li> <li>Version 3.17</li> <li>Version 3.18</li> <li>Version 3.19</li> </ul>","location":"api-reference-index/#am-3x-management-console-api-reference","tags":["API Reference","APIM","AM"]},{"title":"AM 3.x Account API reference","text":"<p>Latest version:</p> <ul> <li>Version 3.19</li> </ul> <p>Older versions:</p> <ul> <li>Version 3.10</li> <li>Version 3.11</li> <li>Version 3.12</li> <li>Version 3.13</li> <li>Version 3.14</li> <li>Version 3.15</li> <li>Version 3.16</li> <li>Version 3.17</li> <li>Version 3.18</li> </ul>","location":"api-reference-index/#am-3x-account-api-reference","tags":["API Reference","APIM","AM"]},{"title":"AM 3.x Client Initiated Backchannel Authentication (CIBA) API reference","text":"<ul> <li>Latest version</li> </ul>","location":"api-reference-index/#am-3x-client-initiated-backchannel-authentication-ciba-api-reference","tags":["API Reference","APIM","AM"]},{"title":"AM 3.x CIBA External Service API reference","text":"<ul> <li>Latest version</li> </ul>","location":"api-reference-index/#am-3x-ciba-external-service-api-reference","tags":["API Reference","APIM","AM"]},{"title":"AM 3.x OAuth2 API reference","text":"<ul> <li>Latest version</li> </ul>","location":"api-reference-index/#am-3x-oauth2-api-reference","tags":["API Reference","APIM","AM"]},{"title":"AM 3.x OpenID Connect (OIDC) API reference","text":"<ul> <li>Latest version</li> </ul>","location":"api-reference-index/#am-3x-openid-connect-oidc-api-reference","tags":["API Reference","APIM","AM"]},{"title":"AM 3.x System for Cross-domain Identity Management (SCIM) API reference","text":"<ul> <li>Latest version</li> </ul>","location":"api-reference-index/#am-3x-system-for-cross-domain-identity-management-scim-api-reference","tags":["API Reference","APIM","AM"]},{"title":"AM 3.x Session API reference","text":"<ul> <li>Latest version</li> </ul>","location":"api-reference-index/#am-3x-session-api-reference","tags":["API Reference","APIM","AM"]},{"title":"AM 3.x User-Managed Access (UMA) 2.0 API reference","text":"<ul> <li>Latest version</li> </ul>","location":"api-reference-index/#am-3x-user-managed-access-uma-20-api-reference","tags":["API Reference","APIM","AM"]},{"title":"AM 3.x Users API reference","text":"<ul> <li>Latest version</li> </ul>","location":"api-reference-index/#am-3x-users-api-reference","tags":["API Reference","APIM","AM"]},{"title":"How to contribute to Gravitee docs","text":"<p>Coming soon!</p> <p>A placeholder to contain licensing info and the overall open source contributing policy for docs and products.</p>","location":"contribute/"},{"title":"Glossary of terms","text":"<p>Coming soon!</p>","location":"glossary/"},{"title":"Gravitee Plugins Marketplace","text":"<p>The brand new Gravitee Plugins Marketplace offers available plugins to extend the Gravitee API Management and Security platform.</p> <p>Check it out at www.gravitee.io/plugins!</p>","location":"marketplace/","tags":["Gravitee","Plugins","Marketplace"]},{"title":"Policy reference","text":"<p>Coming soon!</p>","location":"policies-plugins-index/"},{"title":"Browse by product","text":"<p>Coming soon!</p>","location":"products/","tags":["API Management (APIM)","Access Management (AM)","Alert Engine (AE)","Cockpit","API Designer","Enterprise Edition (EE)"]},{"title":"What's new","text":"<p>Coming soon!</p>","location":"whats-new/"},{"title":"Gravitee.io Alert Engine (AE)","text":"<p>Gravitee.io Alert Engine is included as part of link:{{ /ee/ee_introduction.html | relative_url }}[Gravitee.io Enterprise]. To use it, you need to &lt;&lt;/ee/ee_license.adoc#ask-license, contact Gravitee for a license&gt;&gt;.</p> <p>Gravitee.io\u2019s API Platform is a turnkey solution for managing (APIM) and securing (AM) APIs. As part of its core offering it includes some monitoring capabilities, such as health checking and availability and response time monitoring.</p> <p>You can extend this core monitoring functionality by coupling your API platform with the Alert Engine (AE) component.</p> <p>Some of the additional alerting capabilities AE provides are:</p> <ul> <li> <p>Notifications to API publishers that the health check service was     able or unable to check an endpoint.</p> </li> <li> <p>Notifications to API consumers or publishers when they reach a given     percentage threshold of the quota.</p> </li> <li> <p>Notifications to administrators that one of the APIM Gateway     instances is consuming more than a percentage threshold of heap or     CPU, a new one is available, or a node is down.</p> </li> </ul> <p>Alert Engine (AE) provides APIM and AM users with efficient and flexible API platform monitoring, including advanced alerting configuration and notifications sent through their preferred channels, such as email, Slack and so on.</p> <p>AE does not require any external components or a database as it does not store anything. It receives events and sends notifications under the conditions which have been pre-configured upstream with triggers.</p>","location":"ae/"},{"title":"Gravitee.io Access Management (AM)","text":"<p>Gravitee.io Access Management (AM) is a flexible, lightweight and easy to use open source Identity and Access Management solution. It offers a centralized authentication and authorization service to deliver secure access for authorized users to your applications and APIs from any device.</p>","location":"am/"},{"title":"Authorization in AM","text":"<p>AM is based on OAuth2/OpenID Connect and SAML 2.0 protocols and acts as an identity provider broker</p>","location":"am/#authorization-in-am"},{"title":"OAuth2","text":"<p>OAuth2 is an authorization framework that allows applications acting on behalf of the end user to obtain limited access to HTTP services. OAuth 2 RFC^ defines two endpoints:</p> <ul> <li> <p>The authorization endpoint used to interact with the resource     owner and obtain an authorization grant via user-agent redirection.</p> </li> <li> <p>The token endpoint used by the client to obtain an access token     by presenting its authorization grant.</p> </li> </ul> <p>For further information about OAuth2, view the RFC page^.</p>","location":"am/#oauth2"},{"title":"OpenID Connect","text":"<p>OpenID Connect is an identity layer on top of the OAuth 2.0 protocol. It enables clients to verify the identity of the end user by using an Authorization Server to authenticate and obtain basic profile information about the end user.</p> <p>For further information about OpenID Connect, view the OpenID Connect specifications^.</p>","location":"am/#openid-connect"},{"title":"SAML 2.0","text":"<p>The Security Assertion Markup Language (SAML) protocol is an open-standard, XML-based framework for authentication and authorization of users.</p> <p>Gravitee AM can act as both SAML IdP for applications as well as federate with SAML based Identity Providers for protocol mediation.</p> <p>For further information about SAML 2.0, view the SAML Tech Overview 2.0</p>","location":"am/#saml-20"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/account/3.10/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/account/3.11/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/account/3.12/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/account/3.13/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/account/3.14/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/account/3.15/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/account/3.16/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/account/3.17/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/account/3.18/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/account/3.19/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/ciba/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/ciba-external-service/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/management-api/3.0/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/management-api/3.1/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/management-api/3.10/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/management-api/3.11/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/management-api/3.12/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/management-api/3.13/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/management-api/3.14/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/management-api/3.15/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/management-api/3.16/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/management-api/3.17/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/management-api/3.18/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/management-api/3.19/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/management-api/3.2/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/management-api/3.20/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/management-api/3.3/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/management-api/3.4/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/management-api/3.5/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/management-api/3.6/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/management-api/3.7/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/management-api/3.8/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/management-api/3.9/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/oauth2/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/oidc/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/scim/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/session/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/uma2/"},{"title":"Index","text":"<p></p>","location":"api-ref/am/3.x/users/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/management-api/3.0/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/management-api/3.1/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/management-api/3.10/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/management-api/3.11/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/management-api/3.12/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/management-api/3.13/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/management-api/3.14/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/management-api/3.15/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/management-api/3.16/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/management-api/3.17/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/management-api/3.18/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/management-api/3.19/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/management-api/3.2/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/management-api/3.20/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/management-api/3.3/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/management-api/3.4/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/management-api/3.5/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/management-api/3.6/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/management-api/3.7/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/management-api/3.8/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/management-api/3.9/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/management-api/latest/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/portal-api/3.0/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/portal-api/3.1/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/portal-api/3.10/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/portal-api/3.11/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/portal-api/3.12/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/portal-api/3.13/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/portal-api/3.14/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/portal-api/3.15/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/portal-api/3.16/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/portal-api/3.17/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/portal-api/3.18/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/portal-api/3.19/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/portal-api/3.2/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/portal-api/3.20/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/portal-api/3.3/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/portal-api/3.4/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/portal-api/3.5/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/portal-api/3.6/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/portal-api/3.7/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/portal-api/3.8/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/portal-api/3.9/"},{"title":"Index","text":"<p></p>","location":"api-ref/apim/3.x/portal-api/latest/"},{"title":"Gravitee.io API Management (APIM)","text":"<p>Organizations need API management solutions to publish their APIs to external developers, internal developers, and other partners. API management can unlock the potential of the organization\u2019s data and services, as well as facilitate the transformation to OpenAPI and OpenData, extending the company\u2019s digital platform offerings, opening new communication channels, and finding new customers.</p> <p>Naturally, a growing customer base brings new challenges, such as:</p> <ul> <li>How to reduce the time taken to enroll new partners.</li> <li>How to identify partners and manage their API consumption.</li> <li>How to measure consumption from a consumer and/or producer point of view.</li> <li>How to share existing APIs and how to discover them.</li> <li>How to manage the API lifecycle, versioning, documentation, and so on.</li> </ul> <p>How can businesses address all these challenges seamlessly, for all APIs, using a centralized tool? Simple \u2013 by choosing Gravitee.io API Management.</p>","location":"apim/","tags":["APIM","Introduction"]},{"title":"What Is Gravitee.io API Management?","text":"<p>Gravitee.io API Management (APIM) is a flexible, lightweight, and blazing-fast open source API management solution that gives your organization full control over who accesses your API \u2014 when and how. APIM is both simple to use and powerful, acting as a global solution for API management. Gravitee.io APIM is composed of four main components:</p> <ol> <li>APIM Gateway.</li> <li>APIM API.</li> <li>APIM Console.</li> <li>APIM Portal.</li> </ol> <p>We\u2019ll dive into these components in detail in their respective sections.</p>","location":"apim/#what-is-graviteeio-api-management","tags":["APIM","Introduction"]},{"title":"Why Gravitee.io API Management?","text":"<p>Our goal in launching Gravitee.io APIM is to provide users with a highly flexible and scalable solution that integrates with their infrastructure seamlessly and fits their business needs perfectly. We\u2019ve designed and developed APIM to be fully extensible using its own internal plugin system, so you can define your own policy, develop your own reporting system, and more.</p> <p>Additionally, all APIM components (including API Gateway and APIM API) are incredibly lightweight. We took a consciously aggressive approach to CPU and memory management with our products to supply high availability through our lightning-fast component start-up times.</p> <p>Typically, it takes less than 5 seconds for the API Gateway to be accessible to consumers (subject to the number of APIs being deployed).</p>","location":"apim/#why-graviteeio-api-management","tags":["APIM","Introduction"]},{"title":"Concepts","text":"","location":"apim/#concepts","tags":["APIM","Introduction"]},{"title":"API","text":"<p>API is the root concept defined and used by APIM. Think of this as the starting point through which services are exposed to the gateway.</p>","location":"apim/#api","tags":["APIM","Introduction"]},{"title":"Publisher","text":"<p>In our platform, we define a publisher (also called API publisher) as the role that declares and manages APIs.</p>","location":"apim/#publisher","tags":["APIM","Introduction"]},{"title":"Consumer","text":"<p>In our platform, we define a consumer (also called API consumer) as the role that consumes APIs. PRO-TIP: A consumer can only consume an API after subscribing to it.</p>","location":"apim/#consumer","tags":["APIM","Introduction"]},{"title":"Application","text":"<p>An application is an intermediate level between a consumer and an API. The consumer uses an application to subscribe to the API before they are able to consume it.</p> <p>Ready to use Gravitee.io API Management? Let\u2019s get started!</p>","location":"apim/#application","tags":["APIM","Introduction"]},{"title":"APIM changelog","text":"<p>Select the desired major APIM version page from the menu on the left-hand side to see the dedicated changelog for that version.</p>","location":"apim/changelog/","tags":["APIM changelog","Changelog","Release notes","Upgrades"]},{"title":"About upgrades","text":"<p>For upgrade instructions, please refer to the APIM Migration Guide.</p>  <p>Warning</p> <p>Important: If you plan to skip versions when you upgrade, ensure that you read the version-specific upgrade notes for each intermediate version. You may be required to perform manual actions as part of the upgrade.</p>","location":"apim/changelog/#about-upgrades","tags":["APIM changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM REST API Reference","text":"","location":"apim/api-reference/apim-rest-api-reference-index/","tags":["APIM REST API Reference"]},{"title":"Overview","text":"<p>APIM API includes endpoints for APIM Console and APIM Portal. The sections below gives links to the documentation for the two sets of services.</p>","location":"apim/api-reference/apim-rest-api-reference-index/#overview","tags":["APIM REST API Reference"]},{"title":"APIM Console API reference","text":"<p>APIM API exposes a complete set of endpoints for developers wanting to script some part of APIM administration.</p> <p>You can access the online endpoint reference or the OpenAPI specification by version. For the:</p> <ul> <li> <p>Online reference, see here</p> </li> <li> <p>OpenAPI spec, see here</p> </li> </ul> <p>To see earlier versions, replace the version number in the URL. For example:</p> <ul> <li> <p>Online reference, see here</p> </li> <li> <p>OpenAPI spec, see here</p> </li> </ul>","location":"apim/api-reference/apim-rest-api-reference-index/#apim-console-api-reference","tags":["APIM REST API Reference"]},{"title":"APIM Portal API reference","text":"<p>APIM API exposes a complete set of endpoints for developers wanting to script some part of the APIM Portal functionality.</p> <p>You can access the online endpoint reference or the OpenAPI specification by version. For the:</p> <ul> <li> <p>Online reference, see here</p> </li> <li> <p>OpenAPI spec, see here</p> </li> </ul> <p>To see earlier versions, replace the version number in the URL. For example:</p> <ul> <li> <p>Online reference, see here</p> </li> <li> <p>OpenAPI spec, see here</p> </li> </ul>","location":"apim/api-reference/apim-rest-api-reference-index/#apim-portal-api-reference","tags":["APIM REST API Reference"]},{"title":"APIM 3.15.x changelog","text":"<p>This page contains the changelog entries for APIM 3.15.0 and all subsequent minor APIM 3.15.x releases.</p>","location":"apim/changelog/changelog-3.15/","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"About upgrades","text":"<p>For upgrade instructions, please refer to the APIM Migration Guide.</p>  <p>Warning</p> <p>Important: If you plan to skip versions when you upgrade, ensure that you read the version-specific upgrade notes for each intermediate version. You may be required to perform manual actions as part of the upgrade.</p>","location":"apim/changelog/changelog-3.15/#about-upgrades","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.15.21 (2023-01-04)","text":"","location":"apim/changelog/changelog-3.15/#apim-31521-2023-01-04","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"API","text":"<ul> <li>Handle flow steps order in database.     #8805</li> </ul>","location":"apim/changelog/changelog-3.15/#api","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.15.20 (2023-01-03)","text":"","location":"apim/changelog/changelog-3.15/#apim-31520-2023-01-03","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Gateway","text":"<ul> <li>Json HTTP error message writing ignores multiple types in Accept     header</li> </ul>","location":"apim/changelog/changelog-3.15/#gateway","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Console","text":"<ul> <li> <p>[Policy XSLT] Prevent usage of external XML DTD</p> </li> <li> <p>Add a default value in the HTTP Methods field of Dynamic     Dictionaries and Properties     #8631</p> </li> </ul>","location":"apim/changelog/changelog-3.15/#console","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.15.19 (2022-12-09)","text":"","location":"apim/changelog/changelog-3.15/#apim-31519-2022-12-09","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Handle auth methods in mail configuration     #8655</li> </ul> <p>Portal</p> <ul> <li>In the metadata tab the field for name is not in English     #7235</li> </ul> <p>Management</p> <ul> <li>Duplicate users on login when special characters in username     #8673</li> </ul>","location":"apim/changelog/changelog-3.15/#bug-fixes","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.15.18 (2022-11-18)","text":"","location":"apim/changelog/changelog-3.15/#apim-31518-2022-11-18","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>SpEL in endpoint isn\u2019t evaluated     #8639</li> </ul> <p>Management</p> <ul> <li> <p>Error when accessing gateway instance info     #8635</p> </li> <li> <p>Max clause count set to 1024 error when searching for apis     #8568</p> </li> </ul> <p>Gateway</p> <ul> <li>Health check not properly reported as unhealthy if timeout occurs     when reaching the backend     #8510</li> </ul>","location":"apim/changelog/changelog-3.15/#bug-fixes_1","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.15.17 (2022-11-07)","text":"","location":"apim/changelog/changelog-3.15/#apim-31517-2022-11-07","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Regex quantifier wrongly interpreted causing matching issues     #8367</p> </li> <li> <p>Allow nested EL expressions     #8564</p> </li> </ul> <p>Management</p> <ul> <li> <p>API primary owner is mandatory, and always set     #8162</p> </li> <li> <p>Restore plan selection behavior with multi OAuth plans without     selection rule     #8460</p> </li> <li> <p>Issue when trying to promote API through Cockpit     #8598</p> </li> </ul> <p>Gateway</p> <ul> <li> <p>Dedicated implementation for hybrid deployment standalone mode     #8482</p> </li> <li> <p>Plan selector should throw 401 on wrong API-Key even if a keyless     plan is available     #8452</p> </li> <li> <p>Accept-Encoding headers should not be deleted from the gateway     #7935</p> </li> </ul> <p>Policy - [Cache] Query parameters should be part of the default cache key #8366</p>","location":"apim/changelog/changelog-3.15/#bug-fixes_2","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.15.16 (2022-09-09)","text":"","location":"apim/changelog/changelog-3.15/#apim-31516-2022-09-09","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li> <p>Apply request timeout properly     #8400</p> </li> <li> <p>Heartbeat service isn\u2019t working anymore     #8417</p> </li> </ul> <p>General</p> <ul> <li>Pagination broken in organization settings     #8346</li> </ul> <p>Policy</p> <ul> <li> <p>[XSLT] XSLT parameter get cached depending on the number of     gateways #8382</p> </li> <li> <p>[Cache] Strange behavior when policy cache TTL is higher than     resource cache TTL     #7907</p> </li> <li> <p>[Oauth2] Error when token expiration is greater then cache TTL     #8295</p> </li> </ul>","location":"apim/changelog/changelog-3.15/#bug-fixes_3","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.15.15 (2022-08-29)","text":"","location":"apim/changelog/changelog-3.15/#apim-31515-2022-08-29","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>JWT plan causes gateway error 500     #8364</li> </ul>","location":"apim/changelog/changelog-3.15/#bug-fixes_4","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.15.14 (2022-08-25)","text":"","location":"apim/changelog/changelog-3.15/#apim-31514-2022-08-25","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li> <p>Analytics - Filters for status codes do not work for the Platform     Dashboard for the Line Chart (Response status)     #8325</p> </li> <li> <p>Analytics - Label issue in the dashboards     #8327</p> </li> <li> <p>Analytics - Top APIs and Top Applications links are not working     #8328</p> </li> <li> <p>Navigation - The right click menu links does not work properly.     #8326</p> </li> <li> <p>Organisation Settings - Wrong confirmation message displayed when     activating/deactivating an identity provider     #7774</p> </li> <li> <p>NullPointerException when deleting a group     #8323</p> </li> <li> <p>Unable to use prefix for mongodb collections when running with Java     17 #7918</p> </li> </ul> <p>Gateway</p> <ul> <li> <p>JDBC - Quota and RateLimit Platform Policies do not work as     expected. X-Quota-Reset header returns -1     #7975</p> </li> <li> <p>File reporter headers format feature     #8305</p> </li> <li> <p>Websocket connection error when reaching a non secure endpoint     #8228</p> </li> <li> <p>Websocket subprotocol not forwarded to the endpoint     #8324</p> </li> <li> <p>Improve plan selection based on subscription     #8165</p> </li> </ul> <p>General</p> <ul> <li> <p>Unable to evaluate regex with quantifiers     #8217</p> </li> <li> <p>Merge 3.10.19 in 3.15.x     #8279</p> </li> </ul> <p>Policy</p> <ul> <li>[openid-connect-userinfo] Gateway never responds in case of     invalid oauth token     #6883</li> </ul> <p>Portal</p> <ul> <li>404 on trendings page     #8341</li> </ul>","location":"apim/changelog/changelog-3.15/#bug-fixes_5","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.15.13 (2022-07-27)","text":"","location":"apim/changelog/changelog-3.15/#apim-31513-2022-07-27","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>APIM</p> <ul> <li>In version 3.15.9 the display of healthcheck logs is broken     #7841</li> </ul> <p>Gateway</p> <ul> <li>[expression-language] String Condition Evaluator not work as     expected #8153</li> </ul> <p>General</p> <ul> <li>Improve email template sanitization     #8093</li> </ul> <p>Reporters</p> <ul> <li>RetainDays configuration of file reporter is inaccurate     #8090</li> </ul>","location":"apim/changelog/changelog-3.15/#bug-fixes_6","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.15.12 (2022-07-08)","text":"","location":"apim/changelog/changelog-3.15/#apim-31512-2022-07-08","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>Log file are not created     #8064</li> </ul>","location":"apim/changelog/changelog-3.15/#bug-fixes_7","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.15.11 (2022-07-01)","text":"","location":"apim/changelog/changelog-3.15/#apim-31511-2022-07-01","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>APIM</p> <ul> <li>Not able to fully import an API, issue related to the default page     (System Folder)     #7876</li> </ul> <p>General</p> <ul> <li>Portal - Filtering by a certain Category on All APIs page will     return all existing APIs     #7201</li> </ul> <p>Management</p> <ul> <li>Healthcheck is failing to report in ES due to issue on headers.     #7930</li> </ul>","location":"apim/changelog/changelog-3.15/#bug-fixes_8","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.15.10 (2022-06-28)","text":"","location":"apim/changelog/changelog-3.15/#apim-31510-2022-06-28","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>APIM</p> <ul> <li> <p>ApiPrimaryOwner property of a group disappears when the group is     updated through console/api call     #7448</p> </li> <li> <p>CORS no longer read only if configured in .yml file     #7326</p> </li> </ul> <p>APIM-EL</p> <ul> <li>ExpesionLanguage query used to work but it no longer does in newer     versions.     #7754</li> </ul> <p>Gateway</p> <ul> <li> <p>503 errors may occur when redeploying an api     #6948</p> </li> <li> <p>API gateway_ip:18082/_node/apis/api.id not working, return 500     error #7287</p> </li> <li> <p>Gateway does not start if openssl is enabled     #7742</p> </li> <li> <p>Handle client side sse connection close     #7573</p> </li> </ul> <p>General</p> <ul> <li> <p>500 error when accessing user api details in organization settings     category issue on JDBC     #7882</p> </li> <li> <p>APIM Connection with Google connect fails     #7743</p> </li> <li> <p>Groovy policy error on HTTP headers (backport of 3.17)     #7811</p> </li> <li> <p>HTTP headers breaking changes from 3.15     #7812</p> </li> <li> <p>Merge 3.10.17 in 3.15.x     #7867</p> </li> </ul> <p>Management</p> <ul> <li>Service discovery Healthcheck isn\u2019t working     #7533</li> </ul> <p>Policy</p> <ul> <li>Cache Policy cache not cleared/refreshed after Time to Live     #7740</li> </ul> <p>Reporter</p> <ul> <li>File reporter log files are missing headers details     #7741</li> </ul>","location":"apim/changelog/changelog-3.15/#bug-fixes_9","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.15.9 (2022-06-01)","text":"","location":"apim/changelog/changelog-3.15/#apim-3159-2022-06-01","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>APIM</p> <ul> <li> <p>Errors while creating Platform Policies.     #7547</p> </li> <li> <p>Transfer ownership option is not available to in memory org admin     (in memory admin) if primary owner is another user.     #7430</p> </li> </ul> <p>Console</p> <ul> <li> <p>APIs not showing on a selected user page when the group they are in     is updated.     #7285</p> </li> <li> <p>Platform Policies/Flow\u2192Save button stays enabled even after saving     the flow #7651</p> </li> </ul> <p>General</p> <ul> <li> <p>Cannot connect to APIM from Cockpit     #7773</p> </li> <li> <p>Error NullPointerException when executing code in Javascript policy     On-request content script     #7179</p> </li> <li> <p>Merge 3.10.15 in 3.15.x     #7749</p> </li> </ul> <p>Management</p> <ul> <li> <p>Auto fetch of documentation is not working     #7589</p> </li> <li> <p>Dynamic properties API out of sync     #7269</p> </li> <li> <p>When dynamic properties are triggered to update, the API status     change to out of sync and the front ask for deploy.     #5245</p> </li> <li> <p>[RepositoryJDBC] Error when trying to create flow with policy on     organization level     #7399</p> </li> </ul> <p>Portal</p> <ul> <li>How to disable metrics on the APIM Portal?     #7231</li> </ul>","location":"apim/changelog/changelog-3.15/#bug-fixes_10","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.15.8 (2022-04-27)","text":"","location":"apim/changelog/changelog-3.15/#apim-3158-2022-04-27","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>APIM</p> <ul> <li>Policies (or flow) are getting ignored when best match is used in     flow mode     #7472</li> </ul> <p>Gateway</p> <ul> <li> <p>Analytics in UI stopped working after updating gateway to version     3.15.5 #7288</p> </li> <li> <p>Conditional logging on Application prevents to display API logs     #7329</p> </li> </ul> <p>General</p> <ul> <li>Merge 3.10.14 in 3.15.x     #7570</li> </ul> <p>Management</p> <ul> <li>Backport #7450 on 3.15 One shot upgraders run on each APIM startup     with cockpit     #7453</li> </ul> <p>Migration</p> <ul> <li>Null pointer exception for old started gateways     #7277</li> </ul>","location":"apim/changelog/changelog-3.15/#bug-fixes_11","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Improvements","text":"<p>Upgrader</p> <ul> <li>Deploy APIs that gets out of sync by upgrader     #7511</li> </ul>","location":"apim/changelog/changelog-3.15/#improvements","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.15.7 (2022-04-04)","text":"","location":"apim/changelog/changelog-3.15/#apim-3157-2022-04-04","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Merge 3.10.13     #7444</li> </ul> <p>APIM</p> <ul> <li>Content not read from JKS and PKCS12 Certificates(Binary Content) in     Group Endpoint Configuration     #7405</li> </ul> <p>Data-masking-policy</p> <ul> <li>Data masking policy at platform level is not masking data     #7022</li> </ul> <p>Management</p> <ul> <li>\"Host\" header not overwritten if redefined in Endpoint configuration     #7007</li> </ul>","location":"apim/changelog/changelog-3.15/#bug-fixes_12","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.15.6 (2022-03-24)","text":"","location":"apim/changelog/changelog-3.15/#apim-3156-2022-03-24","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li> <p>Contextual Docs no longer works     #7323</p> </li> <li> <p>Secondary endpoint feature not working/switching if the Health-check     is down on the primary endpoint.     #7135</p> </li> </ul> <p>Gateway</p> <ul> <li>Gateway only keeps last set-Cookie header from backend response even     with different cookie-names     #7325</li> </ul> <p>General</p> <ul> <li> <p>Dictionaries no longer work in expressions     #7303</p> </li> <li> <p>Javascript policy input box is only showing a few lines and not the     whole code     #7028</p> </li> <li> <p>Json is only partially visible in editor under API Documentaiton     #7116</p> </li> <li> <p>Let the API Owner choose the Accept-Encoding     #6967</p> </li> <li> <p>Merge 3.10.12 in 3.15.x     #7363</p> </li> <li> <p>Support DocumentDB index name constraints     #7134</p> </li> </ul> <p>Management</p> <ul> <li>Application subscriptions API keys buttons are not visible     #7273</li> </ul> <p>Policy Groovy</p> <ul> <li>Cannot iterate on Map with entry and trim on GStringImpl     #7302</li> </ul> <p>Policy JavaScript</p> <ul> <li>Allows to break request/response on content phase     #7173</li> </ul>","location":"apim/changelog/changelog-3.15/#bug-fixes_13","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.15.5 (2022-03-09)","text":"","location":"apim/changelog/changelog-3.15/#apim-3155-2022-03-09","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>Health check does not pull out unhealthy endpoints     #7250</li> </ul>","location":"apim/changelog/changelog-3.15/#bug-fixes_14","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.15.4 (2022-03-07)","text":"","location":"apim/changelog/changelog-3.15/#apim-3154-2022-03-07","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>APIM</p> <ul> <li> <p>Condition generated automatically when maximum time limit is set in     API logging does not work     #7205</p> </li> <li> <p>[policy-basic-authentication] Error message is received when using     basic authentication policy     #7198</p> </li> </ul> <p>General</p> <ul> <li>Merge 3.14.1 in 3.15.x     #7162</li> </ul> <p>Management</p> <ul> <li>OAS - servers without basepath make import fail     #7227</li> </ul> <p>Metrics-reporter-policy</p> <ul> <li>Metrics reporting not done at the good time     #7194</li> </ul> <p>Resource-cache-redis</p> <ul> <li>User cannot save configuration     #7172</li> </ul>","location":"apim/changelog/changelog-3.15/#bug-fixes_15","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Features","text":"<p>Expression-language</p> <ul> <li>Improve map access with dot     #7228</li> </ul>","location":"apim/changelog/changelog-3.15/#features","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.15.3 (2022-02-07)","text":"","location":"apim/changelog/changelog-3.15/#apim-3153-2022-02-07","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>Error on API deployment on environment without HrId     #7053</li> </ul> <p>Management</p> <ul> <li> <p>Image not found when sending a email     #7057</p> </li> <li> <p>Can\u2019t get API plans on JDBC when API has no category     #7060</p> </li> <li> <p>SQL error on subscription with PostgreSQL or MsSql     #7051</p> </li> </ul>","location":"apim/changelog/changelog-3.15/#bug-fixes_16","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.15.2 (2022-02-03)","text":"","location":"apim/changelog/changelog-3.15/#apim-3152-2022-02-03","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>Platform</p> <ul> <li>IllegalArgumentException unsupported cipher suite when enforcing tls     protocols     #7038</li> </ul>","location":"apim/changelog/changelog-3.15/#bug-fixes_17","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.15.1 (2022-01-31)","text":"","location":"apim/changelog/changelog-3.15/#apim-3151-2022-01-31","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>Management</p> <ul> <li>[policy] Rest-to-Soap doesn\u2019t work anymore     #7025</li> </ul>","location":"apim/changelog/changelog-3.15/#bug-fixes_18","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.15.0 (2022-01-27)","text":"","location":"apim/changelog/changelog-3.15/#apim-3150-2022-01-27","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Raise error if update API try to update an existing plan belonging     to another API     #6693</p> </li> <li> <p>Use provided page ID when updating API     #6694</p> </li> <li> <p>Kubernetes certificate not working with kubernetes &gt;= 1.20     #6906</p> </li> </ul>","location":"apim/changelog/changelog-3.15/#bug-fixes_19","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Features","text":"<p>Gateway</p> <ul> <li>Performances improvements     #6492</li> </ul> <p>General</p> <ul> <li>API Path-based creation deprecation     #6377</li> </ul> <p>Platform</p> <ul> <li> <p>Update Dockerfile for java 17 support     #6930</p> </li> <li> <p>Support for Java 17 runtime     #6708</p> </li> </ul> <p>Policies Management</p> <ul> <li> <p>Conditional policies     #6629</p> </li> <li> <p>Add a condition for execution     #6614</p> </li> <li> <p>View if a policy is conditional     #6615</p> </li> <li> <p>View if a flow is conditional     #6626</p> </li> </ul> <p>Portal alerts</p> <ul> <li> <p>Add a description field for alert     #6803</p> </li> <li> <p>Allow alert configuration by API     #6702</p> </li> <li> <p>Allow alert notification via webhook     #6703</p> </li> </ul>","location":"apim/changelog/changelog-3.15/#features_1","tags":["APIM 3.15.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM 3.18.x Changelog","text":"<p>This page contains the changelog entries for APIM 3.18.0 and all subsequent minor APIM 3.18.x releases.</p>","location":"apim/changelog/changelog-3.18/","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"About upgrades","text":"<p>For upgrade instructions, please refer to the APIM Migration Guide.</p>  <p>Warning</p> <p>Important: If you plan to skip versions when you upgrade, ensure that you read the version-specific upgrade notes for each intermediate version. You may be required to perform manual actions as part of the upgrade.</p>","location":"apim/changelog/changelog-3.18/#about-upgrades","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.18.17 (2023-01-04)","text":"","location":"apim/changelog/changelog-3.18/#apim-31817-2023-01-04","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"API","text":"<ul> <li>Add a default value in liquibase script when adding a non-nullable     constraint on <code>commands</code> table</li> </ul>","location":"apim/changelog/changelog-3.18/#api","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.18.16 (2023-01-04)","text":"","location":"apim/changelog/changelog-3.18/#apim-31816-2023-01-04","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"API","text":"<ul> <li> <p>Handle flow steps order in database     #8805</p> </li> <li> <p>Handle query with page number higher than max page with data     #8773</p> </li> </ul>","location":"apim/changelog/changelog-3.18/#api_1","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.18.15 (2023-01-03)","text":"","location":"apim/changelog/changelog-3.18/#apim-31815-2023-01-03","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Gateway","text":"<ul> <li> <p>API key plan was not useable after migration to 3.18     #8762</p> </li> <li> <p>Non-explicit \"invalid version format: 0\" log message fixed     #8754</p> </li> </ul>","location":"apim/changelog/changelog-3.18/#gateway","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Management","text":"<ul> <li> <p>PostgreSQL: management API failed to start after 3.18 migration     #8774</p> </li> <li> <p>Import API erased plan general conditions     #8767</p> </li> <li> <p>API key revocation raised an error in non-default environment</p> </li> </ul>","location":"apim/changelog/changelog-3.18/#management","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.18.14 (2022-12-16)","text":"","location":"apim/changelog/changelog-3.18/#apim-31814-2022-12-16","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"General","text":"<ul> <li> <p>Dynamic property schedule is now updateable     #8529</p> </li> <li> <p>Log details no longer fail with closed OAuth 2 or JWT plan     #8685</p> </li> <li> <p>Optimized database access when searching APIs</p> </li> </ul>","location":"apim/changelog/changelog-3.18/#general","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Gateway","text":"<ul> <li> <p>Manage multiple accept headers with quality factor</p> </li> <li> <p>Handle SSL configuration in Debug mode     #8711</p> </li> </ul>","location":"apim/changelog/changelog-3.18/#gateway_1","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Management","text":"<ul> <li> <p>Add <code>authMethods</code> choices to be used by the Vert.x mail client of     the Email Notifier to restrict the choices of authentication methods     #8655</p> </li> <li> <p>Properly handle special characters in username     #8673</p> </li> </ul>","location":"apim/changelog/changelog-3.18/#management_1","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Console","text":"<ul> <li> <p>Automatically display api subscriptions when browsing the     subscription screen     #8739</p> </li> <li> <p>Include archived applications in the filters available in the log     screen #8690</p> </li> <li> <p>Fix display of log details with closed oauth2 or jwt plan     #8685</p> </li> </ul>","location":"apim/changelog/changelog-3.18/#console","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Portal","text":"<ul> <li>Remove untranslated metadata name placeholder     #7235</li> </ul>","location":"apim/changelog/changelog-3.18/#portal","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.18.13 (2022-11-25)","text":"","location":"apim/changelog/changelog-3.18/#apim-31813-2022-11-25","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li>Design studio\u2019s debug mode is not working in gateway bridge     configuration     #8486</li> </ul> <p>General</p> <ul> <li>Merge 3.15.18 into 3.18.x     #8658</li> </ul> <p>Management</p> <ul> <li> <p>Api subscribers resource should return nothing when there is no     subscriptions.     #8630</p> </li> <li> <p>Duplicate users on login when special characters     #8672</p> </li> </ul>","location":"apim/changelog/changelog-3.18/#bug-fixes","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Improvements","text":"<p>Gateway</p> <ul> <li>API Keys Synchronization - Lazy loading mechanism implementation     #8680</li> </ul>","location":"apim/changelog/changelog-3.18/#improvements","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Features","text":"<p>Management</p> <ul> <li>Possibility to override the default background image of the APIM     Developer Portal from the theme customisation page</li> </ul>","location":"apim/changelog/changelog-3.18/#features","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Improvements","text":"<p>General</p> <ul> <li> <p>Support Inline lists in Expression Language     #7894</p> </li> <li> <p>Clearly explain how to have the Portal on a dynamic base url     #8518.     More information     here</p> </li> </ul>","location":"apim/changelog/changelog-3.18/#improvements_1","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.18.12 (2022-11-04)","text":"","location":"apim/changelog/changelog-3.18/#apim-31812-2022-11-04","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>Management</p> <ul> <li> <p>Max clause count set to 1024 error when searching for apis     #8568</p> </li> <li> <p>Error when trying get the subscribers to an api     #8567</p> </li> <li> <p>Issue when trying to promote API through Cockpit     #8598</p> </li> </ul> <p>Gateway</p> <ul> <li> <p>Accept-Encoding headers should not be deleted from the gateway     #7935</p> </li> <li> <p>Incorrect Status Code description when using Response Template     #8613</p> </li> </ul> <p>Policy</p> <ul> <li>[Cache] Query parameters should be part of the default cache key     #8366</li> </ul>","location":"apim/changelog/changelog-3.18/#bug-fixes_1","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Features","text":"<p>Management</p> <ul> <li>Possibility to override the default background image of the APIM     Developer Portal from the theme customisation page</li> </ul>","location":"apim/changelog/changelog-3.18/#features_1","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Improvements","text":"<p>General</p> <ul> <li>Clearly explain how to have the Portal on a dynamic base url     #8518.     More information     here</li> </ul>","location":"apim/changelog/changelog-3.18/#improvements_2","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.18.11 (2022-10-13)","text":"","location":"apim/changelog/changelog-3.18/#apim-31811-2022-10-13","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>Api key synchronization process consumes too much database resources     #8565</li> </ul> <p>General</p> <ul> <li> <p>DELETE user throw errors when user is member of an API     #8566</p> </li> <li> <p>Allow nested EL expressions     #8564</p> </li> </ul>","location":"apim/changelog/changelog-3.18/#bug-fixes_2","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.18.10 (2022-09-23)","text":"","location":"apim/changelog/changelog-3.18/#apim-31810-2022-09-23","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>Dedicated implementation for hybrid deployment standalone mode     #8482</li> </ul> <p>Management</p> <ul> <li> <p>Server unreachable when trying to subscribe to APIs     #8496</p> </li> <li> <p>Status codes in the dashboard are not sorted in order     #8497</p> </li> </ul>","location":"apim/changelog/changelog-3.18/#bug-fixes_3","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.18.9 (2022-09-16)","text":"","location":"apim/changelog/changelog-3.18/#apim-3189-2022-09-16","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li> <p>Design studio\u2019s debug mode is not working in gateway bridge     configuration     #8373</p> </li> <li> <p>Subscription Page can not be displayed when having a lot of     applications (more than 10k)     #8421</p> </li> </ul> <p>Gateway</p> <ul> <li>Plan selector should throw 401 on wrong API-Key even if a keyless     plan is available     #8452</li> </ul> <p>General</p> <ul> <li>Regex quantifier wrongly interpreted causing matching issues     #8367</li> </ul> <p>Management</p> <ul> <li> <p>Health check not properly reported as unhealthy if timeout occurs     when reaching the backend     #8429</p> </li> <li> <p>Restore plan selection behavior with multi OAuth plans without     selection rule     #8460</p> </li> </ul> <p>Portal</p> <ul> <li>Validate button does not work when trying to subscribe to an API     with general conditions set     #8442</li> </ul>","location":"apim/changelog/changelog-3.18/#bug-fixes_4","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Improvements","text":"<p>General</p> <ul> <li>Support Inline lists in Expression Language     #7894</li> </ul>","location":"apim/changelog/changelog-3.18/#improvements_3","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.18.8 (2022-09-07)","text":"","location":"apim/changelog/changelog-3.18/#apim-3188-2022-09-07","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Api key repository search method causing OOM error on DocumentDB     #8419</li> </ul> <p>Management</p> <ul> <li> <p>Exported paths based APIs can not be imported     #8365</p> </li> <li> <p>[Debug Mode] Query params are not well displayed     #7779</p> </li> </ul>","location":"apim/changelog/changelog-3.18/#bug-fixes_5","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.18.7 (2022-08-31)","text":"","location":"apim/changelog/changelog-3.18/#apim-3187-2022-08-31","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li> <p>Inconsistent behavior for API out of sync banner     #8343</p> </li> <li> <p>User\u2019s list of APIs doesn\u2019t display properly     #8344</p> </li> </ul> <p>Gateway</p> <ul> <li>Improve plan selection based on subscription     #8167</li> </ul> <p>Policy</p> <ul> <li>[XSLT transformation] parameter get cached depending on the number     of gateways     #8387</li> </ul> <p>General</p> <ul> <li> <p>Merge 3.15.14 in 3.18.x     #8355</p> </li> <li> <p>Merge 3.15.15 in 3.18.x     #8371</p> </li> </ul>","location":"apim/changelog/changelog-3.18/#bug-fixes_6","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.18.6 (2022-08-23)","text":"","location":"apim/changelog/changelog-3.18/#apim-3186-2022-08-23","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Improvements","text":"<p>General</p> <ul> <li>Improve application search in subscription process -     #8329</li> </ul>","location":"apim/changelog/changelog-3.18/#improvements_4","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.18.5 (2022-08-17)","text":"","location":"apim/changelog/changelog-3.18/#apim-3185-2022-08-17","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li> <p>Use correct path in constants.json     #8283</p> </li> <li> <p>When dragging Json to XML policy in Design Studio, Save button is     not displayed     #8227</p> </li> </ul> <p>Management</p> <ul> <li> <p>Application client_id update is ignored     #8278</p> </li> <li> <p>NullPointerException when deleting a group     #8320</p> </li> <li> <p>Platform alerts never triggered     #8269</p> </li> <li> <p>Temporary allow <code>null</code> value for host in virtual-hosts     #8300</p> </li> </ul> <p>Portal</p> <ul> <li>Unable to refresh a page when deploying with Docker     #8317</li> </ul> <p>Reporters</p> <ul> <li>File and TCP reporters - filtering feature not fully implemented for     headers #8226</li> </ul>","location":"apim/changelog/changelog-3.18/#bug-fixes_7","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Features","text":"<p>Console</p> <ul> <li>Disable in-app documentation when Pendo is activated     #8292</li> </ul>","location":"apim/changelog/changelog-3.18/#features_2","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li>Global performances improvement of GET /applications     #7836</li> </ul>","location":"apim/changelog/changelog-3.18/#improvements_5","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.18.4 (2022-08-02)","text":"","location":"apim/changelog/changelog-3.18/#apim-3184-2022-08-02","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Error while trying to connect using IDP with group mapping     #8205</p> </li> <li> <p>Merge APIM <code>3.17.5</code> into <code>3.18.x</code> #8265</p> </li> </ul>","location":"apim/changelog/changelog-3.18/#bug-fixes_8","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Features","text":"<p>General</p> <ul> <li>Add <code>gateway-bridge-http-server</code> to the APIM REST API bundle     #8133</li> </ul>","location":"apim/changelog/changelog-3.18/#features_3","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.18.3 (2022-07-20)","text":"","location":"apim/changelog/changelog-3.18/#apim-3183-2022-07-20","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>Management</p> <ul> <li> <p>Handle Pendo ApiKey with correct attribute in <code>gravitee.yaml</code> #8155</p> </li> <li> <p>Mongodb migrations scripts fails     #8147</p> </li> <li> <p>Management API fails to start if API without primary     #8130</p> </li> </ul>","location":"apim/changelog/changelog-3.18/#bug-fixes_9","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.18.2 (2022-07-15)","text":"","location":"apim/changelog/changelog-3.18/#apim-3182-2022-07-15","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>Management</p> <ul> <li>Can\u2019t login when using JDBC database     #8110</li> </ul>","location":"apim/changelog/changelog-3.18/#bug-fixes_10","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.18.1 (2022-07-08)","text":"","location":"apim/changelog/changelog-3.18/#apim-3181-2022-07-08","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>file reporter log files are not created     #8065</li> </ul> <p>General</p> <ul> <li>Update build version number of Console and Portal     #8072</li> </ul> <p>Portal</p> <ul> <li>OpenAPI specification of the Portal API not available     #8074</li> </ul>","location":"apim/changelog/changelog-3.18/#bug-fixes_11","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.18.0 (2022-07-07)","text":"","location":"apim/changelog/changelog-3.18/#apim-3180-2022-07-07","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li> <p>Remove the horizontal scroll bar in the markdown creation page     #5119</p> </li> <li> <p>Wrong example when generating Personal Access Token     #5271</p> </li> <li> <p>Not_equals alert filter displays an empty list     #7489</p> </li> <li> <p>Icons not rendering with custom nginx configuration     #7569</p> </li> </ul> <p>General</p> <ul> <li>Merge 3.17.2 into master     #7617</li> </ul> <p>Management</p> <ul> <li> <p>DCR providers should be scoped by org     #6604</p> </li> <li> <p>One shot upgraders run on each APIM startup with cockpit     #7450</p> </li> <li> <p>OpenApi files are never updated     #7631</p> </li> </ul> <p>Policies</p> <ul> <li> <p>Retry Policy: cancel timeout response, manage lastResponse counter     and tests     #7747</p> </li> <li> <p>Data Logging Masking: fix some bugs     #7758</p> </li> </ul>","location":"apim/changelog/changelog-3.18/#bug-fixes_12","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Features","text":"<p>Console</p> <ul> <li> <p>Promote API Designer     #7645</p> </li> <li> <p>Add Pendo analytics tool     #7781</p> </li> </ul> <p>General</p> <ul> <li>Support of RHEL8     #7208</li> </ul> <p>Management</p> <ul> <li> <p>Partial update - PATCH method on Import API     #7443</p> </li> <li> <p>Add page to display organization Audit     #7536</p> </li> </ul> <p>Policies</p> <ul> <li> <p>Transform-Header: Define headers based on the request or on the     response payload     #7359</p> </li> <li> <p>Circuit Breaker: Write documentation for policy     #7756</p> </li> </ul>","location":"apim/changelog/changelog-3.18/#features_4","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"Improvements","text":"<p>Console</p> <ul> <li> <p>API properties header title change     #6065</p> </li> <li> <p>Add Conditional icon in legend     #7457</p> </li> </ul> <p>General</p> <ul> <li>Mutualize System proxy configuration     #7739</li> </ul> <p>Portal</p> <ul> <li>Migrate to last Angular version     #6666</li> </ul>","location":"apim/changelog/changelog-3.18/#improvements_6","tags":["APIM 3.18.x Changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM 3.19.x changelog","text":"<p>This page contains the changelog entries for APIM 3.19.0 and all subsequent minor APIM 3.19.x releases.</p>","location":"apim/changelog/changelog-3.19/","tags":["APIM 3.19.x changelog","Changelog","Release notes","Upgrades"]},{"title":"About upgrades","text":"<p>For upgrade instructions, please refer to the APIM Migration Guide.</p>  <p>Warning</p> <p>Important: If you plan to skip versions when you upgrade, ensure that you read the version-specific upgrade notes for each intermediate version. You may be required to perform manual actions as part of the upgrade.</p>","location":"apim/changelog/changelog-3.19/#about-upgrades","tags":["APIM 3.19.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.19.6 (2023-01-05)","text":"","location":"apim/changelog/changelog-3.19/#apim-3196-2023-01-05","tags":["APIM 3.19.x changelog","Changelog","Release notes","Upgrades"]},{"title":"API","text":"<ul> <li>Add a default value in liquibase script when adding a non-nullable     constraint on <code>commands</code> table</li> </ul>","location":"apim/changelog/changelog-3.19/#api","tags":["APIM 3.19.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.19.5 (2023-01-04)","text":"","location":"apim/changelog/changelog-3.19/#apim-3195-2023-01-04","tags":["APIM 3.19.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Gateway","text":"<ul> <li> <p>API key plan was not useable after migration to 3.18     #8762</p> </li> <li> <p>Non-explicit \"invalid version format: 0\" log message fixed     #8754</p> </li> </ul>","location":"apim/changelog/changelog-3.19/#gateway","tags":["APIM 3.19.x changelog","Changelog","Release notes","Upgrades"]},{"title":"API","text":"<ul> <li> <p>Handle flow steps order in database     #8805</p> </li> <li> <p>Handle query with page number higher than max page with data     #8773</p> </li> <li> <p>PostgreSQL: management API failed to start after 3.18 migration     #8774</p> </li> <li> <p>Import API erased plan general conditions     #8767</p> </li> <li> <p>API key revocation raised an error in non-default environment</p> </li> </ul>","location":"apim/changelog/changelog-3.19/#api_1","tags":["APIM 3.19.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Portal","text":"<ul> <li>Category name was not properly displayed on API page     #8628</li> </ul>","location":"apim/changelog/changelog-3.19/#portal","tags":["APIM 3.19.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.19.4 (2022-12-02)","text":"","location":"apim/changelog/changelog-3.19/#apim-3194-2022-12-02","tags":["APIM 3.19.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Avoid to evict subscription when we close it and accept a new one     #8637</p> </li> <li> <p>Merge 3.18.13 into 3.19.x     #8682</p> </li> </ul>","location":"apim/changelog/changelog-3.19/#bug-fixes","tags":["APIM 3.19.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.19.1 (2022-10-21)","text":"","location":"apim/changelog/changelog-3.19/#apim-3191-2022-10-21","tags":["APIM 3.19.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>Management</p> <ul> <li>Paths based APIs failed to match subscription     #8570</li> </ul>","location":"apim/changelog/changelog-3.19/#bug-fixes_1","tags":["APIM 3.19.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.19.0 (2022-10-04)","text":"","location":"apim/changelog/changelog-3.19/#apim-3190-2022-10-04","tags":["APIM 3.19.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Merge <code>3.18.x</code> into <code>3.19.0</code> #8500</li> </ul> <p>Management</p> <ul> <li> <p>Response template config asks for Content-Type but Accept header     param is taken into account instead     #8263</p> </li> <li> <p>Subscription start date is ignored     #7311</p> </li> </ul>","location":"apim/changelog/changelog-3.19/#bug-fixes_2","tags":["APIM 3.19.x changelog","Changelog","Release notes","Upgrades"]},{"title":"Features","text":"<p>Beta - Gravitee Kubernetes Operator</p> <ul> <li> <p>Make the gateway listen to ConfigMap     #8189</p> </li> <li> <p>Define ManagementContext to target specific environment     #7982</p> </li> <li> <p>Create API using CRD on Management API     #7980</p> </li> <li> <p>Start/stop an API on gateway using CRD     #8136</p> </li> <li> <p>Update an API using CRD     #7981</p> </li> </ul> <p>Beta - New gateway execution engine</p> <ul> <li> <p>Issue with response template and invoker timeout     #8075</p> </li> <li> <p>Reactive Timeout     #7988</p> </li> <li> <p>Security plan execution     #7991</p> </li> <li> <p>Support Failover     #8086</p> </li> </ul> <p>Alpha - Introducing Event-Native API Management</p> <ul> <li> <p>Introduce v4 api defitinion to support sync &amp; async APIs     #8068</p> </li> <li> <p>Deploy v4 api definition     #8009</p> </li> <li> <p>Subscribe to V4 APIs     #8287</p> </li> <li> <p>Http-post entrypoint     #8036</p> </li> <li> <p>[Kafka endpoint] Publish to topic     #8247</p> </li> <li> <p>[Kafka endpoint] Subscribe to topic     #8245</p> </li> </ul>","location":"apim/changelog/changelog-3.19/#features","tags":["APIM 3.19.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM 3.20.x changelog","text":"<p>This page contains the changelog entries for APIM 3.20.0 and any future minor APIM 3.20.x releases.</p>","location":"apim/changelog/changelog-3.20/","tags":["APIM 3.20.x changelog","Changelog","Release notes","Upgrades"]},{"title":"About upgrades","text":"<p>For upgrade instructions, please refer to the APIM Migration Guide.</p>  <p>Warning</p> <p>Important: If you plan to skip versions when you upgrade, ensure that you read the version-specific upgrade notes for each intermediate version. You may be required to perform manual actions as part of the upgrade.</p>","location":"apim/changelog/changelog-3.20/#about-upgrades","tags":["APIM 3.20.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM - 3.20 (2023-01-05)","text":"","location":"apim/changelog/changelog-3.20/#apim-320-2023-01-05","tags":["APIM 3.20.x changelog","Changelog","Release notes","Upgrades"]},{"title":"API Management - Console","text":"<ul> <li> <p>Brand new menu to unify the experience between all Gravitee products</p> </li> <li> <p>Introducing v1 APIs reaching end of support and help users migrate     to v2</p> </li> <li> <p>APIs list page navigation enhancements</p> </li> <li> <p>APIs are read-only if managed by our GKO (Gravitee Kubernetes     Operator)</p> </li> <li> <p>Allow to delete a media using the Management API</p> </li> <li> <p>[V4 BETA M-API] Manage v4 APIs subscriptions as an API Publisher &amp;     an API Consumer</p> </li> </ul> <p>Event-Native API Management (Beta)</p> <ul> <li> <p>Endpoint - Kafka Connector Advanced (EE)</p> <ul> <li> <p>Ability to connect to a secured Kafka cluster</p> </li> <li> <p>Introducing RESUME &amp; LIMIT capabilities for QoS (Quality of     Service)</p> </li> </ul> </li> <li> <p>Endpoint - MQTT5 Connector</p> <ul> <li> <p>Consume messages from a MQTT5 event-broker</p> </li> <li> <p>Push messages to a MQTT5 event-broker</p> </li> </ul> </li> <li> <p>Endpoint - MQTT5 Connector Advanced (EE)</p> <ul> <li> <p>Ability to connect to a secured MQTT5 event-broker</p> </li> <li> <p>Introducing QoS (Quality of Service) capabilities</p> </li> </ul> </li> <li> <p>Entrypoint - Webhook connector</p> <ul> <li> <p>Create an API with a webhook entrypoint</p> </li> <li> <p>Subscribe to an API with a webhook entrypoint</p> </li> <li> <p>Receive messages on my callback url</p> </li> </ul> </li> <li> <p>Introducing foundation support for sync API on v4 - httpproxy     entrypoint &amp; endpoint</p> </li> <li> <p>Message filtering policy</p> </li> <li> <p>Support conditions on messages</p> </li> </ul> <p>Gravitee Kubernetes Operator (Beta)</p> <ul> <li> <p>CRD Lifecycle - Apply changes related CRDs on update</p> </li> <li> <p>Store credentials in K8 secrets</p> </li> <li> <p>Export a complex API and import it in a new/same environment</p> </li> <li> <p>Manage resources as CRD and reuse them in several APIs</p> </li> </ul>","location":"apim/changelog/changelog-3.20/#api-management-console","tags":["APIM 3.20.x changelog","Changelog","Release notes","Upgrades"]},{"title":"APIM pre-3.15.x changelog","text":"<p>This page contains the changelog entries for APIM 3.19.0 and all subsequent minor APIM 3.19.x releases.</p>","location":"apim/changelog/changelog-eos/","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"About upgrades","text":"<p>For upgrade instructions, please refer to the APIM Migration Guide.</p>  <p>Warning</p> <p>Important: If you plan to skip versions when you upgrade, ensure that you read the version-specific upgrade notes for each intermediate version. You may be required to perform manual actions as part of the upgrade.</p>","location":"apim/changelog/changelog-eos/#about-upgrades","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.10.21 (2022-09-16)","text":"","location":"apim/changelog/changelog-eos/#apim-31021-2022-09-16","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Gateway</p> <ul> <li>We have added a new property that enables you to configure the     worker pool size of the HTTP handlers in Bridge mode. To do so, set     the desired size using the <code>services.bridge.http.workerPoolSize</code>     property (the default value is <code>20</code>) and ensure that it is set on     the Gateway Bridge Server side.</li> </ul>","location":"apim/changelog/changelog-eos/#improvements","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Management</p> <ul> <li>Restore plan selection to the behavior it had in APIM 3.10.18 and     lower.</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.17.6 (2022-08-03)","text":"","location":"apim/changelog/changelog-eos/#apim-3176-2022-08-03","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Management</p> <ul> <li>Application client_id update is ignored     #8281</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_1","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"General information","text":"<p>The version 3.17.6 is the last version of the 3.17. We encourage everybody to migrate to 3.18. == APIM - 3.10.19 (2022-08-03)</p>","location":"apim/changelog/changelog-eos/#general-information","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li> <p>An error is displayed when trying to send a message to Users, Owners     and Application Read only     #7253</p> </li> <li> <p>Link to my account is broken in org settings     #6848</p> </li> <li> <p>Subscription pull-down menu displays APIs the user doesn\u2019t have     access to     #7890</p> </li> </ul> <p>Gateway</p> <ul> <li>Heartbeat service do not handle database and timeout exceptions     #8267</li> </ul> <p>Management</p> <ul> <li> <p>Better select plan based on subscription     #7824</p> </li> <li> <p>Improve email template sanitization     #8163</p> </li> <li> <p>Information button on Dictionary doesn\u2019t display anything     #5056</p> </li> <li> <p>Restore an application with an existing clientId create duplication     #6380</p> </li> </ul> <p>Policy</p> <ul> <li>OpenId Connect - UserInfo - Do not use payload in header     #7915</li> </ul> <p>Regex-threat-support-policy</p> <ul> <li>Policy failed silently on a call with a boolean parameter     #8272</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_2","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Console</p> <ul> <li>Login form error handling, when login with no environment     permissions     #6532</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_1","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"General information","text":"<p>The version 3.10.19 is the last version of the 3.10. We encourage everybody to migrate to 3.18. == APIM - 3.17.5 (2022-08-01)</p>","location":"apim/changelog/changelog-eos/#general-information_1","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li> <p>Closed subscription is displayed as still subscribed     #7879</p> </li> <li> <p>Debug mode join multi value headers     #7809</p> </li> </ul> <p>General</p> <ul> <li> <p>Log file are not created     #8066</p> </li> <li> <p>Merge 3.16.4 in 3.17.x     #7869</p> </li> <li> <p>Merge 3.15.13 into 3.17.x     #8225</p> </li> </ul> <p>Management</p> <ul> <li>Update a role API requires an <code>id</code> field when this is not     necessary/required based on the doc     #7661</li> </ul> <p>Policies</p> <ul> <li> <p>Groovy policy error on HTTP headers     #7810</p> </li> <li> <p>Truncated <code>request.content</code> in Callout Http Policy when body     contains accents     #8109</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_3","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Node</p> <ul> <li>Expose endpoints for retrieving heap dump and thread dump     #8222 ==     APIM - 3.10.18     (2022-07-20)</li> </ul>","location":"apim/changelog/changelog-eos/#features","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li>Listening host in virtual-host mode is changed to null when saving     #7856</li> </ul> <p>Management</p> <ul> <li> <p>Application update removes Oauth client data if DCR unreachable     #7953</p> </li> <li> <p>Fixed API import process failing when creating member roles     #7822</p> </li> <li> <p>Subscription created without API Key     #7332</p> </li> <li> <p>Fixed the display of healthcheck logs (backport of 3.15)     #8107 ==     APIM - 3.17.4     (2022-07-05)</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_4","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>APIM</p> <ul> <li>API alerts do not show in analytics     #7480</li> </ul> <p>General</p> <ul> <li>Merge 3.16.5 in 3.17.x     #7787 ==     APIM - 3.16.5     (2022-07-04)</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_5","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Merge 3.15.10 in 3.16.x     #7868</p> </li> <li> <p>Merge 3.15.11 in 3.16.x     #7961 ==     APIM - 3.10.17     (2022-06-24)</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_6","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li>BestMatch Flow mode does not work for Platform flow     #7625</li> </ul> <p>Gateway</p> <ul> <li>Service Discovery error when configured with more than one API     #7821</li> </ul> <p>General</p> <ul> <li>Update Logback library     #7837</li> </ul> <p>Management</p> <ul> <li> <p>Can Transfer Ownership via cURL or Postman where there is no Primary     Owner in the Group.     #6994</p> </li> <li> <p>Regression in API imports     #7807</p> </li> </ul> <p>Repository</p> <ul> <li>[JDBC] Api disappears for all users including org admin when group     default role is changed to non primary_owner     #7428</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_7","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.10.16 (2022-06-13)","text":"","location":"apim/changelog/changelog-eos/#apim-31016-2022-06-13","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li> <p>Filter disabled flows and flows steps     #7794</p> </li> <li> <p>Hazelcast is referring to a queue but get a topic     #7681</p> </li> <li> <p>Headers are not forwarded to websocket upstream     #7750</p> </li> <li> <p>OOM when heartbeat event can\u2019t be delivered     #7806</p> </li> <li> <p>OOM in case of Connect timeouts in health-check     #7709</p> </li> <li> <p>Max logging size must accept smaller size than MB     #7761</p> </li> <li> <p>ElasticSearch indexing data is getting out of bounds on Server Sent     Event APIs (api-response-time)     #7094</p> </li> </ul> <p>Repositories</p> <ul> <li>Switch implementation to IO thread     #7682</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_8","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.10.15 (2022-05-25)","text":"","location":"apim/changelog/changelog-eos/#apim-31015-2022-05-25","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li> <p>Alert not correctly displayed/saved     #6705</p> </li> <li> <p>An organization user (and environnement admin) can\u2019t delete a     dictionary he has created     #6556</p> </li> <li> <p>Count function, when saving alert, not saved properly     #7279</p> </li> <li> <p>Error in console when opening APIM Console     #7737</p> </li> <li> <p>Padding issue on content of some Console screen     #7738</p> </li> </ul> <p>Gateway</p> <ul> <li> <p>Connexion not closed with Server Sent Event APIs     #7093</p> </li> <li> <p>Elasticsearch ilm index_mode is missing rollover_alias and first     index is not created     #7110</p> </li> <li> <p>First dynamic dictionary start causes an IllegalArgumentException on     the gateway     #6044</p> </li> </ul> <p>General</p> <ul> <li>Error when importing an API without logging on an env with     <code>Logging audit events</code> activated     #7612</li> </ul> <p>Management</p> <ul> <li> <p>Allow to use System Proxy on Generic Oauth2 resource as already     present for AM resource     #7258</p> </li> <li> <p>Can\u2019t update a dynamic dictionary     #6043</p> </li> <li> <p>Cannot import APi with primary owner of type group and empty members     list in group mode     #6808</p> </li> <li> <p>Dynamic Property does not get updated after it was created     #7684</p> </li> <li> <p>Error while deleting a user     #7613</p> </li> <li> <p>Fix EnvironmentNotFoundException for task     #7635</p> </li> <li> <p>Issue when deleting the properties of a dictionary     #6996</p> </li> <li> <p>Logging condition with timestamp returns status 500     #7367</p> </li> <li> <p>Wrong log audit date for refresh dictionary events     #6045</p> </li> </ul> <p>Portal</p> <ul> <li> <p>Delete/remove member button does not work     #7241</p> </li> <li> <p>Unable to reply to a rating     #6869</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_9","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li>Add Secure Flag by default on each cookie     #7725</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_2","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.17.3 (2022-05-12)","text":"","location":"apim/changelog/changelog-eos/#apim-3173-2022-05-12","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Cannot connect to APIM from Cockpit     #7649</li> </ul> <p>Management</p> <ul> <li>Mongodb queries fail when encountering a document with a field set     to <code>undefined</code> #7610</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_10","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.17.2 (2022-05-03)","text":"","location":"apim/changelog/changelog-eos/#apim-3172-2022-05-03","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Merge 3.16.4 in 3.17.x     #7615</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_11","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.16.4 (2022-04-29)","text":"","location":"apim/changelog/changelog-eos/#apim-3164-2022-04-29","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>500 Internal Server Error when using Transform Headers policy in     combination with API-Key validationkey     #7499</p> </li> <li> <p>Merge 3.15.8 in 3.16.x     #7585</p> </li> </ul> <p>Management</p> <ul> <li>Backport #7450 on 3.16 One shot upgraders run on each APIM startup     with cockpit     #7452</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_12","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.10.14 (2022-04-21)","text":"","location":"apim/changelog/changelog-eos/#apim-31014-2022-04-21","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>APIM</p> <ul> <li>All APIs in the Console that do not have Group/s as direct members     have all Groups in Members. Only with Postgresql.     #7429</li> </ul> <p>General</p> <ul> <li> <p>Backport of #7489 in 3.10.x     #7490</p> </li> <li> <p>When filtering through the logs, showing results as the maximum     alows, and no other pages even though there are more results     #6913</p> </li> </ul> <p>Management</p> <ul> <li> <p>Alerts are not scoped to environment     #6079</p> </li> <li> <p>Backport #7450 on 3.10 One shot upgraders run on each APIM startup     with cockpit     #7454</p> </li> <li> <p>Org. admin is not allowed to transfer API ownership     #7395</p> </li> </ul> <p>Repository</p> <ul> <li>MongoDB with self-signed SSL certificate     #7539</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_13","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>General</p> <ul> <li>Set Version V3_X by default on creation form     #6454</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_3","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.17.1 (2022-04-07)","text":"","location":"apim/changelog/changelog-eos/#apim-3171-2022-04-07","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>$facet operator not supported in documentDB causes errors in 3.17.0     #7422</p> </li> <li> <p>Merge 3.16.3 in 3.17.x     #7442</p> </li> </ul> <p>Management</p> <ul> <li> <p>Backport #7450 on 3.17 One shot upgraders run on each APIM startup     with cockpit     #7451</p> </li> <li> <p>Java heap space when requesting the OpenAPI specification     #7460</p> </li> <li> <p>Platform Flows deleted after a restart when connected to Cockpit     #7421</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_14","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.16.3 (2022-04-04)","text":"","location":"apim/changelog/changelog-eos/#apim-3163-2022-04-04","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Content policies returning null stream not displayed in debug mode     #7396</p> </li> <li> <p>Merge 3.15.7 in 3.16.x     #7441</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_15","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.10.13 (2022-04-01)","text":"","location":"apim/changelog/changelog-eos/#apim-31013-2022-04-01","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>Best match doesn\u2019t match any flow     #7412</li> </ul> <p>Management</p> <ul> <li>Platform Flows deleted after a restart when connected to cockpit     #7423</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_16","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Policy</p> <ul> <li>Prevent following policies to reach endpoint when input is invalid:     JSON Validation, JSON Threat Protection, XML Threat Protection and     Regex Threat Protection     #7301 ==     APIM - 3.17.0     (2022-03-29)</li> </ul>","location":"apim/changelog/changelog-eos/#features_1","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Merge 3.16.1     #7268</p> </li> <li> <p>Merge 3.16.2     #7402</p> </li> </ul> <p>Console</p> <ul> <li>In Debug mode (fka Try-It), request does not return the good path     #7220</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_17","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Console</p> <ul> <li> <p>Debug mode:</p> <ul> <li> <p>Dynamic table for request headers     #7149</p> </li> <li> <p>Quick access timeline     #6767</p> </li> <li> <p>Allow use of user context-path     #7072</p> </li> <li> <p>View API call metrics     #7111</p> </li> <li> <p>View condition applied on a policy     #7226</p> </li> <li> <p>View if a policy is set at platform or API level     #7183</p> </li> </ul> </li> <li> <p>Shared API Key:</p> <ul> <li> <p>Toggle Shared API Key mode in settings     #6990</p> </li> <li> <p>Manage Shared API Key at application level     (#6798,     #6801,     #6800,     #6804,     #6796,     #6797,     #7192,     #6795)</p> </li> <li> <p>Choose Shared API-Key mode at application level     #6793</p> </li> <li> <p>De-correlate API-Key and Subscription lifecycle     #7266</p> </li> <li> <p>Prevent Shared API-key Key revocation at API Level     #6799</p> </li> <li> <p>View subscriptions for a Shared-API Key     #6794 Policy</p> <ul> <li>Define headers based on the request or on the response     payload     #7358</li> </ul> </li> </ul> </li> </ul> <p>Portal</p> <ul> <li> <p>Shared API Key:</p> <ul> <li> <p>Manage a shared API Key     #6819</p> </li> <li> <p>Use a shared API Key     (#6816,     #6817,     #6818)</p> </li> </ul> </li> </ul>","location":"apim/changelog/changelog-eos/#features_2","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li>Migrate management API documentation from openAPI V2 (aka swagger)     to v3 #6224</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_4","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.16.2 (2022-03-28)","text":"","location":"apim/changelog/changelog-eos/#apim-3162-2022-03-28","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Merge 3.15.6 in 3.16.x     #7388</p> </li> <li> <p>Platform policies not executed in multi environments context     #7379</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_18","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Policy</p> <ul> <li> <p>Define headers based on the request or on the response payload     #7333</p> </li> <li> <p>Prevent following policies to reach endpoint when input is invalid:     JSON Validation, JSON Threat Protection, XML Threat Protection and     Regex Threat Protection     #7301 ==     APIM - 3.10.12     (2022-03-22)</p> </li> </ul>","location":"apim/changelog/changelog-eos/#features_3","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>APIM</p> <ul> <li>Events not being displayed correctly     #7300</li> </ul> <p>Console</p> <ul> <li> <p>Can\u2019t access a newly created API with import     #7216</p> </li> <li> <p>Condition Logging on API is not displayed after saving     #6978</p> </li> </ul> <p>Gateway</p> <ul> <li>Best Match flow mode doesn\u2019t execute the best matching flow     #6654</li> </ul> <p>Gateway-api</p> <ul> <li>Bad behavior on TransformationException if no policyChain     #7130</li> </ul> <p>General</p> <ul> <li>Let the API Owner choose the Accept-Encoding     #7181</li> </ul> <p>Helm</p> <ul> <li>Api template doesn\u2019t support opening of service core port     #6895</li> </ul> <p>Management</p> <ul> <li>Notify API Consumers contact too many people     #7213</li> </ul> <p>Metrics-reporter-policy</p> <ul> <li>Metrics reporting not done at the good time (backport 7194 in     3.10.x) #7196</li> </ul> <p>Policy</p> <ul> <li>Policy-ssl-enforcementsupport x509 attributes     #7276</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_19","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.16.1 (2022-03-09)","text":"","location":"apim/changelog/changelog-eos/#apim-3161-2022-03-09","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Merge 3.15.4 in 3.16.x     #7224</p> </li> <li> <p>Merge 3.15.5 in 3.16.x     #7265</p> </li> </ul> <p>Management</p> <ul> <li>Policy studio - Save reload the page     #7238</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_20","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.14.1 (2022-03-03)","text":"","location":"apim/changelog/changelog-eos/#apim-3141-2022-03-03","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li> <p>Error when discovery service creates new endpoints     #6727</p> </li> <li> <p>Javascript Policy returns 500 OK in case of failure     #6831</p> </li> </ul> <p>General</p> <ul> <li> <p>Environment variables GRAVITEE_PLUGINS_PATH_X are not working for     gateway service     #6909</p> </li> <li> <p>Merge 3.10.11 in 3.14.x     #7160 ==     APIM - 3.16.0     (2022-02-28)</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_21","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>Platform policies should not be executed first on response     #7138</li> </ul> <p>General</p> <ul> <li>Login redirection is sometimes not working     #7141</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_22","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>General</p> <ul> <li> <p>Add crossId, identifying entities across environments     #7003</p> </li> <li> <p>Enhance ci/cd url with crossId     #7084</p> </li> <li> <p>Debug mode     #6760</p> </li> </ul>","location":"apim/changelog/changelog-eos/#features_4","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.10.11 (2022-02-25)","text":"","location":"apim/changelog/changelog-eos/#apim-31011-2022-02-25","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li> <p>Not full log message is displayed in logs while the full one is     received.     #7017</p> </li> <li> <p>User Information - Label display problem     #5625</p> </li> </ul> <p>Gateway</p> <ul> <li> <p>Http requestTimeout prevents the gateway to log Analytics     #6961</p> </li> <li> <p>Platform policies should not be executed first on response (Backport     #7138 in 3.10.x)     #7143</p> </li> </ul> <p>General</p> <ul> <li> <p>API Primary Owner role check     #6360</p> </li> <li> <p>Anchor links are not working anymore in AsciiDoc files     #6952</p> </li> <li> <p>Merge 3.5.29 in 3.10.x     #6974</p> </li> <li> <p>Merge 3.5.30 in 3.10.x</p> </li> <li> <p>Not able to publish documentation in APIM Portal in a desired order     #6652</p> </li> </ul> <p>Management</p> <ul> <li>Checking \"Show the URL to download the content\" in the swagger     documentation generates and error     #6713</li> </ul> <p>Node</p> <ul> <li>Node_health metric returns null values in 3.10     #6924</li> </ul> <p>Repository</p> <ul> <li>Fix invalid SQL syntax when finding alert triggers     #7163</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_23","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Alert</p> <ul> <li>Alert per endpoint when healthcheck status change     #6728</li> </ul>","location":"apim/changelog/changelog-eos/#features_5","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li>Support OpenSearch     #6890</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_5","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.30 (2022-02-25)","text":"","location":"apim/changelog/changelog-eos/#apim-3530-2022-02-25","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Management</p> <ul> <li>Improve personal token matching performance     #7187</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_24","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.29 (2022-01-19)","text":"","location":"apim/changelog/changelog-eos/#apim-3529-2022-01-19","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li> <p>Starting is very slow when there is a lot of events in database     #6955</p> </li> <li> <p>[bridge] Bridge repository client is not backward compatible     #6884</p> </li> </ul> <p>Management</p> <ul> <li> <p>Deleted dynamic dictionary is never undeployed     #6870</p> </li> <li> <p>Path-mapping import is failing     #6856</p> </li> <li> <p>When importing an API through file or URL path-mapping for analytics     are not created.     #6723</p> </li> <li> <p>[design studio] Conflict with keyboard shortcuts     #6935</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_25","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li>Support OpenSearch     #6889</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_6","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.10.10 (2022-01-14)","text":"","location":"apim/changelog/changelog-eos/#apim-31010-2022-01-14","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li>Transfer Group Primary Ownership     #6359</li> </ul> <p>General</p> <ul> <li>Merge 3.5.28 in 3.10.x     #6874</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_26","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.14.0 (2022-01-12)","text":"","location":"apim/changelog/changelog-eos/#apim-3140-2022-01-12","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li>Alerts page documentation is not properly displayed     #6680</li> </ul> <p>Gateway</p> <ul> <li> <p>Vhost mode does not work with HTTP/2     #6574</p> </li> <li> <p>[perf] Some ignored metrics are no longer ignored     #6555</p> </li> </ul> <p>General</p> <ul> <li>Merge 3.13.2 into master     #6749</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_27","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Console</p> <ul> <li>View domain used by application     #6384</li> </ul> <p>Management</p> <ul> <li> <p>Add a domain field for application creation     #6383</p> </li> <li> <p>Generate a group token     #6210</p> </li> <li> <p>[Analytics] OpenSearch support     #6423</p> </li> <li> <p>[CICD] Access token management by administrator     #6468</p> </li> <li> <p>[CICD] Creation of service account     #6467</p> </li> </ul> <p>Portal</p> <ul> <li>Possibilty to disable promoted card on page list     #6472</li> </ul>","location":"apim/changelog/changelog-eos/#features_6","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Elasticsearch-reporter</p> <ul> <li>Enable default plugins for all ES versions, and allow disabling them     from configuration     #6683</li> </ul> <p>Gateway</p> <ul> <li>Add support of native OpenSSL on http connector     #6561</li> </ul> <p>Portal</p> <ul> <li> <p>API Card - Add OwnerName info     #6485</p> </li> <li> <p>Application page list pagination     #6665</p> </li> <li> <p>Direct Search from the API Info     #6486</p> </li> </ul>","location":"apim/changelog/changelog-eos/#improvements_7","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.28 (2022-01-06)","text":"","location":"apim/changelog/changelog-eos/#apim-3528-2022-01-06","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li> <p>Creating simultaneous changes in dictionaries(one user, two tabs)     overwrites the changes in one or the other.     #6750</p> </li> <li> <p>Expression language completion isn\u2019t usable with code editor     #6577</p> </li> <li> <p>When you check/activate HTTP Proxy with System Proxy in Endpoint     configuration, Save button goes grey.     #6619</p> </li> <li> <p>Wrong Units for Request/Response Content length in Analytics     Dashboards     #5706</p> </li> </ul> <p>Management</p> <ul> <li>Stop/start of dynamic dictionaries do not get redeployed on gateways     #6847</li> </ul> <p>Portal</p> <ul> <li>Documentation Page cannot handle lots of menu options     #6618</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_28","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.13.3 (2021-12-29)","text":"","location":"apim/changelog/changelog-eos/#apim-3133-2021-12-29","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Merge 3.12.6 in 3.13.x     #6806</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_29","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.12.6 (2021-12-24)","text":"","location":"apim/changelog/changelog-eos/#apim-3126-2021-12-24","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Merge 3.10.9 in 3.12.x     #6805</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_30","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.10.9 (2021-12-23)","text":"","location":"apim/changelog/changelog-eos/#apim-3109-2021-12-23","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li> <p>Login Error after password reset     #6488</p> </li> <li> <p>Resource can not be saved after being updated     #6781</p> </li> </ul> <p>General</p> <ul> <li> <p>Merge 3.5.26 in 3.10.x     #6756</p> </li> <li> <p>Merge 3.5.27 in 3.10.x     #6789</p> </li> </ul> <p>Management</p> <ul> <li>Healthcheck scheduled every seconds instead of configured value     after import     #6775</li> </ul> <p>Portal</p> <ul> <li>Jump to anchors in Markdown documents does not work - Syntax bug     #6659</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_31","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Reporter</p> <ul> <li>[elasticsearch] Backport #6683 on 3.10 ES plugins management     #6710</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_8","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.27 (2021-12-21)","text":"","location":"apim/changelog/changelog-eos/#apim-3527-2021-12-21","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li>Design studioselecting policies are pushing the menu right side     #5242</li> </ul> <p>Gateway</p> <ul> <li>System proxy is not managed for health-check     #6731</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_32","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.26 (2021-12-17)","text":"","location":"apim/changelog/changelog-eos/#apim-3526-2021-12-17","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li> <p>Executable jar start with an error     #6733</p> </li> <li> <p>[policy] retry policy may cause OOM     #6684</p> </li> </ul> <p>Portal</p> <ul> <li> <p>Different representation of date format in 'Try it out\" swagger     admin console/dev portal     #6506</p> </li> <li> <p>When login is required on portal, an error is displayed     #5727</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_33","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Gateway</p> <ul> <li>Shutdown gracefully     #6722</li> </ul>","location":"apim/changelog/changelog-eos/#features_7","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.13.2 (2021-12-15)","text":"","location":"apim/changelog/changelog-eos/#apim-3132-2021-12-15","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Connector</p> <ul> <li>[kafka] Improve assignment and seeking     #6686</li> </ul> <p>Console</p> <ul> <li> <p>Analytics/metrics are no more present if index_per_typetrue with     ES 5.x #6630</p> </li> <li> <p>Can\u2019t configure healthcheck on an old API     #6736</p> </li> </ul> <p>Gateway</p> <ul> <li>Executable jar start with an error     #6732</li> </ul> <p>General</p> <ul> <li>Merge 3.12.5 in 3.13.x     #6704</li> </ul> <p>Management</p> <ul> <li>HealthCheck does not take into account Proxy settings     #6698</li> </ul> <p>Policy</p> <ul> <li>[groovy] Groovy scripts fails to resolve method even if     whitelisted     #6681</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_34","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.12.5 (2021-12-10)","text":"","location":"apim/changelog/changelog-eos/#apim-3125-2021-12-10","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>OpenTracing hanging gateway     #6366</li> </ul> <p>General</p> <ul> <li>Merge 3.10.8 into 3.12.x     #6701</li> </ul> <p>Management</p> <ul> <li>Fetching Documentation Page from external source (GitHub/Gitlab)     return 401 or 404     #6331</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_35","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.10.8 (2021-12-08)","text":"","location":"apim/changelog/changelog-eos/#apim-3108-2021-12-08","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li> <p>API Logs - Consumer response is no longer displayed     #6596</p> </li> <li> <p>Error log on delete action     #6583</p> </li> </ul> <p>General</p> <ul> <li> <p>Merge 3.5.24 into 3.10.x     #6611</p> </li> <li> <p>Merge 3.5.25 in 3.10.x     #6687</p> </li> </ul> <p>Management</p> <ul> <li> <p>Fix plans inconsistencies in database     #6586</p> </li> <li> <p>Rollback introduces duplicated plans     #6595</p> </li> </ul> <p>Portal</p> <ul> <li> <p>\"page not found\" after Google authentication     #6235</p> </li> <li> <p>Error message on login page     #6203</p> </li> <li> <p>Subscriptions menu should not be displayed if user does not have     access rights on Applications subscriptions     #6021</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_36","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.25 (2021-12-06)","text":"","location":"apim/changelog/changelog-eos/#apim-3525-2021-12-06","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li>API:ALERT:read permission doesn\u2019t activate API alert detail     #5974</li> </ul> <p>Gateway</p> <ul> <li> <p>Api HealthCheck of endpoints consume too much resources     #6658</p> </li> <li> <p>EndpointHealthcheckService not ready when Api sync starts     #6657</p> </li> <li> <p>Heartbeat may cause infinite loop and server crash under certain     circumptances     #6655</p> </li> <li> <p>Make entrypoints concurrently available     #6656</p> </li> <li> <p>[perf] ensure ClassLoaders are well released after api undeploy     #6678</p> </li> </ul> <p>Management</p> <ul> <li> <p>Handle null value when getting instances     #6639</p> </li> <li> <p>Search API should keep the search score order     #5744</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_37","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.13.1 (2021-11-26)","text":"","location":"apim/changelog/changelog-eos/#apim-3131-2021-11-26","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li>Cannot configure healthcheck at API Level     #6569</li> </ul> <p>General</p> <ul> <li>Merge 3.12.4 in 3.13.x     #6606</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_38","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.24 (2021-11-23)","text":"","location":"apim/changelog/changelog-eos/#apim-3524-2021-11-23","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>Inconsistent entrypoint resolution may cause 500 errors     #6543</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_39","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.12.4 (2021-11-22)","text":"","location":"apim/changelog/changelog-eos/#apim-3124-2021-11-22","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li>Organization Roles - Member list is empty     #6527</li> </ul> <p>General</p> <ul> <li>Merge 3.10.7 in 3.12.x     #6603</li> </ul> <p>Management</p> <ul> <li>\"Role not found\" exception when importing an API to a new     environment     #6448</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_40","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.10.7 (2021-11-22)","text":"","location":"apim/changelog/changelog-eos/#apim-3107-2021-11-22","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>API call always returns 500 internal error after redeploy     #6601</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_41","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.13.0 (2021-11-19)","text":"","location":"apim/changelog/changelog-eos/#apim-3130-2021-11-19","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Merge 3.12.2     #6557</p> </li> <li> <p>Merge 3.12.3     #6594</p> </li> </ul> <p>Management</p> <ul> <li>Fix Jetty\u2019s class loader     #6495</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_42","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Console</p> <ul> <li> <p>Display excluded groups in plans     #5259</p> </li> <li> <p>Support webhook on API update event     #5426</p> </li> </ul> <p>Management</p> <ul> <li> <p>Service Management Ecosystem (SME): API HTTP Connector Integration     #6132</p> </li> <li> <p>Service Management Ecosystem (SME): Kafka connector (available next     week) #6133</p> </li> </ul> <p>Portal</p> <ul> <li>Add an API search bar in the portal homepage     #5323</li> </ul>","location":"apim/changelog/changelog-eos/#features_8","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Policy</p> <ul> <li>JWT-PolicyCache management improvements     #6046</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_9","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.12.3 (2021-11-18)","text":"","location":"apim/changelog/changelog-eos/#apim-3123-2021-11-18","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Merge 3.10.6 in 3.12.x     #6593</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_43","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.10.6 (2021-11-18)","text":"","location":"apim/changelog/changelog-eos/#apim-3106-2021-11-18","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li>Not possible to change the logs configuration     #6282</li> </ul> <p>General</p> <ul> <li>Merge 3.5.23 in 3.10.x     #6576</li> </ul> <p>Management</p> <ul> <li>Plan is duplicated when importing an api with one plan     #6042</li> </ul> <p>Reporter-file</p> <ul> <li>Monitor logs (node-*) get empty if output is set to elasticsearch     #6564</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_44","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Console</p> <ul> <li>[alerts] Add HTTP_SIGNATURE_INVALID_SIGNATURE to api metrics     list #6462</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_10","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.23 (2021-11-17)","text":"","location":"apim/changelog/changelog-eos/#apim-3523-2021-11-17","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li> <p>API search doesn\u2019t return all expected results     #6565</p> </li> <li> <p>Signup not possible on console using JDBC     #6330</p> </li> </ul> <p>Gateway</p> <ul> <li> <p>Avoid 404 and 500 error during api redeploy or stop     #6553</p> </li> <li> <p>ILM managed indice are not handled by elasticsearch reporter     #6507</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_45","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.12.2 (2021-11-12)","text":"","location":"apim/changelog/changelog-eos/#apim-3122-2021-11-12","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Merge 3.11.3 in 3.12.x     #6511</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_46","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Console</p> <ul> <li>Customize HTTP_SIGNATURE_INVALID_SIGNATURE response template     #6320</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_11","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.11.3 (2021-11-12)","text":"","location":"apim/changelog/changelog-eos/#apim-3113-2021-11-12","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Merge 3.10.4 in 3.11.x     #6512</p> </li> <li> <p>Merge 3.10.5 in 3.11.x     #6548</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_47","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.10.5 (2021-11-10)","text":"","location":"apim/changelog/changelog-eos/#apim-3105-2021-11-10","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li>Policy - Pressing tab in EL fields add a transparent \\t     #6534</li> </ul> <p>Gateway</p> <ul> <li> <p>Cannot use JWT multiple plans     #6529</p> </li> <li> <p>Inconsistent entrypoint resolution may cause 500 errors     #6544</p> </li> <li> <p>Irrelevant bean injection warning for apis with health check     #6105</p> </li> <li> <p>Sync probe ends with an exception when calling /_node/sync     #6541</p> </li> </ul> <p>Policy</p> <ul> <li>[geoip-filtering] Upgrade for APIM &gt;= 3.10     #6531</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_48","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.22 (2021-11-10)","text":"","location":"apim/changelog/changelog-eos/#apim-3522-2021-11-10","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li> <p>Design studio - Policy disappear after save     #6517</p> </li> <li> <p>Plan level policies are not displayed in the history     #6524</p> </li> <li> <p>Policy - Pressing tab in EL fields add a transparent \\t     #6533</p> </li> <li> <p>Policy Mock unexpected behavior     #6438</p> </li> </ul> <p>Gateway</p> <ul> <li> <p>Cannot use JWT multiple plans     #6528</p> </li> <li> <p>Inconsistent entrypoint resolution may cause 500 errors     #6543</p> </li> <li> <p>Sync probe ends with an exception when calling /_node/sync     #6539</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_49","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.10.4 (2021-11-05)","text":"","location":"apim/changelog/changelog-eos/#apim-3104-2021-11-05","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li> <p>Documentation page configuration imported from external source can     not be edited     #6149</p> </li> <li> <p>Organization Settings get reinitialized after changing     Authentication configuration.     #6114</p> </li> <li> <p>Portal Settings get reinitialized after changing Portal     Authentication configuration     #6154</p> </li> <li> <p>Quality Metrics lost after upgrade     #6290</p> </li> <li> <p>Reset button in settings does not work     #6497</p> </li> </ul> <p>Gateway</p> <ul> <li> <p>Can not start gateway if Hazelcast ratelimt enabled     java.lang.ClassNotFoundExceptioncom.hazelcast.core.IMap     #6117</p> </li> <li> <p>Health-check stops working after gateway is stopped/started.     #6306</p> </li> <li> <p>Unable to start gateway when activating TLS and HTTP/2     #6232</p> </li> <li> <p>[policy] fix license management of data-logging-masking and     assign-metrics policies     #6435</p> </li> </ul> <p>General</p> <ul> <li> <p>Backport #6101 in 3.10.x     #6279</p> </li> <li> <p>Backport 6173 in 3.10.x     #6174</p> </li> <li> <p>Backport of #5966 in 3.10.x     #6085</p> </li> <li> <p>Merge 3.5.21 into 3.10.4     #6496</p> </li> </ul> <p>Management</p> <ul> <li> <p>Error when creating an alert with system email notification     #6231</p> </li> <li> <p>Swagger description of APIM Console API is empty     #6494</p> </li> </ul> <p>Policy</p> <ul> <li>[data-logging-masking] datas are no longer masked     #6122</li> </ul> <p>Portal</p> <ul> <li>Filters on path on the logs in APIM Portal do not work.     #6238</li> </ul> <p>Repository</p> <ul> <li>[sqlserver] Rest API database setup     #6447</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_50","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Console</p> <ul> <li>Enable/Disable API Status dashboard     #6365</li> </ul> <p>Management</p> <ul> <li>Customize HTTP SIGNATURE response template     #6319</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_12","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.21 (2021-11-02)","text":"","location":"apim/changelog/changelog-eos/#apim-3521-2021-11-02","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li> <p>500 error when importing definition of an API, null pointer     exception     #6052</p> </li> <li> <p>Change button labels (dashboard types) on Settings &gt; Analytics     page #6363</p> </li> <li> <p>Deleted plan is not removed from design studio     #5942</p> </li> <li> <p>Documentation page configuration imported from external source can     not be edited     #6461</p> </li> <li> <p>Top failed APIs shows 100% Failed on 200 status in Application     Analytics     #5703</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_51","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Gateway</p> <ul> <li>Provide information for accurate Kubernetes Probes support     #6455</li> </ul> <p>Policy</p> <ul> <li>Print more accurate logs in case of invalid configuration     #6479</li> </ul> <p>Reporter</p> <ul> <li>Improve reporters performances     #6430</li> </ul> <p>Repository</p> <ul> <li>Optimize mongodb searchLatest events     #6481</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_13","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.12.1 (2021-10-25)","text":"","location":"apim/changelog/changelog-eos/#apim-3121-2021-10-25","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Merge 3.11.2     #6451</li> </ul> <p>Portal</p> <ul> <li>APIKey isn\u2019t the right one     #6413</li> </ul> <p>Repository</p> <ul> <li>[sqlserver] Rest API database setup     #6453 ==     APIM - 3.11.2     (2021-10-25)</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_52","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Repository</p> <ul> <li>[jdbc] APIs are not loaded at gateway startup after migration     #6449</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_53","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.20 (2021-10-14)","text":"","location":"apim/changelog/changelog-eos/#apim-3520-2021-10-14","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>Fix JWT and OAuth2 plans     #6391</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_54","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.19 (2021-10-07)","text":"","location":"apim/changelog/changelog-eos/#apim-3519-2021-10-07","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li> <p>Backport of     #5649 :     Heartbeat stops after 1h     #6183</p> </li> <li> <p>Wrong settings for SyncService     #5977</p> </li> <li> <p>[sync] In case of dictionary sync issue, APIs are fully resync     #6301</p> </li> <li> <p>[sync] Sync process is trying to deploy APIs twice     #6300</p> </li> </ul> <p>General</p> <ul> <li> <p>Backport of     #5966 : Node     stop event are not well propagated when node is stopped     #6084</p> </li> <li> <p>Backport of     #5982 : JSON     Threat Protection Policy : unable to adjust default values     #5983</p> </li> </ul> <p>Management</p> <ul> <li> <p>Application Dashboard inconsistent filtering on \"Top Failed\" widget     #5771</p> </li> <li> <p>Plans get lost when imported with different user with admin rights     #6008</p> </li> <li> <p>Reorder issue on PageServiceImpl.java     #5931</p> </li> <li> <p>SMTP TLS negotiation error     #6101</p> </li> <li> <p>SQL error when trying to search application to subscribe with     #5812</p> </li> <li> <p>User can list all applications without permissions     #6307</p> </li> <li> <p>[repository] missing mongodb index makes impossible to start     management api     #5995</p> </li> </ul> <p>Policy</p> <ul> <li> <p>[json threat] - MAX JSON Array size issue not taken into account     #6050</p> </li> <li> <p>[ratelimit] Error 429 is being returned while using two Rate Limit     Policies.     #6218</p> </li> <li> <p>[ratelimit] Redis AsyncRateLimitRepositoryError     NumberFormatExceptionnull     #5988</p> </li> </ul> <p>Portal</p> <ul> <li> <p>API name not displayed correctly when multiple labels     #5761</p> </li> <li> <p>Long paths/names are not well displayed in Analytics and Logs     widgets #5767</p> </li> <li> <p>Scopes (Available Authorizations) can\u2019t be displayed in API     Documentation (swagger)     #5661</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_55","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Management</p> <ul> <li></li> </ul>","location":"apim/changelog/changelog-eos/#features_9","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li> <p>Allow spaces in the declaration of dictionaries, at the dynamic     routing level     #5938</p> </li> <li> <p>Startup performance improvements     #6066</p> </li> </ul>","location":"apim/changelog/changelog-eos/#improvements_14","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.12.0 (2021-09-30)","text":"","location":"apim/changelog/changelog-eos/#apim-3120-2021-09-30","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Merge 3.11.1     #6240</li> </ul> <p>Repository</p> <ul> <li>[mongo] Wrong total number of elements in paginated search     #6173</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_56","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Gateway</p> <ul> <li>Update Gateway API to add an access to the SSLSession     #5322</li> </ul> <p>Platform</p> <ul> <li>Handle duplicate API keys     #6006</li> </ul> <p>Policy</p> <ul> <li>[generate-http-signature] Genrate HTTP Signature policy     #4899</li> </ul> <p>Portal</p> <ul> <li>Advanced search on APIs     #2839</li> </ul>","location":"apim/changelog/changelog-eos/#features_10","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.11.1 (2021-09-22)","text":"","location":"apim/changelog/changelog-eos/#apim-3111-2021-09-22","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li> <p>Try It Mode - Number of instances provided should be set     #6073</p> </li> <li> <p>Try It Mode - issues if api has health check configured     #6069</p> </li> <li> <p>Try It Mode - issues with configuration     #6072</p> </li> </ul> <p>General</p> <ul> <li> <p>Merge 3.10.1     #6056</p> </li> <li> <p>Merge 3.10.2     #6217</p> </li> <li> <p>Merge 3.10.3     #6219</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_57","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li>Try It Mode - check api configuration when requesting debug     #6017</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_15","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.10.3 (2021-09-17)","text":"","location":"apim/changelog/changelog-eos/#apim-3103-2021-09-17","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Platform</p> <ul> <li>Fix APIM Dockerfile     #6206</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_58","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.10.2 (2021-09-17)","text":"","location":"apim/changelog/changelog-eos/#apim-3102-2021-09-17","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>[oauth-am-resource] memory leak     #6119</li> </ul> <p>Management</p> <ul> <li>Add missing script and missing documentation     #6142</li> </ul> <p>Repository</p> <ul> <li>[rate-limit] redis health check throws an exception     #6111</li> </ul> <p>Resource-oauth2-provider</p> <ul> <li>Exceptions occur when two many concurrent requests are made     #6176</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_59","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Platform</p> <ul> <li> <p>Upgrade Docker Images     #6139</p> </li> <li> <p>Update APIM dependencies     #6152</p> </li> </ul>","location":"apim/changelog/changelog-eos/#improvements_16","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.10.1 (2021-09-06)","text":"","location":"apim/changelog/changelog-eos/#apim-3101-2021-09-06","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li> <p>Logo disappeared after migration to 3.10     #6038</p> </li> <li> <p>Metrics of instances are not displayed     #6039</p> </li> <li> <p>Pending Tasks are visible to any users in the Console     #6036</p> </li> <li> <p>Portal Settings get reinitialized after changes     #6009</p> </li> <li> <p>[3.10.0] \"Authentication button color\" set in Console OIDC     Authentication Settings not propagated to Portal     #6010</p> </li> </ul> <p>Gateway</p> <ul> <li>Enabling prometheus Metrics gives     java.lang.ClassNotFoundExceptionorg.LatencyUtils.PauseDetector     #5996</li> </ul> <p>General</p> <ul> <li> <p>Cannot access API as a User     #6033</p> </li> <li> <p>Merge 3.9.4     #5945</p> </li> </ul> <p>Management</p> <ul> <li>Enable to sync APIs due to NPE     #5980</li> </ul> <p>Platform</p> <ul> <li>El expression request.method leads to an InvocationTargetException     #6051</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_60","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Reporter</p> <ul> <li>Add the ability to filter or rename properties / fields     #5831</li> </ul>","location":"apim/changelog/changelog-eos/#features_11","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Gateway</p> <ul> <li> <p>Enhance certificate management in keystore to enable to     differenciate certificates per domain     #5894</p> </li> <li> <p>Resource hogging when using many certificates in keystore     #5895</p> </li> </ul> <p>Management</p> <ul> <li>Set spring security dependencies as provided in IDP plugins     #5947</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_17","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.11.0 (2021-08-31)","text":"","location":"apim/changelog/changelog-eos/#apim-3110-2021-08-31","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>OAuth2 plan parsing must accept tokens other than JWT (example 1)     #5828</p> </li> <li> <p>OAuth2 plan parsing must accept tokens other than JWT (example 2)     #5829</p> </li> <li> <p>The \"Access control\" tab of a documentation page does not return the     correct list of roles     #5789</p> </li> </ul> <p>Management</p> <ul> <li>Logging is enabled on the wrong api     #5991</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_61","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>General</p> <ul> <li> <p>Add <code>Try it</code> in Design Studio     #5901</p> </li> <li> <p>Define the request     #5804</p> </li> <li> <p>Display the response     #5805</p> </li> <li> <p>Encrypt API properties     #5638</p> </li> <li> <p>Javascript policy     #5948</p> </li> <li> <p>Write documentation with AsyncAPI     #5575</p> </li> </ul> <p>Policy</p> <ul> <li>[gravitee-policy-callout-http] fire &amp; forget mode     #5972</li> </ul>","location":"apim/changelog/changelog-eos/#features_12","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Policy-groovy</p> <ul> <li>Improve form     #6027</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_18","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.9.4 (2021-08-23)","text":"","location":"apim/changelog/changelog-eos/#apim-394-2021-08-23","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li>Probem on registration of the proxy conf     #5896</li> </ul> <p>General</p> <ul> <li>Merge 3.8.7     #5944</li> </ul> <p>Management</p> <ul> <li>JSON Threat Protection Policy unable to adjust default values     #5982</li> </ul> <p>Ratelimit</p> <ul> <li>Rate limiting not working with Redis     #5882</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_62","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.8.7 (2021-08-12)","text":"","location":"apim/changelog/changelog-eos/#apim-387-2021-08-12","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Merge 3.5.18     #5943</li> </ul> <p>Management</p> <ul> <li> <p>Error while importing a file     #5933</p> </li> <li> <p>Metadata of type URL do not support all characters     #5964</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_63","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.18 (2021-08-04)","text":"","location":"apim/changelog/changelog-eos/#apim-3518-2021-08-04","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Definition</p> <ul> <li>Virtual host with / is not saved     #5859</li> </ul> <p>Gateway</p> <ul> <li> <p>Sync process optimisations     #5615</p> </li> <li> <p>Upgrade dependency for AE 1.3.3 plugin     #5890</p> </li> </ul> <p>Management</p> <ul> <li> <p>\"order\" field of Plans get reseted when imported from 3.5.x to 3.8.x     #5696</p> </li> <li> <p>Allow to specify multiple roles to map with ldap idp     #5619</p> </li> <li> <p>Check plan policy configuration     #5952</p> </li> <li> <p>Flows property not accepted in request payload for Update Plan     #5694</p> </li> <li> <p>Plan Flows get lost on updating an API with an existing API     definition (updateApiWithDefinition)     #5820</p> </li> <li> <p>[analytics] \"Display percentage\" is never checked     #5495</p> </li> <li> <p>[github idp] user without space in their username fail to     authenticate     #5507</p> </li> </ul> <p>Policy-ratelimit</p> <ul> <li>Unable to use quota notification.properties     #5834</li> </ul> <p>Reporter-file</p> <ul> <li>[reporter-tcp] manage user-agent in the elasticsearch output     #5893</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_64","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>General</p> <ul> <li>Add the created_at value in the Get API definition response     #5455</li> </ul> <p>Management</p> <ul> <li>Re-enable \"retainDays\" configuration in file-reporter plugin     #5463</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_19","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.10.0 (2021-08-03)","text":"","location":"apim/changelog/changelog-eos/#apim-3100-2021-08-03","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li> <p>Heartbeat stops after 1h     #5649</p> </li> <li> <p>[apim] gRPC in Server streaming mode the call is never close     #5494</p> </li> </ul> <p>General</p> <ul> <li> <p>Lost documentation pages when duplicating an API     #5849</p> </li> <li> <p>Merge 3.9.2     #5814</p> </li> <li> <p>Merge 3.9.3     #5818</p> </li> </ul> <p>Management</p> <ul> <li> <p>Error while importing a file     #5932</p> </li> <li> <p>Not redirect to dashboard when click on gravitee logo     #5768</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_65","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Gateway</p> <ul> <li>OpenTracing support     #1581</li> </ul> <p>General</p> <ul> <li> <p>API Promotion     #5530</p> </li> <li> <p>Accepting/Rejecting an API promotion request     #5528</p> </li> <li> <p>Handle <code>groups</code> during API Promotion     #5844</p> </li> <li> <p>Handle <code>pages</code> during API Promotion     #5841</p> </li> <li> <p>Handle <code>plans</code> during API Promotion     #5842</p> </li> <li> <p>Logging events for API promotion     #5531</p> </li> <li> <p>Making requests for API promotion     #5526</p> </li> <li> <p>Managing in progress API promotion requests     #5746</p> </li> <li> <p>Support Redis for cache resource     #5712</p> </li> <li> <p>Viewing tasks for API promotion requests     #5527</p> </li> </ul> <p>Management</p> <ul> <li> <p>Allows to use Expression Language in health check configuration     #4943</p> </li> <li> <p>Manage AsciiDoc pages     #4717</p> </li> <li> <p>Notify consumer before the expiration of its subscription     #3887</p> </li> </ul> <p>Policy</p> <ul> <li>[groovy] add XML support     #5891</li> </ul>","location":"apim/changelog/changelog-eos/#features_13","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.9.3 (2021-07-16)","text":"","location":"apim/changelog/changelog-eos/#apim-393-2021-07-16","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>APIM Console Plan creation with Rate Limiting causes an exception     #5833</p> </li> <li> <p>Merge 3.8.6     #5817</p> </li> <li> <p>The GW instance is no longer displayed on the nightly     #5782</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_66","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.8.6 (2021-07-16)","text":"","location":"apim/changelog/changelog-eos/#apim-386-2021-07-16","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>GetGroupMembers align documentation vs real output     #5614</p> </li> <li> <p>Merge 3.5.17     #5816</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_67","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Gateway</p> <ul> <li>[response template] add a GATEWAY_TIMEOUT response template     #5501</li> </ul>","location":"apim/changelog/changelog-eos/#features_14","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.17 (2021-07-06)","text":"","location":"apim/changelog/changelog-eos/#apim-3517-2021-07-06","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Backport 5756     #5757</li> </ul> <p>Management</p> <ul> <li> <p>Strange UI behaviour in the console     #5807</p> </li> <li> <p>[alerting] When creating \"Alert on the health status of the node\",     CREATE button is disabled     #5808</p> </li> </ul> <p>Managment</p> <ul> <li>API Analytics response payload not displayed, fails with javascript     error e.getTextArea is not a function     #5364</li> </ul> <p>Policy</p> <ul> <li> <p>Allow array.length with groovy sandbox     #5557</p> </li> <li> <p>[transform headers] support null in arrays     #5778</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_68","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Resource</p> <ul> <li>[auth-provider] Support HTTP-based authentication provider     #5737</li> </ul>","location":"apim/changelog/changelog-eos/#features_15","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Policy</p> <ul> <li>[basic-authentication] Manage async auth providers     #5733</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_20","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.9.2 (2021-06-29)","text":"","location":"apim/changelog/changelog-eos/#apim-392-2021-06-29","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Merge 3.8.4     #5721</p> </li> <li> <p>Merge 3.8.5     #5793</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_69","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.8.5 (2021-06-29)","text":"","location":"apim/changelog/changelog-eos/#apim-385-2021-06-29","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Merge 3.5.15     #5740</p> </li> <li> <p>Merge 3.5.16     #5758</p> </li> </ul> <p>Management</p> <ul> <li> <p>API_REVIEW_* Audit Event filters are missing in the scrolling     list (API and Global Levels)     #5673</p> </li> <li> <p>Redirection problem when connecting to console from cockpit     #5785</p> </li> <li> <p>Roles initialized to default after removing a role mapping     configuration     #5756</p> </li> <li> <p>Subscription approval link not correct     #5724</p> </li> </ul> <p>Reporter</p> <ul> <li> <p>Bad timestamp format by reporters     #5707</p> </li> <li> <p>[file] NPEs thrown in log     #5668</p> </li> </ul> <p>Resource-cache</p> <ul> <li>Error when redeploy an api     #5671</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_70","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Helm</p> <ul> <li>Adapt liveness probe of the gateway to check API synchronization     #5734</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_21","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.16 (2021-06-18)","text":"","location":"apim/changelog/changelog-eos/#apim-3516-2021-06-18","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>API health check is duplicating slash in some case     #5752</li> </ul> <p>Portal</p> <ul> <li>Login issue on the portal     #5748</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_71","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.15 (2021-06-17)","text":"","location":"apim/changelog/changelog-eos/#apim-3515-2021-06-17","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li> <p>Allow to disable \"maintenance\" mode     #5731</p> </li> <li> <p>CORS settings doesn\u2019t display     #5729</p> </li> </ul> <p>Gateway</p> <ul> <li>Unable to establish websocket connection using Firefox     #5722</li> </ul> <p>General</p> <ul> <li> <p>Backport #5632     #5697</p> </li> <li> <p>Check consistency of Plans on API update     #5718</p> </li> </ul> <p>Management</p> <ul> <li> <p>Can not Auto-fetch Documentation Page from an external source     #5699</p> </li> <li> <p>Inconsistent Sharding Tags behavior compared to the documentation     #5600</p> </li> <li> <p>Newsletter subscribe link not working anymore     #5720</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_72","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Policy</p> <ul> <li>[Http Signature] Support non quoted String in the signature     #5684</li> </ul>","location":"apim/changelog/changelog-eos/#features_16","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.8.4 (2021-06-14)","text":"","location":"apim/changelog/changelog-eos/#apim-384-2021-06-14","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Backport #5649     #5704</p> </li> <li> <p>Merge 3.5.13     #5690</p> </li> <li> <p>Merge 3.5.14     #5698</p> </li> </ul> <p>Management</p> <ul> <li>Categories order field not set at creation     #5632</li> </ul> <p>Resource-cache</p> <ul> <li>Error when redeploy an api     #5671</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_73","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.9.1 (2021-06-12)","text":"","location":"apim/changelog/changelog-eos/#apim-391-2021-06-12","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Management</p> <ul> <li>Loss of data when migrating on 3.9.0 for jdbc users     #5711</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_74","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.14 (2021-06-09)","text":"","location":"apim/changelog/changelog-eos/#apim-3514-2021-06-09","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Group/role mapping lost after OIDC login     #5686</li> </ul> <p>Management</p> <ul> <li> <p>Allow to specify multiple roles to map with ldap idp     #5619</p> </li> <li> <p>Gravitee_http_cors_alloworigin environment variable setting not     reflected in UI     #5583</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_75","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.9.0 (2021-06-08)","text":"","location":"apim/changelog/changelog-eos/#apim-390-2021-06-08","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Merge 3.8.1     #5497</p> </li> <li> <p>Merge 3.8.2     #5554</p> </li> <li> <p>Merge 3.8.3     #5634</p> </li> </ul> <p>Management</p> <ul> <li> <p>Cannot ask for review anymore     #5558</p> </li> <li> <p>Cannot publish / unpublish a page with a link     #5559</p> </li> <li> <p>Check existance of confirmUrl     #5567</p> </li> <li> <p>Error when updating user\u2019s avatar     #5533</p> </li> <li> <p>[gateway] reintroduce serializers/deserializers on     gravitee-definition     #5642</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_76","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Console</p> <ul> <li>Custom templates for alert notifications (HTTP Status Code and     Average Response Time)     #5481</li> </ul> <p>Gateway</p> <ul> <li> <p>Allow to associate a gateway to a specific environment     #5357</p> </li> <li> <p>Platform policies     #4460</p> </li> </ul> <p>Management</p> <ul> <li> <p>Allow an API Publisher to push API Metrics to a specific target     #5349</p> </li> <li> <p>Configure an alert on a timeframe     #4894</p> </li> </ul> <p>Portal</p> <ul> <li>Allow to define alerts for a consumer     #5341</li> </ul>","location":"apim/changelog/changelog-eos/#features_17","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.13 (2021-06-04)","text":"","location":"apim/changelog/changelog-eos/#apim-3513-2021-06-04","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Backport #5621     #5633</p> </li> <li> <p>Default_api_logo.png can not be overriden     #5524</p> </li> <li> <p>Merge 3.0.17     #5647</p> </li> </ul> <p>Helm</p> <ul> <li>Cannot disable the Alert Engine connector     #5662</li> </ul> <p>Management</p> <ul> <li> <p>CORS Access-Control-Allow-Origin regex fails on pattern as     \".*.mydomain.com\"     #5611</p> </li> <li> <p>Cannot update Quality Rules     #5626</p> </li> <li> <p>Invalid logout url construction with external OIDC Provider     #5593</p> </li> <li> <p>Plan Flows get lost when re-importing API from a swagger/oas3     specification     #5651</p> </li> <li> <p>Policies on path are not updated when updating an API with swagger     #4970</p> </li> <li> <p>Unable to use default image on API     #5303</p> </li> </ul> <p>Management-api</p> <ul> <li>Unable to change admin password with the environment variables in     Openshift     #2680</li> </ul> <p>Portal</p> <ul> <li>Do not display \"Create an Application\" in Portal if user has     insufficient privileges     #5403</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_77","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.8.3 (2021-05-26)","text":"","location":"apim/changelog/changelog-eos/#apim-383-2021-05-26","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Merge 3.7.4     #5602</li> </ul> <p>Management-ui</p> <ul> <li>Loss of path when OIDC logout process     #5621</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_78","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.0.17 (2021-05-20)","text":"","location":"apim/changelog/changelog-eos/#apim-3017-2021-05-20","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Backport #5468     #5503</p> </li> <li> <p>Backport #5517     #5534</p> </li> <li> <p>The API footer overlap the redoc documentation     #5597</p> </li> </ul> <p>Management</p> <ul> <li> <p>Update start date label for audit logs     #5256</p> </li> <li> <p>User search is not accurate     #5150</p> </li> </ul> <p>Portal</p> <ul> <li> <p>\"information\" is singular     #5595</p> </li> <li> <p>Unable to create an App from the portal     #5563</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_79","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.7.4 (2021-05-22)","text":"","location":"apim/changelog/changelog-eos/#apim-374-2021-05-22","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Merge 3.5.12     #5601</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_80","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.12 (2021-05-18)","text":"","location":"apim/changelog/changelog-eos/#apim-3512-2021-05-18","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Backport #5558     #5568</p> </li> <li> <p>Backport #5564     #5590</p> </li> <li> <p>Backport #5567     #5589</p> </li> <li> <p>Default_api_logo.png can not be overriden     #5524</p> </li> </ul> <p>IdentityProvider</p> <ul> <li>Not default role when user created with external IDP     #5561</li> </ul> <p>Management</p> <ul> <li>Disabling Newsletter does not disable bottom right Pop-in     #5502</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_81","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Elasticsearch</p> <ul> <li>Do not include date as part of the index name for ILM managed     indices #5551</li> </ul> <p>General</p> <ul> <li>Add postman for /applications?query=A accessible to unauthorized     users #5535</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_22","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.8.2 (2021-05-14)","text":"","location":"apim/changelog/changelog-eos/#apim-382-2021-05-14","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Backport #5559     #5569</p> </li> <li> <p>Backport 5533     #5552</p> </li> <li> <p>Merge 3.7.3     #5553</p> </li> </ul> <p>Management</p> <ul> <li>Missing plan selection rule for V2 Definition APIs     #5564</li> </ul> <p>Management-ui</p> <ul> <li>As a user I should see user assigned to the group without refreshing     the page #5401</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_82","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.7.3 (2021-05-12)","text":"","location":"apim/changelog/changelog-eos/#apim-373-2021-05-12","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Merge 3.5.11     #5541</li> </ul> <p>Management</p> <ul> <li> <p>API Health-check screen is broken     #5511</p> </li> <li> <p>Environment permission is needed to display the api events in     analytics     #5473</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_83","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.11 (2021-05-07)","text":"","location":"apim/changelog/changelog-eos/#apim-3511-2021-05-07","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li> <p>File descriptors exhaustion on POST method with form-data inputfile     #5517</p> </li> <li> <p>Issue when flushing inbound request queue on an already ended     request #5539</p> </li> </ul> <p>General</p> <ul> <li> <p>Backport #5468     #5504</p> </li> <li> <p>CVE#2168 #5450</p> </li> </ul> <p>Management</p> <ul> <li> <p>/applications?query=A accessible to unauthorized users     #5518</p> </li> <li> <p>A Membership for member USER and ref GROUP already exists.     #5413</p> </li> <li> <p>API logs and permissions     #5412</p> </li> <li> <p>Get an API by its context-path doesn\u2019t seem to work on latest     version #5298</p> </li> <li> <p>Make /portal protected by authentication     #5435</p> </li> <li> <p>Plan id not preserved on API import     #5489</p> </li> <li> <p>[healthcheck] add a query parameter in the path without /     #5433</p> </li> </ul> <p>Portal</p> <ul> <li>Do not display \"Create an Application\" in Portal if user has     insufficient privileges     #5403</li> </ul> <p>Reporter</p> <ul> <li>[file] OOM when flush takes a long time     #5515</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_84","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.8.1 (2021-04-28)","text":"","location":"apim/changelog/changelog-eos/#apim-381-2021-04-28","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Merge 3.7.2     #5467</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_85","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>General</p> <ul> <li> <p>APIM dependencies upgrade     #5471</p> </li> <li> <p>EE docker image jdk upgrade openjdk11:jre-11.0.10_9-alpine     #5472</p> </li> </ul>","location":"apim/changelog/changelog-eos/#features_18","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.7.2 (2021-04-23)","text":"","location":"apim/changelog/changelog-eos/#apim-372-2021-04-23","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Backport #5416     #5421</p> </li> <li> <p>Merge 3.5.10     #5466</p> </li> <li> <p>Merge 3.6.3     #5446</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_86","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li>Default Schema is now set to \"public\" for jdbc     #5468</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_23","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.10 (2021-04-21)","text":"","location":"apim/changelog/changelog-eos/#apim-3510-2021-04-21","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>API Design Cannot save and deploy policy more than once     #5336</p> </li> <li> <p>Backport #5159     #5381</p> </li> <li> <p>CVE#2168 #5450</p> </li> <li> <p>CVE#2169 #5451</p> </li> </ul> <p>Management</p> <ul> <li> <p>502 response received on health-check timeout     #5342</p> </li> <li> <p>A Membership for member USER and ref GROUP already exists.     #5413</p> </li> <li> <p>Health availability is KO when HC is disabled on a specific endpoint     #5365</p> </li> <li> <p>Health-check details Response colors to be consistent with colors in     the Platform logs     #5309</p> </li> <li> <p>Improve the user account screen     #5376</p> </li> <li> <p>Nullpointer exception on OIDC provider login after migration from     1.30 #5410</p> </li> <li> <p>Policies configuration form not well displayed     #5351</p> </li> <li> <p>Search criteria and table offset get lost when clicking back to     Health-check #5302</p> </li> <li> <p>[portal] unable to logout with OIDC provider     #5247</p> </li> </ul> <p>Managment</p> <ul> <li>API Analytics response payload not displayed, fails with javascript     error e.getTextArea is not a function     #5364</li> </ul> <p>Portal</p> <ul> <li> <p>AddressException when trying to submit a Ticket with custom \"from\"     configuration that contains &lt;&gt;     #5352</p> </li> <li> <p>Documentation pages not displayed (imported from 1.30)     #5192</p> </li> <li> <p>Inconsistent display in Portal search box     #5160</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_87","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Management</p> <ul> <li>Add icon on policies     #5399</li> </ul>","location":"apim/changelog/changelog-eos/#features_19","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li> <p>Allows to sort the logs by API response time     #3391</p> </li> <li> <p>Naming confusion between path authorizations and resource filtering     #5464</p> </li> </ul>","location":"apim/changelog/changelog-eos/#improvements_24","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.8.0 (2021-04-16)","text":"","location":"apim/changelog/changelog-eos/#apim-380-2021-04-16","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Management</p> <ul> <li>API creation and permissions     #5416</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_88","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Gateway</p> <ul> <li> <p>Readiness vs Liveness     #4902</p> </li> <li> <p>Resource information in health API     #4903</p> </li> </ul> <p>Management</p> <ul> <li> <p>Allow to navigate to previous / next log     #4871</p> </li> <li> <p>Allows to restore an archived application     #4453</p> </li> <li> <p>Contact subscribers as an API publisher     #4896</p> </li> <li> <p>Dashboard of all alerts     #4892</p> </li> <li> <p>Display groups in user account information     #4870</p> </li> <li> <p>Private page     #4893</p> </li> <li> <p>Traffic shadowing     #5186</p> </li> </ul> <p>Policy</p> <ul> <li>[jwt] Allows to configure the client id claims     #4900</li> </ul> <p>Portal</p> <ul> <li> <p>Allows to change favicon     #4855</p> </li> <li> <p>Override the main sentence in the homepage     #4856</p> </li> </ul>","location":"apim/changelog/changelog-eos/#features_20","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Gateway</p> <ul> <li>Allow to filter probes on health resource     #5236</li> </ul> <p>Management</p> <ul> <li> <p>Add ACL on the custom links     #4563</p> </li> <li> <p>[portal] Update ui-component library to 2.3.1     #5389</p> </li> </ul> <p>Policy</p> <ul> <li>Endpoint reference from policy     #5268</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_25","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.6.3 (2021-04-15)","text":"","location":"apim/changelog/changelog-eos/#apim-363-2021-04-15","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Cockpit</p> <ul> <li>Backport #5170 (delete installation)     #5430</li> </ul> <p>Management</p> <ul> <li>Cannot login with new users with newsletter     #5423</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_89","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>General</p> <ul> <li>New http-signature policy with support for base64 encoding     #5408</li> </ul>","location":"apim/changelog/changelog-eos/#features_21","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.7.1 (2021-04-10)","text":"","location":"apim/changelog/changelog-eos/#apim-371-2021-04-10","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>. This error mainly occurs when the policy is linked to a missing     resource, for example a cache or an oauth2 resource. Please check     your policy configuration!\"     #5354</p> </li> <li> <p>Merge 3.6.2     #5360</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_90","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.6.2 (2021-04-06)","text":"","location":"apim/changelog/changelog-eos/#apim-362-2021-04-06","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Merge 3.5.9     #5326</li> </ul> <p>Management</p> <ul> <li> <p>As a simple USER I can see the Analytics dashboard but I have a     permission error     #5251</p> </li> <li> <p>In a multi env context search of APIs is not working well     #5296</p> </li> <li> <p>Portal authentication settings has disappeared     #5278</p> </li> <li> <p>Unable to save an api Cron expression must consist of 6 fields     (found 0 in \\\"\\\")     #5118</p> </li> <li> <p>User pre-registration does not work with an OIDC provider     #5159</p> </li> </ul> <p>Portal</p> <ul> <li>Example and schema imported from swagger document not displayed in     portal #5202</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_91","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.9 (2021-03-30)","text":"","location":"apim/changelog/changelog-eos/#apim-359-2021-03-30","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Merge 3.0.16     #5299</p> </li> <li> <p>ResonseContainer Annotation does not work for <code>Page</code> and     <code>PagedResult</code> #5289</p> </li> </ul> <p>Management</p> <ul> <li> <p>Dates are not updated when create/update a category     #5275</p> </li> <li> <p>JWT Plan - resolver param using JWKS URL with EL get unresolved     (Error 404)     #5206</p> </li> <li> <p>Minimum limit on IDP name is too short     #5297</p> </li> <li> <p>Unable to subscribe to public apis from an application     #5223</p> </li> <li> <p>[portal] Groups get lost while changing the Application image in     Portal #5274</p> </li> <li> <p>[portal] unable to logout with OIDC provider     #5247</p> </li> </ul> <p>Repository</p> <ul> <li>[jdbc] Make the repositories transactional     #5284</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_92","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li>Dynamic newsletter taglines     #5269</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_26","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.0.16 (2021-03-24)","text":"","location":"apim/changelog/changelog-eos/#apim-3016-2021-03-24","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li>User can not access application analytics     #4843</li> </ul> <p>General</p> <ul> <li> <p>Merge 1.30.30     #4962</p> </li> <li> <p>Merge 1.30.31     #5288</p> </li> </ul> <p>Management</p> <ul> <li> <p>Client side code injection     #5031</p> </li> <li> <p>Do not use system proxy by default for OAuth authentication     #5281</p> </li> <li> <p>Enable to search APIs     #5043</p> </li> <li> <p>Event type button in dashboards are too big     #4983</p> </li> </ul> <p>Oauth2</p> <ul> <li>Oauth2 Authentication of API Portal and API Management have not the     same behavior     #4058</li> </ul> <p>Policy</p> <ul> <li>[assign-content] Template Injection     #5033</li> </ul> <p>Portal</p> <ul> <li>Do not display the \"add application members\" section if the current     user has not the permission     #4635</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_93","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li>Access-Control-Allow-Origin regex fail and do not conform with     rfc6454 and rfc3986     #4796</li> </ul> <p>Repository</p> <ul> <li>[jdbc] Add ability to set db schema name     #4940</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_27","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.7.0 (2021-03-23)","text":"","location":"apim/changelog/changelog-eos/#apim-370-2021-03-23","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Merge 3.6.1     #5273</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_94","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Management</p> <ul> <li> <p>Define Group as Primary Owner of an API     #5016</p> </li> <li> <p>Global markdown template pages     #4465</p> </li> <li> <p>Searchable Metadata     #5017</p> </li> </ul> <p>Policy</p> <ul> <li> <p>[cache] Support of cache replication across an APIM cluster     #599</p> </li> <li> <p>[oauth2] Add a cache at the policy level     #2298</p> </li> </ul> <p>Repository</p> <ul> <li>Allows to define a prefix for collections / tables     #4715</li> </ul>","location":"apim/changelog/changelog-eos/#features_22","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Gateway</p> <ul> <li>Add the libraries to allow to write application logs in JSON by     changing the logback configuration     #5139</li> </ul> <p>Reporter</p> <ul> <li>Metrics do not expose timestamp for formatters     #5097</li> </ul> <p>Resource</p> <ul> <li>[cache] Allows to limit the cache usage at the platform level     #4455</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_28","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.6.1 (2021-03-19)","text":"","location":"apim/changelog/changelog-eos/#apim-361-2021-03-19","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Merge 3.5.5     #5246</p> </li> <li> <p>Merge 3.5.6     #5248</p> </li> <li> <p>Merge 3.5.7     #5249</p> </li> <li> <p>Merge 3.5.8     #5264</p> </li> <li> <p>Migration from 3.5.x to 3.6.x fails with MySQL     #5175</p> </li> </ul> <p>Management</p> <ul> <li> <p>Error when trying to log in using an OpenIDConnect Provider     #5144</p> </li> <li> <p>[multi-org] Allow to change the current organization in the     console #5044</p> </li> </ul> <p>Policy</p> <ul> <li>[hmac]Error 500 on HMAC Http Signature policy     #5180</li> </ul> <p>Portal</p> <ul> <li>Fix the api subscription screen     #5103</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_95","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.8 (2021-03-18)","text":"","location":"apim/changelog/changelog-eos/#apim-358-2021-03-18","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Management</p> <ul> <li> <p>Cannot create dynamic properties     #5230</p> </li> <li> <p>I18n base path reference is incorrect     #5240</p> </li> <li> <p>Quality metrics not shown in APIs main page     #5238</p> </li> <li> <p>Using the right naming convention     #5235</p> </li> <li> <p>[portal] image media uri is not right     #5244</p> </li> </ul> <p>Policy</p> <ul> <li>[rest-to-soap] Can not use query parameters from SOAP envelope     template #5209</li> </ul> <p>Portal</p> <ul> <li> <p>Application menus are not correctly displayed     #5207</p> </li> <li> <p>Cannot read menu entries when is in a sticky mode     #5233</p> </li> <li> <p>Dasboard list have wrong style     #5121</p> </li> <li> <p>Display type selector cannot be seen well     #5234</p> </li> </ul> <p>Repository</p> <ul> <li> <p>[http] Improve server to execute repository requests     #5203</p> </li> <li> <p>[http] Remove strong constraint on client / server version     #5204</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_96","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.7 (2021-03-11)","text":"","location":"apim/changelog/changelog-eos/#apim-357-2021-03-11","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Management</p> <ul> <li> <p>Cannot delete a deprecated API anymore     #5113</p> </li> <li> <p>Some API Logging settings get lost after saving     #5164</p> </li> </ul> <p>Reporter</p> <ul> <li> <p>[tcp | file] Monitor elasticsearch output contains a wrong id     value #5181</p> </li> <li> <p>[tcp] Reporter must be disabled by default     #5183</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_97","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Gateway</p> <ul> <li> <p>Add SNI support     #5194</p> </li> <li> <p>Heartbeat is storing unlimited events which may cause OOM     #5191</p> </li> </ul>","location":"apim/changelog/changelog-eos/#improvements_29","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.6 (2021-03-09)","text":"","location":"apim/changelog/changelog-eos/#apim-356-2021-03-09","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Management</p> <ul> <li> <p>Can\u2019t access a group page if too many users     #5083</p> </li> <li> <p>Closed plans are visible in the design studio     #5122</p> </li> </ul> <p>Portal</p> <ul> <li>Permissions issue when accessing category documentation     #5114</li> </ul> <p>Repository</p> <ul> <li>[bridge] Unable to retrieve subscriptions for some APIs     #5176</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_98","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Repository</p> <ul> <li>[bridge] Add support for HTTP/S proxy     #5178</li> </ul>","location":"apim/changelog/changelog-eos/#features_23","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li>Improve /apis performance     #5045</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_30","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.5 (2021-02-24)","text":"","location":"apim/changelog/changelog-eos/#apim-355-2021-02-24","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>[hc] handle DAYS time unit     #5085</li> </ul> <p>Management</p> <ul> <li> <p>A user should only see APIs it can manage     #5096</p> </li> <li> <p>EL inputs should be in single line mode     #5086</p> </li> <li> <p>Handle default value during policy schema validation     #5095</p> </li> <li> <p>Missing response templates when creating or updating a plan     #5110</p> </li> <li> <p>User not found when looking for subscriptions     #5091</p> </li> </ul> <p>Policy</p> <ul> <li>[circuit-breaker] Use the correct types in the UI form     #5116</li> </ul> <p>Portal</p> <ul> <li>Css issue when displaying my subscriptions     #5094</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_99","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management-ui</p> <ul> <li>Hide swagger authorization button if try it option is disabled     #5100</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_31","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.6.0 (2021-02-18)","text":"","location":"apim/changelog/changelog-eos/#apim-360-2021-02-18","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Merge 3.5.2     #4961</p> </li> <li> <p>Merge 3.5.3     #5025</p> </li> <li> <p>Merge 3.5.4     #5084</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_100","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Management</p> <ul> <li> <p>Advanced API logging configuration     #4745</p> </li> <li> <p>Associate a label to an API deployment     #4742</p> </li> <li> <p>Be able to enable / disable health-check during some periods     #4043</p> </li> <li> <p>Cockpit authentication support     #4522</p> </li> <li> <p>Console dashboard page     #4747</p> </li> <li> <p>Define HTTP verb for dynamic properties and dictionaries     #4746</p> </li> <li> <p>Display deployments markups on analytics charts     #4743</p> </li> <li> <p>Improve logging configuration for GDPR compliance     #3919</p> </li> <li> <p>Manage Cockpit installation registration     #4766</p> </li> <li> <p>Move organization &amp; environment creation to command handler     #4287</p> </li> <li> <p>Policy studio history preview     #4749</p> </li> <li> <p>Propagate installation events to APIM     #4945</p> </li> <li> <p>Status page for endpoints based on HC     #4750</p> </li> <li> <p>[multi-env] Display current environment id in the console URL     #4778</p> </li> </ul> <p>Policy</p> <ul> <li> <p>[assign-metrics] Allows to add some custom metrics in analytics     #4769</p> </li> <li> <p>[hmac] Enable HMAC authentication     #4813</p> </li> </ul> <p>Reporter</p> <ul> <li>[elasticsearch] Auto-enable geo-ip, user-agent when Elasticsearch     &gt;= 7.x     #4744</li> </ul>","location":"apim/changelog/changelog-eos/#features_24","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Analytics</p> <ul> <li>Improve Log detail view     #4815</li> </ul> <p>Identity-providers</p> <ul> <li>[multi-env] Adapt role mapping screen for multi-environment     #4803</li> </ul> <p>Management</p> <ul> <li> <p>Add more configuration options on dynamic dictionaries / properties     #4447</p> </li> <li> <p>Allows to select groups while creating an API     #4449</p> </li> <li> <p>[multi-env] Handle environment switching     #4777</p> </li> <li> <p>[multi-env] Handle user without environments permissions     #4774</p> </li> <li> <p>[multi-env]Default application creation     #4776</p> </li> </ul> <p>Policy</p> <ul> <li>[json-xml] Allows to transform a JSON to a XML     #4561</li> </ul> <p>Portal</p> <ul> <li> <p>Display the category selected to navigate to the current API page     #4466</p> </li> <li> <p>EN typo #4857</p> </li> </ul>","location":"apim/changelog/changelog-eos/#improvements_32","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.4 (2021-02-15)","text":"","location":"apim/changelog/changelog-eos/#apim-354-2021-02-15","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li> <p>Policies are executed following wrong order for response stream     policy flow     #5054</p> </li> <li> <p>[healthcheck] Exception on HC request should return a 502 instead     of 503 #5059</p> </li> </ul> <p>General</p> <ul> <li>Backport #4653     #5076</li> </ul> <p>Management</p> <ul> <li> <p>Enable to search APIs     #5080</p> </li> <li> <p>Unable to delete a metadata when I delete an API     #5000</p> </li> <li> <p>[policy-studio] Impossible to scroll on code field when have long     text #5060</p> </li> </ul> <p>Management-api</p> <ul> <li>Do not expose sensitive information from settings endpoint     #5034</li> </ul> <p>Management-ui</p> <ul> <li>Calendar widget is not accurate     #5027</li> </ul> <p>Policy</p> <ul> <li> <p>[groovy] add documentation in the studio     #5077</p> </li> <li> <p>[groovy] unable to whitelist array.getAt     #5075</p> </li> </ul> <p>Repository</p> <ul> <li>[mongodb] Unable to save dictionary with properties containing a     dot #5072</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_101","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>General</p> <ul> <li>Missing id_token_hint on logout endpoint     #4975</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_33","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.3 (2021-02-06)","text":"","location":"apim/changelog/changelog-eos/#apim-353-2021-02-06","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>Problem with the execution order of the policies of a response flow     #4973</li> </ul> <p>General</p> <ul> <li>Merge 3.4.3     #5001</li> </ul> <p>Management</p> <ul> <li> <p>Cannot deploy APIs with configured HTTP headers at the endpoint     level or health check     #4963</p> </li> <li> <p>Manage WSDL imports when creating or updating an API     #4976</p> </li> <li> <p>Policies on path are not updated when updating an API with swagger     #4970</p> </li> <li> <p>SecurityDefinition is missing when migrating API from v1 to v2     definition     #4979</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_102","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.4.3 (2021-02-01)","text":"","location":"apim/changelog/changelog-eos/#apim-343-2021-02-01","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Backport #4592 to 3.4.x     #4864</p> </li> <li> <p>Backport #4797 to 3.4.x     #4800</p> </li> <li> <p>Backport 4761     #4783</p> </li> <li> <p>Client ID and Client Secret are not shown in developer portal     #4779</p> </li> <li> <p>Merge 3.0.14     #4853</p> </li> <li> <p>Merge 3.0.15     #4923</p> </li> </ul> <p>Management</p> <ul> <li> <p>A new invited user does not have environment role     #4833</p> </li> <li> <p>Dictionary start/stop API fails in case of empty Accept header     #4740</p> </li> <li> <p>Duplicate pages when importing an API     #4944</p> </li> <li> <p>Fix swagger documentation     #4726</p> </li> <li> <p>Improve attach media feature     #4702</p> </li> <li> <p>Manage rights on the plans displayed on the policy studio     #4770</p> </li> <li> <p>OpenAPI with external $ref is not well parsed     #4967</p> </li> <li> <p>Swagger type is not sync with API model     #4788</p> </li> <li> <p>[studio] scope is not automaticaly selected     #4801</p> </li> </ul> <p>Portal</p> <ul> <li> <p>Enable to subscribe to a jwt plan with an app with a client_id     #4724</p> </li> <li> <p>Has invalid dates when viewing a pending subscription     #4873</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_103","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Gateway</p> <ul> <li>Allow to use the system proxy for the endpoint health check     #4627</li> </ul> <p>Management</p> <ul> <li>Handle input type password in schema form     #4701</li> </ul> <p>Repository</p> <ul> <li>[mongodb] Improve 3.4.0 update script     #4881</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_34","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.2 (2021-01-22)","text":"","location":"apim/changelog/changelog-eos/#apim-352-2021-01-22","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>PathParametersIndexProcessor error for specific request pathInfo     #4960</li> </ul> <p>Management</p> <ul> <li> <p>Disable default username / password for SMTP     #4913</p> </li> <li> <p>Error when trying to access Design menu with new design studio and     without admin rights     #4925</p> </li> <li> <p>Social authentication is not working anymore     #4937</p> </li> </ul> <p>Policy</p> <ul> <li> <p>[ip-filtering] Empty IPs can be defined as part of whitelist /     blacklist     #4912</p> </li> <li> <p>[rest-to-soap] do not override request path info     #4860</p> </li> </ul> <p>Repository</p> <ul> <li>[elasticsearch] Retry is not working in case of non 2xx status     code #4919</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_104","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li> <p>Newsletter improvment     #4692</p> </li> <li> <p>Social idp are not enabled after creation     #4956</p> </li> </ul> <p>Portal</p> <ul> <li>Align delete link in aside box     #4926</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_35","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.0.15 (2021-01-18)","text":"","location":"apim/changelog/changelog-eos/#apim-3015-2021-01-18","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Management</p> <ul> <li> <p>Add HTTP proxy configuration for the OAuth2AuthenticationResource     #4398</p> </li> <li> <p>I18n error on console start in production mode     #4878</p> </li> <li> <p>Input not disable for application group     #4710</p> </li> <li> <p>Unable to finalize user invitation     #4858</p> </li> </ul> <p>Repository</p> <ul> <li>[jdbc] Cannot remove a group anymore in some case     #4785</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_105","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Resource</p> <ul> <li>[am] Add trailing slash to the URL automatically     #4907</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_36","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.1 (2021-01-13)","text":"","location":"apim/changelog/changelog-eos/#apim-351-2021-01-13","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Console</p> <ul> <li> <p>Contextual documentation     <code>management-configuration-identityproviders.md</code> is missing     #4890</p> </li> <li> <p>Revoked apikey can not be reactived     #4850</p> </li> </ul> <p>Gateway</p> <ul> <li>ALPN is enabled by default if ssl is disabled     #4887</li> </ul> <p>Management</p> <ul> <li> <p>Mails are not sent anymore with authenticated smtp     #4904</p> </li> <li> <p>Missing environment id when fetching current user tasks     #4862</p> </li> <li> <p>Swagger parsing with fully resolve mode may result in OOM     #4906</p> </li> <li> <p>WSDL import generate wrong scope for <code>xml-to-json</code> policy     #4879</p> </li> </ul> <p>Ui</p> <ul> <li>Alert menu does not appears anymore at API level     #4908</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_106","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Policy</p> <ul> <li>[Retry] Use Expression Language Editor in schema-form     #4844</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_37","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.0.14 (2020-12-28)","text":"","location":"apim/changelog/changelog-eos/#apim-3014-2020-12-28","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li> <p>Unable to disable websockets support     #4476</p> </li> <li> <p>Unable to establish websocket connection     #4768</p> </li> </ul> <p>General</p> <ul> <li> <p>Backport #4798 to 3.0.x     #4846</p> </li> <li> <p>Backport #4825 to 3.0.x     #4826</p> </li> <li> <p>Backport 4669 to 3.0.x     #4670</p> </li> <li> <p>Backport 4678     #4679</p> </li> <li> <p>Backport 4680     #4681</p> </li> <li> <p>Backport 4823 to 3.0.x     #4824</p> </li> <li> <p>Inconsistent synchronization between portal and management ui when     using OIDC     #4532</p> </li> <li> <p>Merge 1.30.29     #4794</p> </li> </ul> <p>Management</p> <ul> <li> <p>API import not working with a documentation fetcher from a future     version (configuration not compatible)     #4806</p> </li> <li> <p>Add HTTP proxy configuration for the AMAuthenticationResource     #4832</p> </li> <li> <p>Cannot define a scope on Authentication creation but only on update     #4684</p> </li> <li> <p>Closing a subscription with an expiry date is still active     #4799</p> </li> <li> <p>Hits by country not well sorted     #4668</p> </li> <li> <p>Markdown generation issue with too big images     #4810</p> </li> </ul> <p>Portal</p> <ul> <li> <p>Do not display error when metrics cannot be retrieved on an     application     #4677</p> </li> <li> <p>Link to an unpublished API should not be display in subscriptions     #4836</p> </li> <li> <p>User without rights on Applications should not see the menu and be     able to browse the dashboard     #4675</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_107","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li>Update user profile information     #4618</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_38","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.5.0 (2020-12-23)","text":"","location":"apim/changelog/changelog-eos/#apim-350-2020-12-23","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>Avoid usage of URI.create to handle properly path and query     parameters with special caracters     #4837</li> </ul> <p>General</p> <ul> <li> <p>Merge 3.4.1     #4775</p> </li> <li> <p>Merge 3.4.2     #4790</p> </li> <li> <p>Report bug 4756 to master     #4757</p> </li> </ul> <p>Identity-providers</p> <ul> <li>Can\u2019t sign in on console with an IDP that is not enabled for portal     #4797</li> </ul> <p>Management</p> <ul> <li> <p>An api-key can not be reactivated for a closed plan     #4798</p> </li> <li> <p>Cannot change an existing plan to add restrictions     #4761</p> </li> <li> <p>Environment Role is not being set with Role Mapping     #4762</p> </li> </ul> <p>Policy</p> <ul> <li>[CalloutHttp] variables should be optional     #4818</li> </ul> <p>Portal</p> <ul> <li> <p>404 when filtering on all APIs     #4823</p> </li> <li> <p>Missing one API when filtering by category     #4825</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_108","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Gateway</p> <ul> <li> <p>Fine-grained conditional policies     #60</p> </li> <li> <p>Handle best match on the policy flows     #4598</p> </li> </ul> <p>Management</p> <ul> <li> <p>Allows to migrate from policy studio v1 to v2     #4589</p> </li> <li> <p>Default response template per API     #4464</p> </li> </ul> <p>Policy</p> <ul> <li>Retry policy     #4802</li> </ul>","location":"apim/changelog/changelog-eos/#features_25","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Gateway</p> <ul> <li>Support for cipher suites configuration     #4541</li> </ul> <p>General</p> <ul> <li>Change the subject of emails about adding members     #4809</li> </ul> <p>Management</p> <ul> <li> <p>Better handling of settings (report #4787)     #4804</p> </li> <li> <p>Make APIM Console multi-env ready     #4151</p> </li> <li> <p>Multi tenancy parameters - implementation     #4642</p> </li> </ul> <p>Policies</p> <ul> <li>Update documentation     #4831</li> </ul> <p>Repository</p> <ul> <li>[redis] Add support for Redis Sentinel     #79</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_39","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.4.2 (2020-12-13)","text":"","location":"apim/changelog/changelog-eos/#apim-342-2020-12-13","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Backport 4762 to 3.4.x     #4780</li> </ul> <p>Management</p> <ul> <li>Wrong email template when resetting a password     #4756</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_109","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li>Better handling of settings     #4787</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_40","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.4.1 (2020-12-08)","text":"","location":"apim/changelog/changelog-eos/#apim-341-2020-12-08","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Management</p> <ul> <li> <p>API importing block is too small and does not scroll     #4723</p> </li> <li> <p>Cannot create a plan with rate limiting restriction on an API     created with the new design studio     #4700</p> </li> <li> <p>Cannot save good script values on Grooy policy with policy-studio     #4712</p> </li> <li> <p>Create or Update API with duplicated label fails with     SQLIntegrityConstraintViolationException     #4704</p> </li> <li> <p>Ignore missing properties when updating settings.     #4682</p> </li> <li> <p>Not able to define mock body with policy studio     #4665</p> </li> <li> <p>Sometimes APIs are not well deployed in gateway     #4707</p> </li> <li> <p>Wrong format of securitydefinition when create a plan     #4714</p> </li> <li> <p>[policy-validate-request] unable to create a complex validation     #4722</p> </li> </ul> <p>Portal</p> <ul> <li>Media links are not well computed     #4669</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_110","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.3.4 (2020-12-01)","text":"","location":"apim/changelog/changelog-eos/#apim-334-2020-12-01","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Backport #4655 to 3.3.x     #4657</p> </li> <li> <p>Backport 4578     #4608</p> </li> <li> <p>Backport 4591     #4607</p> </li> <li> <p>Backport 4620 and 4669 to 3.3.x     #4630</p> </li> <li> <p>Backport 4634 to 3.3.x     #4636</p> </li> <li> <p>Merge 3.2.3     #4676</p> </li> </ul> <p>Portal</p> <ul> <li>Example cURL not displayed for an unpublished API on subscriptions     #4680</li> </ul> <p>Reporter</p> <ul> <li>[elasticsearch] Template mapping of log is incorrect with ES 7.x     #4685</li> </ul> <p>Repository</p> <ul> <li>[jdbc] Simple user without groups can see all the applications     #4678</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_111","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li> <p>Check that the version of the accepted CGU is the current one     #4603</p> </li> <li> <p>Manage attached resources in API import/export     #4315</p> </li> </ul>","location":"apim/changelog/changelog-eos/#improvements_41","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.2.3 (2020-11-27)","text":"","location":"apim/changelog/changelog-eos/#apim-323-2020-11-27","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Merge 3.0.13     #4671</li> </ul> <p>Management</p> <ul> <li> <p>Backport #4551 on 3.2.x     #4552</p> </li> <li> <p>Cannot reorder a page anymore     #4417</p> </li> <li> <p>Forbidden access with a Authorization bearer token     #4440</p> </li> <li> <p>Null constraint violation with jdbc repository at startup     #4521</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_112","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.0.13 (2020-11-26)","text":"","location":"apim/changelog/changelog-eos/#apim-3013-2020-11-26","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Backport #4620 to 3.0.x     #4629</p> </li> <li> <p>Backport 4585     #4606</p> </li> <li> <p>Backport 4591 to 3.0.x     #4619</p> </li> <li> <p>Merge 1.30.26     #4663</p> </li> </ul> <p>Management</p> <ul> <li> <p>API not found on global dashboard when deleted     #4573</p> </li> <li> <p>Cannot create an API and ask for review     #4571</p> </li> <li> <p>Config file user roles are ignored when user is assigned to a group     before his first login     #4586</p> </li> <li> <p>Export logs in CSV should contain the user when it is displayed     #4659</p> </li> <li> <p>Importing theme with images fails     #4179</p> </li> <li> <p>Improve UI when search user to add     #4599</p> </li> <li> <p>Location header does not contain full path to resource     #4624</p> </li> <li> <p>Unable to delete the homepage background     #4213</p> </li> </ul> <p>Portal</p> <ul> <li> <p>Cannot list more than 10 plans during the subscription     #4653</p> </li> <li> <p>Cannot search on labels with some special characters     #4661</p> </li> <li> <p>Missing X-Xsrf-Token header from the portal UI in APIM     #4628</p> </li> <li> <p>Size list of application log is not well updated     #4662</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_113","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li>Allows to export all the logs in a CSV and not only the current page     #4664</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_42","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.4.0 (2020-11-24)","text":"","location":"apim/changelog/changelog-eos/#apim-340-2020-11-24","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li> <p>Graceful shutdown on streamFailWith     #4648</p> </li> <li> <p>Manage graceful shutdown for 3.x     #4632</p> </li> </ul> <p>General</p> <ul> <li> <p>Add an API from another docker-compose stack than the Gravitee one     #4640</p> </li> <li> <p>Typo in french portal translation when connection issues     #4504</p> </li> </ul> <p>Management</p> <ul> <li> <p>Cannot create an API from a Gravitee.io definition anymore     #4570</p> </li> <li> <p>Default admin can\u2019t see/go to the dashboard and settings menu     #4591</p> </li> <li> <p>Default application is not correctly created for social / OAuth     login #4634</p> </li> <li> <p>Impossible to move documentation page to folder     #4655</p> </li> <li> <p>Portal and Schedulers sections appear two times in settings     #4578</p> </li> <li> <p>Redoc is not working with a private API on dist     #4585</p> </li> <li> <p>[quality-rules]unable to create a new quality-rule     #4602</p> </li> </ul> <p>Plugin</p> <ul> <li>Ensure plugin loading order     #4486</li> </ul> <p>Portal</p> <ul> <li>Image links are broken on portal documentation     #4620</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_114","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Gateway</p> <ul> <li> <p>Forward the X-Forwarded-Prefix to the backend endpoint     #4434</p> </li> <li> <p>Support for path-named parameters in Expression Language (EL)     #4431</p> </li> </ul> <p>Management</p> <ul> <li> <p>Allows to manage authentication identity providers on the portal     #3963</p> </li> <li> <p>Global reviewer     #4436</p> </li> <li> <p>Label\u2019s dictionary     #4437</p> </li> <li> <p>Move CORS from static to dynamic configuration     #4432</p> </li> <li> <p>Move SMTP from static to dynamic configuration     #4433</p> </li> <li> <p>Move notification templates in the UI     #4297</p> </li> <li> <p>Override settings via envvars     #4452</p> </li> <li> <p>Support tickets history     #4435</p> </li> <li> <p>[audit] Adapt audit system to Orgs &amp; Envs     #3976</p> </li> </ul> <p>Policy</p> <ul> <li>[api-key] Allows to define custom api-key     #4318</li> </ul> <p>Reporter</p> <ul> <li> <p>[file] File reporter to write raw data (csv format)     #4236</p> </li> <li> <p>[tcp] Add support for a TCP reporter     #4584</p> </li> </ul> <p>Repository</p> <ul> <li>[hazelcast] Rate-limit support     #4527</li> </ul>","location":"apim/changelog/changelog-eos/#features_26","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li> <p>Allows to configure statically the theme     #4456</p> </li> <li> <p>Allows to define the background color of the login page from the     theme #4458</p> </li> <li> <p>Improve API Quality checks display     #3201</p> </li> <li> <p>Remove i18n support on the management UI     #4485</p> </li> </ul> <p>Policy</p> <ul> <li>[aws-lambda] Allows to extract data in execution context from     payload #4395</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_43","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.0.12 (2020-11-15)","text":"","location":"apim/changelog/changelog-eos/#apim-3012-2020-11-15","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Backport 4602     #4604</p> </li> <li> <p>Merge 1.30.25     #4610</p> </li> </ul> <p>Swagger</p> <ul> <li>Only validate swagger content on create/update     #4605</li> </ul> <p>Ui-components</p> <ul> <li>Double icon rendering on gv-table     #4523</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_115","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Gateway</p> <ul> <li> <p>HTTP code 414 (URL too long) with gateway     #4534</p> </li> <li> <p>Support for TLS 1.3     #4065</p> </li> </ul>","location":"apim/changelog/changelog-eos/#improvements_44","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.3.3 (2020-11-04)","text":"","location":"apim/changelog/changelog-eos/#apim-333-2020-11-04","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Management</p> <ul> <li>Cannot update roles of a user anymore     #4551</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_116","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.3.2 (2020-11-03)","text":"","location":"apim/changelog/changelog-eos/#apim-332-2020-11-03","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Management-ui</p> <ul> <li>Connection pool min limit for an endpoint should be 1 and not 10     #4543</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_117","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.3.1 (2020-11-03)","text":"","location":"apim/changelog/changelog-eos/#apim-331-2020-11-03","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Merge 3.2.2     #4559</li> </ul> <p>Management</p> <ul> <li>Impossible to create Cache Policy     #4478</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_118","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li> <p>Coherence between api import with definition and with swagger     #4411</p> </li> <li> <p>Typo in _depreciate subpath     #4414</p> </li> </ul>","location":"apim/changelog/changelog-eos/#improvements_45","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.2.2 (2020-11-04)","text":"","location":"apim/changelog/changelog-eos/#apim-322-2020-11-04","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Merge 3.0.10     #4515</p> </li> <li> <p>Merge 3.0.11     #4558</p> </li> <li> <p>Merge 3.0.9     #4424</p> </li> </ul> <p>Management</p> <ul> <li>Missing description in operation response when import WSDL     #4416</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_119","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.0.11 (2020-10-31)","text":"","location":"apim/changelog/changelog-eos/#apim-3011-2020-10-31","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Jdbc-repository</p> <ul> <li>Liquibase checksum fail when migrating from 3.0.6 to 3.0.7     #4526</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_120","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Gateway</p> <ul> <li>Allowing constructors in expression language     #4514</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_46","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.0.10 (2020-10-27)","text":"","location":"apim/changelog/changelog-eos/#apim-3010-2020-10-27","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Create dedicated resource to change user password     #4480</p> </li> <li> <p>Ensure bad response are considered as errors     #4513</p> </li> <li> <p>Merge 1.30.24     #4491</p> </li> <li> <p>Missing mapping for orgId and envId in swagger definition generated     for management Rest-API     #4394</p> </li> </ul> <p>Management</p> <ul> <li> <p>As standard user i see an administration link on portal UI     #4399</p> </li> <li> <p>Change background color for theme logo     #4444</p> </li> <li> <p>Error while searching through LDAP to transfer application     #4441</p> </li> <li> <p>Improve the force login feature     #4412</p> </li> <li> <p>Removing a user from a role, removes the user from all roles of the     scope #4501</p> </li> <li> <p>Resetting password from Portal UI should not invalidate password     #4410</p> </li> </ul> <p>Portal</p> <ul> <li> <p>Anchor links not working correctly     #2161</p> </li> <li> <p>Code preview display as block for inline code     #4404</p> </li> <li> <p>Display of a large API name broken on a table list     #4035</p> </li> <li> <p>Version too large in the dashboard\u2019s subscriptions     #4461</p> </li> </ul> <p>Repository</p> <ul> <li>[http-bridge] Gateway does not resync (gateway-bridge-http) after     network issue     #4505</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_121","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Portal</p> <ul> <li> <p>Allows to get the portal\u2019s version     #4459</p> </li> <li> <p>Hide empty categories     #4477</p> </li> </ul>","location":"apim/changelog/changelog-eos/#improvements_47","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.3.0 (2020-10-15)","text":"","location":"apim/changelog/changelog-eos/#apim-330-2020-10-15","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Merge 3.2.1     #4385</li> </ul> <p>Management</p> <ul> <li>Import of OpenAPI/Swagger containing path definition with     parentheses and url parameters failed     #4336</li> </ul> <p>Policy</p> <ul> <li>[json-validation] Scope Enum modification     #4420</li> </ul> <p>Portal</p> <ul> <li>Fix typo in EN     #4379</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_122","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Management</p> <ul> <li> <p>Support for custom Swagger tags to define API\u2019s information     #4295</p> </li> <li> <p>[identity-provider]Users and IdentityProviders can only be     attached to an organization     #3973</p> </li> </ul> <p>Policy</p> <ul> <li> <p>AWS Lambda Function     #4276</p> </li> <li> <p>[json-validation] Integration with swagger / OpenAPI     #4293</p> </li> <li> <p>[spike-arrest] Protect backend against overload     #4296</p> </li> <li> <p>[xml-validation] Integration with swagger / OpenAPI     #4294</p> </li> </ul>","location":"apim/changelog/changelog-eos/#features_27","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.0.9 (2020-10-09)","text":"","location":"apim/changelog/changelog-eos/#apim-309-2020-10-09","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Merge 1.30.22     #4346</p> </li> <li> <p>Merge 1.30.23     #4390</p> </li> </ul> <p>Management</p> <ul> <li> <p>Blank page when selecting multiple times the setting menu     #4392</p> </li> <li> <p>Error popup after a login with an OIDC provider     #4290</p> </li> <li> <p>Import of an existing api fail since 3.2     #4397</p> </li> </ul> <p>Migration</p> <ul> <li>Duplicate memberships after v3 migration     #4382</li> </ul> <p>Portal</p> <ul> <li> <p>Align EN translations for rating     #4388</p> </li> <li> <p>Cannot display payloads on a log     #4048</p> </li> <li> <p>Fix typo in EN     #4383</p> </li> <li> <p>In Prod mode, folders in documentation can not be expanded     #4275</p> </li> <li> <p>Log\u2019s title truncated     #4054</p> </li> <li> <p>Redoc does not use gateway url but portal url     #4389</p> </li> <li> <p>Remove the useless portal title from settings     #4370</p> </li> </ul> <p>Repository</p> <ul> <li>[jdbc] Startup repository error when using MySQL 8.0.15     plugin/driver     #4255</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_123","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Management</p> <ul> <li>Remove the Application picture     #4316</li> </ul>","location":"apim/changelog/changelog-eos/#features_28","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li>Improve canReadAPI method     #4401</li> </ul> <p>Management-api</p> <ul> <li>Create Subscription not returning subscription keys     #4171</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_48","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.2.1 (2020-10-01)","text":"","location":"apim/changelog/changelog-eos/#apim-321-2020-10-01","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Policy</p> <ul> <li> <p>[ipfiltering] Socket leak with DNS resolution     #4362</p> </li> <li> <p>[quota] Inconsistent body for Quota at V3.2     #4345</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_124","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.2.0 (2020-09-22)","text":"","location":"apim/changelog/changelog-eos/#apim-320-2020-09-22","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Merge 3.1.3     #4261</p> </li> <li> <p>Merge 3.1.4     #4299</p> </li> </ul> <p>Reporter</p> <ul> <li>[elasticsearch] invalid default value for ILM lifecycle property     name #4303</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_125","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Fetcher</p> <ul> <li>Add a cron task to fetch the documentation     #3196</li> </ul> <p>Management</p> <ul> <li> <p>Associate assets to a page     #4066</p> </li> <li> <p>Associate page to a category     #4067</p> </li> <li> <p>Custom user fields     #4070</p> </li> <li> <p>General Conditions of use (when subscribing to a plan)     #4068</p> </li> <li> <p>Process to validate an account (registration)     #4069</p> </li> </ul> <p>Management-api</p> <ul> <li>Create api from a WSDL     #322</li> </ul> <p>Policy</p> <ul> <li> <p>WS-Security based authentication     #4247</p> </li> <li> <p>[basic-auth] Protect api w/ simple basic auth     #689</p> </li> <li> <p>[rate-limit] Increase configurability of the rate-limit policy     #4128</p> </li> </ul> <p>Portal</p> <ul> <li> <p>Add versioning on documentation pages     #146</p> </li> <li> <p>Allows to link pages in markdown     #4072</p> </li> </ul> <p>Resource</p> <ul> <li>[auth-provider] Provide user attributes     #4281</li> </ul>","location":"apim/changelog/changelog-eos/#features_29","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li> <p>Enable / disable swagger\u2019s rendering editor     #4055</p> </li> <li> <p>Enable logging without condition     #2778</p> </li> </ul> <p>Management-ui</p> <ul> <li> <p>Provide more logs about CORS issue     #4231</p> </li> <li> <p>Show API status icons on API portal page     #4229</p> </li> </ul>","location":"apim/changelog/changelog-eos/#improvements_49","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.1.4 (2020-09-16)","text":"","location":"apim/changelog/changelog-eos/#apim-314-2020-09-16","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>NPE on windows environment when using alerting     #4240</li> </ul> <p>General</p> <ul> <li>Merge 3.0.8     #4286</li> </ul> <p>Management-api</p> <ul> <li>Inconsistent behavior of Gravitee     #4130</li> </ul> <p>Portal</p> <ul> <li>Unable to logout when using AM IDP     #4215</li> </ul> <p>Repository</p> <ul> <li>[jdbc] Impossible to delete a group     #4234</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_126","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.0.8 (2020-09-15)","text":"","location":"apim/changelog/changelog-eos/#apim-308-2020-09-15","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Merge 1.30.20     #4259</p> </li> <li> <p>Merge 1.30.21     #4282</p> </li> </ul> <p>Management</p> <ul> <li> <p>All user invitations are made for the idp \"gravitee\"     #4226</p> </li> <li> <p>Cannot save an API with health check inheritance     #4251</p> </li> <li> <p>When we import an api, documentation is brokeninternal link, image,     order of appearance     #4149</p> </li> </ul> <p>Repository</p> <ul> <li> <p>[jdbc] Cannot update custom roles     #4258</p> </li> <li> <p>[mongodb]index script contains an error on memberships     #4233</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_127","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.1.3 (2020-09-02)","text":"","location":"apim/changelog/changelog-eos/#apim-313-2020-09-02","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>Improve websocket continuation support     #4220</li> </ul> <p>General</p> <ul> <li> <p>Merge 3.0.7     #4194</p> </li> <li> <p>Requests seems stuck when enabling restrictions (Quota or Rate     limiting) on a plan     #4175</p> </li> </ul> <p>Management</p> <ul> <li> <p>NPE on login if user has no first connection information     #4196</p> </li> <li> <p>Not able to set default API / application role with JDBC repository     #4214</p> </li> </ul> <p>Portal</p> <ul> <li> <p>An error occurred during the subscription for an OAuth 2 Plan     #4195</p> </li> <li> <p>Unable to logout when using AM IDP     #4215</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_128","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.0.7 (2020-08-19)","text":"","location":"apim/changelog/changelog-eos/#apim-307-2020-08-19","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>APIM gateway 3.0.4 \u2192 3.0.6 causes WARN No plan has been selected and     apis does not work     #4169</li> </ul> <p>General</p> <ul> <li> <p>Merge 1.30.17     #4157</p> </li> <li> <p>Merge 1.30.18     #4163</p> </li> <li> <p>Merge 1.30.19     #4181</p> </li> </ul> <p>Management</p> <ul> <li> <p>Make markdown documentation visually similar to the one present in     version 1.30     #4147</p> </li> <li> <p>Members inherited from group doesn\u2019t work on 3.1.1 and 3.0.6     #4154</p> </li> </ul> <p>Portal</p> <ul> <li>Application\u2019s metadata management     #4089</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_129","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li>Use URLs of the portal and management from settings     #4144</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_50","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.1.2 (2020-08-04)","text":"","location":"apim/changelog/changelog-eos/#apim-312-2020-08-04","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>Disable logging activity     #4131</li> </ul> <p>General</p> <ul> <li>Merge 3.0.6     #4142</li> </ul> <p>Management</p> <ul> <li>Allows to export from 3.1 to 3.0 also with grpc endpoints     #4098</li> </ul> <p>Policy</p> <ul> <li>[rest-to-soap] Can not save the form after updating prefill soap     envelope in some case     #4087</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_130","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li>Allows a user to subscribe to the newsletter after first login     #4096</li> </ul> <p>Service-discovery</p> <ul> <li>Consul.io MTLS support     #4116</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_51","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.0.6 (2020-07-30)","text":"","location":"apim/changelog/changelog-eos/#apim-306-2020-07-30","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Merge 1.30.16     #4132</li> </ul> <p>Portal</p> <ul> <li> <p>Confirmation message when deleting a member is not well displayed     #4140</p> </li> <li> <p>Copy to sender not work in user contact form     #4136</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_131","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.1.1 (2020-07-20)","text":"","location":"apim/changelog/changelog-eos/#apim-311-2020-07-20","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>Bad merge with 1.30.14     #4121</li> </ul> <p>Management</p> <ul> <li>Node cannot start on an empty database in some context     #4118</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_132","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.1.0 (2020-07-17)","text":"","location":"apim/changelog/changelog-eos/#apim-310-2020-07-17","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Merge 3.0.4     #4042</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_133","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Gateway</p> <ul> <li> <p>Support zone in order to group analytics     #3858</p> </li> <li> <p>Use backup endpoints as secondary choice     #3877</p> </li> </ul> <p>Policy</p> <ul> <li> <p>Json Threat Protection policy     #3950</p> </li> <li> <p>Regex Threat Protection Policy     #3949</p> </li> <li> <p>Xml Threat Protection Policy     #3951</p> </li> <li> <p>[ip-filtering] Add DNS resolution option for host filtering     #3880</p> </li> </ul>","location":"apim/changelog/changelog-eos/#features_30","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Gateway</p> <ul> <li>Accept backends/entrypoints supporting only HTTP/2     #3105</li> </ul> <p>Policy</p> <ul> <li>[request-validation] support for type \"ENUM\"     #3556</li> </ul> <p>Portal</p> <ul> <li>Allows to define a background on the APIs/Apps/Categories headers     #3761</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_52","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.0.5 (2020-07-17)","text":"","location":"apim/changelog/changelog-eos/#apim-305-2020-07-17","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Gateway</p> <ul> <li>Websocket and stompgetting \"Error during WebSocket handshakeSent     non-empty Sec-WebSocket-Protocol header but no response was     received\"     #4060</li> </ul> <p>General</p> <ul> <li>Merge 1.30.15     #4083</li> </ul> <p>Management</p> <ul> <li> <p>HtmlSanitizer can sometimes generate an error when creating or     updating a markdown page     #4077</p> </li> <li> <p>Incorrect audit when deleting a portal page     #4099</p> </li> <li> <p>Sometimes social login is not working     #4088</p> </li> </ul> <p>Portal</p> <ul> <li> <p>Application image not well displayed if too large in last step of     application creation     #4063</p> </li> <li> <p>Wrong table headers in last step of application creation     #4057</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_134","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.0.4 (2020-07-01)","text":"","location":"apim/changelog/changelog-eos/#apim-304-2020-07-01","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>Merge 1.30.13     #4026</p> </li> <li> <p>Merge 1.30.14     #4027</p> </li> </ul> <p>Management</p> <ul> <li> <p>Cannot save API in some case with http headers     #4001</p> </li> <li> <p>Configuration of logging don\u2019t work     #4021</p> </li> <li> <p>Exported APIs to 1.x version incorrect     #3996</p> </li> <li> <p>Geo map is not displayed     #4007</p> </li> </ul> <p>Management-ui</p> <ul> <li>Checkbox \"override entrypoint\" is very big in api virtualhost mode     #3999</li> </ul> <p>Platform</p> <ul> <li>EL sandbox is not well instantiated     #4003</li> </ul> <p>Portal</p> <ul> <li> <p>Cannot list my subscriptions in some cases     #3994</p> </li> <li> <p>Configure the baseUrl on default distribution config     #4005</p> </li> <li> <p>Try it with oauth2 is not working when the UI is served with a base     path #4038</p> </li> <li> <p>With different basePath sends redirect request for openid without     the basePath     #3993</p> </li> </ul> <p>Repository</p> <ul> <li>[jdbc] Increase the client id to allow 128 characters     #4040</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_135","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Portal</p> <ul> <li>Adapt configuration to be more consistant with the mgmt config     #3968</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_53","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.0.3 (2020-06-18)","text":"","location":"apim/changelog/changelog-eos/#apim-303-2020-06-18","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Merge 1.30.12     #3971</li> </ul> <p>Portal</p> <ul> <li> <p>A simple user without permissions on API plan read get an exception     on subscription     #3953</p> </li> <li> <p>Better handling of logos with a large width     #3892</p> </li> <li> <p>Pagination is broken when browsing APIs     #3960</p> </li> <li> <p>The subscribe button should not disappear on scroll     #3955</p> </li> <li> <p>Unable to get plans list for subscriptions     #3914</p> </li> </ul> <p>Repository</p> <ul> <li> <p>[jdbc] When opening portal as not logged in user, getting browser     error #3913</p> </li> <li> <p>[jdbc] in apim 3 requires super user privilege to gravitee user in     postgresql     #3909</p> </li> <li> <p>[jdbc] upgraded users should be linked to an ORGANIZATION     #3912</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_136","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Management</p> <ul> <li>Support for redirection after authentication     #3857</li> </ul>","location":"apim/changelog/changelog-eos/#features_31","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.0.2 (2020-06-03)","text":"","location":"apim/changelog/changelog-eos/#apim-302-2020-06-03","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li> <p>APIM3.0.1 Portal-UI uri baseurl not configurable     #3883</p> </li> <li> <p>Merge 1.30.11     #3890</p> </li> <li> <p>Update in FROM clause Error in MySQL environment when use     gravitee-repository-jdbc-3.0.0     #3853</p> </li> </ul> <p>Management-api</p> <ul> <li>ID is sent on create View and this cause error     #3882</li> </ul> <p>Portal</p> <ul> <li> <p>Access URL not well displayed when too long     #3898</p> </li> <li> <p>Application default icon is not well generated in subscriptions     lists #3847</p> </li> <li> <p>Console error when trying to rate an API     #3902</p> </li> <li> <p>Error message on application creation &amp; api subscription     #3875</p> </li> <li> <p>On the dashboard, the version of API is not well displayed with a     large API name     #3832</p> </li> <li> <p>Should not be able to subscribe to a JWT API without a client id     #3874</p> </li> <li> <p>Sometimes my subscriptions are not well displayed on hover     #3804</p> </li> <li> <p>Tags and views are not displayed anymore on cards when not     configured in API\u2019s aside     #3897</p> </li> <li> <p>The error message is not displayed until we click     #3817</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_137","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Management</p> <ul> <li> <p>Better handling of read access on API\u2019s items     #3886</p> </li> <li> <p>Change the wording of the views to categories     #3843</p> </li> </ul> <p>Portal</p> <ul> <li>Enable to click on a tag displayed on a card     #3842</li> </ul>","location":"apim/changelog/changelog-eos/#improvements_54","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.0.1 (2020-05-26)","text":"","location":"apim/changelog/changelog-eos/#apim-301-2020-05-26","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>Management</p> <ul> <li> <p>Default admin can\u2019t go to the dashboard and settings menu     #3834</p> </li> <li> <p>Unable to create a folder in TopFooter system folder     #3825</p> </li> </ul> <p>Portal</p> <ul> <li> <p>Api rating issues     #3824</p> </li> <li> <p>Link in aside reloads all the application     #3810</p> </li> <li> <p>Swagger OAuth integration     #3813</p> </li> <li> <p>Take care of defined properties to display API\u2019s aside     #3812</p> </li> <li> <p>Unpublished pages are displayed on API\u2019s documentation     #3837</p> </li> <li> <p>Use the color defined on the identity providers display on the login     #3811</p> </li> <li> <p>When creating view the picture is broken     #3841</p> </li> <li> <p>When forceLogin is enabled, we cannot register anymore     #3845</p> </li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_138","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"APIM - 3.0.0 (2020-05-20)","text":"","location":"apim/changelog/changelog-eos/#apim-300-2020-05-20","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bug fixes","text":"<p>General</p> <ul> <li>Merge 1.30.x     #3392</li> </ul> <p>Management</p> <ul> <li> <p>Empty mode is not well displayed on Gateway Instances screen     #3739</p> </li> <li> <p>User/avatar should return 200 with no body when user doesn\u2019t have     avatar #3330</p> </li> </ul> <p>Portal</p> <ul> <li>Display labels on API cards     #3116</li> </ul>","location":"apim/changelog/changelog-eos/#bug-fixes_139","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Features","text":"<p>Gateway</p> <ul> <li>Remove the legacy mode for url encoding     #2634</li> </ul> <p>Management</p> <ul> <li> <p>I18n for documentation     #3071</p> </li> <li> <p>[multi-env] Adapt memberships scopes and permissions to multi-env     #3206</p> </li> </ul> <p>Multi-env</p> <ul> <li>Add organization feature     #3182</li> </ul> <p>Portal</p> <ul> <li> <p>Add a link to admin in user menu     #3109</p> </li> <li> <p>Add message for Cookies     #2956</p> </li> <li> <p>Add the possibility to comment / rate an API     #3061</p> </li> <li> <p>Allow a user to change his avatar     #2806</p> </li> <li> <p>Allow a user to consult analytics of an application     #2804</p> </li> <li> <p>Allow a user to consult logs of an application     #2805</p> </li> <li> <p>Allow a user to consult subscriptions of an application     #3114</p> </li> <li> <p>Allow a user to consult/edit global settings of an application     #2799</p> </li> <li> <p>Allow a user to consult/edit members of an application     #2803</p> </li> <li> <p>Allow a user to create an application     #2798</p> </li> <li> <p>Allow a user to reset his password     #2822</p> </li> <li> <p>Allow a user to subscribe to notifications on an application     #3115</p> </li> <li> <p>Allow users to subscribe to newsletters     #3420</p> </li> <li> <p>Allows to consult a subscription     #3108</p> </li> <li> <p>Generate a custom default icon for user/apis/application     #2853</p> </li> <li> <p>Integrate Google Analytics     #3344</p> </li> </ul>","location":"apim/changelog/changelog-eos/#features_32","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Improvements","text":"<p>Platform</p> <ul> <li>Update v3 configuration     #3668</li> </ul> <p>Portal</p> <ul> <li> <p>Add a 404 page     #2991</p> </li> <li> <p>Generate dist on the root     #3737</p> </li> <li> <p>Keep API display preference to the user     #3110</p> </li> <li> <p>Work on route transition animations     #3010</p> </li> <li> <p>Work on scroll to top strategy router navigation     #3012</p> </li> </ul>","location":"apim/changelog/changelog-eos/#improvements_55","tags":["APIM pre-3.15.x changelog","Changelog","Release notes","Upgrades","End-of-support versions"]},{"title":"Bootstrap your development environment","text":"","location":"apim/dev-guide/dev-guide-boostrap/","tags":["APIM","Developer guide","Bootstrap"]},{"title":"Overview","text":"<p>This section explains how to set up your environment to start contributing to APIM development.</p>","location":"apim/dev-guide/dev-guide-boostrap/#overview","tags":["APIM","Developer guide","Bootstrap"]},{"title":"Prerequisites","text":"<p>You will need the following tools installed on your computer:</p> <ul> <li>Java (JDK &gt;= 11)</li> <li>Maven</li> <li>Docker</li> <li>NPM (preferably NVM)</li> </ul>","location":"apim/dev-guide/dev-guide-boostrap/#prerequisites","tags":["APIM","Developer guide","Bootstrap"]},{"title":"Get the project and prepare your workspace","text":"","location":"apim/dev-guide/dev-guide-boostrap/#get-the-project-and-prepare-your-workspace","tags":["APIM","Developer guide","Bootstrap"]},{"title":"Clone the project in your workspace:","text":"<pre><code>git clone https://github.com/gravitee-io/gravitee-api-management\n</code></pre>","location":"apim/dev-guide/dev-guide-boostrap/#clone-the-project-in-your-workspace","tags":["APIM","Developer guide","Bootstrap"]},{"title":"Build APIM Management API and Gateway:","text":"<pre><code># before 3.18.0-SNAPSHOT\nmvn -pl '!gravitee-apim-console-webui, !gravitee-apim-portal-webui' clean install -T 2C\n\n# starting from 3.18.0-SNAPSHOT, UIs projects are not managed by Maven anymore.\nmvn clean install -T 2C\n</code></pre>  <p>Tip</p> <p>You can use <code>-Dskip.validation=true</code> to skip license validation and prettier checks.</p>  <p>This command will create a <code>distribution</code> folder in the <code>target</code> folder of each module. These folders contain a full distribution of Management API and Gateway, with default plugins. These <code>distribution</code> folder should be used as the <code>gravitee.home</code> environment variable</p>","location":"apim/dev-guide/dev-guide-boostrap/#build-apim-management-api-and-gateway","tags":["APIM","Developer guide","Bootstrap"]},{"title":"Prepare APIM Console UI and Portal UI","text":"<p>Run <code>npm install</code> from the <code>gravitee-api-management/gravitee-apim-console-webui</code> and <code>gravitee-api-management/gravitee-apim-portal-webui</code> directories.</p>  <p>Tip</p> <p>You can use <code>nvm use</code> to switch to the appropriate version of npm to build the UIs.</p>","location":"apim/dev-guide/dev-guide-boostrap/#prepare-apim-console-ui-and-portal-ui","tags":["APIM","Developer guide","Bootstrap"]},{"title":"Run Prerequisites","text":"<p>Before starting APIM Management API and Gateway, you need to start MongoDB and ElasticSearch.  </p> <p>To do so, you can use Docker, as shown in the examples below.</p> <p>To start MongoDB with Docker, run:</p> <pre><code>docker run -p 27017:27017 --name local-mongo -d mongo:3\n</code></pre> <p>To start ElasticSearch with Docker, run:</p> <pre><code>docker run -d --name local-es7 -p 9200:9200 -p 9300:9300 -e \"discovery.type=single-node\" docker.elastic.co/elasticsearch/elasticsearch:7.7.0\n</code></pre>","location":"apim/dev-guide/dev-guide-boostrap/#run-prerequisites","tags":["APIM","Developer guide","Bootstrap"]},{"title":"Run Configuration","text":"","location":"apim/dev-guide/dev-guide-boostrap/#run-configuration","tags":["APIM","Developer guide","Bootstrap"]},{"title":"APIM Gateway (gravitee-apim-gateway)","text":"<p>CLI Version</p> <p>Run <code>./gravitee</code> from the <code>${GRAVITEE_HOME}/bin</code> directory.</p> <p><code>${GRAVITEE_HOME}</code> refers to the <code>target/distribution</code> folder created before.</p> <p>IntelliJ configuration</p> <p>Create a new Run configuration in IntelliJ:</p> <ol> <li>Click Run \u2192 Edit configurations \u2192 \u271a \u2192 Application.</li> <li>Name it as required.</li> <li>Choose Use classpath of module: <code>gravitee-apim-gateway-standalone-container</code>.</li> <li>Select Main class: <code>io.gravitee.gateway.standalone.GatewayContainer</code>.</li> <li>In the VM options, add the following (change the path to point to     your project):     <pre><code>-Dgravitee.home=\"/home/user/dev/gravitee-api-management/gravitee-apim-gateway/gravitee-apim-gateway-standalone/gravitee-apim-gateway-standalone-distribution/target/distribution\"\n</code></pre></li> </ol>","location":"apim/dev-guide/dev-guide-boostrap/#apim-gateway-gravitee-apim-gateway","tags":["APIM","Developer guide","Bootstrap"]},{"title":"APIM Management API","text":"<p>CLI Version</p> <p>Run <code>./gravitee</code> from the <code>${GRAVITEE_HOME}/bin</code> directory.</p> <p><code>${GRAVITEE_HOME}</code> refers to the <code>target/distribution</code> folder created before.</p> <p>IntelliJ configuration</p> <p>Create a new Run configuration in IntelliJ:</p> <ol> <li>Click Run \u2192 Edit configurations \u2192 \u271a \u2192 Application.</li> <li>Name it as required.</li> <li>Choose Use classpath of module: <code>gravitee-apim-rest-api-standalone-container</code>.</li> <li>Select Main class: <code>io.gravitee.rest.api.standalone.GraviteeApisContainer</code>.</li> <li>In the VM options, add the following (change the path to point to     your project):     <pre><code>-Dgravitee.home=\"/home/user/dev/gravitee-api-management/gravitee-apim-rest-api/gravitee-apim-rest-api-standalone/gravitee-apim-rest-api-standalone-distribution/target/distribution\"\n</code></pre></li> </ol>","location":"apim/dev-guide/dev-guide-boostrap/#apim-management-api","tags":["APIM","Developer guide","Bootstrap"]},{"title":"APIM Console","text":"<p>CLI Version</p> <p>Run <code>npm run serve</code> from the <code>gravitee-api-management/gravitee-apim-console-webui</code> directory to start the UI.</p> <p>IntelliJ configuration</p> <p>Create a new Run configuration in IntelliJ:</p> <ol> <li>Click Run \u2192 Edit configurations \u2192 \u271a \u2192 npm.</li> <li>Name it as required.</li> <li>Choose package.json:     gravitee-api-management/gravitee-apim-console-webui/package.json.</li> <li>Select Command: run.</li> <li>Select Script: serve.</li> </ol> <p>To <code>npm install</code>, you can duplicate this configuration and choose Command &gt; Install.</p>","location":"apim/dev-guide/dev-guide-boostrap/#apim-console","tags":["APIM","Developer guide","Bootstrap"]},{"title":"APIM Portal","text":"<p>CLI Version</p> <p>Run <code>npm run serve</code> from the <code>gravitee-api-management/gravitee-apim-portal-webui</code> directory to start the UI.</p> <p>IntelliJ Configuration</p> <p>Create a new Run configuration in IntelliJ:</p> <ol> <li>Click Run \u2192 Edit configurations \u2192 \u271a \u2192 npm.</li> <li>Name it as required.</li> <li>Choose package.json:     gravitee-api-management/gravitee-apim-portal-webui/package.json.</li> <li>Select Command: run.</li> <li>Select Script: serve.</li> </ol> <p>To <code>npm install</code>, you can duplicate this configuration and choose Command &gt; Install.</p>","location":"apim/dev-guide/dev-guide-boostrap/#apim-portal","tags":["APIM","Developer guide","Bootstrap"]},{"title":"APIM Developer Guide - Plugins","text":"","location":"apim/dev-guide/dev-guide-plugins/","tags":["APIM","Developer guide","Plugins"]},{"title":"Plugins","text":"<p>APIM plugins are additional components that can be plugged into the Gravitee ecosystem. You can use plugins to extend and customize the behavior of Gravitee to meet your strategic needs.</p>  <p>Note</p> <p>APIM includes a default set of plugins with each distribution. You can also obtain and install some additional plugins from Gravitee. For more information, see the Installation Guide.</p>  <p>This section describes how to create your own custom plugins.</p>","location":"apim/dev-guide/dev-guide-plugins/#plugins","tags":["APIM","Developer guide","Plugins"]},{"title":"Common structure","text":"<p>Each plugin follows the following common structure:</p> <pre><code>-----------------\n.\n\u251c\u2500\u2500 pom.xml\n\u251c\u2500\u2500 README.md\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 assembly\n    \u2502   \u2514\u2500\u2500 &lt;plugin&gt;-assembly.xml\n    \u251c\u2500\u2500 main\n    \u2502   \u251c\u2500\u2500 java\n    \u2502   \u2502   \u2514\u2500\u2500 &lt;main java files&gt;\n    \u2502   \u2514\u2500\u2500 resources\n    \u2502       \u2514\u2500\u2500 plugin.properties\n    \u2514\u2500\u2500 test\n        \u2514\u2500\u2500 java\n            \u2514\u2500\u2500 &lt;test java files&gt;\n-----------------\n</code></pre> <p>The different key files are as follows:</p> <pre><code>|===\n| File                                                               | Description\n\n| &lt;&lt;gravitee-dev-guide-plugins-pom, `pom.xml`&gt;&gt;                      | The main Maven POM file\n| &lt;&lt;gravitee-dev-guide-plugins-readme, `README.md`&gt;&gt;                 | The main entry point for the plugin documentation\n| &lt;&lt;gravitee-dev-guide-plugins-assembly, `&lt;plugin&gt;-assembly.xml`&gt;&gt;   | The common Maven assembly descriptor\n| &lt;&lt;gravitee-dev-guide-plugins-descriptor, `plugin.properties`&gt;&gt;     | The plugin descriptor file\n|===\n</code></pre>","location":"apim/dev-guide/dev-guide-plugins/#common-structure","tags":["APIM","Developer guide","Plugins"]},{"title":"pom.xml","text":"<p>Any plugins (and more generally any Gravitee projects) are Maven managed. A plugin project is described by using the Maven Project Object Model file.</p>","location":"apim/dev-guide/dev-guide-plugins/#pomxml","tags":["APIM","Developer guide","Plugins"]},{"title":"README.md","text":"<p>Each plugin should have a dedicated <code>README.md</code> file to document it. The <code>README.md</code> file should contain everything related to the use of your plugin: What is its functionality? How can you use it? How can you configure it?</p>","location":"apim/dev-guide/dev-guide-plugins/#readmemd","tags":["APIM","Developer guide","Plugins"]},{"title":"-assembly.xml <p>In order to be plugged into the Gravitee ecosystem, a plugin needs to be deployed following a given file structure. The <code>&lt;plugin&gt;-assembly.xml</code> file is the Maven Assembly descriptor used to build the distribution file.</p> <p>Commonly, a plugin distribution file is organized as follows:</p> <pre><code>-----------------\n.\n\u251c\u2500\u2500 &lt;main Jar file&gt;.jar\n\u2514\u2500\u2500 lib\n-----------------\n</code></pre> <p>The different files are as follows:</p> <pre><code>|===\n| File                   | Description\n\n| `&lt;main Jar File&gt;.jar`  | The plugin's main Jar file\n| `lib/`                 | A directory containing external libraries to correctly execute the &lt;main Jar File&gt;.jar\n|===\n</code></pre>","text":"","location":"apim/dev-guide/dev-guide-plugins/#-assemblyxml","tags":["APIM","Developer guide","Plugins"]},{"title":".jar <p>Each plugin has its main <code>.jar</code> file containing the business behavior plus the <code>&lt;&lt;gravitee-dev-guide-plugins-descriptor, plugin descriptor file&gt;&gt;</code>.</p>","text":"","location":"apim/dev-guide/dev-guide-plugins/#jar","tags":["APIM","Developer guide","Plugins"]},{"title":"lib/ <p>This directory contains all the plugin's external dependencies (non provided-scope Maven dependencies).</p>","text":"","location":"apim/dev-guide/dev-guide-plugins/#lib","tags":["APIM","Developer guide","Plugins"]},{"title":"plugin.properties <p>The <code>plugin.properties</code> file is the descriptor of the plugin. It acts as the ID Card of the plugin and will be read by APIM Gateway during the plugin loading process.</p> <p>Hereafter parameters included into the descriptor:</p> <pre><code>|===\n| Parameter     | Description\n\n| id            | The plugin identifier\n| name          | The plugin name\n| version       | The plugin version\n| description   | The plugin description\n| class         | The main plugin class\n| type          | The type of plugin (_policy_, _reporter_)\n|===\n</code></pre>  <p>Note</p> <p>Naturally, the plugin identifier has to be unique to be correctly loaded by APIM Gateway.</p>","text":"","location":"apim/dev-guide/dev-guide-plugins/#pluginproperties","tags":["APIM","Developer guide","Plugins"]},{"title":"Deployment","text":"<p>Deploying a plugin is as easy as copying the plugin archive (zip) into the dedicated directory. By default, you need to deploy the archives in <code>${GRAVITEE_HOME/plugins}</code>. Refer to the configuration documentation for more information.</p>  <p>Warning</p> <p>You must restart APIM nodes when applying new or updated plugins!</p>","location":"apim/dev-guide/dev-guide-plugins/#deployment","tags":["APIM","Developer guide","Plugins"]},{"title":"Policies","text":"<p>Policies are steps in the Request/Response gateway proxy chain. A policy acts as a proxy controller by guaranteeing if a given business rule is fulfilled during Request/Response processing.</p> <p>Let's look at an example of how to develop a policy.</p>","location":"apim/dev-guide/dev-guide-policies/","tags":["APIM","Developer guide","Policies"]},{"title":"Getting started","text":"<p>Before you start, don't forget to activate OSS repositories in your Maven settings.</p>","location":"apim/dev-guide/dev-guide-policies/#getting-started","tags":["APIM","Developer guide","Policies"]},{"title":"Policy skeleton generation","text":"<p>Imagine you want to create a policy that controls if requests contains the <code>X-Foo</code> header. Let's name it the Foo header check policy. Then you can generate your policy like this:</p> <pre><code>$ mvn archetype:generate\\\n    -DarchetypeGroupId=io.gravitee.maven.archetypes\\\n    -DarchetypeArtifactId=gravitee-policy-maven-archetype\\\n    -DarchetypeVersion=1.8.0\\\n    -DartifactId=foo-header-check-policy\\\n    -DgroupId=my.gravitee.extension.policy\\\n    -Dversion=1.0.0-SNAPSHOT\\\n    -DpolicyName=FooHeaderCheck\n</code></pre>  <p>Note</p> <p>When generating a policy, choose a short but clear name for it, without specifying the policy suffix. The <code>gravitee-policy-maven-archetype</code> will add it automatically. For example, do not specify the <code>policyName</code> of your policy like this: <pre><code>-DpolicyName=AmazingStuffPolicy\n</code></pre> Instead, do it like this: <pre><code>-DpolicyName=AmazingStuff\n</code></pre></p>  <p>Once executed and parameters confirmed, the above command will create the <code>foo-header-check-policy</code> directory containing the following structure:</p> <pre><code>.\n\u251c\u2500\u2500 pom.xml\n\u251c\u2500\u2500 README.md\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 assembly\n    \u2502   \u2514\u2500\u2500 policy-assembly.xml\n    \u251c\u2500\u2500 main\n    \u2502   \u251c\u2500\u2500 java\n    \u2502   \u2502   \u2514\u2500\u2500 my\n    \u2502   \u2502       \u2514\u2500\u2500 gravitee\n    \u2502   \u2502           \u2514\u2500\u2500 extension\n    \u2502   \u2502               \u2514\u2500\u2500 policy\n    \u2502   \u2502                   \u251c\u2500\u2500 FooHeaderCheckPolicyConfiguration.java\n    \u2502   \u2502                   \u2514\u2500\u2500 FooHeaderCheckPolicy.java\n    \u2502   \u2514\u2500\u2500 resources\n    \u2502       \u2514\u2500\u2500 plugin.properties\n    \u2514\u2500\u2500 test\n        \u2514\u2500\u2500 java\n            \u2514\u2500\u2500 my\n                \u2514\u2500\u2500 gravitee\n                    \u2514\u2500\u2500 extension\n                        \u2514\u2500\u2500 policy\n                            \u2514\u2500\u2500 FooHeaderCheckPolicyTest.java\n</code></pre> <p>The different generated files are as follows:</p> <pre><code>|===\n|File |Description\n\n| &lt;&lt;bookmark-pom&gt;&gt; |The main Maven POM file\n| &lt;&lt;bookmark-readme&gt;&gt; |The main entry point for the policy documentation\n| &lt;&lt;bookmark-policy-assembly&gt;&gt; |The common Maven assembly descriptor for any policies\n| &lt;&lt;bookmark-configuration-class&gt;&gt; |The policy configuration class\n| &lt;&lt;bookmark-policy-class&gt;&gt; |The policy class, from which the business behavior is implemented\n| &lt;&lt;bookmark-descriptor&gt;&gt; |The policy descriptor file\n| &lt;&lt;bookmark-test&gt;&gt; |The policy unit test Java class\n|===\n</code></pre>","location":"apim/dev-guide/dev-guide-policies/#policy-skeleton-generation","tags":["APIM","Developer guide","Policies"]},{"title":"pom.xml","text":"<p>Each policy (and more generally all Gravitee projects) are Maven managed. A policy project is described by using the Maven Project Object Model file.</p>","location":"apim/dev-guide/dev-guide-policies/#pomxml","tags":["APIM","Developer guide","Policies"]},{"title":"README.md","text":"<p>Each policy should have a dedicated <code>README.md</code> file to document it. The <code>README.md</code> file should contain everything related to the use of your policy: What is its functionality? How can you use it? How can you configure it?</p>","location":"apim/dev-guide/dev-guide-policies/#readmemd","tags":["APIM","Developer guide","Policies"]},{"title":"policy-assembly.xml","text":"<p>A policy is just a kind of Gravitee plugin.</p> <p>It can be plugged into the &lt;&gt; by using the distribution file built from the <code>policy-assembly.xml</code> file. <p>Based on our FooHeaderCheck policy, the distribution file structure is as follows:</p> <pre><code>.\n\u251c\u2500\u2500 foo-header-check-policy-1.0.0-SNAPSHOT.jar\n\u251c\u2500\u2500 lib\n\u2514\u2500\u2500 schemas\n    \u2514\u2500\u2500 urn:jsonschema:my:gravitee:extension:policy:FooHeaderCheckPolicyConfiguration.json\n</code></pre> <p>The different generated files are as follows:</p> <pre><code>|===\n|File |Description\n\n|`foo-header-check-policy-1.0.0-SNAPSHOT.jar` |The main _policy_ jar file\n|`lib/` |Where the external dependencies are stored (from the Maven POM file dependencies - see https://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html)\n|`schemas/` |Where the JSON configuration schemas are stored\n|===\n</code></pre>","location":"apim/dev-guide/dev-guide-policies/#policy-assemblyxml","tags":["APIM","Developer guide","Policies"]},{"title":"JSON Configuration schemas","text":"<p>Policy configuration is described inside one or several Java Bean classes (see the example in the next section below).</p> <p>During the packaging phase, each policy configuration class is processed to generate one or several JSON schema(s) that will be read by the gateway when the policy is plugged in.</p> <p>JSON schema generation is performed by Gravitee's json-schema-generator-maven-plugin Maven plugin.</p>","location":"apim/dev-guide/dev-guide-policies/#json-configuration-schemas","tags":["APIM","Developer guide","Policies"]},{"title":"FooHeaderCheckPolicyConfiguration.java","text":"<p>The policy configuration class.</p> <p>Policy configuration is described in one or several Java Bean class(es) where each attribute is a configuration parameter.</p> <p>During packaging, policy configuration is compiled into link:#schemas[JSON Configuration schemas]. These schemas are used to parse API definitions.</p> <p>Policy configuration is injected into the policy class instance at runtime and can then be used during implementation.</p>","location":"apim/dev-guide/dev-guide-policies/#fooheadercheckpolicyconfigurationjava","tags":["APIM","Developer guide","Policies"]},{"title":"FooHeaderCheckPolicy.java","text":"<p>The main policy class. Contains business code that implements the policy.</p> <p>A policy can be applied on several parts of the proxy chain:</p> <ul> <li>The Request phase</li> <li>The Response phase</li> <li>Both of them</li> </ul>","location":"apim/dev-guide/dev-guide-policies/#fooheadercheckpolicyjava","tags":["APIM","Developer guide","Policies"]},{"title":"Apply policy during the Request phase","text":"<p>A policy can be applied to the proxy Request phase by just implementing a method dealing with the <code>io.gravitee.gateway.api.policy.annotations.OnRequest</code> annotation. For instance:</p> <pre><code>@OnRequest\npublic void onRequest(Request request, Response response, PolicyChain policyChain) {\n    // Add a dummy header\n    request.headers().set(\"X-DummyHeader\", configuration.getDummyHeaderValue());\n\n    // Finally continue chaining\n    policyChain.doNext(request, response);\n}\n</code></pre>  <p>Note</p> <p>The <code>PolicyChain</code> must always be called to end on Request processing. Ensure you make a call to the <code>PolicyChain#doNext()</code> or <code>PolicyChain#failWith()</code> to correctly end the on Request processing.</p>","location":"apim/dev-guide/dev-guide-policies/#apply-policy-during-the-request-phase","tags":["APIM","Developer guide","Policies"]},{"title":"Apply policy during the Response phase","text":"<p>A policy can be applied to the proxy Response phase by just implementing a method which works the <code>io.gravitee.gateway.api.policy.annotations.OnResponse</code> annotation. For instance:</p> <pre><code>@OnResponse\npublic void onResponse(Request request, Response response, PolicyChain policyChain) {\n    if (isASuccessfulResponse(response)) {\n        policyChain.doNext(request, response);\n    } else {\n        policyChain.failWith(new PolicyResult() {\n            @Override\n            public boolean isFailure() {\n                return true;\n            }\n\n            @Override\n            public int httpStatusCode() {\n                return HttpStatusCode.INTERNAL_SERVER_ERROR_500;\n            }\n\n            @Override\n            public String message() {\n                return \"Not a successful response :-(\";\n            }\n        });\n    }\n}\n\nprivate static boolean isASuccessfulResponse(Response response) {\n    switch (response.status() / 100) {\n        case 1:\n        case 2:\n        case 3:\n            return true;\n        default:\n            return false;\n    }\n}\n</code></pre>  <p>Note</p> <p>The <code>PolicyChain</code> must always be called to end on Response processing. Ensure you make a call to the <code>PolicyChain#doNext()</code> or <code>PolicyChain#failWith()</code> to correctly end the on Response processing.</p>","location":"apim/dev-guide/dev-guide-policies/#apply-policy-during-the-response-phase","tags":["APIM","Developer guide","Policies"]},{"title":"Apply policy during both the Request and Response phases","text":"<p>A policy is not restricted to only one gateway proxy phase. It can be applied during both the Request and Response phases by simply using both annotations in the same class.</p>","location":"apim/dev-guide/dev-guide-policies/#apply-policy-during-both-the-request-and-response-phases","tags":["APIM","Developer guide","Policies"]},{"title":"Provided parameters","text":"<p>The annotated methods can declare several parameters (but not necessary all of them) which will be automatically provided by the gateway at runtime.</p> <p>Available parameters are:</p> <pre><code>|===\n|Parameter class |Mandatory |Description\n\n|`io.gravitee.gateway.api.Request` |No |Wrapper to the Request object containing all information about the processed request (URI, parameters, headers, input stream, \u2026)\n|`io.gravitee.gateway.api.Response` |No |Wrapper to the Response object containing all information about the processed response (status, headers, output stream, \u2026)\n|`io.gravitee.gateway.api.policy.PolicyChain` |Yes |The current policy chain that gives control to the policy to continue (`doNext`) or reject (`failWith`) the current chain.\n|`io.gravitee.gateway.api.policy.PolicyContext` |No |The policy context that can be used to get contextualized objects (API store, \u2026).\n|===\n</code></pre>","location":"apim/dev-guide/dev-guide-policies/#provided-parameters","tags":["APIM","Developer guide","Policies"]},{"title":"plugin.properties","text":"<p>As mentioned previously, a policy is a kind of Gravitee plugin. Each plugin is described by the plugin.properties descriptor which declares the following parameters:</p> <pre><code>|===\n|Parameter |Description |Default value\n\n|`id` |The policy identifier |_policy_ artifact id\n|`name` |The policy name |N/A (mandatory parameter)\n|`version` |The policy version |N/A (mandatory parameter)\n|`description` |The policy description |\"Description of the _Policy name_ Gravitee Policy\"\n|`class` |The main policy class |Path to the generated class file\n|`type` |The type of Gravitee plugin |`policy`\n|===\n</code></pre>  <p>Note</p> <p>A policy is enabled when declared in the API definition. The policy identifier is used, as its name suggests, to identify the policy. You must ensure you choose the correct policy identifier* from the outset. It may be hard to rename it later if there are many API definitions linked to it.</p>","location":"apim/dev-guide/dev-guide-policies/#pluginproperties","tags":["APIM","Developer guide","Policies"]},{"title":"FooHeaderCheckPolicyTest.java","text":"<p>The JUnit unit test class for this policy.</p>","location":"apim/dev-guide/dev-guide-policies/#fooheadercheckpolicytestjava","tags":["APIM","Developer guide","Policies"]},{"title":"How to add custom metrics in dashboards","text":"","location":"apim/how-tos/how-to-add-custom-metrics-in-dashboards/","tags":["APIM","How to","Custom metrics","Dashboards","Enterprise Edition feature"]},{"title":"Overview","text":"<p>This document describes how you can easily configure the 'Assign metrics' policy to use custom metrics in your dashboards.</p>","location":"apim/how-tos/how-to-add-custom-metrics-in-dashboards/#overview","tags":["APIM","How to","Custom metrics","Dashboards","Enterprise Edition feature"]},{"title":"Assign metrics policy","text":"<ol> <li>In Design Studio, add the Assign metrics policy to a request or a     response.</li> <li>Add a new metric and give it a name. This name will be the field     name to use in dashboards. Example: MyCustomHeader</li> <li>Specify a value for your metric. It can be a static value, but you     can also use Expression Language syntax. Example: <code>{#request.headers['X-MyCustomHeader'] != null ? #request.headers['X-MyCustomHeader'][0] : null}</code></li> </ol> <p>Assign-metrics policy configuration:</p> <p></p>","location":"apim/how-tos/how-to-add-custom-metrics-in-dashboards/#assign-metrics-policy","tags":["APIM","How to","Custom metrics","Dashboards","Enterprise Edition feature"]},{"title":"Configure your dashboard","text":"<p>Only table, pie and line widgets can be configured with a custom field.</p> <ol> <li>Click Settings &gt; Analytics.</li> <li>Create or edit a dashboard.</li> <li>Add a widget and select the table, line or pie type.</li> <li>Toggle on the Use custom field? option.</li> <li>Add your metric name in the Field input. Example: MyCustomHeader</li> <li>Save your configuration.</li> </ol> <p>Configuration of widgets using a custom field:</p> <p></p>","location":"apim/how-tos/how-to-add-custom-metrics-in-dashboards/#configure-your-dashboard","tags":["APIM","How to","Custom metrics","Dashboards","Enterprise Edition feature"]},{"title":"Result","text":"<p>You now have a widget using your custom metric.  </p> <p>In the example, you can see the distribution of different requests depending on the HTTP Header X-MyCustomHeader.</p> <p>Custom widgets in action:</p> <p></p>","location":"apim/how-tos/how-to-add-custom-metrics-in-dashboards/#result","tags":["APIM","How to","Custom metrics","Dashboards","Enterprise Edition feature"]},{"title":"How to configure global API reviewers","text":"","location":"apim/how-tos/how-to-configure-global-API-reviewers/","tags":["APIM","How to","Reviewers"]},{"title":"Overview","text":"<p>This document describes how you can easily configure a group of global reviewers instead of manually adding reviewers as a member of each API.</p>","location":"apim/how-tos/how-to-configure-global-API-reviewers/#overview","tags":["APIM","How to","Reviewers"]},{"title":"API reviews","text":"<p>In the APIM Console, you can configure API reviewers. They can check various aspects of the API, such as:</p> <ul> <li>Documentation</li> <li>Versioning</li> <li>Endpoints</li> </ul> <p>API reviews can be requested by the API owner. When their review is complete, reviewers can accept or reject the API. If reviewers reject the API, its owner knows the API needs some changes.</p> <p>API reviewers must have access rights to an API to review it.</p>","location":"apim/how-tos/how-to-configure-global-API-reviewers/#api-reviews","tags":["APIM","How to","Reviewers"]},{"title":"Prerequisites","text":"<p>You first need to enable the Enable API review option in the APIM Console in Settings &gt; API Quality.</p> <p>You also need a <code>REVIEWER</code> role with at least the following permissions:</p> <ul> <li>Scope: API</li> <li>Permissions:</li> <li>ALERT: READ</li> <li>DEFINITION: READ</li> <li>DISCOVERY: READ</li> <li>DOCUMENTATION: READ</li> <li>GATEWAY_DEFINITION: READ</li> <li>METADATA: READ</li> <li>NOTIFICATION: READ, UPDATE</li> <li>PLAN: READ</li> <li>QUALITY_RULE: CREATE, READ, UPDATE</li> <li>REVIEWS: CREATE, READ, UPDATE, DELETE</li> </ul> <p>APIM comes with a default <code>REVIEWER</code> role that includes all these conditions.</p>","location":"apim/how-tos/how-to-configure-global-API-reviewers/#prerequisites","tags":["APIM","How to","Reviewers"]},{"title":"Configuration","text":"<ol> <li>In APIM Console, click Settings &gt; Groups and click the plus icon  to create a new group: </li> <li>Give it a name (for example, Global Reviewers).</li> <li>Select the Associate automatically to every new API option.</li> <li>Click CREATE.</li> <li>Give a name to the group: .</li> <li>Select a reviewer role in the Default API role dropdown list (e.g. <code>REVIEWER</code>).</li> <li>Click UPDATE.</li> <li>Choose default API role: </li> <li>Click ASSOCIATE TO EXISTING APIS: </li> <li>In the Dependents section, click the plus icon followed by the users icon to add users to the group, checking that their API role is correct.  </li> <li>Click UPDATE.</li> </ol>","location":"apim/how-tos/how-to-configure-global-API-reviewers/#configuration","tags":["APIM","How to","Reviewers"]},{"title":"Result","text":"<p>With this configuration:</p> <ul> <li>Your new group is attached to all existing APIs.</li> <li>Your new group will be attached to every new API.</li> <li>All the reviewers in this group (with a configured email address)     are notified by email when a review is requested on an API.</li> </ul> <p>You do not need to add new reviewers to every API or add every reviewer to new APIs.</p> <p>You can still add specific reviewers to a specific API. They will also be notified by email when a review is requested on this API.</p>","location":"apim/how-tos/how-to-configure-global-API-reviewers/#result","tags":["APIM","How to","Reviewers"]},{"title":"How to configure a HTTP reverse proxy","text":"<p>Here is a simple example of APIM components configuration with <code>docker-compose</code>.</p>","location":"apim/how-tos/how-to-configure-reverse-proxy/","tags":["APIM","How to","HTTP reverse proxy"]},{"title":"APIM configuration","text":"<p>For this example, we use a <code>docker-compose.yml</code> file to configure each APIM components, the needed to run modules</p> <pre><code>version: '3.5'\n\nnetworks:\n  frontend:\n    name: frontend\n  storage:\n    name: storage\n\nvolumes:\n  data-elasticsearch:\n  data-mongo:\n\nservices:\n\n  mongodb:\n    image: mongo:${MONGODB_VERSION:-3.6}\n    container_name: gio_apim_mongodb\n    restart: always\n    volumes:\n      - data-mongo:/data/db\n      - ./.logs/apim-mongodb:/var/log/mongodb\n    networks:\n      - storage\n\n  elasticsearch:\n    image: docker.elastic.co/elasticsearch/elasticsearch:${ELASTIC_VERSION:-7.7.0}\n    container_name: gio_apim_elasticsearch\n    restart: always\n    volumes:\n      - data-elasticsearch:/usr/share/elasticsearch/data\n    environment:\n      - http.host=0.0.0.0\n      - transport.host=0.0.0.0\n      - xpack.security.enabled=false\n      - xpack.monitoring.enabled=false\n      - cluster.name=elasticsearch\n      - bootstrap.memory_lock=true\n      - discovery.type=single-node\n      - \"ES_JAVA_OPTS=-Xms512m -Xmx512m\"\n    ulimits:\n      memlock:\n        soft: -1\n        hard: -1\n      nofile: 65536\n    networks:\n      - storage\n\n  gateway:\n    image: graviteeio/apim-gateway:${APIM_VERSION:-nightly}\n    container_name: gio_apim_gateway\n    restart: always\n    depends_on:\n      - mongodb\n      - elasticsearch\n    volumes:\n      - ./.logs/apim-gateway:/opt/graviteeio-gateway/logs\n    environment:\n      - gravitee_management_mongodb_uri=mongodb://mongodb:27017/gravitee?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000\n      - gravitee_ratelimit_mongodb_uri=mongodb://mongodb:27017/gravitee?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000\n      - gravitee_reporters_elasticsearch_endpoints_0=http://elasticsearch:9200\n    networks:\n      - storage\n      - frontend\n\n  management_api:\n    image: graviteeio/apim-management-api:${APIM_VERSION:-nightly}\n    container_name: gio_apim_management_api\n    restart: always\n    links:\n      - mongodb\n      - elasticsearch\n    depends_on:\n      - mongodb\n      - elasticsearch\n    volumes:\n      - ./.logs/apim-management-api:/opt/graviteeio-management-api/logs\n    environment:\n      - gravitee_management_mongodb_uri=mongodb://mongodb:27017/gravitee?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000\n      - gravitee_analytics_elasticsearch_endpoints_0=http://elasticsearch:9200\n      - console_ui_url=http://localhost/console\n      - console_api_url=http://localhost/management\n      - portal_ui_url=http://localhost/\n    networks:\n      - storage\n      - frontend\n\n  management_ui:\n    image: graviteeio/apim-management-ui:${APIM_VERSION:-nightly}\n    container_name: gio_apim_management_ui\n    restart: always\n    depends_on:\n      - management_api\n    environment:\n      - MGMT_API_URL=/management/organizations/DEFAULT/environments/DEFAULT/\n    volumes:\n      - ./.logs/apim-management-ui:/var/log/nginx\n    networks:\n      - frontend\n\n  portal_ui:\n    image: graviteeio/apim-portal-ui:${APIM_VERSION:-nightly}\n    container_name: gio_apim_portal_ui\n    restart: always\n    depends_on:\n      - management_api\n    environment:\n      - PORTAL_API_URL=/portal/environments/DEFAULT\n    volumes:\n      - ./.logs/apim-portal-ui:/var/log/nginx\n    networks:\n      - frontend\n</code></pre>","location":"apim/how-tos/how-to-configure-reverse-proxy/#apim-configuration","tags":["APIM","How to","HTTP reverse proxy"]},{"title":"Nginx","text":"","location":"apim/how-tos/how-to-configure-reverse-proxy/#nginx","tags":["APIM","How to","HTTP reverse proxy"]},{"title":"Nginx configuration","text":"<p>Add the location for each Gravitee component - define:</p> <ol> <li>Managment API under Console UI.</li> <li>Portal API under Portal UI.</li> </ol> <p>Make sure to add the <code>sub_filter</code> directives according to the locations.</p> <pre><code>http {\n        include /etc/nginx/mime.types;\n\n        resolver 127.0.0.1 ipv6=off;\n\n        upstream apim-gateway {\n            server gateway:8082;\n        }\n\n        upstream apim-management-api {\n            server management_api:8083;\n        }\n\n        upstream apim-management-ui {\n            server management_ui:8080;\n        }\n\n        upstream apim-portal-dev {\n            server portal_ui:8080;\n        }\n\n        proxy_set_header   Host $host;\n        proxy_set_header   X-Real-IP $remote_addr;\n        proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header   X-Forwarded-Host $server_name;\n        proxy_set_header   X-Forwarded-Proto $scheme;\n\n        server {\n            listen 80;\n\n            location /gateway/ {\n                proxy_pass http://apim-gateway/;\n            }\n\n            location /management {\n                proxy_pass http://apim-management-api/management/;\n            }\n\n            location /console/ {\n                proxy_pass http://apim-management-ui/;\n                sub_filter_once  on;\n                sub_filter  '&lt;base href=\"/' '&lt;base href=\"/console/';\n            }\n\n            location /portal/ {\n                proxy_pass http://apim-management-api/portal/;\n                sub_filter_once  on;\n                sub_filter  '&lt;base href=\"/' '&lt;base href=\"/portal/';\n            }\n\n            location / {\n                proxy_pass http://apim-portal-dev/;\n            }\n\n            error_page   500 502 503 504  /50x.html;\n            location = /50x.html {\n                root /usr/share/nginx/html;\n            }\n        }\n}\n</code></pre>","location":"apim/how-tos/how-to-configure-reverse-proxy/#nginx-configuration","tags":["APIM","How to","HTTP reverse proxy"]},{"title":"Nginx container","text":"<p>Add an Nginx container to <code>docker-compose.yml</code>:</p> <pre><code>  nginx:\n    image: nginx:latest\n    container_name: nginx\n    restart: unless-stopped\n    depends_on:\n      - management_ui\n      - portal_ui\n    ports:\n      - \"80:80\"\n    volumes:\n      - ./conf/nginx.conf:/etc/nginx/nginx.conf\n    networks:\n      - frontend\n</code></pre> <p>After restart, you can access your components through nginx at the following addresses:</p> <p>[cols=\"1,1\"] |=== |Component|URL</p> <p>|Gateway |http://localhost/gateway/</p> <p>|Management API |http://localhost/management/</p> <p>|Portal API |http://localhost/portal/</p> <p>|Console UI |http://localhost/console/</p> <p>|Portal UI |http://localhost/ |===</p>","location":"apim/how-tos/how-to-configure-reverse-proxy/#nginx-container","tags":["APIM","How to","HTTP reverse proxy"]},{"title":"How to configure a production-ready APIM environment","text":"","location":"apim/how-tos/how-to-general-configuration/","tags":["APIM","How to","HTTP reverse proxy"]},{"title":"Overview","text":"<p>During APIM installation, some default settings are created. While these default settings can be useful for testing your new installation, some of them may not be suitable for a production environment, where security is more of a consideration.</p> <p>This document gives some tips on important settings to check in APIM when preparing to move to a production environment. APIM includes many other configuration options and every environment is unique. It is recommended that you also read the APIM Configuration Guide to determine if you have completed all the configuration you need before you can deploy APIM in production.</p>","location":"apim/how-tos/how-to-general-configuration/#overview","tags":["APIM","How to","HTTP reverse proxy"]},{"title":"Configuring APIM","text":"<p>You can configure APIM settings in various ways\u2009\u2014 by using\u2009the <code>gravitee.yml</code> file, the APIM Console settings, and environment and system variables.</p> <p>When you configure new settings, it is important to understand that one configuration type can override another. The Configure APIM API page gives a good overview of this topic.</p>","location":"apim/how-tos/how-to-general-configuration/#configuring-apim","tags":["APIM","How to","HTTP reverse proxy"]},{"title":"Step 1: Disable the internal APIs","text":"<p>APIM API and APIM Gateway include internal APIs which are enabled by default. If you do not intend to use them, we recommend you disable them.</p> <p>Perform the following steps on both the APIM API component and the APIM Gateway component:</p> <ol> <li>Open your <code>gravitee.yml</code> file.</li> <li>In the <code>services:</code> section, set the <code>http:</code> <code>enabled</code> value to     <code>false</code>:     <code>services:           core:             http:               enabled: false               port: 18083               host: localhost               authentication:                 # authentication type to be used for the core services                 # - none : to disable authentication                 # - basic : to use basic authentication                 # default is \"basic\"                 type: basic                 users:                   admin: adminadmin</code></li> </ol> <p>To learn more about the internal APIs, see:</p> <ul> <li>Configure the APIM API internal API</li> <li>Configure the APIM Gateway internal API</li> </ul>","location":"apim/how-tos/how-to-general-configuration/#step-1-disable-the-internal-apis","tags":["APIM","How to","HTTP reverse proxy"]},{"title":"Step 2: Update the default users","text":"<p>Some default users are created for you during installation. It is recommended that you remove any users you do not need.</p>  <p>Warning</p> <p>It is also strongly recommended that, regardless of the user management system you put in place, you keep the default admin user, so that you can recover APIM in case of issues. Remember to change the default administrator password.</p>  <p>Perform the following steps on the APIM API component:</p> <ol> <li>Open your <code>gravitee.yml</code> file.</li> <li>In the <code>security \\ providers</code> section, remove any users you do not     need:     <pre><code>    security:\n      # When using an authentication providers, use trustAll mode for TLS connections\n      # trustAll: false\n      providers:  # authentication providers\n        - type: memory\n          # allow search results to display the user email. Be careful, It may be contrary to the user privacy.\n    #      allow-email-in-search-results: true\n          # password encoding/hashing algorithm. One of:\n          # - bcrypt : passwords are hashed with bcrypt (supports only $2a$ algorithm)\n          # - none : passwords are not hashed/encrypted\n          # default value is bcrypt\n          password-encoding-algo: bcrypt\n          users:\n            - user:\n              username: user\n              #firstname:\n              #lastname:\n              # Passwords are encoded using BCrypt\n              # Password value: password\n              password: $2a$10$9kjw/SH9gucCId3Lnt6EmuFreUAcXSZgpvAYuW2ISv7hSOhHRH1AO\n              roles: ORGANIZATION:USER,ENVIRONMENT:USER\n              # Useful to receive notifications\n              #email:\n            - user:\n              username: admin\n              #firstname:\n              #lastname:\n              # Password value: admin\n              password: $2a$10$Ihk05VSds5rUSgMdsMVi9OKMIx2yUvMz7y9VP3rJmQeizZLrhLMyq\n              roles: ORGANIZATION:ADMIN,ENVIRONMENT:ADMIN\n              #email:\n            - user:\n              username: api1\n              #firstname:\n              #lastname:\n              # Password value: api1\n              password: $2a$10$iXdXO4wAYdhx2LOwijsp7.PsoAZQ05zEdHxbriIYCbtyo.y32LTji\n              # You can declare multiple roles using comma separator\n              roles: ORGANIZATION:USER,ENVIRONMENT:API_PUBLISHER\n              #email:\n            - user:\n              username: application1\n              #firstname:\n              #lastname:\n              # Password value: application1\n              password: $2a$10$2gtKPYRB9zaVaPcn5RBx/.3T.7SeZoDGs9GKqbo9G64fKyXFR1He.\n              roles: ORGANIZATION:USER,ENVIRONMENT:USER\n</code></pre></li> <li>Update the default administrator password: </li> </ol> <p>To learn more about configuring users, see Configure authentication.</p>","location":"apim/how-tos/how-to-general-configuration/#step-2-update-the-default-users","tags":["APIM","How to","HTTP reverse proxy"]},{"title":"Step 3: Update the JWT secret","text":"<p>The JWT secret is used for signing session cookies in the APIM UI components. Any users with this secret can log in to APIM and update their permissions.</p> <p>Perform the following steps on the APIM API component:</p> <ol> <li>Open your <code>gravitee.yml</code> file.</li> <li>In the <code>jwt</code> section, update the <code>secret</code> value:     <pre><code>    jwt:\n      secret: myJWT4Gr4v1t33_S3cr3t\n      # Allows to define the end of validity of the token in seconds (default 604800 = a week)\n      #expire-after: 604800\n      # Allows to define the end of validity of the token in seconds for email registration (default 86400 = a day)\n      #email-registration-expire-after: 86400\n      # Allows to define issuer (default gravitee-management-auth)\n      #issuer: gravitee-management-auth\n      # Allows to define cookie context path (default /)\n      #cookie-path: /\n      # Allows to define cookie domain (default \"\")\n      #cookie-domain: .gravitee.io\n      # Allows to define if cookie secure only (default false)\n      #cookie-secure: true\n</code></pre></li> <li>You can also update other values, such as:</li> <li>The <code>expire-after</code> value, to change the validity period from the default value of one week.</li> <li>The <code>cookie-path</code> and <code>cookie-domain</code> values, to adapt them to your own environment; the values you define must be specific to the domain and path where the API is running and not apply to any another environment (for example, <code>.gravitee.io</code> could apply to any domain called <code>xxx.gravitee.io</code>, such as <code>dev.gravitee.io</code> or <code>qa.gravitee.io</code>)</li> </ol>","location":"apim/how-tos/how-to-general-configuration/#step-3-update-the-jwt-secret","tags":["APIM","How to","HTTP reverse proxy"]},{"title":"Step 4: Update the default APIM settings","text":"<p>The most common settings are described below. Not all of these settings need to be changed in every environment.</p> <p>Perform the following steps in APIM Console:</p> <ol> <li>Log in to APIM Console.</li> <li>Click Settings.</li> <li>In the PORTAL section:<ol> <li>Click Settings.</li> <li>Update the Company name.</li> <li>In the Management section of the page:</li> <li>Update the Title of APIM Console to make it more appropriate for your own environment.</li> <li>Update the Management URL to your APIM Console URL.   </li> </ol> </li> <li>In the GATEWAY section:<ol> <li>Click Sharding Tags.</li> <li>In the Default configuration section of the page, update th Entrypoint field with your APIM API endpoint. You can also update this value using an environment variable. </li> </ol> </li> <li>Click API Logging.</li> <li>Update the maximum logging duration for APIM API logging to avoid flooding. In this example, we have configured a logging duration of 15 minutes:   </li> </ol>  <p>Note</p> <p>The recommended value depends on the type of logging you have enabled: the more information you log, the lower the value needs to be (although the value must be above zero to be taken into account).</p>","location":"apim/how-tos/how-to-general-configuration/#step-4-update-the-default-apim-settings","tags":["APIM","How to","HTTP reverse proxy"]},{"title":"Overview","text":"<p>This section explains how to accomplish certain specific tasks using APIM.</p>","location":"apim/how-tos/how-to-introduction/","tags":["APIM","How to"]},{"title":"Installing APIM with Kubernetes","text":"<p>To make the most of this guide, you should be familiar with Kubernetes and its terms.</p>","location":"apim/installation-guide/installation-guide-kubernetes/","tags":["APIM","Installation","Kubernetes","GKO"]},{"title":"Gravitee.io API Management Helm Chart","text":"<p>Chart supported versions: 3.0.x and higher</p>","location":"apim/installation-guide/installation-guide-kubernetes/#graviteeio-api-management-helm-chart","tags":["APIM","Installation","Kubernetes","GKO"]},{"title":"Components","text":"<p>This chart will deploy the following:</p> <ul> <li>Gravitee Management API</li> <li>Gravitee Management UI</li> <li>Gravitee Portal UI</li> <li>Gravitee Gateway</li> <li>MongoDB replica-set (optional dependency)</li> <li>Elasticsearch cluster (optional dependency)</li> </ul>","location":"apim/installation-guide/installation-guide-kubernetes/#components","tags":["APIM","Installation","Kubernetes","GKO"]},{"title":"Installing","text":"<ul> <li>Add the Gravitee.io helm charts repo   <pre><code>$ helm repo add graviteeio https://helm.gravitee.io\n</code></pre></li> <li>Install it   <pre><code>$ helm install --name graviteeio-apim3x graviteeio/apim3\n</code></pre></li> </ul>","location":"apim/installation-guide/installation-guide-kubernetes/#installing","tags":["APIM","Installation","Kubernetes","GKO"]},{"title":"Create a chart archive","text":"<p>To package this chart directory into a chart archive, run:</p> <pre><code>$ helm package .\n</code></pre>","location":"apim/installation-guide/installation-guide-kubernetes/#create-a-chart-archive","tags":["APIM","Installation","Kubernetes","GKO"]},{"title":"Installing the Chart","text":"<p>To install the chart from the Helm repository with the release name <code>graviteeio-apim3x</code>:</p> <pre><code>$ helm install --name graviteeio-apim3x graviteeio/apim3\n</code></pre> <p>Note: If you're using Helm 3, the name parameter is no more valid. Please check https://helm.sh/docs/faq/#release-names-are-now-scoped-to-the-namespace</p> <p>To install the chart using the chart archive, run:</p> <pre><code>$ helm install apim3-3.0.0.tgz\n</code></pre>","location":"apim/installation-guide/installation-guide-kubernetes/#installing-the-chart","tags":["APIM","Installation","Kubernetes","GKO"]},{"title":"Configuration","text":"<p>The following tables list the configurable parameters of the Gravitee chart and their default values.</p> <p>You can rely on kubernetes ConfigMaps and Secrets to initialize Gravitee settings since APIM 3.15.0. To use this feature, you have to create the ServiceAccount that allows APIM to connect to the Kubernetes API (the helm chart should do it by default) and then you simply have to define your application settings like this:</p> <ul> <li>for a Secret : <code>kubernetes://&lt;namespace&gt;/secrets/&lt;my-secret-name&gt;/&lt;my-secret-key&gt;</code></li> <li>for a ConfigMap : <code>kubernetes://&lt;namespace&gt;/configmaps/&lt;my-configmap-name&gt;/&lt;my-configmap-key&gt;</code></li> </ul> <p>Here is an example for the mongodb uri initialized from the <code>mongo</code> secret deployed in the <code>default</code> namespace:</p> <pre><code>mongo:\n  uri: kubernetes://default/secrets/mongo/mongouri\n</code></pre> <p>If you need to access a secret, you have to create a role within your namespace.</p> <p>If you are deploying in another namespace and you need to access a secret there, you have to create a separate role in that namespace. The two roles can have the same name, but they are completely separate objects - each role only gives access to the namespace it is created in.</p> <p>For more information about roles, see Role and ClusterRole in the Kubernetes documentation.</p>","location":"apim/installation-guide/installation-guide-kubernetes/#configuration","tags":["APIM","Installation","Kubernetes","GKO"]},{"title":"Shared configuration","text":"<p>To configure common features such as:</p> <ul> <li>chaos testing (see   chaoskube   chart)</li> <li>configuration database (see   mongodb-replicaset   chart)</li> <li>logs database (see elastichsearch   chart)</li> </ul>    Parameter Description Default     <code>chaos.enabled</code> Enable Chaos test false   <code>inMemoryAuth.enabled</code> Enable oauth login true   <code>ldap.enabled</code> Enable LDAP login false","location":"apim/installation-guide/installation-guide-kubernetes/#shared-configuration","tags":["APIM","Installation","Kubernetes","GKO"]},{"title":"Mongo","text":"","location":"apim/installation-guide/installation-guide-kubernetes/#mongo","tags":["APIM","Installation","Kubernetes","GKO"]},{"title":"MongoDB connections","text":"<p>There are three ways to configure MongoDB connections.</p> <p>The most simple is to provide the MongoDB URI.</p>    Parameter Description Default     <code>mongo.uri</code> Mongo URI <code>null</code>    <p>If no <code>mongo.uri</code> is provided, you can provide a <code>mongo.servers</code> raw definition in combination with <code>mongo.dbname</code>, plus eventual authentication configuration:</p> <pre><code>mongo:\n  servers: |\n    - host: mongo1\n      port: 27017\n    - host: mongo2\n      port: 27017\n  dbname: gravitee\n  auth:\n    enabled: false\n    username:\n    password:\n</code></pre> <p>If neither <code>mongo.uri</code> or <code>mongo.servers</code> are provided, you have to define the following configuration options:</p>    Parameter Description Default     <code>mongo.rsEnabled</code> Whether Mongo replicaset is enabled or not <code>true</code>   <code>mongo.rs</code> Mongo replicaset name <code>rs0</code>   <code>mongo.dbhost</code> Mongo host address <code>mongo-mongodb-replicaset</code>   <code>mongo.dbport</code> Mongo host port <code>27017</code>   <code>mongo.dbname</code> Mongo DB name <code>gravitee</code>   <code>mongo.auth.enabled</code> Enable Mongo DB authentication <code>false</code>   <code>mongo.auth.username</code> Mongo DB username <code>null</code>   <code>mongo.auth.password</code> Mongo DB password <code>null</code>","location":"apim/installation-guide/installation-guide-kubernetes/#mongodb-connections","tags":["APIM","Installation","Kubernetes","GKO"]},{"title":"Other keys","text":"Parameter Description Default     <code>mongo.sslEnabled</code> Enable SSL connection to MongoDB <code>false</code>   <code>mongo.socketKeepAlive</code> Enable keep alive for socket <code>false</code>","location":"apim/installation-guide/installation-guide-kubernetes/#other-keys","tags":["APIM","Installation","Kubernetes","GKO"]},{"title":"Mongo ReplicaSet","text":"Parameter Description Default     <code>mongodb-replicaset.enabled</code> Enable deployment of Mongo replicaset <code>false</code>    <p>See MongoDB replicaset for detailed documentation on helm chart.</p> <p>** Please be aware that the mongodb-replicaset installed by Gravitee is NOT recommended in production and it is just for testing purpose and running APIM locally.  </p>","location":"apim/installation-guide/installation-guide-kubernetes/#mongo-replicaset","tags":["APIM","Installation","Kubernetes","GKO"]},{"title":"Elasticsearch","text":"Parameter Description Default     <code>es.security.enabled</code> Elasticsearch username and password enabled false   <code>es.security.username</code> Elasticsearch username <code>example</code>   <code>es.security.password</code> Elasticsearch password <code>example</code>   <code>es.tls.enabled</code> Elasticsearch TLS enabled false   <code>es.tls.keystore.type</code> Elasticsearch TLS keystore type (jks, pem or pfx) <code>null</code>   <code>es.tls.keystore.path</code> Elasticsearch TLS keystore path (jks, pfx) <code>null</code>   <code>es.tls.keystore.password</code> Elasticsearch TLS keystore password (jks, pfx) <code>null</code>   <code>es.tls.keystore.certs</code> Elasticsearch TLS certs (only pems) <code>null</code>   <code>es.tls.keystore.keys</code> Elasticsearch TLS keys (only pems) <code>null</code>   <code>es.index</code> Elasticsearch index <code>gravitee</code>   <code>es.endpoints</code> Elasticsearch endpoint array <code>[http://elastic-elasticsearch-client.default.svc.cluster.local:9200]</code>   <code>es.pipeline.plugins.ingest</code> Elasticsearch pipeline ingest plugins <code>geoip, user_agent</code>","location":"apim/installation-guide/installation-guide-kubernetes/#elasticsearch","tags":["APIM","Installation","Kubernetes","GKO"]},{"title":"Elasticsearch cluster","text":"Parameter Description Default     <code>elasticsearch.enabled</code> Enable deployment of Elasticsearch cluster <code>false</code>    <p>See Elasticsearch for detailed documentation on optional requirements helm chart.</p> <p>** Please be aware that the Elasticsearch installed by Gravitee is NOT recommended in production and it is just for testing purpose and running APIM locally.</p>","location":"apim/installation-guide/installation-guide-kubernetes/#elasticsearch-cluster","tags":["APIM","Installation","Kubernetes","GKO"]},{"title":"Gravitee UI","text":"Parameter Description Default     <code>ui.name</code> UI service name <code>ui</code>   <code>ui.baseURL</code> Base URL to access to the Management API (if set to <code>null</code>, defaults to Management API ingress value) <code>[apim.example.com]/management</code>   <code>ui.title</code> UI Portal title (if set to <code>null</code>, retrieved from the management repository) <code>API Portal</code>   <code>ui.managementTitle</code> UI Management title (if set to <code>null</code>, retrieved from the management repository) <code>API Management</code>   <code>ui.documentationLink</code> UI link to documentation (if set to <code>null</code>, retrieved from the management repository) <code>http://docs.gravitee.io/</code>   <code>ui.portal.apikeyHeader</code> API key header name (if set to <code>null</code>, retrieved from the management repository) <code>X-Gravitee-Api-Key</code>   <code>ui.portal.devMode.enabled</code> Whether to enable developer mode (if set to <code>null</code>, retrieved from the management repository) <code>false</code>   <code>ui.portal.userCreation.enabled</code> Whether to enable user creation (if set to <code>null</code>, retrieved from the management repository) <code>false</code>   <code>ui.portal.support.enabled</code> Whether to enable support features (if set to <code>null</code>, retrieved from the management repository) <code>true</code>   <code>ui.portal.rating.enabled</code> Whether to enable API rating (if set to <code>null</code>, retrieved from the management repository) <code>false</code>   <code>ui.portal.analytics.enabled</code> Whether to enable analytics features (if set to <code>null</code>, retrieved from the management repository) <code>false</code>   <code>ui.portal.analytics.trackingId</code> Tracking ID used for analytics (if set to <code>null</code>, retrieved from the management repository) <code>\"\"</code>   <code>ui.replicaCount</code> How many replicas of the UI pod <code>1</code>   <code>ui.image.repository</code> Gravitee UI image repository <code>graviteeio/management-ui</code>   <code>ui.image.tag</code> Gravitee UI image tag <code>1.29.5</code>   <code>ui.image.pullPolicy</code> K8s image pull policy <code>Always</code>   <code>ui.image.pullSecrets</code> K8s image pull secrets, used to pull both Gravitee UI image and <code>extraInitContainers</code> <code>null</code>   <code>ui.autoscaling.enabled</code> Whether auto-scaling is enabled or not <code>true</code>   <code>ui.autoscaling.minReplicas</code> If <code>ui.autoscaling.enabled</code> is <code>true</code>, what's the minimum number of replicas <code>2</code>   <code>ui.autoscaling.maxReplicas</code> If <code>ui.autoscaling.enabled</code> is <code>true</code>, what's the maximum number of replicas <code>3</code>   <code>ui.autoscaling.targetAverageUtilization</code> If <code>ui.autoscaling.enabled</code> what's the average target utilization (in %) before it auto-scale <code>50</code>   <code>ui.service.name</code> UI service name <code>nginx</code>   <code>ui.service.type</code> K8s publishing service type <code>ClusterIP</code>   <code>ui.service.externalPort</code> K8s UI service external port <code>8082</code>   <code>ui.service.internalPort</code> K8s UI service internal port (container) <code>80</code>   <code>ui.service.internalPortName</code> K8s UI service internal port name (container) <code>http</code>   <code>ui.ingress.enabled</code> Whether Ingress is enabled or not <code>true</code>   <code>ui.ingress.hosts</code> If <code>ui.ingress.enabled</code> is enabled, set possible ingress hosts <code>[apim.example.com]</code>   <code>ui.ingress.annotations</code> Supported Ingress annotations to configure ingress controller <code>[kubernetes.io/ingress.class: nginx, kubernetes.io/app-root: /management, kubernetes.io/rewrite-target: /management, ingress.kubernetes.io/configuration-snippet: \"etag on;\\nproxy_pass_header ETag;\\n\"]</code>   <code>ui.ingress.tls.hosts</code> Ingress TLS termination <code>[apim.example.com]</code>   <code>ui.ingress.tls.secretName</code> Ingress TLS K8s secret name containing the TLS private key and certificate <code>api-custom-cert</code>   <code>ui.resources.limits.cpu</code> K8s pod deployment limits definition for CPU <code>100m</code>   <code>ui.resources.limits.memory</code> K8s pod deployment limits definition for memory <code>128Mi</code>   <code>ui.resources.requests.cpu</code> K8s pod deployment requests definition for CPU <code>50m</code>   <code>ui.resources.requests.memory</code> K8s pod deployment requests definition for memory <code>64Mi</code>   <code>ui.lifecycle.postStart</code> K8s pod deployment postStart command definition <code>null</code>   <code>ui.lifecycle.preStop</code> K8s pod deployment preStop command definition <code>null</code>","location":"apim/installation-guide/installation-guide-kubernetes/#gravitee-ui","tags":["APIM","Installation","Kubernetes","GKO"]},{"title":"Gravitee API","text":"Parameter Description Default     <code>api.name</code> API service name <code>api</code>   <code>api.logging.debug</code> Whether to enable API debug logging or not <code>false</code>   <code>api.logging.graviteeLevel</code> Logging level for Gravitee classes <code>DEBUG</code>   <code>api.logging.jettyLevel</code> Logging level for Jetty classes <code>INFO</code>   <code>api.logging.stdout.encoderPattern</code> Logback standard output encoder pattern <code>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</code>   <code>api.logging.file.enabled</code> Whether to enable file logging or not <code>true</code>   <code>api.logging.file.rollingPolicy</code> Logback file rolling policy configuration <code>TimeBasedRollingPolicy</code> for 30 days   <code>api.logging.file.encoderPattern</code> Logback file encoder pattern <code>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</code>   <code>api.logging.additionalLoggers</code> List of additional logback loggers. Each logger is defined by a <code>name</code> and <code>level</code> (TRACE, DEBUG, INFO, WARN, or ERROR) <code>empty</code>   <code>api.ssl.enabled</code> API exposition through HTTPS protocol activation <code>false</code>   <code>api.ssl.keystore.type</code> Keystore type for API exposition through HTTPS protocol <code>jks</code>   <code>api.ssl.keystore.path</code> Keystore path for API exposition through HTTPS protocol <code>null</code>   <code>api.ssl.keystore.password</code> Keystore password for API exposition through HTTPS protocol <code>null</code>   <code>api.ssl.truststore.type</code> Truststore type for client authentication through 2 way TLS <code>jks</code>   <code>api.ssl.truststore.path</code> Truststore path for client authentication through 2 way TLS <code>null</code>   <code>api.ssl.truststore.password</code> Truststore password for client authentication through 2 way TLS <code>null</code>   <code>api.http.services.core.http.authentication.password</code> HTTP core service authentication password <code>adminadmin</code>   <code>api.http.services.core.http.port</code> HTTP core service port exposed in container <code>18083</code>   <code>api.http.services.core.http.host</code> HTTP core service bind IP or host inside container (0.0.0.0 for exposure on every interfaces) <code>localhost</code>   <code>api.http.services.core.http.authentication.password</code> HTTP core service authentication password <code>adminadmin</code>   <code>api.http.services.core.http.ingress.enabled</code> Ingress for HTTP core service authentication (requires <code>api.http.services.core.service.enabled</code> to be true) <code>false</code>   <code>api.http.services.core.http.ingress.path</code> The ingress path which should match for incoming requests to the management technical API. <code>/management/_(.*)</code>   <code>api.http.services.core.http.ingress.hosts</code> If <code>api.ingress.enabled</code> is enabled, set possible ingress hosts <code>[apim.example.com]</code>   <code>api.http.services.core.http.ingress.annotations</code> Supported Ingress annotations to configure ingress controller <code>[kubernetes.io/ingress.class: nginx, nginx.ingress.kubernetes.io/rewrite-target: /_$1]</code>   <code>api.http.services.core.http.ingress.tls.hosts</code> Ingress TLS termination <code>[apim.example.com]</code>   <code>api.http.services.core.http.ingress.tls.secretName</code> Ingress TLS K8s secret name containing the TLS private key and certificate <code>api-custom-cert</code>   <code>api.http.services.core.http.service.enabled</code> Whether a service is added or not for technical API <code>false</code>   <code>api.http.services.core.http.service.externalPort</code> K8s service external port (internal port is defined by <code>api.http.services.core.http.port</code> ) <code>18083</code>   <code>api.http.api.entrypoint</code> Listening path for the API <code>/management</code>   <code>api.http.client.timeout</code> HTTP client global timeout <code>10000</code>   <code>api.http.client.proxy.type</code> HTTP client proxy type <code>HTTP</code>   <code>api.http.client.proxy.http.host</code> HTTP client proxy host for HTTP protocol <code>localhost</code>   <code>api.http.client.proxy.http.port</code> HTTP client proxy port for HTTP protocol <code>3128</code>   <code>api.http.client.proxy.http.username</code> HTTP client proxy username for HTTP protocol <code>null</code>   <code>api.http.client.proxy.http.password</code> HTTP client proxy password for HTTP protocol <code>null</code>   <code>api.http.client.proxy.https.host</code> HTTP client proxy host for HTTPS protocol <code>localhost</code>   <code>api.http.client.proxy.https.port</code> HTTP client proxy port for HTTPS protocol <code>3128</code>   <code>api.http.client.proxy.https.username</code> HTTP client proxy username for HTTPS protocol <code>null</code>   <code>api.http.client.proxy.https.password</code> HTTP client proxy password for HTTPS protocol <code>null</code>   <code>api.user.login.defaultApplication</code> Whether to enable default application creation on first user authentication <code>true</code>   <code>api.user.anonymizeOnDelete</code> Whether to enable user anonymization on deletion <code>false</code>   <code>api.supportEnabled</code> Whether to enable support feature <code>true</code>   <code>api.ratingEnabled</code> Whether to enable API rating feature <code>true</code>   <code>api.newsletterEnabled</code> Whether to enable newsletter sign up feature <code>true</code>   <code>smtp.enabled</code> Email sending activation <code>true</code>   <code>smtp.host</code> SMTP server host <code>smtp.example.com</code>   <code>smtp.port</code> SMTP server port <code>25</code>   <code>smtp.from</code> Email sending address <code>info@example.com</code>   <code>smtp.username</code> SMTP server username <code>info@example.com</code>   <code>smtp.password</code> SMTP server password <code>example.com</code>   <code>smtp.subject</code> Email subjects template <code>[gravitee] %s</code>   <code>smtp.auth</code> SMTP server authentication activation <code>true</code>   <code>smtp.starttlsEnable</code> SMTP server TLS activation <code>false</code>   <code>smtp.localhost</code> Hostname that is resolvable by the SMTP server <code>null</code>   <code>api.portalURL</code> The portal URL used in emails <code>https://{{ index .Values.ui.ingress.hosts 0 }}</code>   <code>api.restartPolicy</code> Policy to restart K8 pod <code>OnFailure</code>   <code>api.updateStrategy.type</code> K8s deployment strategy type <code>RollingUpdate</code>   <code>api.updateStrategy.rollingUpdate.maxUnavailable</code> If api.updateStrategy.type is set to <code>RollingUpdate</code>, make sure to set a value here or your Deployment can have 100% unavailability by default. The Deployment controller will stop the bad rollout automatically, and will stop scaling up the new ReplicaSet. This depends on the rollingUpdate parameters (maxUnavailable specifically) that you have specified. Kubernetes by default sets the value to 1 and spec.replicas to 1 so if you haven\u2019t cared about setting those parameters, your Deployment can have 100% unavailability by default! <code>1</code>   <code>api.replicaCount</code> How many replicas for the API pod <code>1</code>   <code>api.image.repository</code> Gravitee API image repository <code>graviteeio/management-api</code>   <code>api.image.tag</code> Gravitee API image tag <code>1.29.5</code>   <code>api.image.pullPolicy</code> K8s image pull policy <code>Always</code>   <code>api.image.pullSecrets</code> K8s image pull secrets, used to pull both Gravitee Management API image and <code>extraInitContainers</code> <code>null</code>   <code>api.env</code> Environment variables, defined as a list of <code>name</code> and <code>value</code> as specified in Kubernetes documentation <code>null</code>   <code>api.service.type</code> K8s publishing service type <code>ClusterIP</code>   <code>api.service.externalPort</code> K8s service external port <code>83</code>   <code>api.service.internalPort</code> K8s service internal port (container) <code>8083</code>   <code>api.service.internalPortName</code> K8s service internal port name (container) <code>http</code>   <code>api.autoscaling.enabled</code> Whether auto-scaling is enabled or not <code>true</code>   <code>api.autoscaling.minReplicas</code> If <code>api.autoscaling.enabled</code> is <code>true</code>, what's the minimum number of replicas <code>2</code>   <code>api.autoscaling.maxReplicas</code> If <code>api.autoscaling.enabled</code> is <code>true</code>, what's the maximum number of replicas <code>3</code>   <code>api.autoscaling.targetAverageUtilization</code> If <code>api.autoscaling.enabled</code> what's the average target utilization (in %) before it auto-scale <code>50</code>   <code>api.ingress.enabled</code> Whether Ingress is enabled or not <code>true</code>   <code>api.ingress.path</code> The ingress path which should match for incoming requests to the management API. <code>/management</code>   <code>api.ingress.hosts</code> If <code>api.ingress.enabled</code> is enabled, set possible ingress hosts <code>[apim.example.com]</code>   <code>api.ingress.annotations</code> Supported Ingress annotations to configure ingress controller <code>[kubernetes.io/ingress.class: nginx, ingress.kubernetes.io/configuration-snippet: \"etag on;\\nproxy_pass_header ETag;\\nproxy_set_header if-match \\\"\\\";\\n\"]</code>   <code>api.ingress.tls.hosts</code> Ingress TLS termination <code>[apim.example.com]</code>   <code>api.ingress.tls.secretName</code> Ingress TLS K8s secret name containing the TLS private key and certificate <code>api-custom-cert</code>   <code>api.resources.limits.cpu</code> K8s pod deployment limits definition for CPU <code>500m</code>   <code>api.resources.limits.memory</code> K8s pod deployment limits definition for memory <code>1024Mi</code>   <code>api.resources.requests.cpu</code> K8s pod deployment requests definition for CPU <code>200m</code>   <code>api.resources.requests.memory</code> K8s pod deployment requests definition for memory <code>512Mi</code>   <code>api.lifecycle.postStart</code> K8s pod deployment postStart command definition <code>null</code>   <code>api.lifecycle.preStop</code> K8s pod deployment preStop command definition <code>null</code>","location":"apim/installation-guide/installation-guide-kubernetes/#gravitee-api","tags":["APIM","Installation","Kubernetes","GKO"]},{"title":"Gravitee Gateway","text":"Parameter Description Default     <code>gateway.name</code> Gateway service name <code>gateway</code>   <code>gateway.logging.debug</code> Whether to enable Gateway debug logging or not <code>false</code>   <code>gateway.ssl.enabled</code> API exposition through HTTPS protocol activation <code>false</code>   <code>gateway.ssl.keystore.type</code> Keystore type for API exposition through HTTPS protocol <code>jks</code>   <code>gateway.ssl.keystore.path</code> Keystore path for API exposition through HTTPS protocol <code>null</code>   <code>gateway.ssl.keystore.password</code> Keystore password for API exposition through HTTPS protocol <code>null</code>   <code>gateway.ssl.clientAuth</code> Client authentication through 2 way TLS activation <code>false</code>   <code>gateway.ssl.truststore.type</code> Truststore type for client authentication through 2 way TLS <code>jks</code>   <code>gateway.ssl.truststore.path</code> Truststore path for client authentication through 2 way TLS <code>null</code>   <code>gateway.ssl.truststore.password</code> Truststore password for client authentication through 2 way TLS <code>null</code>   <code>gateway.logging.graviteeLevel</code> Logging level for Gravitee classes <code>DEBUG</code>   <code>gateway.logging.jettyLevel</code> Logging level for Jetty classes <code>INFO</code>   <code>gateway.logging.stdout.encoderPattern</code> Logback standard output encoder pattern <code>%d{HH:mm:ss.SSS} [%thread] [%X{api}] %-5level %logger{36} - %msg%n</code>   <code>gateway.logging.file.enabled</code> Whether to enable file logging or not <code>true</code>   <code>gateway.logging.file.rollingPolicy</code> Logback file rolling policy configuration <code>TimeBasedRollingPolicy</code> for 30 days   <code>gateway.logging.file.encoderPattern</code> Logback file encoder pattern <code>%d{HH:mm:ss.SSS} [%thread] [%X{api}] %-5level %logger{36} - %msg%n</code>   <code>gateway.logging.additionalLoggers</code> List of additional logback loggers. Each logger is defined by a <code>name</code> and <code>level</code> (TRACE, DEBUG, INFO, WARN, or ERROR) <code>empty</code>   <code>gateway.type</code> Gateway deployment type: <code>deployment</code> or <code>statefulSet</code> <code>deployment</code>   <code>gateway.replicaCount</code> How many replicas of the Gateway pod <code>2</code>   <code>gateway.image.repository</code> Gravitee Gateway image repository <code>graviteeio/gateway</code>   <code>gateway.image.tag</code> Gravitee Gateway image tag <code>1.29.5</code>   <code>gateway.image.pullPolicy</code> K8s image pull policy <code>Always</code>   <code>gateway.image.pullSecrets</code> K8s image pull secrets, used to pull both Gravitee Gateway image and <code>extraInitContainers</code> <code>null</code>   <code>gateway.env</code> Environment variables, defined as a list of <code>name</code> and <code>value</code> as specified in Kubernetes documentation <code>null</code>   <code>gateway.service.type</code> K8s publishing service type <code>ClusterIP</code>   <code>gateway.service.externalPort</code> K8s Gateway service external port <code>82</code>   <code>gateway.service.internalPort</code> K8s Gateway service internal port (container) <code>8082</code>   <code>gateway.service.internalPortName</code> K8s Gateway service internal port name (container) <code>http</code>   <code>gateway.autoscaling.enabled</code> Whether auto-scaling is enabled or not <code>true</code>   <code>gateway.autoscaling.minReplicas</code> If <code>gateway.autoscaling.enabled</code> is <code>true</code>, what's the minimum number of replicas <code>2</code>   <code>gateway.autoscaling.maxReplicas</code> If <code>gateway.autoscaling.enabled</code> is <code>true</code>, what's the maximum number of replicas <code>3</code>   <code>gateway.autoscaling.targetAverageUtilization</code> If <code>gateway.autoscaling.enabled</code> what's the average target utilization (in %) before it auto-scale <code>50</code>   <code>gateway.websocket</code> Whether websocket protocol is enabled or not <code>false</code>   <code>gateway.apiKey.header</code> Header used for the API Key. Set an empty value to prohibit its use. <code>X-Gravitee-Api-Key</code>   <code>gateway.apiKey.param</code> Query parameter used for the API Key. Set an empty value to prohibit its use. <code>api-key</code>   <code>gateway.sharding_tags</code> Sharding tags (comma separated list) ``   <code>gateway.ingress.enabled</code> Whether Ingress is enabled or not <code>true</code>   <code>gateway.ingress.path</code> The ingress path which should match for incoming requests to the gateway. <code>/gateway</code>   <code>gateway.ingress.hosts</code> If <code>gateway.ingress.enabled</code> is enabled, set possible ingress hosts <code>[apim.example.com]</code>   <code>gateway.ingress.annotations</code> Supported Ingress annotations to configure ingress controller <code>[kubernetes.io/ingress.class: nginx, nginx.ingress.kubernetes.io/ssl-redirect: \"false\", nginx.ingress.kubernetes.io/enable-rewrite-log: \"true\", kubernetes.io/app-root: /gateway, kubernetes.io/rewrite-target: /gateway]</code>   <code>gateway.ingress.tls.hosts</code> Ingress TLS termination <code>[apim.example.com]</code>   <code>gateway.ingress.tls.secretName</code> Ingress TLS K8s secret name containing the TLS private key and certificate <code>api-custom-cert</code>   <code>gateway.resources.limits.cpu</code> K8s pod deployment limits definition for CPU <code>500m</code>   <code>gateway.resources.limits.memory</code> K8s pod deployment limits definition for memory <code>512Mi</code>   <code>gateway.resources.requests.cpu</code> K8s pod deployment requests definition for CPU <code>200m</code>   <code>gateway.resources.requests.memory</code> K8s pod deployment requests definition for memory <code>256Mi</code>   <code>gateway.lifecycle.postStart</code> K8s pod deployment postStart command definition <code>null</code>   <code>gateway.lifecycle.preStop</code> K8s pod deployment preStop command definition <code>null</code>    <p>Specify each parameter using the <code>--set key=value[,key=value]</code> argument to <code>helm install</code>.</p> <p>Alternatively, a YAML file that specifies the values for the parameters can be provided while installing the chart. For example,</p> <pre><code>$ helm install --name my-release -f values.yaml gravitee\n</code></pre>  <p>Tip</p> <p>You can use the default values.yaml</p>","location":"apim/installation-guide/installation-guide-kubernetes/#gravitee-gateway","tags":["APIM","Installation","Kubernetes","GKO"]},{"title":"OpenShift","text":"<p>The Gravitee.io API Management Helm Chart supports OpenShift &gt; 3.10.</p> <p>This chart is only supporting Ingress standard objects and not the specific OpenShift Routes, reason why OpenShift is supported started from 3.10.</p> <p>There are two major considerations to have in mind when deploying Gravitee.io API Management within OpenShift:</p> <ol> <li>Use full host domain instead of paths for all the components (ingress paths are not well supported by OpenShift).</li> <li>Override the security context to let OpenShift to define automatically the user-id and the group-id to run the containers.</li> </ol> <p>Also, for Openshift to automatically create Routes from Ingress, you must define the ingressClassName to \"none\".</p> <p>Here is a standard <code>values.yaml</code> used to deploy Gravitee.io APIM into OpenShift:</p> <pre><code>api:\n  ingress:\n    management:\n      ingressClassName: none\n      path: /management\n      hosts:\n        - api-graviteeio.apps.openshift-test.l8e4.p1.openshiftapps.com\n      annotations:\n        route.openshift.io/termination: edge\n    portal:\n      ingressClassName: none\n      path: /portal\n      hosts:\n        - api-graviteeio.apps.openshift-test.l8e4.p1.openshiftapps.com\n      annotations:\n        route.openshift.io/termination: edge\n  securityContext: null\n  deployment:\n    securityContext:\n      runAsUser: null\n      runAsGroup: null\n      runAsNonRoot: true\n      allowPrivilegeEscalation: false\n      capabilities:\n        drop: [\"ALL\"]\n      seccompProfile:\n        type: RuntimeDefault\n\ngateway:\n  ingress:\n    ingressClassName: none\n    path: /\n    hosts:\n      - gw-graviteeio.apps.openshift-test.l8e4.p1.openshiftapps.com\n    annotations:\n      route.openshift.io/termination: edge\n  securityContext: null\n  deployment:\n    securityContext:\n      runAsUser: null\n      runAsGroup: null\n      runAsNonRoot: true\n      allowPrivilegeEscalation: false\n      capabilities:\n        drop: [\"ALL\"]\n      seccompProfile:\n        type: RuntimeDefault\n\nportal:\n  ingress:\n    ingressClassName: none\n    path: /\n    hosts:\n      - portal-graviteeio.apps.openshift-test.l8e4.p1.openshiftapps.com\n    annotations:\n      route.openshift.io/termination: edge\n  securityContext: null\n  deployment:\n    securityContext:\n      runAsUser: null\n      runAsGroup: null\n      runAsNonRoot: true\n      allowPrivilegeEscalation: false\n      capabilities:\n        drop: [\"ALL\"]\n      seccompProfile:\n        type: RuntimeDefault\n\nui:\n  ingress:\n    ingressClassName: none\n    path: /\n    hosts:\n      - console-graviteeio.apps.openshift-test.l8e4.p1.openshiftapps.com\n    annotations:\n      route.openshift.io/termination: edge\n  securityContext: null\n  deployment:\n    securityContext:\n      runAsUser: null\n      runAsGroup: null\n      runAsNonRoot: true\n      allowPrivilegeEscalation: false\n      capabilities:\n        drop: [\"ALL\"]\n      seccompProfile:\n        type: RuntimeDefault\n</code></pre> <p>By setting the value to <code>null</code> for <code>runAsUser</code> and <code>runAsGroup</code> it forces OpenShift to define the correct values for you while deploying the Helm Chart.</p>","location":"apim/installation-guide/installation-guide-kubernetes/#openshift","tags":["APIM","Installation","Kubernetes","GKO"]},{"title":"Run unit tests","text":"<p>Install <code>unittest</code> helm plugin</p> <pre><code>helm plugin install https://github.com/quintush/helm-unittest\n</code></pre> <p>Inside <code>apim/3.x</code> directory, run:</p> <pre><code>helm unittest -3 -f 'tests/**/*.yaml' .\n</code></pre>","location":"apim/installation-guide/installation-guide-kubernetes/#run-unit-tests","tags":["APIM","Installation","Kubernetes","GKO"]},{"title":"Installing APIM with Gravitee Kubernetes Operator (GKO)","text":"<p>As of APIM version 3.19.0, you can also use deploy APIM using the Gravitee Kubernetes Operator (GKO).</p>","location":"apim/installation-guide/installation-guide-kubernetes/#installing-apim-with-gravitee-kubernetes-operator-gko","tags":["APIM","Installation","Kubernetes","GKO"]},{"title":"Upgrade APIM","text":"<p>Note</p> <p>WORK IN PROGRESS (content incorporation and cleanup for individual versions)</p>","location":"apim/installation-guide/installation-guide-migration/","tags":["APIM","Upgrade","Migration"]},{"title":"Upgrade Notes","text":"<p>If you plan to skip versions when you upgrade, ensure that you read the version-specific upgrade notes for each intermediate version. You may be required to perform manual actions as part of the upgrade.</p>  <p>Warning</p> <p>Be sure to run scripts on the correct database since <code>gravitee</code> is not always the default database! Check your db name by running <code>show dbs;</code>.</p>","location":"apim/installation-guide/installation-guide-migration/#upgrade-notes","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes","tags":["APIM","Upgrade","Migration"]},{"title":"API key and JWT plans","text":"<p>The security chain (the internal process that selects the executable plan for the incoming request and applies the related security rules) parses all active plans to select and execute the relevant one.</p> <p>Prior to this version:</p> <ul> <li> <p>The API key plan was executed if the request contained an API key.</p> </li> <li> <p>The JWT plan was executed if the request contained a Bearer token.</p> </li> </ul> <p>From this version:</p> <p>The security chain has been improved to select and execute plans more efficiently. As a result, API keys and JWT plans are now only executed if there is an active subscription related to the provided security token. If there is no relevant subscription, the currently parsed plans are not executed and the security chain moves to parse the next available plans. The process continues until the security chain parses plans related to the provided security token and these plans are executed, or until all available plans are parsed without a match.</p> <p>Specific examples of this change are provided in the table below:</p>          <p>API plans</p> <p>Request</p> <p>Prior to this version</p> <p>From this version</p>   <p>API key plan + Keyless plan</p> <p>Request contains an invalid API key</p> <p>API key plan is executed = HTTP 401 unauthorized</p> <p>Keyless plan is executed</p>   <p>JWT plan 1 + JWT plan 2</p> <p>Request contains a Bearer token valid for JWT plan 2</p> <p>JWT plan 1 is executed = HTTP 401 unauthorized</p> <p>JWT plan 2 is executed</p>","location":"apim/installation-guide/installation-guide-migration/#api-key-and-jwt-plans","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_1","tags":["APIM","Upgrade","Migration"]},{"title":"Portal API","text":"<p>Endpoint: <code>[GET] portal/environments/{envId}/applications</code>.</p> <p>For performance reasons, calling <code>/applications?size=-1</code> will no longer return the number of subscribers and the only information available in the owner of each application will be:</p> <ul> <li> <p>id</p> </li> <li> <p>displayName</p> </li> <li> <p>email</p> </li> </ul>","location":"apim/installation-guide/installation-guide-migration/#portal-api","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_2","tags":["APIM","Upgrade","Migration"]},{"title":"Environment Audits","text":"<p>Endpoint: <code>[GET] management/organizations/{orgId}/environments/{envId}/apis/{api}/audit</code> (link:{{ /apim/3.x/management-api/ | relative_url | append: current_version | append: /index.html#operation/getApiAudits }}[API audits^]).</p> <p>Before this version, the Management API allowed getting all audits of all environments and organizations with this endpoint.</p> <p>As of 3.18.0, a GET request will return the audits of the environment specified in the url and no longer return organization audits. To get organization audits you need to use the following endpoint: <code>[GET] management/organizations/{orgId}/audit</code>.</p> <p>The query params <code>envLog:boolean</code> &amp; <code>orgLog:boolean</code> are removed. Now to get only environment or organization audit you have to use the query params <code>referenceType:string</code> with <code>ENVIRONMENT</code> or <code>ORGANIZATION</code>. You can also filter by environment id with <code>environment:string</code> query params.</p>","location":"apim/installation-guide/installation-guide-migration/#environment-audits","tags":["APIM","Upgrade","Migration"]},{"title":"Platform alerts on multi-environments APIM","text":"<p>Before this version, platform alerts were common to all environments. That led to inconsistencies while handling platform alerts on multi-environments APIM.</p> <p>From this version, platform alerts are scoped to the environment. For example, if you create an alert on your <code>production</code> environment, it is related only to this environment.</p> <p>Old platform alerts existing before Gravitee upgrade will be linked to the default environment. You will see them disappear from your others (non-default) environments, and will have to recreate them manually if relevant.</p>","location":"apim/installation-guide/installation-guide-migration/#platform-alerts-on-multi-environments-apim","tags":["APIM","Upgrade","Migration"]},{"title":"System Roles Edition","text":"<p>To provide more flexibility in the way roles are managed, some system roles have been made editable. From now on, the permissions of the following roles can be edited:</p> <ol> <li> <p>The Environment Admin Role.</p> </li> <li> <p>The API Primary Owner Role</p> </li> <li> <p>The Application Primary Owner Role</p> </li> </ol> <p>The Organization Admin Role remains a read-only role. If any accidental loss of access happened to one of the roles listed above, the Organization Admin Role will be the only one able to revert the changes.</p> <p>This mode is deactivated by default, you can toggle it on via <code>gravitee.yml</code> :</p> <pre><code>console:\n  systemRoleEdition:\n    enabled: true\n</code></pre> <p>Updating permissions for system roles should be done carefully to avoid any unexpected behavior.</p>","location":"apim/installation-guide/installation-guide-migration/#system-roles-edition","tags":["APIM","Upgrade","Migration"]},{"title":"Plugin renaming","text":"<p>From this version, and for the next 3.18.x versions and greater, the name of the Elasticsearch repository component changes. As a consequence, the Elasticsearch repository component available on https://download.gravitee.io is now <code>gravitee-*apim*-repository-elasticsearch-x.y.z.zip</code></p> <p>instead of <code>gravitee-repository-elasticsearch-x.y.z.zip</code></p> <p>This plugin has also been moved in another folder: https://download.gravitee.io/#graviteeio-apim/plugins/repositories/gravitee-apim-repository-elasticsearch/.</p> <p>You can download directly the Elasticsearch repository using this link: https://download.gravitee.io/graviteeio-apim/plugins/repositories/gravitee-apim-repository-elasticsearch/gravitee-apim-repository-elasticsearch-3.18.0.zip</p>","location":"apim/installation-guide/installation-guide-migration/#plugin-renaming","tags":["APIM","Upgrade","Migration"]},{"title":"MySQL","text":"<p>In 3.18.0, the MySQL Java driver has been updated to 8.0.29. As a consequence, TLS 1.0 and 1.1 are no longer supported.</p>","location":"apim/installation-guide/installation-guide-migration/#mysql","tags":["APIM","Upgrade","Migration"]},{"title":"Plans data","text":"<p>Since this version, APIM improves plans data storage, and uses the <code>plans</code> database collection as the unique source of plans data.</p> <p>Before trusting data in <code>plans</code> collection, we have to ensure their reliability.</p> <p>In 3.10, an upgrader was introduced to fix data, but was running in dry-run mode per default.</p> <p>This upgrader will run once again during APIM 3.18 startup, with dry-run mode disabled : if relevant, it will fix plans data in your database as it\u2019s explained in this documentation</p>","location":"apim/installation-guide/installation-guide-migration/#plans-data","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"<p>From this version, and for the next 3.17.x versions, the name of the Elasticsearch repository component changes. As a consequence, the Elasticsearch repository component available on https://download.gravitee.io is now  </p> <p><code>gravitee-*apim*-repository-elasticsearch-x.y.z.zip</code> </p> <p>instead of  </p> <p><code>gravitee-repository-elasticsearch-x.y.z.zip</code></p> <p>This plugin has also been moved in another folder: https://download.gravitee.io/#graviteeio-apim/plugins/repositories/gravitee-apim-repository-elasticsearch/.  </p> <p>You can download directly the Elasticsearch repository using this link: https://download.gravitee.io/graviteeio-apim/plugins/repositories/gravitee-apim-repository-elasticsearch/gravitee-apim-repository-elasticsearch-3.17.3.zip</p>","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_3","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking Changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_4","tags":["APIM","Upgrade","Migration"]},{"title":"Management API Documentation","text":"<p>From this version, APIM\u2019s Management API documentation is now using OpenAPI v3 format, instead of the old Swagger v2 format.</p> <p>As a consequence, the specification of this API is now accessible from:</p> <ul> <li> <p><code>{host:port}/management/openapi.yaml</code></p> </li> <li> <p><code>{host:port}/management/openapi.json</code></p> </li> </ul> <p>To allow a smooth transition, the old URL (<code>{host:port}/management/swagger.json</code>) will remain available until 3.18.0.</p>","location":"apim/installation-guide/installation-guide-migration/#management-api-documentation","tags":["APIM","Upgrade","Migration"]},{"title":"Docker Images - Enterprise Edition","text":"<p>To reduce the number of security vulnerabilities and ensure a better maintenance in the future, the base Docker images used for the Enterprise Edition have changed.</p> <p>As of 3.17.0, APIM Gateway EE and Management API EE base Docker images are moving from Ubuntu to Alpine with JDK 17. It means users creating their own Docker images based on the one provided by Gravitee.io might need to update their Dockerfile to make them compatible with the Alpine distribution.</p> <p>Notes: Community Edition users will not be affected as the base images were already Alpine ones.</p>","location":"apim/installation-guide/installation-guide-migration/#docker-images-enterprise-edition","tags":["APIM","Upgrade","Migration"]},{"title":"Upgrade Order","text":"<p>In order to achieve a 0 downtime upgrade, APIM has to be upgraded before upgrading the gateways.</p> <p>On hybrid architectures where gateway bridge feature is enabled, gateways have to be upgraded in this order :</p> <ol> <li> <p>The bridge server gateway</p> </li> <li> <p>The bridge client gateway</p> </li> </ol>","location":"apim/installation-guide/installation-guide-migration/#upgrade-order","tags":["APIM","Upgrade","Migration"]},{"title":"Deprecated Bridge Endpoints","text":"<p>Since bridge client rely on their own internals to fulfil API key requests, the ``/apis/{api.id}/keys/{api.key}`` endpoint has been deprecated on the bridge server and will be removed in a future version.</p> <p>The ``/keys/_search`` endpoint has been deprecated and replaced with ``/keys/_findByCriteria`` endpoint. It will be removed in a future version.</p> <p>More information on the gateway bridge feature can be found here.</p>","location":"apim/installation-guide/installation-guide-migration/#deprecated-bridge-endpoints","tags":["APIM","Upgrade","Migration"]},{"title":"The mongodb upgrade scripts have been moved","text":"<p>For the sake of improving our documentation management process, we have started decommissioning our release repository (which contained among other things this guide).</p> <p>As a part of this change, our mongodb upgrade scripts are not hosted inside the release repository anymore and have been moved to the gravitee-api-management repository.</p>","location":"apim/installation-guide/installation-guide-migration/#the-mongodb-upgrade-scripts-have-been-moved","tags":["APIM","Upgrade","Migration"]},{"title":"MongoDB","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.17.0/api-keys-cleanup.js This script performs some cleanup on the keys collection in order to avoid issues while moving to the new model.</p>","location":"apim/installation-guide/installation-guide-migration/#mongodb","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"<p>From this version, and for the next 3.17.x versions, the name of the Elasticsearch repository component changes. As a consequence, the Elasticsearch repository component available on https://download.gravitee.io is now <code>gravitee-*apim*-repository-elasticsearch-x.y.z.zip</code></p> <p>instead of <code>gravitee-repository-elasticsearch-x.y.z.zip</code></p> <p>This plugin has also been moved in another folder: https://download.gravitee.io/#graviteeio-apim/plugins/repositories/gravitee-apim-repository-elasticsearch/.</p> <p>You can download directly the Elasticsearch repository using this link: https://download.gravitee.io/graviteeio-apim/plugins/repositories/gravitee-apim-repository-elasticsearch/gravitee-apim-repository-elasticsearch-3.16.5.zip</p>","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_5","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking Change","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-change","tags":["APIM","Upgrade","Migration"]},{"title":"Docker Images - Enterprise Edition","text":"<p>To reduce the number of security vulnerabilities and ensure a better maintenance in the future, the base Docker images used for the Enterprise Edition have changed.</p> <p>As of 3.16.2, APIM Gateway EE and Management API EE base Docker images are moving from Ubuntu to Alpine with JDK 17. It means users creating their own Docker images based on the one provided by Gravitee.io might need to update their Dockerfile to make them compatible with the Alpine distribution.</p> <p>Notes: Community Edition users will not be affected as the base images were already Alpine ones.</p>","location":"apim/installation-guide/installation-guide-migration/#docker-images-enterprise-edition_1","tags":["APIM","Upgrade","Migration"]},{"title":"API definition import process changes","text":"<p>Gravitee 3.16.0 introduces a new crossId in API definition, which identifies entities across environments. This improves the API import and promotion processes reliability.</p> <p>If you are using the API import from JSON definition feature, we highly recommend updating your API definitions by re-exporting your API.</p> <p>Otherwise, if you import an API definition which doesn\u2019t contain crossId, Gravitee will do the best-effort to import your API definition without it.</p>","location":"apim/installation-guide/installation-guide-migration/#api-definition-import-process-changes","tags":["APIM","Upgrade","Migration"]},{"title":"Deprecations","text":"<p>The Rest API endpoints listed below are deprecated since Gravitee v3.0.9, and will be removed in a future version.</p>        <p>Deprecated Endpoint</p> <p>Replace With</p>   <p>POST /apis/{api.id}/import</p> <p>POST /apis/import</p>   <p>POST /apis/{api.id}/import/swagger</p> <p>PUT /apis/{api.id}/import/swagger</p>","location":"apim/installation-guide/installation-guide-migration/#deprecations","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_6","tags":["APIM","Upgrade","Migration"]},{"title":"API key and JWT plans","text":"<p>The security chain (the internal process that selects the executable plan for the incoming request and applies the related security rules) parses all active plans to select and execute the relevant one.</p> <p>Prior to this version:</p> <ul> <li> <p>The API key plan was executed if the request contained an API key.</p> </li> <li> <p>The JWT plan was executed if the request contained a Bearer token.</p> </li> </ul> <p>From this version:</p> <p>The security chain has been improved to select and execute plans more efficiently. As a result, API keys and JWT plans are now only executed if there is an active subscription related to the provided security token. If there is no relevant subscription, the currently parsed plans are not executed and the security chain moves to parse the next available plans. The process continues until the security chain parses plans related to the provided security token and these plans are executed, or until all available plans are parsed without a match.</p> <p>Specific examples of this change are provided in the table below:</p>          <p>API plans</p> <p>Request</p> <p>Prior to this version</p> <p>From this version</p>   <p>API key plan + Keyless plan</p> <p>Request contains an invalid API key</p> <p>API key plan is executed = HTTP 401 unauthorized</p> <p>Keyless plan is executed</p>   <p>JWT plan 1 + JWT plan 2</p> <p>Request contains a Bearer token valid for JWT plan 2</p> <p>JWT plan 1 is executed = HTTP 401 unauthorized</p> <p>JWT plan 2 is executed</p>","location":"apim/installation-guide/installation-guide-migration/#api-key-and-jwt-plans_1","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"<p>From this version, and for the next 3.15.x versions, the name of the Elasticsearch repository component changes. As a consequence, the Elasticsearch repository component available on https://download.gravitee.io is now <code>gravitee-*apim*-repository-elasticsearch-x.y.z.zip</code></p> <p>instead of <code>gravitee-repository-elasticsearch-x.y.z.zip</code></p> <p>This plugin has also been moved in another folder: https://download.gravitee.io/#graviteeio-apim/plugins/repositories/gravitee-apim-repository-elasticsearch/.</p> <p>You can download directly the Elasticsearch repository using this link: https://download.gravitee.io/graviteeio-apim/plugins/repositories/gravitee-apim-repository-elasticsearch/gravitee-apim-repository-elasticsearch-3.15.9.zip</p>","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_7","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking Change","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-change_1","tags":["APIM","Upgrade","Migration"]},{"title":"Docker Images - Enterprise Edition","text":"<p>To reduce the number of security vulnerabilities and ensure a better maintenance in the future, the base Docker images used for the Enterprise Edition have changed.</p> <p>As of 3.15.6, APIM Gateway EE and Management API EE base Docker images are moving from Ubuntu to Alpine with JDK 17. It means users creating their own Docker images based on the one provided by Gravitee.io might need to update their Dockerfile to make them compatible with the Alpine distribution.</p> <p>Notes: Community Edition users will not be affected as the base images were already Alpine ones.</p>","location":"apim/installation-guide/installation-guide-migration/#docker-images-enterprise-edition_2","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking Change","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-change_2","tags":["APIM","Upgrade","Migration"]},{"title":"Management API","text":"<p>Since they were deprecated since version 3.12.0, the Rest API endpoints listed below have been removed.</p>        <p>Removed Endpoint</p> <p>Replace With</p>   <p>PUT /apis/{api.id}/keys/{apiKey.key}</p> <p>PUT /apis/{api.id}/subscriptions/{subscription.id}/apikeys/{apiKey.id}</p>   <p>DELETE /apis/{api.id}/keys/{apiKey.key}</p> <p>DELETE /apis/{api.id}/subscriptions/{subscription.id}/apikeys/{apiKey.id}</p>   <p>POST /apis/{api.id}/keys/_verify?apiKey={apiKey.key}</p> <p>GET /apis/{api.id}/subscriptions/_canCreate?application={application.id}&amp;key={apiKey.key}</p>   <p>DELETE /apis/{api.id}/subscriptions/{subscription.id}/keys/{apiKey.key}</p> <p>DELETE /apis/{api.id}/subscriptions/{subscription.id}/apikeys/{apiKey.id}</p>   <p>GET /apis/{api.id}/subscriptions/{subscription.id}/keys</p> <p>GET /apis/{api.id}/subscriptions/{subscription.id}/apikeys</p>   <p>POST /apis/{api.id}/subscriptions/{subscription.id}</p> <p>POST /apis/{api.id}/subscriptions/{subscription.id}/apikeys/_renew</p>   <p>POST /apis/{api.id}/subscriptions/{subscription.id}/keys/{apiKey.key}/_reactivate</p> <p>POST /apis/{api.id}/subscriptions/{subscription.id}/apikeys/{apiKey.id}/_reactivate</p>   <p>GET /applications/{application.id}/subscriptions/{subscription.id}/keys</p> <p>GET /applications/{application.id}/subscriptions/{subscription.id}/apikeys</p>   <p>POST /applications/{application.id}/subscriptions/{subscription.id}</p> <p>POST /applications/{application.id}/subscriptions/{subscription.id}/apikeys/_renew</p>   <p>DELETE /applications/{application.id}/subscriptions/{subscription.id}/keys/{apiKey.key}</p> <p>DELETE /applications/{application.id}/subscriptions/{subscription.id}/apikeys/{apiKey.id}</p>","location":"apim/installation-guide/installation-guide-migration/#management-api","tags":["APIM","Upgrade","Migration"]},{"title":"Deprecation of path-based API creation","text":"<p>The path-based approach to create APIs will be removed in our next LTS and has been deprecated. From now on, this mode is disabled by default but can still be re-activated from your organization settings.</p>","location":"apim/installation-guide/installation-guide-migration/#deprecation-of-path-based-api-creation","tags":["APIM","Upgrade","Migration"]},{"title":"Gateway","text":"","location":"apim/installation-guide/installation-guide-migration/#gateway","tags":["APIM","Upgrade","Migration"]},{"title":"Custom policy breaking changes","text":"<p>We\u2019ve made huge improvements on the v3.15.0 in order to considerably decrease the memory and cpu resources required to serve the traffic on the gateway. For that, we rework some parts of the gateway which have impacts on few policies we maintain and could have impact on your custom policies you may have developed.</p> <p>To summarize, here is the short list of the possible breaking changes that could impact you:</p> <ol> <li> <p>Rework the way request and response headers are internally managed</p> </li> <li> <p>Policy class loading</p> </li> </ol> <p>Details on each breaking changes are given below.</p> <p>All policies maintained by Gravitee\u2019s teams are already ready to work with APIM v3.15.0. You may consider upgrading your custom policies if they match one of the following cases:</p> <ul> <li> <p>Your policy relies on a static object instance that was previously     instantiated per api and will become shared starting from the     v3.15.0 of APIM</p> </li> <li> <p>Your policy manipulate request or response headers and should move     to new way to manage headers.</p> </li> </ul> <p>For each of these cases, please find the appropriate actions below.</p>","location":"apim/installation-guide/installation-guide-migration/#custom-policy-breaking-changes","tags":["APIM","Upgrade","Migration"]},{"title":"Http headers","text":"<p>Starting from 3.15.0 we rework the way the request and response headers are manage to make them even performant than ever.</p> <p>For that reason, if your custom policy relies on headers make sure to upgrade it by replacing <code>io.gravitee.common.http.HttpHeaders</code> with the new headers class <code>io.gravitee.gateway.api.http.HttpHeaders</code> and migrate the few methods where name changed a bit:</p> <ul> <li> <p><code>new HttpHeaders()</code> \u2192 <code>HttpHeaders.create()</code></p> </li> <li> <p><code>headers.containsKey(\"key\")</code> \u2192 <code>headers.contains(\"key\")</code></p> </li> <li> <p><code>headers.get(\"key\")</code> \u2192 <code>headers.getAll(\"key\")</code> (previous get     returned a list)</p> </li> </ul>","location":"apim/installation-guide/installation-guide-migration/#http-headers","tags":["APIM","Upgrade","Migration"]},{"title":"Policy class loading","text":"<p>We\u2019ve made huge improvements on the v3.15.0 by reworking the way policies are loaded when deploying an api on the APIM gateway. While previously, one ClassLoader were instantiated per deployed api, we decided to shift to a single ClassLoader instance to avoid memory pressure, especially when deploying a lot of apis. Also, policy instances are now reused across all the requests instead of re-instantiate them on each call.</p> <p>For that, we had to adapt some policies we support in order to make sure they work with the new class loading and policy instantiation mechanisms. Basically, policy instances are now considered as fully stateless and must get rid of any state which cannot be shared across the whole platform.</p> <p>All the policies we support were already stateless. However, few changes have been made on some of them to move from static maps to cache instances that can be safely accessed and revoked concurrently.</p> <p>For all custom policies you may have developed, we strongly recommend adopting the same strategy by avoiding usage of static instances in your policies. If you are unable to adapt your policy before the migration to v3.15.0, there is still the possibility to explicitly switch back to the previous class loading behavior by setting the following configuration:</p> <p>```yaml classloader: legacy: enabled: true ```</p> <p>We highly recommend adopting the new class loading strategy as soon as possible as it may not be maintained in the future versions.</p>","location":"apim/installation-guide/installation-guide-migration/#policy-class-loading","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_8","tags":["APIM","Upgrade","Migration"]},{"title":"Gateway","text":"<p>From with this version, the name of the APIM Gateway component changes. As a consequence:</p> <ol> <li> <p>The APIM Gateway component available on     https://download.gravitee.io is now     <code>gravitee-*apim-gateway*-x.y.z.zip</code> instead of     <code>gravitee-gateway-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Gateway folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim-gateway*-x.y.z</code> instead of     <code>graviteeio-gateway-x.y.z</code></p> </li> </ol>","location":"apim/installation-guide/installation-guide-migration/#gateway_1","tags":["APIM","Upgrade","Migration"]},{"title":"Gateway bridge upgrade","text":"<p>On hybrid architectures where gateway bridge feature is enabled, gateways have to be upgraded in this order :</p> <ol> <li> <p>The bridge server gateway</p> </li> <li> <p>The bridge client gateway</p> </li> </ol> <p>More information on the gateway bridge feature can be found here.</p>","location":"apim/installation-guide/installation-guide-migration/#gateway-bridge-upgrade","tags":["APIM","Upgrade","Migration"]},{"title":"Elastic Search reporter plugins configuration","text":"<p>Before Gravitee 3.14 :</p> <ul> <li> <p>For ES&gt;=7, GeoIp and UserAgent plugins are enabled by default in     Gravitee, and can\u2019t be disabled</p> </li> <li> <p>For ES&lt;7, those plugins are disabled by default and can be     enabled in Gravitee configuration.</p> </li> </ul> <p>Since Gravitee 3.14, it behave the same way for all ES versions : GeoIp and UserAgent plugins are be enabled by default, and can be disabled by overriding default <code>reporters.elasticsearch.pipeline.plugins.ingest</code> configuration.</p> <p>If your Gravitee configuration enables a plugin which is not available on your ES instance, you will get this kind of error message on gateway startup :</p> <p><code>Unable to create ES pipeline 'gravitee_pipeline': status[400] response[{\"error\":{\"root_cause\":[{\"reason\":\"No processor type exists with name [geoip]\",\"processor_type\":\"geoip\"}]</code></p> <p>And then, you have to override <code>reporters.elasticsearch.pipeline.plugins.ingest</code> default configuration, to remove unrelevant plugin.</p>","location":"apim/installation-guide/installation-guide-migration/#elastic-search-reporter-plugins-configuration","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_9","tags":["APIM","Upgrade","Migration"]},{"title":"Gateway","text":"<p>From with this version, the name of the APIM Gateway component changes. As a consequence:</p> <ol> <li> <p>The APIM Gateway component available on     https://download.gravitee.io is now     <code>gravitee-*apim-gateway*-x.y.z.zip</code> instead of     <code>gravitee-gateway-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Gateway folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim-gateway*-x.y.z</code> instead of     <code>graviteeio-gateway-x.y.z</code></p> </li> </ol>","location":"apim/installation-guide/installation-guide-migration/#gateway_2","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_10","tags":["APIM","Upgrade","Migration"]},{"title":"Gateway","text":"<p>HTTP Bridge Service is now disabled by default starting.</p> <p>If you are using this feature, do not forget to update your settings.</p> <p>For more information, click here for documentation.</p>","location":"apim/installation-guide/installation-guide-migration/#gateway_3","tags":["APIM","Upgrade","Migration"]},{"title":"Management Web UI","text":"<p>From with this version, the name of the APIM Console component changes. As a consequence:</p> <ol> <li> <p>The APIM Console component available on     https://download.gravitee.io is now     <code>gravitee-*apim-console*-webui-x.y.z.zip</code> instead of     <code>gravitee-management-webui-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Console folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim-console*-ui-x.y.z</code> instead of     <code>graviteeio-management-ui-x.y.z</code></p> </li> </ol>","location":"apim/installation-guide/installation-guide-migration/#management-web-ui","tags":["APIM","Upgrade","Migration"]},{"title":"Portal Web UI","text":"<p>From with this version, the name of the APIM Portal component changes. As a consequence:</p> <ol> <li> <p>The APIM Portal component available on     https://download.gravitee.io is now     <code>gravitee-*apim*-portal-webui-x.y.z.zip</code> instead of     <code>gravitee-portal-webui-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Portal folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim*-portal-ui-x.y.z</code> instead of     <code>graviteeio-portal-ui-x.y.z</code></p> </li> </ol> <p>In future versions, others plugins &amp; components might be renamed. Stay tuned!</p>","location":"apim/installation-guide/installation-guide-migration/#portal-web-ui","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_11","tags":["APIM","Upgrade","Migration"]},{"title":"Gateway","text":"<p>From with this version, the name of the APIM Gateway component changes. As a consequence:</p> <ol> <li> <p>The APIM Gateway component available on     https://download.gravitee.io is now     <code>gravitee-*apim-gateway*-x.y.z.zip</code> instead of     <code>gravitee-gateway-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Gateway folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim-gateway*-x.y.z</code> instead of     <code>graviteeio-gateway-x.y.z</code></p> </li> </ol>","location":"apim/installation-guide/installation-guide-migration/#gateway_4","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_12","tags":["APIM","Upgrade","Migration"]},{"title":"Management Web UI","text":"<p>From with this version, the name of the APIM Console component changes. As a consequence:</p> <ol> <li> <p>The APIM Console component available on     https://download.gravitee.io is now     <code>gravitee-*apim-console*-webui-x.y.z.zip</code> instead of     <code>gravitee-management-webui-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Console folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim-console*-ui-x.y.z</code> instead of     <code>graviteeio-management-ui-x.y.z</code></p> </li> </ol>","location":"apim/installation-guide/installation-guide-migration/#management-web-ui_1","tags":["APIM","Upgrade","Migration"]},{"title":"Portal Web UI","text":"<p>From with this version, the name of the APIM Portal component changes. As a consequence:</p> <ol> <li> <p>The APIM Portal component available on     https://download.gravitee.io is now     <code>gravitee-*apim*-portal-webui-x.y.z.zip</code> instead of     <code>gravitee-portal-webui-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Portal folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim*-portal-ui-x.y.z</code> instead of     <code>graviteeio-portal-ui-x.y.z</code></p> </li> </ol> <p>In future versions, others plugins &amp; components might be renamed. Stay tuned!</p>","location":"apim/installation-guide/installation-guide-migration/#portal-web-ui_1","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking Change","text":"<p>Policy plugin <code>gravitee-policy-apikey</code> prior to version 2.3.0 is no longer compatible with APIM 3.12.0.</p> <p>Starting in version 3.12.0, you must use <code>gravitee-policy-apikey</code> &gt;= 2.3.0.</p>","location":"apim/installation-guide/installation-guide-migration/#breaking-change_3","tags":["APIM","Upgrade","Migration"]},{"title":"Default Settings Change Announcement","text":"<p>HTTP Bridge Service will be disabled by default starting in version 3.13.</p> <p>If you are using this feature, do not forget to update your settings.</p> <p>For more information, click here for documentation.</p>","location":"apim/installation-guide/installation-guide-migration/#default-settings-change-announcement","tags":["APIM","Upgrade","Migration"]},{"title":"API Keys","text":"","location":"apim/installation-guide/installation-guide-migration/#api-keys","tags":["APIM","Upgrade","Migration"]},{"title":"Model Change","text":"<p>Before this version, API keys contained a key attribute, which is both the value of the key and also the database ID.</p> <p>Starting in version 3.12.0, APIKeys now contain distinct attributes:</p> <ul> <li> <p>key: API key value</p> </li> <li> <p>ID: API key database unique ID</p> </li> </ul> <p>The 3 Portal API endpoints listed below now expose distinct IDs and keys in the HTTP response (previously, the key attribute was exposed as ID) :</p> <ul> <li> <p>GET /subscriptions/{subscription.id}</p> </li> <li> <p>POST /subscriptions/{subscription.id}</p> </li> <li> <p>POST /subscriptions/{subscription.id}/_renew</p> </li> </ul>","location":"apim/installation-guide/installation-guide-migration/#model-change","tags":["APIM","Upgrade","Migration"]},{"title":"Deprecated Endpoints","text":"<p>The Rest API endpoints listed below are now deprecated, and will be removed in a future version.</p>        <p>Deprecated Endpoint</p> <p>Replace With</p>   <p>PUT /apis/{api.id}/keys/{apiKey.key}</p> <p>PUT /apis/{api.id}/subscriptions/{subscription.id}/apikeys/{apiKey.id}</p>   <p>DELETE /apis/{api.id}/keys/{apiKey.key}</p> <p>DELETE /apis/{api.id}/subscriptions/{subscription.id}/apikeys/{apiKey.id}</p>   <p>POST /apis/{api.id}/keys/_verify?apiKey={apiKey.key}</p> <p>GET /apis/{api.id}/subscriptions/_canCreate?application={application.id}&amp;key={apiKey.key}</p>   <p>DELETE /apis/{api.id}/subscriptions/{subscription.id}/keys/{apiKey.key}</p> <p>DELETE /apis/{api.id}/subscriptions/{subscription.id}/apikeys/{apiKey.id}</p>   <p>GET /apis/{api.id}/subscriptions/{subscription.id}/keys</p> <p>GET /apis/{api.id}/subscriptions/{subscription.id}/apikeys</p>   <p>POST /apis/{api.id}/subscriptions/{subscription.id}</p> <p>POST /apis/{api.id}/subscriptions/{subscription.id}/apikeys/_renew</p>   <p>POST /apis/{api.id}/subscriptions/{subscription.id}/keys/{apiKey.key}/_reactivate</p> <p>POST /apis/{api.id}/subscriptions/{subscription.id}/apikeys/{apiKey.id}/_reactivate</p>   <p>GET /applications/{application.id}/subscriptions/{subscription.id}/keys</p> <p>GET /applications/{application.id}/subscriptions/{subscription.id}/apikeys</p>   <p>POST /applications/{application.id}/subscriptions/{subscription.id}</p> <p>POST /applications/{application.id}/subscriptions/{subscription.id}/apikeys/_renew</p>   <p>DELETE /applications/{application.id}/subscriptions/{subscription.id}/keys/{apiKey.key}</p> <p>DELETE /applications/{application.id}/subscriptions/{subscription.id}/apikeys/{apiKey.id}</p>","location":"apim/installation-guide/installation-guide-migration/#deprecated-endpoints","tags":["APIM","Upgrade","Migration"]},{"title":"Repository","text":"","location":"apim/installation-guide/installation-guide-migration/#repository","tags":["APIM","Upgrade","Migration"]},{"title":"MongoDB","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.12.0/api-keys-migration.js This script adds key and api columns in api keys keys table.</p>","location":"apim/installation-guide/installation-guide-migration/#mongodb_1","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_13","tags":["APIM","Upgrade","Migration"]},{"title":"Management Web UI","text":"<p>From with this version, the name of the APIM Console component changes. As a consequence:</p> <ol> <li> <p>The APIM Console component available on     https://download.gravitee.io is now     <code>gravitee-*apim-console*-webui-x.y.z.zip</code> instead of     <code>gravitee-management-webui-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Console folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim-console*-ui-x.y.z</code> instead of     <code>graviteeio-management-ui-x.y.z</code></p> </li> </ol>","location":"apim/installation-guide/installation-guide-migration/#management-web-ui_2","tags":["APIM","Upgrade","Migration"]},{"title":"Portal Web UI","text":"<p>From with this version, the name of the APIM Portal component changes. As a consequence:</p> <ol> <li> <p>The APIM Portal component available on     https://download.gravitee.io is now     <code>gravitee-*apim*-portal-webui-x.y.z.zip</code> instead of     <code>gravitee-portal-webui-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Portal folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim*-portal-ui-x.y.z</code> instead of     <code>graviteeio-portal-ui-x.y.z</code></p> </li> </ol> <p>In future versions, others plugins &amp; components might be renamed. Stay tuned!</p>","location":"apim/installation-guide/installation-guide-migration/#portal-web-ui_2","tags":["APIM","Upgrade","Migration"]},{"title":"Repository","text":"","location":"apim/installation-guide/installation-guide-migration/#repository_1","tags":["APIM","Upgrade","Migration"]},{"title":"Mongodb","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.11.1/1-event-debug-migration.js This script removes the <code>API_ID</code> property for events of type <code>DEBUG</code>.</p>","location":"apim/installation-guide/installation-guide-migration/#mongodb_2","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"<p>From with this version, the name of the APIM Rest APIs component changes. As a consequence:</p> <ol> <li> <p>The APIM Rest API component available on     https://download.gravitee.io is now     <code>gravitee-*apim*-rest-api-x.y.z.zip</code> instead of     <code>gravitee-management-rest-api-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Rest API folder within the full distribution     zip file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim*-rest-api-x.y.z</code> instead of     <code>graviteeio-rest-api-x.y.z</code></p> </li> </ol> <p>In future versions, others plugins &amp; components might be renamed. Stay tuned!</p>","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_14","tags":["APIM","Upgrade","Migration"]},{"title":"Security update","text":"<p>From this version, API properties can be encrypted.</p> <p>Encryption key is located in gravitee.yml of Rest APIs and gateway.</p> <p>You should not use this default key, and set your own custom 32 bytes length secret.</p> <p>```\u1ef3ml # Encrypt API properties using this secret api: properties: encryption: secret: vvLJ4Q8Khvv9tm2tIPdkGEdmgKUruAL6 ```</p>","location":"apim/installation-guide/installation-guide-migration/#security-update","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_15","tags":["APIM","Upgrade","Migration"]},{"title":"API key and JWT plans","text":"<p>The security chain (the internal process that selects the executable plan for the incoming request and applies the related security rules) parses all active plans to select and execute the relevant one.</p> <p>Prior to this version:</p> <ul> <li> <p>The API key plan was executed if the request contained an API key.</p> </li> <li> <p>The JWT plan was executed if the request contained a Bearer token.</p> </li> </ul> <p>From this version:</p> <p>The security chain has been improved to select and execute plans more efficiently. As a result, API keys and JWT plans are now only executed if there is an active subscription related to the provided security token. If there is no relevant subscription, the currently parsed plans are not executed and the security chain moves to parse the next available plans. The process continues until the security chain parses plans related to the provided security token and these plans are executed, or until all available plans are parsed without a match.</p> <p>Specific examples of this change are provided in the table below:</p>          <p>API plans</p> <p>Request</p> <p>Prior to this version</p> <p>From this version</p>   <p>API key plan + Keyless plan</p> <p>Request contains an invalid API key</p> <p>API key plan is executed = HTTP 401 unauthorized</p> <p>Keyless plan is executed</p>   <p>JWT plan 1 + JWT plan 2</p> <p>Request contains a Bearer token valid for JWT plan 2</p> <p>JWT plan 1 is executed = HTTP 401 unauthorized</p> <p>JWT plan 2 is executed</p>","location":"apim/installation-guide/installation-guide-migration/#api-key-and-jwt-plans_2","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"<p>From this version, and for the next 3.10.x versions, the name of the Elasticsearch repository component changes. As a consequence, the Elasticsearch repository component available on https://download.gravitee.io is now <code>gravitee-*apim*-repository-elasticsearch-x.y.z.zip</code></p> <p>instead of <code>gravitee-repository-elasticsearch-x.y.z.zip</code></p> <p>This plugin has also been moved in another folder: https://download.gravitee.io/#graviteeio-apim/plugins/repositories/gravitee-apim-repository-elasticsearch/.</p> <p>You can download directly the Elasticsearch repository using this link: https://download.gravitee.io/graviteeio-apim/plugins/repositories/gravitee-apim-repository-elasticsearch/gravitee-apim-repository-elasticsearch-3.10.15.zip</p>","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_16","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking Change","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-change_4","tags":["APIM","Upgrade","Migration"]},{"title":"Docker Images - Enterprise Edition","text":"<p>To reduce the number of security vulnerabilities and ensure a better maintenance in the future, the base Docker images used for the Enterprise Edition have changed.</p> <p>As of 3.10.13, APIM Gateway EE and Management API EE base Docker images are moving from Ubuntu to Alpine with JDK 17. It means users creating their own Docker images based on the one provided by Gravitee.io might need to update their Dockerfile to make them compatible with the Alpine distribution.</p> <p>Notes: Community Edition users will not be affected as the base images were already Alpine ones.</p>","location":"apim/installation-guide/installation-guide-migration/#docker-images-enterprise-edition_3","tags":["APIM","Upgrade","Migration"]},{"title":"Elastic Search reporter plugins configuration","text":"<p>Before Gravitee 3.10.9 :</p> <ul> <li> <p>For ES&gt;=7, GeoIp and UserAgent plugins are enabled by default in     Gravitee, and can\u2019t be disabled</p> </li> <li> <p>For ES&lt;7, those plugins are disabled by default and can be     enabled in Gravitee configuration.</p> </li> </ul> <p>Since Gravitee 3.10.9, it behave the same way for all ES versions : GeoIp and UserAgent plugins are be enabled by default, and can be disabled by overriding default <code>reporters.elasticsearch.pipeline.plugins.ingest</code> configuration.</p> <p>If your Gravitee configuration enables a plugin which is not available on your ES instance, you will get this kind of error message on gateway startup :</p> <p><code>Unable to create ES pipeline 'gravitee_pipeline': status[400] response[{\"error\":{\"root_cause\":[{\"reason\":\"No processor type exists with name [geoip]\",\"processor_type\":\"geoip\"}]</code></p> <p>And then, you have to override <code>reporters.elasticsearch.pipeline.plugins.ingest</code> default configuration, to remove unrelevant plugin.</p>","location":"apim/installation-guide/installation-guide-migration/#elastic-search-reporter-plugins-configuration_1","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_17","tags":["APIM","Upgrade","Migration"]},{"title":"Gateway","text":"<p>From with this version, the name of the APIM Gateway component changes. As a consequence:</p> <ol> <li> <p>The APIM Gateway component available on     https://download.gravitee.io is now     <code>gravitee-*apim-gateway*-x.y.z.zip</code> instead of     <code>gravitee-gateway-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Gateway folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim-gateway*-x.y.z</code> instead of     <code>graviteeio-gateway-x.y.z</code></p> </li> </ol>","location":"apim/installation-guide/installation-guide-migration/#gateway_5","tags":["APIM","Upgrade","Migration"]},{"title":"Plans anomalies in database","text":"","location":"apim/installation-guide/installation-guide-migration/#plans-anomalies-in-database","tags":["APIM","Upgrade","Migration"]},{"title":"TLDR","text":"<p>In Gravitee &lt; 3.10.8, some processes have caused database inconsistencies, regarding plans and flows.</p> <p>Gravitee 3.10.8, introduces an automated process to detect and fix those anomalies.</p> <p>By default, this process will run in dry mode and won\u2019t do any database modification. Check the <code>gravitee-upgraders.log</code> file to see if any of your API is concerned, and how it will be fixed.</p> <p>After check, fix those database anomalies by disabling the dry mode.</p>","location":"apim/installation-guide/installation-guide-migration/#tldr","tags":["APIM","Upgrade","Migration"]},{"title":"What are those database anomalies ?","text":"<p>In Gravitee &lt; 3.10.8, some processes have caused inconsistencies in database, regarding plans and flows.</p> <p>Concerned processes are :</p> <ul> <li> <p>import an API</p> </li> <li> <p>promote an API</p> </li> <li> <p>duplicate an API</p> </li> <li> <p>rollback an API</p> </li> </ul> <p>For concerned APIs, plans and flows displayed in console doesn\u2019t reflect the ones runned by gateway.</p>","location":"apim/installation-guide/installation-guide-migration/#what-are-those-database-anomalies","tags":["APIM","Upgrade","Migration"]},{"title":"How to fix it ?","text":"<p>Gravitee 3.10.8, introduces an automated process to detect and fix those anomalies.</p> <p>This process will run on management API startup. By default, it will run in dry mode, to detect and list anomalies without fixing them in database.</p> <p>After you checked those anomalies have to be fixed, you can disable the dry mode, and restart your API to update your database.</p>","location":"apim/installation-guide/installation-guide-migration/#how-to-fix-it","tags":["APIM","Upgrade","Migration"]},{"title":"My APIs are concerned ?","text":"<p>On management API startup, you will see this trace in the console, or the dedicated <code>gravitee-upgraders.log</code> log file.</p> <p>If no anomaly was detected :</p> <pre><code>14:19:43.171 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - Starting PlansDataFixUpgrader execution with dry-run enabled\n14:19:43.352 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - No plan data anomaly found\n14:19:43.360 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - Finishing PlansDataFixUpgrader execution\n</code></pre> <p>If anomalies were detected :</p> <pre><code>14:51:50.890 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - Starting PlansDataFixUpgrader execution with dry-run enabled\n14:51:50.979 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader -\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader - ##############################################################\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader - #                           WARNING                          #\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader - ##############################################################\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader -\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader - We detected database anomalies in your plans data.\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader -\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader - THIS IS A DRY RUN. DATABASE WON'T BE UPDATED.\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader - To fix anomalies, disable the dry run mode.\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader - Below, a list of changes that would happen without dry run\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader - See related documentation : https://docs.gravitee.io/apim/3.x/apim_installguide_migration.html#upgrade_to_3_10_8\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader -\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader - ##############################################################\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader -\n14:51:50.980 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - Plans anomalies found for API \"Movies\" (99999999-6595-9999-8a7e-796595985132) :\n14:51:50.981 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - - Will create plan \"Gold-Recreated\" for API \"Movies\" (99999999-6595-9999-8a7e-796595985132), which is missing in plans table\n14:51:50.982 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - - Will create plan \"Free-Recreated\" for API \"Movies\" (99999999-6595-9999-8a7e-796595985132), which is missing in plans table\n14:51:50.982 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - - Will close plan \"Free\" (66664545-1234-1234-1234-1234567891425), cause it's absent from api definition\n14:51:51.019 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - Plans anomalies found for API \"Horses\" (0456455556-5465-5465-4894955554) :\n14:51:51.019 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - - Will create plan \"LimitedUsage-Recreated\" for API \"Horses\" (0456455556-5465-5465-4894955554), which is missing in plans table\n14:51:51.025 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - Plans anomalies found for API \"Petstore\" (121112-1211-1111-121121211) :\n14:51:51.025 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - - Will create plan \"Silver-Recreated\" for API \"Petstore\" (121112-1211-1111-121121211), which is missing in plans table\n14:51:51.058 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - Finishing PlansDataFixUpgrader execution\n</code></pre>","location":"apim/installation-guide/installation-guide-migration/#my-apis-are-concerned","tags":["APIM","Upgrade","Migration"]},{"title":"How anomalies are fixed ?","text":"<p>This process will fix your API plans data.</p> <p>But it won\u2019t change the runtime behavior of your APIs in the gateway, until you redeploy them manually from console.</p>","location":"apim/installation-guide/installation-guide-migration/#how-anomalies-are-fixed","tags":["APIM","Upgrade","Migration"]},{"title":"Some plans were considered by gateway, but were not visible in console :","text":"<p>They will be recreated in console, and you will see new plans appear :</p> <ul> <li> <p>with name suffixed by \"-Recreated\"</p> </li> <li> <p>with description \"This plan has been recreated during a data fix     process. See documentation : \u2026\"</p> </li> </ul> <p>Those plans will be in <code>deprecated</code> state, without any subscription. It will allow you to check those plans and their flows, and close them if relevant.</p>","location":"apim/installation-guide/installation-guide-migration/#some-plans-were-considered-by-gateway-but-were-not-visible-in-console","tags":["APIM","Upgrade","Migration"]},{"title":"Some plans visible in console were not considered by gateway :","text":"<p>Those plans will be closed, as they were not actually used during API runtime.</p>","location":"apim/installation-guide/installation-guide-migration/#some-plans-visible-in-console-were-not-considered-by-gateway","tags":["APIM","Upgrade","Migration"]},{"title":"I\u2019m ready. How to disable the dry mode and fix data ?","text":"<p>To fix data in your database, turn off the dry-mode, setting the <code>services.plans-data-fix-upgrader.dryRun</code> parameter to false. Then, restart the management API.</p>","location":"apim/installation-guide/installation-guide-migration/#im-ready-how-to-disable-the-dry-mode-and-fix-data","tags":["APIM","Upgrade","Migration"]},{"title":"Further configuration ?","text":"<p>You can configure this process in gravitee.yml, for example :</p> <pre><code>services:\n  plans-data-fix-upgrader:\n    enabled: true\n    dryRun: true\n    notifyApiOwner: false\n</code></pre> <p>Possible configuration keys are :</p>         <p>Key</p> <p>Description</p> <p>Default value</p>   <p>enabled</p> <p>If set to false, the process won\u2019t execute</p> <p>true</p>   <p>dryRun</p> <p>If set to true, the process won\u2019t make any database change, but only list changes.</p> <p>true</p>   <p>notifyApiOwner</p> <p>If set to true, an email notification will be send to the api owner for each fixed API.</p> <p>false</p>","location":"apim/installation-guide/installation-guide-migration/#further-configuration","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_18","tags":["APIM","Upgrade","Migration"]},{"title":"Management Web UI","text":"<p>From with this version, the name of the APIM Console component changes. As a consequence:</p> <ol> <li> <p>The APIM Console component available on     https://download.gravitee.io is now     <code>gravitee-*apim-console*-webui-x.y.z.zip</code> instead of     <code>gravitee-management-webui-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Console folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim-console*-ui-x.y.z</code> instead of     <code>graviteeio-management-ui-x.y.z</code></p> </li> </ol>","location":"apim/installation-guide/installation-guide-migration/#management-web-ui_3","tags":["APIM","Upgrade","Migration"]},{"title":"Portal Web UI","text":"<p>From with this version, the name of the APIM Portal component changes. As a consequence:</p> <ol> <li> <p>The APIM Portal component available on     https://download.gravitee.io is now     <code>gravitee-*apim*-portal-webui-x.y.z.zip</code> instead of     <code>gravitee-portal-webui-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Portal folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim*-portal-ui-x.y.z</code> instead of     <code>graviteeio-portal-ui-x.y.z</code></p> </li> </ol> <p>In future versions, others plugins &amp; components might be renamed. Stay tuned!</p>","location":"apim/installation-guide/installation-guide-migration/#portal-web-ui_3","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"<p>From this version, the name of the APIM Rest APIs component changes. As a consequence:</p> <ol> <li> <p>The APIM Rest API component available on     https://download.gravitee.io is now     <code>gravitee-*apim*-rest-api-x.y.z.zip</code> instead of     <code>gravitee-management-rest-api-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Rest API folder within the full distribution     zip file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim*-rest-api-x.y.z</code> instead of     <code>graviteeio-rest-api-x.y.z</code></p> </li> </ol> <p>In future versions, others plugins &amp; components might be renamed. Stay tuned!</p>","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_19","tags":["APIM","Upgrade","Migration"]},{"title":"Repository","text":"","location":"apim/installation-guide/installation-guide-migration/#repository_2","tags":["APIM","Upgrade","Migration"]},{"title":"Mongodb","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.10.1/1-upgrade-parameters-for-theme-console.js This script upgrade default value of <code>theme.logo</code> in parameters</p>","location":"apim/installation-guide/installation-guide-migration/#mongodb_3","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"<p>From with this version, the name of some components of Gravitee.io APIM changes. As a consequence, the following plugins are renamed :</p>        <p>before 3.10.0</p> <p>after 3.10.0</p>   <p>gravitee.repository.mongodb-x.y.z.zip</p> <p>gravitee.apim.repository.mongodb-x.y.z.zip</p>   <p>gravitee.repository.jdbc-x.y.z.zip</p> <p>gravitee.apim.repository.jdbc-x.y.z.zip</p>   <p>gravitee.repository.redis-x.y.z.zip</p> <p>gravitee.apim.repository.redis-x.y.z.zip</p>   <p>gravitee.repository.hazelcast-x.y.z.zip</p> <p>gravitee.apim.repository.hazelcast-x.y.z.zip</p>   <p>gravitee.repository.gateway.bridge.http.client-x.y.z.zip</p> <p>gravitee.apim.repository.gateway.bridge.http.client-x.y.z.zip</p>   <p>gravitee.repository.gateway.bridge.http.server-x.y.z.zip</p> <p>gravitee.apim.repository.gateway.bridge.http.server-x.y.z.zip</p>    <p>These plugins have also been moved in another folder on https://download.gravitee.io. For instance, the MongoDB plugin is now available using this link:</p> <p>https://download.gravitee.io/graviteeio-apim/plugins/repositories/gravitee-apim-repository-mongodb/gravitee-apim-repository-mongodb-3.10.0.zip</p> <p>In future versions, others plugins will be renamed. Stay tuned!</p>","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_20","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_21","tags":["APIM","Upgrade","Migration"]},{"title":"Threat protection policies","text":"<p>From this version, configuration form for JSON Threat Protection Policy and XML Threat Protection Policy changes: <code>null</code> is no longer authorized, only <code>-1</code> is accepted for a no limit setting.</p>","location":"apim/installation-guide/installation-guide-migration/#threat-protection-policies","tags":["APIM","Upgrade","Migration"]},{"title":"Impacts","text":"<ul> <li> <p>If some fields are set to <code>null</code> in your db, and if you want to edit     this policy configuration through APIM Console, then the form     will replace them by the default value. Please, be careful when     updating your policy if you do not want the default values to be     applied.</p> </li> <li> <p>If some fields are set to <code>null</code> in your db, and if you want to edit     this policy configuration through REST API, an error message     will appear if you do not set an explicit value for those fields in     your request payload.</p> </li> </ul>","location":"apim/installation-guide/installation-guide-migration/#impacts","tags":["APIM","Upgrade","Migration"]},{"title":"Management Rest API","text":"<p>From with this version, the name of the APIM Rest APIs component changes. As a consequence:</p> <ol> <li> <p>The APIM Rest API component available on     https://download.gravitee.io is now     <code>gravitee-*apim*-rest-api-x.y.z.zip</code> instead of     <code>gravitee-management-rest-api-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Rest API folder within the full distribution     zip file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim*-rest-api-x.y.z</code> instead of     <code>graviteeio-rest-api-x.y.z</code></p> </li> </ol> <p>In future versions, others plugins &amp; components might be renamed. Stay tuned!</p>","location":"apim/installation-guide/installation-guide-migration/#management-rest-api","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"<p>From with this version, the name of some components of Gravitee.io APIM changes. As a consequence, the following plugins are renamed :</p>        <p>before 3.9.3</p> <p>after 3.9.3</p>   <p>gravitee.repository.mongodb-3.9.x.zip</p> <p>gravitee.apim.repository.mongodb-3.9.x.zip</p>   <p>gravitee.repository.jdbc-3.9.x.zip</p> <p>gravitee.apim.repository.jdbc-3.9.x.zip</p>   <p>gravitee.repository.redis-3.9.x.zip</p> <p>gravitee.apim.repository.redis-3.9.x.zip</p>   <p>gravitee.repository.hazelcast-3.9.x.zip</p> <p>gravitee.apim.repository.hazelcast-3.9.x.zip</p>   <p>gravitee.repository.gateway.bridge.http.client-3.9.x.zip</p> <p>gravitee.apim.repository.gateway.bridge.http.client-3.9.x.zip</p>   <p>gravitee.repository.gateway.bridge.http.server-3.9.x.zip</p> <p>gravitee.apim.repository.gateway.bridge.http.server-3.9.x.zip</p>    <p>These plugins have also been moved in another folder on https://download.gravitee.io. For instance, the MongoDB plugin is now available using this link:</p> <p>https://download.gravitee.io/graviteeio-apim/plugins/repositories/gravitee-apim-repository-mongodb/gravitee-apim-repository-mongodb-3.9.3.zip</p> <p>In future versions, others plugins will be renamed. Stay tuned!</p>","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_22","tags":["APIM","Upgrade","Migration"]},{"title":"Important: Alert Engine","text":"<p>For users of Gravitee Enterprise Edition with Alert Engine, please check your gravitee configuration to ensure that the alert engine feature is explictly enable. Starting from this version, the alert engine connector is disabled by default if the option <code>alerts.alert-engine-enabled</code> is missing from the gravitee.yaml. (see https://docs.gravitee.io/ae/apim_installation.html#configuration)</p>","location":"apim/installation-guide/installation-guide-migration/#important-alert-engine","tags":["APIM","Upgrade","Migration"]},{"title":"Warning","text":"<p>For JDBC users only, please don\u2019t upgrade to 3.9.0 since we detected a critical bug in a liquibase script that could lead to data loss. This will be fixed in 3.9.1. We apologize for this inconvenience.</p> <p>GitHub issue: 5711</p>","location":"apim/installation-guide/installation-guide-migration/#warning","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"<p>From this version, in order to propose a better swagger descriptor, all enum values returned by the APIM API are in uppercase.</p> <p>Lowercase and uppercase values are still accepted in incoming requests.</p>","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_23","tags":["APIM","Upgrade","Migration"]},{"title":"Memory management","text":"<p>Starting from this new version, the default Xms and Xmx parameters has been fixed to 256m. Previous value was too high and does not reflect real memory usage for both the API Gateway and Management API.</p> <p>If, for some reasons, you need to increase those default values, you can set the <code>GIO_MIN_MEM</code> and <code>GIO_MAX_MEM</code> environment variables in your scripts. Those variables are then \"injected\" into the JAVA_OPTS during bootstrap.</p>","location":"apim/installation-guide/installation-guide-migration/#memory-management","tags":["APIM","Upgrade","Migration"]},{"title":"APIM API - Tags and Tenants","text":"<p>This version changes permissions' scope from <code>ENVIRONMENT</code> to <code>ORGANIZATION</code> for:</p> <ul> <li> <p>TAG</p> </li> <li> <p>TENANT</p> </li> <li> <p>ENTRYPOINT</p> </li> </ul> <p>These permissions are now readonly for the scope <code>ENVIRONMENT</code>. They will be deleted on version 3.10. If you are using these permissions, please update them for the scope <code>ORGANIZATION</code>.</p>","location":"apim/installation-guide/installation-guide-migration/#apim-api-tags-and-tenants","tags":["APIM","Upgrade","Migration"]},{"title":"Repository","text":"","location":"apim/installation-guide/installation-guide-migration/#repository_3","tags":["APIM","Upgrade","Migration"]},{"title":"Mongodb","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.9.0/1-tags-and-tenants-migration.js This script adds referenceId set to DEFAULT and referenceType set to ORGANIZATION to tags, tenants and entrypoint collections.</p> <p>/apim/3.x/mongodb/3.9.0/2-events-migration.js This script modifies events, so an event can be linked to more than one environment.</p>","location":"apim/installation-guide/installation-guide-migration/#mongodb_4","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"<p>From with this version, the name of some components of Gravitee.io APIM changes. As a consequence, the following plugins are renamed :</p>        <p>before 3.8.6</p> <p>after 3.8.6</p>   <p>gravitee.repository.mongodb-3.8.x.zip</p> <p>gravitee.apim.repository.mongodb-3.8.x.zip</p>   <p>gravitee.repository.jdbc-3.8.x.zip</p> <p>gravitee.apim.repository.jdbc-3.8.x.zip</p>   <p>gravitee.repository.redis-3.8.x.zip</p> <p>gravitee.apim.repository.redis-3.8.x.zip</p>   <p>gravitee.repository.hazelcast-3.8.x.zip</p> <p>gravitee.apim.repository.hazelcast-3.8.x.zip</p>   <p>gravitee.repository.gateway.bridge.http.client-3.8.x.zip</p> <p>gravitee.apim.repository.gateway.bridge.http.client-3.8.x.zip</p>   <p>gravitee.repository.gateway.bridge.http.server-3.8.x.zip</p> <p>gravitee.apim.repository.gateway.bridge.http.server-3.8.x.zip</p>    <p>These plugins have also been moved in another folder on https://download.gravitee.io. For instance, the MongoDB plugin is now available using this link:</p> <p>https://download.gravitee.io/graviteeio-apim/plugins/repositories/gravitee-apim-repository-mongodb/gravitee-apim-repository-mongodb-3.8.6.zip</p> <p>In future versions, others plugins will be renamed. Stay tuned!</p>","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_24","tags":["APIM","Upgrade","Migration"]},{"title":"Repository","text":"","location":"apim/installation-guide/installation-guide-migration/#repository_4","tags":["APIM","Upgrade","Migration"]},{"title":"Mongodb","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.8.0/1-page-acl-migration.js This script replaces excluded_groups by visibility, excludedAccessControls and accessControls collection.</p>","location":"apim/installation-guide/installation-guide-migration/#mongodb_5","tags":["APIM","Upgrade","Migration"]},{"title":"Repository","text":"<p>Since 3.7, you have the ability to configure a prefix for your tables or collections name.</p> <p>Rate limit configuration has to be defined in both Gateway and Management <code>gravitee.yml</code> files.</p> <p>With this centralized configuration, you can disable the liquibase phase of the gateway, if you do not want it to modify your dbms.</p> <p>If you choose to use prefix, follow these instructions.</p>","location":"apim/installation-guide/installation-guide-migration/#repository_5","tags":["APIM","Upgrade","Migration"]},{"title":"Mongodb","text":"","location":"apim/installation-guide/installation-guide-migration/#mongodb_6","tags":["APIM","Upgrade","Migration"]},{"title":"New installation","text":"<p>You just have to modify the <code>gravitee.yml</code> files of gateway and console to configure <code>management.mongodb.prefix</code> and <code>ratelimit.mongodb.prefix</code>. Default value is empty.</p>","location":"apim/installation-guide/installation-guide-migration/#new-installation","tags":["APIM","Upgrade","Migration"]},{"title":"Migrate an existing installation","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>If you want to prefix your collections, you will have to rename them. You can use the following script.</p> <p>Check documentation at https://docs.gravitee.io/apim/3.x/apim_installguide_repositories_mongodb.html</p> <p>This script rename all the collections adding the <code>prefix</code> and <code>rateLimitPrefix</code>.</p> <p>For the following steps, we admit you choose this prefix: prefix_</p> <ol> <li> <p>Modify <code>gravitee.yml</code> to configure <code>management.mongodb.prefix</code> and     <code>ratelimit.mongodb.prefix</code> if needed.</p> </li> <li> <p>Run the following script to rename your collections:     /apim/3.x/mongodb/3.7.0/1-rename-collections-with-prefix.js</p> </li> <li> <p>Run your instances!</p> </li> </ol>","location":"apim/installation-guide/installation-guide-migration/#migrate-an-existing-installation","tags":["APIM","Upgrade","Migration"]},{"title":"JDBC","text":"","location":"apim/installation-guide/installation-guide-migration/#jdbc","tags":["APIM","Upgrade","Migration"]},{"title":"New installation","text":"<p>You just have to modify the <code>gravitee.yml</code> files of gateway and console to configure <code>management.jdbc.prefix</code> and <code>ratelimit.jdbc.prefix</code>. Default value is empty.</p>","location":"apim/installation-guide/installation-guide-migration/#new-installation_1","tags":["APIM","Upgrade","Migration"]},{"title":"Migrate an existing installation","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>If you want to prefix your tables, you will have to rename them. Check documentation at https://docs.gravitee.io/apim/3.x/apim_installguide_repositories_jdbc.html</p> <p>For the following steps, we admit you choose this prefix: prefix_</p> <ol> <li> <p>Modify <code>gravitee.yml</code> to configure <code>management.jdbc.prefix</code> and     <code>ratelimit.jdbc.prefix</code> if needed.</p> </li> <li> <p>Run the application on a new database to generate     <code>prefix_databasechangelog</code></p> </li> <li> <p>Replace the content of <code>databasechangelog</code> table by the generated     one from <code>prefix_databasechangelog</code></p> </li> <li> <p>Rename your tables following this syntax: prefix_tablename</p> </li> <li> <p>Rename your indexes following this syntax: idx_prefix_indexname</p> </li> <li> <p>Rename your primary keys following this syntax: pk_prefix_pkname</p> </li> <li> <p>Run your instances!</p> </li> </ol>","location":"apim/installation-guide/installation-guide-migration/#migrate-an-existing-installation_1","tags":["APIM","Upgrade","Migration"]},{"title":"Elasticsearch","text":"<p>With Elasticsearch version above 7.x, <code>geoip</code> and <code>user_agent</code> plugins are automatically enabled.</p>","location":"apim/installation-guide/installation-guide-migration/#elasticsearch","tags":["APIM","Upgrade","Migration"]},{"title":"APIM API","text":"<p>Two new configuration keys have been added to the <code>gravitee.yml</code> file, they should be set with the URLs of the UI console and the management API: ```yml console: ui: url: gravitee_apim_ui_url # TO UPDATE WITH YOUR OWN URL api: url: gravitee_apim_management_api_url # TO UPDATE WITH YOUR OWN URL ```</p> <p>NB: For Gravitee Cockpit to work properly these URLs are mandatory, they will be used by Cockpit to interact with your APIM installation.</p>","location":"apim/installation-guide/installation-guide-migration/#apim-api","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_25","tags":["APIM","Upgrade","Migration"]},{"title":"Gateway","text":"<p>From with this version, the name of the APIM Gateway component changes. As a consequence:</p> <ol> <li> <p>The APIM Gateway component available on     https://download.gravitee.io is now     <code>gravitee-*apim-gateway*-x.y.z.zip</code> instead of     <code>gravitee-gateway-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Gateway folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim-gateway*-x.y.z</code> instead of     <code>graviteeio-gateway-x.y.z</code></p> </li> </ol>","location":"apim/installation-guide/installation-guide-migration/#gateway_6","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_26","tags":["APIM","Upgrade","Migration"]},{"title":"Management Web UI","text":"<p>From with this version, the name of the APIM Console component changes. As a consequence:</p> <ol> <li> <p>The APIM Console component available on     https://download.gravitee.io is now     <code>gravitee-*apim-console*-webui-x.y.z.zip</code> instead of     <code>gravitee-management-webui-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Console folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim-console*-ui-x.y.z</code> instead of     <code>graviteeio-management-ui-x.y.z</code></p> </li> </ol>","location":"apim/installation-guide/installation-guide-migration/#management-web-ui_4","tags":["APIM","Upgrade","Migration"]},{"title":"Portal Web UI","text":"<p>From with this version, the name of the APIM Portal component changes. As a consequence:</p> <ol> <li> <p>The APIM Portal component available on     https://download.gravitee.io is now     <code>gravitee-*apim*-portal-webui-x.y.z.zip</code> instead of     <code>gravitee-portal-webui-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Portal folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim*-portal-ui-x.y.z</code> instead of     <code>graviteeio-portal-ui-x.y.z</code></p> </li> </ol> <p>In future versions, others plugins &amp; components might be renamed. Stay tuned!</p>","location":"apim/installation-guide/installation-guide-migration/#portal-web-ui_4","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_27","tags":["APIM","Upgrade","Migration"]},{"title":"Threat protection policies","text":"<p>From this version, configuration form for JSON Threat Protection Policy and XML Threat Protection Policy changes: <code>null</code> is no longer authorized, only <code>-1</code> is accepted for a no limit setting.</p>","location":"apim/installation-guide/installation-guide-migration/#threat-protection-policies_1","tags":["APIM","Upgrade","Migration"]},{"title":"Impacts","text":"<ul> <li> <p>If some fields are set to <code>null</code> in your db, and if you want to edit     this policy configuration through APIM Console, then the form     will replace them by the default value. Please, be careful when     updating your policy if you do not want the default values to be     applied.</p> </li> <li> <p>If some fields are set to <code>null</code> in your db, and if you want to edit     this policy configuration through REST API, an error message     will appear if you do not set an explicit value for those fields in     your request payload.</p> </li> </ul>","location":"apim/installation-guide/installation-guide-migration/#impacts_1","tags":["APIM","Upgrade","Migration"]},{"title":"Management Rest API","text":"<p>From with this version, the name of the APIM Rest APIs component changes. As a consequence:</p> <ol> <li> <p>The APIM Rest API component available on     https://download.gravitee.io is now     <code>gravitee-*apim*-rest-api-x.y.z.zip</code> instead of     <code>gravitee-management-rest-api-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Rest API folder within the full distribution     zip file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim*-rest-api-x.y.z</code> instead of     <code>graviteeio-rest-api-x.y.z</code></p> </li> </ol> <p>In future versions, others plugins &amp; components might be renamed. Stay tuned!</p>","location":"apim/installation-guide/installation-guide-migration/#management-rest-api_1","tags":["APIM","Upgrade","Migration"]},{"title":"Improvements","text":"<p>Some performance improvements have been made (#6066). As a consequence, the scheduled service used to automatically close expired subscriptions now runs every hour instead of every 5 seconds</p>","location":"apim/installation-guide/installation-guide-migration/#improvements","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"<p>From with this version, the name of some components of Gravitee.io APIM changes. As a consequence, the following plugins are renamed :</p>        <p>before 3.5.18</p> <p>after 3.5.18</p>   <p>gravitee.repository.mongodb-3.5.x.zip</p> <p>gravitee.apim.repository.mongodb-3.5.x.zip</p>   <p>gravitee.repository.jdbc-3.5.x.zip</p> <p>gravitee.apim.repository.jdbc-3.5.x.zip</p>   <p>gravitee.repository.redis-3.5.x.zip</p> <p>gravitee.apim.repository.redis-3.5.x.zip</p>   <p>gravitee.repository.hazelcast-3.5.x.zip</p> <p>gravitee.apim.repository.hazelcast-3.5.x.zip</p>   <p>gravitee.repository.gateway.bridge.http.client-3.5.x.zip</p> <p>gravitee.apim.repository.gateway.bridge.http.client-3.5.x.zip</p>   <p>gravitee.repository.gateway.bridge.http.server-3.5.x.zip</p> <p>gravitee.apim.repository.gateway.bridge.http.server-3.5.x.zip</p>    <p>These plugins have also been moved in another folder on https://download.gravitee.io. For instance, the MongoDB plugin is now available using this link:</p> <p>https://download.gravitee.io/graviteeio-apim/plugins/repositories/gravitee-apim-repository-mongodb/gravitee-apim-repository-mongodb-3.5.18.zip</p> <p>In future versions, others plugins will be renamed. Stay tuned!</p>","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_28","tags":["APIM","Upgrade","Migration"]},{"title":"Repository","text":"","location":"apim/installation-guide/installation-guide-migration/#repository_6","tags":["APIM","Upgrade","Migration"]},{"title":"Mongodb","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.5.14/1-fix-cors-env-vars.js This script migrate CORS environment variables for portal and console. (See below).</p>","location":"apim/installation-guide/installation-guide-migration/#mongodb_7","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking Changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_29","tags":["APIM","Upgrade","Migration"]},{"title":"Environment variables","text":"<p>Some environment variables have been doubled for the portal and the console, see correspondence table:</p>         <p>before 3.5.14</p> <p>after 3.5.14 (for portal)</p> <p>after 3.5.14 (for console)</p>   <p>portal.http.cors.allow-origin</p> <p>http.api.portal.cors.allow-origin</p> <p>X</p>   <p>console.http.cors.allow-origin</p> <p>X</p> <p>http.api.management.cors.allow-origin</p>   <p>portal.http.cors.allow-headers</p> <p>http.api.portal.cors.allow-headers</p> <p>X</p>   <p>console.http.cors.allow-headers</p> <p>X</p> <p>http.api.management.cors.allow-header</p>   <p>portal.http.cors.allow-methods</p> <p>http.api.portal.cors.allow-methods</p> <p>X</p>   <p>console.http.cors.allow-methods</p> <p>X</p> <p>http.api.management.cors.allow-methods</p>   <p>portal.http.cors.exposed-headers</p> <p>http.api.portal.cors.exposed-headers</p> <p>X</p>   <p>console.http.cors.exposed-headers</p> <p>X</p> <p>http.api.management.cors.exposed-headers</p>   <p>portal.http.cors.max-age</p> <p>http.api.portal.cors.max-age</p> <p>X</p>   <p>console.http.cors.max-age</p> <p>X</p> <p>http.api.management.cors.max-age</p>","location":"apim/installation-guide/installation-guide-migration/#environment-variables","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking Changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_30","tags":["APIM","Upgrade","Migration"]},{"title":"Management API","text":"<p>If you are using the REST API directly, please note that now these requests need authentication:</p>","location":"apim/installation-guide/installation-guide-migration/#management-api_1","tags":["APIM","Upgrade","Migration"]},{"title":"-","text":"","location":"apim/installation-guide/installation-guide-migration/#-","tags":["APIM","Upgrade","Migration"]},{"title":"-","text":"","location":"apim/installation-guide/installation-guide-migration/#-_1","tags":["APIM","Upgrade","Migration"]},{"title":"-","text":"","location":"apim/installation-guide/installation-guide-migration/#-_2","tags":["APIM","Upgrade","Migration"]},{"title":"-","text":"","location":"apim/installation-guide/installation-guide-migration/#-_3","tags":["APIM","Upgrade","Migration"]},{"title":"Repository","text":"","location":"apim/installation-guide/installation-guide-migration/#repository_7","tags":["APIM","Upgrade","Migration"]},{"title":"Mongodb","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.5.2/1-add-DEFAULT-referenceId-in-memberships.js This script add the \"DEFAULT\" <code>referenceId</code> for memberships with <code>null</code> one. This bug impacts users created when using social authentication since version 3.5.0.</p>","location":"apim/installation-guide/installation-guide-migration/#mongodb_8","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking Changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_31","tags":["APIM","Upgrade","Migration"]},{"title":"Environment variables","text":"<p>Some environment variables have been doubled for the portal and the console, see correspondence table:</p>         <p>before 3.5.0</p> <p>after 3.5.0 (for portal)</p> <p>after 3.5.0 (for console)</p>   <p>authentication.localLogin.enabled</p> <p>portal.authentication.localLogin.enabled</p> <p>console.authentication.localLogin.enabled</p>   <p>scheduler.tasks</p> <p>portal.scheduler.tasks</p> <p>console.scheduler.tasks</p>   <p>scheduler.notifications</p> <p>portal.scheduler.notifications</p> <p>console.scheduler.notifications</p>   <p>reCaptcha.enabled</p> <p>portal.reCaptcha.enabled</p> <p>console.reCaptcha.enabled</p>   <p>reCaptcha.siteKey</p> <p>portal.reCaptcha.siteKey</p> <p>console.reCaptcha.siteKey</p>   <p>portal.support.enabled</p> <p>portal.support.enabled</p> <p>console.support.enabled</p>   <p>portal.userCreation.enabled</p> <p>portal.userCreation.enabled</p> <p>console.userCreation.enabled</p>   <p>portal.userCreation.automaticValidation.enabled</p> <p>portal.userCreation.automaticValidation.enabled</p> <p>console.userCreation.automaticValidation.enabled</p>   <p>http.cors.allow-origin</p> <p>portal.http.cors.allow-origin</p> <p>console.http.cors.allow-origin</p>   <p>http.cors.allow-headers</p> <p>portal.http.cors.allow-headers</p> <p>console.http.cors.allow-headers</p>   <p>http.cors.allow-methods</p> <p>portal.http.cors.allow-methods</p> <p>console.http.cors.allow-methods</p>   <p>http.cors.exposed-headers</p> <p>portal.http.cors.exposed-headers</p> <p>console.http.cors.exposed-headers</p>   <p>http.cors.max-age</p> <p>portal.http.cors.max-age</p> <p>console.http.cors.max-age</p>","location":"apim/installation-guide/installation-guide-migration/#environment-variables_1","tags":["APIM","Upgrade","Migration"]},{"title":"Distribution","text":"<p>From this version, Gravitee.IO APIM is distributed with MongoDB and JDBC plugins, as well as Hybrid HTTP plugin (gateway-bridge-http), in the <code>full</code> ZIP. You no longer have to choose between the \"full\" or \"full-jdbc\" ZIP file.</p>","location":"apim/installation-guide/installation-guide-migration/#distribution","tags":["APIM","Upgrade","Migration"]},{"title":"Repository","text":"","location":"apim/installation-guide/installation-guide-migration/#repository_8","tags":["APIM","Upgrade","Migration"]},{"title":"Mongodb","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.5.01-duplicate-some-parameters-for-console.js This script duplicates some parameters for the console to have different behaviors between portal and console. It also modifies the _id of each mongo document to add referenceId and referenceType.</p>","location":"apim/installation-guide/installation-guide-migration/#mongodb_9","tags":["APIM","Upgrade","Migration"]},{"title":"Repository","text":"","location":"apim/installation-guide/installation-guide-migration/#repository_9","tags":["APIM","Upgrade","Migration"]},{"title":"Mongodb","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.4.0/1-update-audit-to-replace-PORTAL-with_ORGANIZATION-and-ENVIRONMENT.js This script convert PORTAL audit into ENVIRONMENT audits or ORGANIZATION audits regarding some conditions.</p> <p>/apim/3.x/mongodb/3.4.0/2-update-default-role-REVIEWER.js This script add new permissions to the default REVIEWER role.</p>","location":"apim/installation-guide/installation-guide-migration/#mongodb_10","tags":["APIM","Upgrade","Migration"]},{"title":"Repository","text":"","location":"apim/installation-guide/installation-guide-migration/#repository_10","tags":["APIM","Upgrade","Migration"]},{"title":"Mongodb","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.3.0/1-update-users-and-identityProviders.js This script replaces referenceId and referenceType with organizationId for <code>users</code> and <code>identity_providers</code> collections.</p> <p>/apim/3.x/mongodb/3.3.0/2-update-json-validation-policy-scopes.js This script replaces REQUEST and RESPONSE with REQUEST_CONTENT and RESPONSE_CONTENT for json-validation policy configuration in <code>apis</code> collections.</p>","location":"apim/installation-guide/installation-guide-migration/#mongodb_11","tags":["APIM","Upgrade","Migration"]},{"title":"Deprecation","text":"","location":"apim/installation-guide/installation-guide-migration/#deprecation","tags":["APIM","Upgrade","Migration"]},{"title":"Management API","text":"<p>Starting with this version, <code>User</code> and <code>IdentityProvider</code> are now linked to an organization and not to an environment. As a consequence, the Management REST API has been updated. If you are using the REST API directly, please note that you should adapt your URL for these resources as they will no longer be accessible from version 4.x In the meantime, these resources will be tagged as <code>Deprecated</code>.</p>        Deprecated in 3.3.0, deleted in 4.x Since 3.3.0         <p>/organizations/DEFAULT/environments/DEFAULT/configuration/identities</p> <p>/organizations/DEFAULT/configuration/identities</p>       <p>/organizations/DEFAULT/environments/DEFAULT/configuration/rolescopes</p> <p>/organizations/DEFAULT/configuration/rolescopes</p>                   <p>/organizations/DEFAULT/environments/DEFAULT/search/users</p> <p>/organizations/DEFAULT/search/users</p>   <p>/organizations/DEFAULT/environments/DEFAULT/user</p> <p>/organizations/DEFAULT/user</p>   <p>/organizations/DEFAULT/environments/DEFAULT/user/subscribeNewsletter</p> <p>/organizations/DEFAULT/user/subscribeNewsletter</p>   <p>/organizations/DEFAULT/environments/DEFAULT/user/avatar</p> <p>/organizations/DEFAULT/user/avatar</p>   <p>/organizations/DEFAULT/environments/DEFAULT/user/login</p> <p>/organizations/DEFAULT/user/login</p>   <p>/organizations/DEFAULT/environments/DEFAULT/user/logout</p> <p>/organizations/DEFAULT/user/logout</p>   <p>/organizations/DEFAULT/environments/DEFAULT/user/tasks</p> <p>/organizations/DEFAULT/user/tasks</p>   <p>/organizations/DEFAULT/environments/DEFAULT/user/tags</p> <p>/organizations/DEFAULT/user/tags</p>   <p>/organizations/DEFAULT/environments/DEFAULT/user/notifications</p> <p>/organizations/DEFAULT/user/notifications</p>   <p>/organizations/DEFAULT/environments/DEFAULT/user/tokens</p> <p>/organizations/DEFAULT/user/tokens</p>       <p>/organizations/DEFAULT/environments/DEFAULT/users</p> <p>/organizations/DEFAULT/users</p>                               <p>/organizations/DEFAULT/environments/DEFAULT/users/registration</p> <p>/organizations/DEFAULT/users/registration</p>   <p>/organizations/DEFAULT/environments/DEFAULT/users/registration/finalize</p> <p>/organizations/DEFAULT/users/registration/finalize</p>","location":"apim/installation-guide/installation-guide-migration/#management-api_2","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking Changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_32","tags":["APIM","Upgrade","Migration"]},{"title":"Portal UI","text":"<p>The variables css of <code>gv-link</code> component has been modified to improve the theme\u2019s customization. Now the component uses :</p> <ul> <li> <p>Active border color <code>--gv-link-active--bdc</code> instead of Active border     bottom color <code>--gv-link-active--bdbc</code></p> </li> <li> <p>Active border style <code>--gv-link-active--bds</code> instead of Active border     bottom style <code>--gv-link-active--bdbs</code></p> </li> <li> <p>Active border width <code>--gv-link-active--bdw</code> instead of Active border     bottom width <code>--gv-link-active--bdbw</code></p> </li> </ul> <p>For example, if you has set <code>--gv-link-active--bdbw=3px</code>, now you should set <code>--gv-link-active--bdw=0 0 3px 0</code></p>","location":"apim/installation-guide/installation-guide-migration/#portal-ui","tags":["APIM","Upgrade","Migration"]},{"title":"Docker images","text":"<p>All the UI based docker images (APIM Console, APIM Portal) are now using HTTP port 8080 and HTTPS port 8443 by default to avoid the need of a root account to use 80/443 to improve the security of our platform.</p>","location":"apim/installation-guide/installation-guide-migration/#docker-images","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking Changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_33","tags":["APIM","Upgrade","Migration"]},{"title":"Management API","text":"<p>Starting with this version, <code>Apis</code> resources require authentication even for the GET method.</p> <p>If you are using the REST API directly, please note that you should adapt your application.</p> <p><code>Apis</code> resources start with the path <code>/management/organizations/DEFAULT/environments/DEFAULT/apis/</code></p>","location":"apim/installation-guide/installation-guide-migration/#management-api_3","tags":["APIM","Upgrade","Migration"]},{"title":"Portal API","text":"<p>Starting with this version, <code>Apis</code>, <code>Pages</code> and <code>Categories</code> resources that were public for GET method require authentication if the users have to sign in to access the portal. (forceLogin = true)</p> <p>If you are using the REST API directly, please note that you should adapt your application.</p> <ul> <li> <p><code>Apis</code> resources start with the path     <code>/portal/environments/DEFAULT/apis</code></p> </li> <li> <p><code>Pages</code> resources start with the path     <code>/portal/environments/DEFAULT/pages</code></p> </li> <li> <p><code>Categories</code> resources start with the path     <code>/portal/environments/DEFAULT/categories</code></p> </li> </ul>","location":"apim/installation-guide/installation-guide-migration/#portal-api_1","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking changes","text":"<p>The <code>portalURL</code> parameter in the gravitee.yml file has been removed. It has become useless with this issue #4144.</p> <p>As this <code>portalURL</code> stands for the former portal, it will be replaced by the <code>management.url</code> parameter in the console settings. This parameter will be initialized with the former <code>portalURL</code> value if it still exists in your gravitee.yml. Otherwise, the default value of <code>management.url</code> is http://localhost:3000</p> <p>The <code>portal.url</code> parameter in the console settings will also have a default value : http://localhost:4100</p>","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_34","tags":["APIM","Upgrade","Migration"]},{"title":"View renamed to Categories","text":"<p>In the new portal, views are called categories. But in the management console, they are still called views. To be consistent, the term View is replaced by Category in the whole platform.</p> <p>Linked to this issue: #3843</p>","location":"apim/installation-guide/installation-guide-migration/#view-renamed-to-categories","tags":["APIM","Upgrade","Migration"]},{"title":"Mongodb","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>upgrades/3.x/3.0.2/mongodb/1-rename-view-in-category.js This script renames a field in apis collection, rename views collection, change 3 parameters, replace view by category in audits collection and convert documentation view LINK to ctagory LINK</p>","location":"apim/installation-guide/installation-guide-migration/#mongodb_12","tags":["APIM","Upgrade","Migration"]},{"title":"Important","text":"<p>If you are using mongoDB, it is strongly recommended to run the scripts to upgrade your database before starting the new version of the gravitee REST APIs. Otherwise, you could experience data corruption issues.</p> <p>Mongo version MUST be at least 3.6</p>","location":"apim/installation-guide/installation-guide-migration/#important","tags":["APIM","Upgrade","Migration"]},{"title":"General","text":"","location":"apim/installation-guide/installation-guide-migration/#general","tags":["APIM","Upgrade","Migration"]},{"title":"Organization &amp; Environment","text":"<p>In this new version Gravitee comes with a new way of managing your environments. By default, Gravitee is configured with a first Organization: ``` organization { id: DEFAULT, name: Default organization } ``` And a first Environment in this Organization: ``` environment { id: DEFAULT, name: Default environment, organization: DEFAULT } ```</p> <p>It will allow you to manage more than one environment for each instance of Gravitee.</p>","location":"apim/installation-guide/installation-guide-migration/#organization-environment","tags":["APIM","Upgrade","Migration"]},{"title":"Breaking Changes","text":"","location":"apim/installation-guide/installation-guide-migration/#breaking-changes_35","tags":["APIM","Upgrade","Migration"]},{"title":"API-Key policy","text":"<p>In this new version, if api-keys used to call an API is invalid or has expired, the gateway will fail with a 401 (instead of 403 in previous versions of Gravitee).</p>","location":"apim/installation-guide/installation-guide-migration/#api-key-policy","tags":["APIM","Upgrade","Migration"]},{"title":"Management API","text":"<p>If you are using the REST API directly, please note that you will have to adapt the URL from <code>https://host/management/</code> to <code>https://host/management/organizations/DEFAULT/environments/DEFAULT/</code></p> <p>The resource <code>/views/default</code> has been deleted since a view does not have a default field anymore.</p>","location":"apim/installation-guide/installation-guide-migration/#management-api_4","tags":["APIM","Upgrade","Migration"]},{"title":"Management UI","text":"<p>The actual portal has been replaced by a brand new version, with its own location. As a consequence, the URL of the management UI has been modified to remove the /management part.</p> <p>For instance, to access the Platform Overview page, you should use <code>https://host/\\#!/platform</code> instead of <code>https://host/#!/management/platform</code></p>","location":"apim/installation-guide/installation-guide-migration/#management-ui","tags":["APIM","Upgrade","Migration"]},{"title":"Memberships, roles and role mappings","text":"<p>One major breaking change in this new version is the replacement of MANAGEMENT and PORTAL scopes by ENVIRONNMENT and ORGANIZATION scopes. It\u2019s not just a renaming but a dispatch of permissions among these 2 news scopes. As a consequence, all existing memberships, roles, groups and Identity Providers role mappings should be updated.</p> <ul> <li> <p>Memberhips, roles and groups have to be updated with migration     scripts here</p> </li> <li> <p>Role Mappings for Identity Providers stored in database will be     updated with a specific upgrader. See Upgrader</p> </li> <li> <p>Role mappings defined in the gravitee.yml file have to be     updated with these new scopes.</p> </li> </ul> <p>Here\u2019s a correlation table of permissions before and after migration :</p>         Permission Name Scope Name before migration Scope name after migration     <p>INSTANCE</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>GROUP</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>TAG</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>TENANT</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>API</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>ROLE</p> <p>MANAGEMENT</p> <p>ORGANIZATION</p>   <p>APPLICATION</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>PLATFORM</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>AUDIT</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>NOTIFICATION</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>USER</p> <p>MANAGEMENT</p> <p>ORGANIZATION</p>   <p>MESSAGE</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>DICTIONARY</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>ALERT</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>ENTRYPOINT</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>SETTINGS</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>DASHBOARD</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>QUALITY_RULE</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>METADATA</p> <p>PORTAL</p> <p>ENVIRONMENT</p>   <p>DOCUMENTATION</p> <p>PORTAL</p> <p>ENVIRONMENT</p>   <p>APPLICATION</p> <p>PORTAL</p> <p>ENVIRONMENT</p>   <p>VIEW</p> <p>PORTAL</p> <p>ENVIRONMENT</p>   <p>TOP_APIS</p> <p>PORTAL</p> <p>ENVIRONMENT</p>   <p>SETTINGS</p> <p>PORTAL</p> <p>ENVIRONMENT</p>   <p>API_HEADER</p> <p>PORTAL</p> <p>ENVIRONMENT</p>   <p>IDENTITY_PROVIDER</p> <p>PORTAL</p> <p>ENVIRONMENT</p>   <p>CLIENT_REGISTRATION_PROVIDER</p> <p>PORTAL</p> <p>ENVIRONMENT</p>","location":"apim/installation-guide/installation-guide-migration/#memberships-roles-and-role-mappings","tags":["APIM","Upgrade","Migration"]},{"title":"Repository","text":"","location":"apim/installation-guide/installation-guide-migration/#repository_11","tags":["APIM","Upgrade","Migration"]},{"title":"Mongodb","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.0.0/1-collections-linked-to-environment-or-organization.js This script adds new fields that refer the default environment or the default organization.</p> <p>/apim/3.x/mongodb/3.0.0/2-roles-groups-and-memberships-migration.js This script migrates permission values in roles since MANAGEMENT roles and PORTAL roles have been merged and dispatched into new ENVIRONMENT and ORGANIZATION roles. It also updates memberships and groups by adding or removing columns. All previous indexes for roles and memberships will be deleted and replaced by new indexes.</p> <p>/apim/3.x/mongodb/3.0.0/3-replace-apiArray-by-unique-api.js This script adds a new field that refers the api and remove the api array. All previous indexes for plans will be deleted and replaced by new indexes.</p> <p>/apim/3.x/mongodb/3.0.0/4-remove-devMode.js This script removes the devMode parameter, since the legacy portal has been replaced.</p> <p>/apim/3.x/mongodb/3.0.0/5-remove-orphan-documentation-pages.js Due to a bug in a previous version of gravitee when importing APIs, orphan pages may have been created. Orphan pages are all pages with a parentId but no page with such id exists. In some situation, this can lead to errors when accessing portal or apis documentation. You may use this script to find and remove orphan pages.</p> <p>Note: You can make a dry run by commenting line 6 and uncommenting line 5.</p> <p>/apim/3.x/mongodb/3.0.0/6-remove-ALL-view-and-defaultView-field.js This script removes the All view, since the legacy portal has been replaced and the new portal does not need this default view anymore. The script also updates existing views to remove defaultView field.</p>","location":"apim/installation-guide/installation-guide-migration/#mongodb_13","tags":["APIM","Upgrade","Migration"]},{"title":"Upgrader","text":"","location":"apim/installation-guide/installation-guide-migration/#upgrader","tags":["APIM","Upgrade","Migration"]},{"title":"Identity providers","text":"<p>Because of the evolution of the roles and their scope, role mappings in Identity Providers must be updated. To achieve this, a specific service has been created and will be launched at APIM startup. As this is not necessary to launch this service more than once, it can be disabled with some configuration.</p> <pre><code>services:\n  # v3 upgrader service. Can be disabled after first launch.\n  v3-upgrader:\n    enabled: true\n</code></pre>","location":"apim/installation-guide/installation-guide-migration/#identity-providers","tags":["APIM","Upgrade","Migration"]},{"title":"Docker","text":"<p>Docker images for Gravitee.io APIM have been renamed to follow the same conventions as the others Gravitee.io modules.</p> <p>In the case of Gravitee.io APIM, all the images have been prefixed by <code>-apim</code>.</p> <p>For example, for the API gateway <code>graviteeio/gateway</code> has been replaced by <code>graviteeio/apim-gateway</code>.</p> <p>Please have a look to the documentation at: https://docs.gravitee.io/apim/3.x/apim_installguide_docker_images.html</p>","location":"apim/installation-guide/installation-guide-migration/#docker","tags":["APIM","Upgrade","Migration"]},{"title":"Installing and updating Plugins","text":"","location":"apim/installation-guide/installation-guide-plugins/","tags":["APIM","Installation","Plugins"]},{"title":"Overview","text":"<p>Plugins bring Gravitee APIM to life. They provide functionality ranging from connectors (for example, Kafka) to tracers (for example, Jaeger) and everything in between. A special mention goes to policies - these are plugins that provide you with options to shape and control the flow of your APIs.</p> <p>A lot of plugins are part of the Gravitee APIM installation. Ones that are not generally applicable, can be added. You can even write your own plugins! This document explains how you can install and upgrade additional plugins.</p>","location":"apim/installation-guide/installation-guide-plugins/#overview","tags":["APIM","Installation","Plugins"]},{"title":"In a nutshell - Option I","text":"<ol> <li>Get your plugin zip-file ready.   The supported plugins for Gravitee APIM can be found here.</li> <li>Drop the plugin zip file in the plugins folder of the relevant component. This could be the APIM REST API, the APIM Gateway, or both!</li> <li>Restart the component.</li> </ol>  <p>Note</p> <p>At this time installing and updating plugins requires a restart of the component.</p>","location":"apim/installation-guide/installation-guide-plugins/#in-a-nutshell-option-i","tags":["APIM","Installation","Plugins"]},{"title":"In a nutshell - Option II","text":"<ol> <li>Get your plugin zip-file ready.   The supported plugins for Gravitee APIM can be found here.</li> <li>Drop the plugin zip file in a plugins folder of your own choosing.</li> <li>Modify the <code>gravitee.yml</code> configuration file of the relevant component (APIM REST API / APIM Gateway / both) to take the additional folder into account.</li> <li>Restart the component.</li> </ol>  <p>Note</p> <p>At this time installing and updating plugins requires a restart of the component.</p>","location":"apim/installation-guide/installation-guide-plugins/#in-a-nutshell-option-ii","tags":["APIM","Installation","Plugins"]},{"title":"Details for .ZIP installations","text":"","location":"apim/installation-guide/installation-guide-plugins/#details-for-zip-installations","tags":["APIM","Installation","Plugins"]},{"title":"Option I","text":"<ol> <li>Locate the plugins folder of the component</li> <li>APIM REST API - <code>&lt;your installation folder&gt;/graviteeio-apim-rest-api-{{ site.products.apim._3x.version }}/plugins</code></li> <li>APIM Gateway - <code>&lt;your installation folder&gt;/graviteeio-apim-gateway-{{ site.products.apim._3x.version }}/plugins</code></li> <li>Drop the plugin zip file into the folder.</li> <li>Restart the component.</li> </ol>","location":"apim/installation-guide/installation-guide-plugins/#option-i","tags":["APIM","Installation","Plugins"]},{"title":"Option II","text":"<ol> <li>Create custom locations for plugins   <pre><code>mkdir /customlocation/gateway/plugins\nmkdir /customlocation/rest-api/plugins\n</code></pre>   !!! note       This are example locations, yours can differ.</li> <li>Drop the plugin zip file into the relevant folder(s).</li> <li>Modify the <code>gravitee.yml</code> configuration file of the component   APIM REST API - <code>&lt;your installation folder&gt;/graviteeio-apim-rest-api-{{ site.products.apim._3x.version }}/config</code>:   <pre><code>  # Plugins repository\n  plugins:\n    path:\n      - ${gravitee.home}/plugins\n      - /customlocation/rest-api/plugins\n</code></pre> APIM Gateway - <code>&lt;your installation folder&gt;/graviteeio-apim-gateway-{{ site.products.apim._3x.version }}/config</code>:   <pre><code>  # Plugins repository\n  plugins:\n    path:\n      - ${gravitee.home}/plugins\n      - /customlocation/gateway/plugins\n</code></pre></li> <li>Restart the component.</li> </ol>","location":"apim/installation-guide/installation-guide-plugins/#option-ii","tags":["APIM","Installation","Plugins"]},{"title":"Details for package installations (Amazon Linux, RHEL, CentOS)","text":"","location":"apim/installation-guide/installation-guide-plugins/#details-for-package-installations-amazon-linux-rhel-centos","tags":["APIM","Installation","Plugins"]},{"title":"Option I","text":"<ol> <li>Locate the plugins folder of the component:</li> <li>APIM REST API - <code>/opt/graviteeio/apim/rest-api/plugins</code></li> <li>APIM Gateway - <code>/opt/graviteeio/apim/gateway/plugins</code></li> <li>Drop the plugin zip file into the folder.</li> <li>Restart the component.</li> </ol>","location":"apim/installation-guide/installation-guide-plugins/#option-i_1","tags":["APIM","Installation","Plugins"]},{"title":"Option II","text":"<ol> <li>Create custom locations for plugins   <pre><code>mkdir /customlocation/gateway/plugins\nmkdir /customlocation/rest-api/plugins\n</code></pre>   !!! note       This are example locations, yours can differ.</li> <li>Drop the plugin zip file into the relevant folder(s).</li> <li>Modify the <code>gravitee.yml</code> configuration file of the component:   APIM REST API - <code>/opt/graviteeio/apim/rest-api/config</code> <pre><code># Plugins repository\nplugins:\n  path:\n    - ${gravitee.home}/plugins\n    - /customlocation/rest-api/plugins\n</code></pre> APIM Gateway - <code>/opt/graviteeio/apim/gateway/config</code> <pre><code># Plugins repository\nplugins:\n  path:\n    - ${gravitee.home}/plugins\n    - /customlocation/gateway/plugins\n</code></pre></li> <li>Restart the component</li> </ol>","location":"apim/installation-guide/installation-guide-plugins/#option-ii_1","tags":["APIM","Installation","Plugins"]},{"title":"Details for Docker installations","text":"<p>Note</p> <p>Option I is not available for Docker installations as there is no direct access to the inside of the container.</p>","location":"apim/installation-guide/installation-guide-plugins/#details-for-docker-installations","tags":["APIM","Installation","Plugins"]},{"title":"Option II","text":"<ol> <li>Create custom locations for plugins.   <pre><code>mkdir /customlocation/gateway/plugins\nmkdir /customlocation/rest-api/plugins\n</code></pre>   !!! note       This are example locations, yours can differ.</li> <li>Drop the plugin zip file into the relevant folder(s).</li> <li>Customize the Docker command to provide:    The custom location as a <code>volume</code> that overrides the internal <code>/opt/graviteeio-management-api/plugins-ext</code> folder.    Two environment variables (<code>gravitee_plugins_path_0</code> and <code>gravitee_plugins_path_1</code>) that specify both plugin folders (by default only one is used).   <pre><code># APIM REST API\ndocker run --publish 8083:8083 \\\n  --volume /customlocation/rest-api/plugins:/opt/graviteeio-management-api/plugins-ext \\\n  --env gravitee_management_mongodb_uri=\"mongodb://gravitee-mongo:27017/gravitee-apim\" \\\n  --env gravitee_analytics_elasticsearch_endpoints_0=\"http://gravitee-elasticsearch:9200\" \\\n  --env gravitee_plugins_path_0=/opt/graviteeio-management-api/plugins \\\n  --env gravitee_plugins_path_1=/opt/graviteeio-management-api/plugins-ext \\\n  --name gravitee-apim-rest-api  \\\n  --detach graviteeio/apim-management-api:latest\n\n# APIM Gateway\ndocker run --publish 8082:8082 \\\n  --volume /customlocation/gateway/plugins:/opt/graviteeio-gateway/plugins-ext \\\n  --env gravitee_management_mongodb_uri=\"mongodb://gravitee-mongo:27017/gravitee-apim\" \\\n  --env gravitee_ratelimit_mongodb_uri=\"mongodb://gravitee-mongo:27017/gravitee-apim\" \\\n  --env gravitee_reporters_elasticsearch_endpoints_0=\"http://gravitee-elasticsearch:9200\" \\\n  --env gravitee_plugins_path_0=/opt/graviteeio-gateway/plugins \\\n  --env gravitee_plugins_path_1=/opt/graviteeio-gateway/plugins-ext \\\n  --name gravitee-apim-gateway \\\n  --detach graviteeio/apim-gateway:latest\n</code></pre>   !!! note       This is an example, your ports and URLs may differ.</li> </ol>","location":"apim/installation-guide/installation-guide-plugins/#option-ii_2","tags":["APIM","Installation","Plugins"]},{"title":"Details for Kubernetes installations","text":"<p>Note</p> <p>Option I is not available for Kubernetes installations as there is no direct access to the inside of the pods.</p>","location":"apim/installation-guide/installation-guide-plugins/#details-for-kubernetes-installations","tags":["APIM","Installation","Plugins"]},{"title":"Option II","text":"<ol> <li>Provide an URL to the plugin zip file.</li> <li>Modify the <code>value.yaml</code> file that you pass in with the Helm chart.   <pre><code>api:\n  additionalPlugins:\n    - https://download.gravitee.io/graviteeio-apim/plugins/policies/gravitee-policy-javascript/gravitee-policy-javascript-1.1.0.zip\n    - https://download.gravitee.io/graviteeio-apim/plugins/services/gravitee-kubernetes-controller/gravitee-kubernetes-controller-0.1.0.zip\n\ngateway:\n  additionalPlugins:\n    - https://download.gravitee.io/graviteeio-apim/plugins/policies/gravitee-policy-javascript/gravitee-policy-javascript-1.1.0.zip\n</code></pre></li> </ol>  <p>Note</p> <p>This is an example, your plugins may differ.</p>","location":"apim/installation-guide/installation-guide-plugins/#option-ii_3","tags":["APIM","Installation","Plugins"]},{"title":"APIM Installation Guide","text":"<p>As described in the APIM Overview, Gravitee.io API Management (APIM) is split into four main components:</p> <ul> <li>APIM Gateway</li> <li>APIM API</li> <li>APIM Console</li> <li>APIM Portal</li> </ul> <p>The links below provide information on how you can prepare, install, and configure your APIM environment. You can install APIM in a variety of ways, including:</p> <ul> <li> <p>Install on Amazon</p> </li> <li> <p>Install on Docker</p> </li> <li> <p>Install on Red Hat and CentOS (Linux)</p> </li> <li> <p>Install on Kubernetes</p> </li> <li> <p>Install with .ZIP</p> </li> <li> <p>Install a Hybrid Deployment</p> </li> </ul>  <p>Note</p> <p>The Gravitee.io installation guide provides information on how to install Gravitee.io components. For prerequisite documentation on third-party products such as MongoDB, Elasticsearch, or others, please visit their respective websites.</p>","location":"apim/installation-guide/installation-guide/","tags":["APIM","Installation","Introduction"]},{"title":"APIM Installation Guide - Component - Install all","text":"","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-all/","tags":["APIM","Installation"]},{"title":"Prerequisites","text":"<ul> <li>Machine up and running</li> <li>Gravitee YUM repository added</li> <li>Java 11 jre installed</li> <li>MongoDB installed and running</li> <li>Elasticsearch installed and running</li> <li>Nginx installed</li> </ul>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-all/#prerequisites","tags":["APIM","Installation"]},{"title":"Security group","text":"<ul> <li>open port 8082</li> <li>open port 8083</li> <li>open port 8084</li> <li>open port 8085</li> </ul>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-all/#security-group","tags":["APIM","Installation"]},{"title":"Instructions","text":"<ol> <li>Install all Gravitee APIM components:   <pre><code>sudo yum install graviteeio-apim-3x -y\n</code></pre></li> <li>Enable Gateway and REST API on startup:   <pre><code>sudo systemctl daemon-reload\nsudo systemctl enable graviteeio-apim-gateway\nsudo systemctl enable graviteeio-apim-rest-api\n</code></pre></li> <li>Start Gateway and REST API:   <pre><code>sudo systemctl start graviteeio-apim-gateway\nsudo systemctl start graviteeio-apim-rest-api\n</code></pre></li> <li>Restart Nginx:   <pre><code>sudo systemctl restart nginx\n</code></pre></li> <li>Fix an issue.   There is a known issue with the Portal UI configuration. You can find a fix here.</li> <li>Verify:   <pre><code>sudo journalctl -f\n</code></pre>   Follow along with the startup process. If any of the prerequisites is missing, this is were you\u2019ll get error messages.   You can also see the same in <code>/opt/graviteeio/apim/gateway/logs/gravitee.log</code> and <code>/opt/graviteeio/apim/rest-api/logs/gravitee.log</code>.</li> <li>Verify some more:   <pre><code>sudo ss -lntp '( sport = 8082 )'\nsudo ss -lntp '( sport = 8083 )'\nsudo ss -lntp '( sport = 8084 )'\nsudo ss -lntp '( sport = 8085 )'\n</code></pre>   You should see that there are processes listening on those ports.</li> <li>Verify some more still:   <pre><code>curl -X GET http://localhost:8082/\ncurl -X GET http://localhost:8083/management/organizations/DEFAULT/console\ncurl -X GET http://localhost:8083/portal/environments/DEFAULT/apis\n</code></pre>   If the installation is successful the first one returns: No context-path matches the request URI. The others return a JSON structure.</li> </ol> <p>Congratulations, you have a fully functional Gravitee APIM!</p>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-all/#instructions","tags":["APIM","Installation"]},{"title":"APIM Component - Install Gateway","text":"","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-gateway/","tags":["APIM","Installation","APIM component","Amazon","Gateway"]},{"title":"Prerequisites","text":"<ul> <li>Machine up and running</li> <li>Gravitee YUM repository added</li> <li>Java 11 jre installed</li> <li>MongoDB installed and running</li> <li>Elasticsearch installed and running</li> </ul>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-gateway/#prerequisites","tags":["APIM","Installation","APIM component","Amazon","Gateway"]},{"title":"Security group","text":"<ul> <li>open port 8082</li> </ul>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-gateway/#security-group","tags":["APIM","Installation","APIM component","Amazon","Gateway"]},{"title":"Instructions","text":"<ol> <li>Install Gateway:   <pre><code>sudo yum install graviteeio-apim-gateway-3x -y\n</code></pre></li> <li>Enable Gateway on startup:   <pre><code>sudo systemctl daemon-reload\nsudo systemctl enable graviteeio-apim-gateway\n</code></pre></li> <li>Start Gateway:   <pre><code>sudo systemctl start graviteeio-apim-gateway\n</code></pre></li> <li>Verify:   <pre><code>sudo journalctl -f\n</code></pre>     Follow along with the startup process. If any of the prerequisites     is missing, this is were you\u2019ll get error messages.     You can also see the same in <code>/opt/graviteeio/apim/gateway/logs/gravitee.log</code>.</li> <li>Verify some more:   <pre><code>sudo ss -lntp '( sport = 8082 )'\n</code></pre>     You should see that there\u2019s a process listening on that port.</li> <li>Verify some more still:   <pre><code>curl -X GET http://localhost:8082/\n</code></pre>     If the installation is successful this returns: No context-path     matches the request URI.</li> </ol>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-gateway/#instructions","tags":["APIM","Installation","APIM component","Amazon","Gateway"]},{"title":"Next steps","text":"<p>The next step is installing the Gravitee APIM REST API.</p>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-gateway/#next-steps","tags":["APIM","Installation","APIM component","Amazon","Gateway"]},{"title":"APIM Installation Guide - Amazon Linux","text":"","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-introduction/","tags":["APIM","Installation","Introduction","Amazon"]},{"title":"Options","text":"<p>There are three ways to go about this:</p> <ul> <li> <p>Step by step</p> <p>Excellent choice! The path for you is:</p> <ul> <li>Install the prerequisites one by one - start here</li> <li>Install the Gravitee APIM components one by one, start here</li> </ul> </li> <li> <p>Gravitee APIM fast track</p> <p>Great choice! The path for you is:</p> <ul> <li>Install the prerequisites one by one - start here</li> <li>Install all of the Gravitee APIM components in one go</li> </ul> </li> <li> <p>Full stack</p> <p>Fantastic choice! The path for you is:</p> <ul> <li>Provision a machine (check here for the specifications)</li> <li>Install prerequisites and the Gravitee APIM components in one go</li> </ul> </li> </ul>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-introduction/#options","tags":["APIM","Installation","Introduction","Amazon"]},{"title":"Fixing a known post-installation issue","text":"","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-issue/","tags":["APIM","Installation","Known issue","Fix"]},{"title":"Known issue description","text":"<p>There is currently a known issue in the Portal UI configuration. After installation, the <code>baseURL</code> in <code>/opt/graviteeio/apim/portal-ui/assets/config.json</code> is incorrect, as shown below:</p> <p></p>  <p>Note</p> <p>Obviously your actual IP will differ from the one shown in this example.</p>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-issue/#known-issue-description","tags":["APIM","Installation","Known issue","Fix"]},{"title":"Fix","text":"<p>To fix this issue:</p> <ol> <li>Remove the http://localhost:8083 from the <code>baseURL</code>:   <pre><code>sudo perl -pi -e 's/\"baseURL\": \"http:\\/\\/localhost:8083/\"baseURL\": \"/g' /opt/graviteeio/apim/portal-ui/assets/config.json\n</code></pre></li> <li>Restart Nginx:   <pre><code>sudo systemctl restart nginx\n</code></pre></li> </ol>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-issue/#fix","tags":["APIM","Installation","Known issue","Fix"]},{"title":"Install Management UI","text":"","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-management-ui/","tags":["APIM","Installation","Introduction"]},{"title":"Prerequisites","text":"<ul> <li>Machine up and running</li> <li>Gravitee YUM repository added</li> <li>Gravitee APIM REST API installed and running</li> <li>Nginx installed</li> </ul>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-management-ui/#prerequisites","tags":["APIM","Installation","Introduction"]},{"title":"Security group","text":"<ul> <li>open port 8084</li> </ul>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-management-ui/#security-group","tags":["APIM","Installation","Introduction"]},{"title":"Instructions","text":"<ol> <li>Install Management UI:   <pre><code>sudo yum install graviteeio-apim-management-ui-3x -y\n</code></pre></li> <li>Restart Nginx:   <pre><code>sudo systemctl restart nginx\n</code></pre></li> <li>Verify:   <pre><code>sudo ss -lntp '( sport = 8084 )'\n</code></pre>     You should see that there\u2019s a process listening on that port.</li> </ol>  <p>Note</p> <p>The Management UI package does not provide its own service. It provides:</p> <ul> <li>A javascript application that can be found at <code>/opt/graviteeio/apim/management-ui</code>.</li> <li>An Nginx configuration that can be found at <code>/etc/nginx/conf.d/graviteeio-apim-management-ui.conf</code>.</li> </ul>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-management-ui/#instructions","tags":["APIM","Installation","Introduction"]},{"title":"Next steps","text":"<p>The next step is installing the Gravitee APIM Portal UI.</p>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-management-ui/#next-steps","tags":["APIM","Installation","Introduction"]},{"title":"Install Portal UI","text":"","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-portal-ui/","tags":["APIM","Installation","Introduction"]},{"title":"Prerequisites","text":"<ul> <li>Machine up and running</li> <li>Gravitee YUM repository added</li> <li>Gravitee APIM REST API installed and running</li> <li>Nginx installed</li> </ul>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-portal-ui/#prerequisites","tags":["APIM","Installation","Introduction"]},{"title":"Security group","text":"<ul> <li>open port 8085</li> </ul>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-portal-ui/#security-group","tags":["APIM","Installation","Introduction"]},{"title":"Instructions","text":"<ol> <li>Install Portal UI:   <pre><code>sudo yum install graviteeio-apim-portal-ui-3x -y\n</code></pre></li> <li>Restart Nginx:   <pre><code>sudo systemctl restart nginx\n</code></pre></li> <li>Fix an issue. There is a known issue with the Portal UI configuration. You can find a fix here.</li> <li>Verify:   <pre><code>sudo ss -lntp '( sport = 8085 )'\n</code></pre>     You should see that there\u2019s a process listening on that port.</li> </ol>  <p>Note</p> <p>The Portal UI package does not provide its own service. It provides: - A javascript application that can be found at <code>/opt/graviteeio/apim/portal-ui</code>. - An Nginx configuration that can be found at <code>/etc/nginx/conf.d/graviteeio-apim-portal-ui.conf</code>.</p>  <p>Congratulations, you have a fully functional Gravitee APIM!</p>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-portal-ui/#instructions","tags":["APIM","Installation","Introduction"]},{"title":"Prerequisite - Install Elasticsearch","text":"","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-prerequisite-elasticsearch/","tags":["APIM","Installation","Prerequisites","Amazon","Elasticsearch"]},{"title":"Overview","text":"<p>Gravitee APIM uses Elasticsearch as a default reporting and analytics repository. Follow the instructions below to set up Elasticsearch.</p> <p>For more information, see the Elasticsearch installation documentation.</p>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-prerequisite-elasticsearch/#overview","tags":["APIM","Installation","Prerequisites","Amazon","Elasticsearch"]},{"title":"Instructions","text":"<ol> <li>Create a file called <code>/etc/yum.repos.d/elasticsearch.repo</code>:</li> </ol> <pre><code>  sudo tee -a /etc/yum.repos.d/elasticsearch.repo &lt;&lt;EOF\n  [elasticsearch]\n  name=Elasticsearch repository for 7.x packages\n  baseurl=https://artifacts.elastic.co/packages/7.x/yum\n  gpgcheck=1\n  gpgkey=https://artifacts.elastic.co/GPG-KEY-elasticsearch\n  enabled=0\n  autorefresh=1\n  type=rpm-md\n  EOF\n</code></pre> <ol> <li>Install Elasticsearch:</li> </ol> <pre><code>  sudo yum install --enablerepo=elasticsearch elasticsearch -y\n</code></pre> <ol> <li>Enable Elasticsearch on startup:</li> </ol> <pre><code>  sudo systemctl daemon-reload\n  sudo systemctl enable elasticsearch.service\n</code></pre> <ol> <li>Start Elasticsearch:</li> </ol> <pre><code>sudo systemctl start elasticsearch.service\n</code></pre> <ol> <li>Verify:</li> </ol> <pre><code>  sudo ss -lntp '( sport = 9200 )'\n</code></pre> <p>You should see that there is a process listening on that port.</p>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-prerequisite-elasticsearch/#instructions","tags":["APIM","Installation","Prerequisites","Amazon","Elasticsearch"]},{"title":"Next steps","text":"<p>The next step is installing Nginx.</p>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-prerequisite-elasticsearch/#next-steps","tags":["APIM","Installation","Prerequisites","Amazon","Elasticsearch"]},{"title":"Overview","text":"<p>Running the Gravitee APIM components requires a Java 11 JRE. To set it up, follow the instructions below.</p>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-prerequisite-java/","tags":["APIM","Installation","Prerequisites","Amazon","Java"]},{"title":"Instructions","text":"<ol> <li>Enable the repository that contains java:</li> </ol> <pre><code>  sudo amazon-linux-extras enable java-openjdk11\n</code></pre> <ol> <li>Install Java:</li> </ol> <pre><code>  sudo yum install java-11-openjdk -y\n</code></pre> <ol> <li>Verify:</li> </ol> <pre><code>  java -version\n</code></pre>  <p>Note</p> <p>You don\u2019t have to go for this particular implementation of openjdk, as long as you have a decent uncrippled Java 11 JRE it\u2019s fine!</p>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-prerequisite-java/#instructions","tags":["APIM","Installation","Prerequisites","Amazon","Java"]},{"title":"Next steps","text":"<p>The next step is installing MongoDB.</p>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-prerequisite-java/#next-steps","tags":["APIM","Installation","Prerequisites","Amazon","Java"]},{"title":"Prerequisite - Machine","text":"","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-prerequisite-machine/","tags":["APIM","Installation","Prerequisites","Amazon","Machine"]},{"title":"Amazon instance specification","text":"<ul> <li> <p>Instance Type : t2.medium</p> </li> <li> <p>Storage : Increase the root volume size to 40GB</p> </li> <li> <p>Security Groups : SSH access is sufficient for now</p> </li> </ul>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-prerequisite-machine/#amazon-instance-specification","tags":["APIM","Installation","Prerequisites","Amazon","Machine"]},{"title":"Next steps","text":"<p>The next steps are setting up the Gravitee YUM repository and installing the Gravitee APIM full stack.</p>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-prerequisite-machine/#next-steps","tags":["APIM","Installation","Prerequisites","Amazon","Machine"]},{"title":"Prerequisite - Install MongoDB","text":"","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-prerequisite-mongodb/","tags":["APIM","Installation","Prerequisites","Amazon","MongoDB"]},{"title":"Overview","text":"<p>Gravitee APIM uses MongoDB as its default repository to store global configurations. Follow the instructions below to set up MongoDB.</p> <p>For more information, see the MongoDB Installation documentation.</p>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-prerequisite-mongodb/#overview","tags":["APIM","Installation","Prerequisites","Amazon","MongoDB"]},{"title":"Instructions","text":"<ol> <li>Create a file called <code>/etc/yum.repos.d/mongodb-org-3.6.repo</code>:</li> </ol> <pre><code>  sudo tee -a /etc/yum.repos.d/graviteeio.repo &lt;&lt;EOF\n  [mongodb-org-3.6]\n  name=MongoDB Repository\n  baseurl=https://repo.mongodb.org/yum/amazon/2013.03/mongodb-org/3.6/x86_64/\n  gpgcheck=1\n  enabled=1\n  gpgkey=https://www.mongodb.org/static/pgp/server-3.6.asc\n  EOF\n</code></pre> <ol> <li>Install MongoDB:</li> </ol> <pre><code>  sudo yum install mongodb-org -y\n</code></pre> <ol> <li>Enable MongoDB on startup:</li> </ol> <pre><code>  sudo systemctl daemon-reload\n  sudo systemctl enable mongod\n</code></pre> <ol> <li>Start MongoDB:</li> </ol> <pre><code>  sudo systemctl start mongod\n</code></pre> <ol> <li>Verify:</li> </ol> <pre><code>sudo ss -lntp '( sport = 27017 )'\n</code></pre> <p>You should see that there is a process listening on that port.</p>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-prerequisite-mongodb/#instructions","tags":["APIM","Installation","Prerequisites","Amazon","MongoDB"]},{"title":"Next steps","text":"<p>The next step is installing Elasticsearch.</p>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-prerequisite-mongodb/#next-steps","tags":["APIM","Installation","Prerequisites","Amazon","MongoDB"]},{"title":"Prerequisite - Install Nginx","text":"","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-prerequisite-nginx/","tags":["APIM","Installation","Prerequisites","Amazon","Nginx"]},{"title":"Overview","text":"<p>Both Gravitee APIM user interfaces (console and developer portal) use Nginx as their webserver. Follow the instructions below to set up Nginx.</p> <p>For more information, see the Nginx Installation documentation.</p>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-prerequisite-nginx/#overview","tags":["APIM","Installation","Prerequisites","Amazon","Nginx"]},{"title":"Instructions","text":"<ol> <li>Create a file called <code>/etc/yum.repos.d/nginx.repo</code>:</li> </ol> <pre><code>  sudo tee -a /etc/yum.repos.d/nginx.repo &lt;&lt;EOF\n  [nginx-stable]\n  name=nginx stable repo\n  baseurl=http://nginx.org/packages/amzn2/\\$releasever/\\$basearch/\n  gpgcheck=1\n  enabled=1\n  gpgkey=https://nginx.org/keys/nginx_signing.key\n  module_hotfixes=true\n  EOF\n</code></pre> <ol> <li>Install Nginx:</li> </ol> <pre><code>  sudo yum install nginx -y\n</code></pre> <ol> <li>Enable Nginx on startup:</li> </ol> <pre><code>  sudo systemctl daemon-reload\n  sudo systemctl enable nginx\n</code></pre> <ol> <li>Start Nginx:</li> </ol> <pre><code>  sudo systemctl start nginx\n</code></pre> <ol> <li>Verify:</li> </ol> <pre><code>  sudo ss -lntp '( sport = 80 )'\n</code></pre> <p>You should see that there is a process listening on that port.</p>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-prerequisite-nginx/#instructions","tags":["APIM","Installation","Prerequisites","Amazon","Nginx"]},{"title":"Next steps","text":"<p>You are done with the prerequisites!</p> <p>The next steps are installing the Gravitee APIM Gateway and installing all the Gravitee APIM components.</p>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-prerequisite-nginx/#next-steps","tags":["APIM","Installation","Prerequisites","Amazon","Nginx"]},{"title":"Prerequisites - Setup Gravitee YUM repository","text":"","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-prerequisite-yum/","tags":["APIM","Installation","Prerequisites","Amazon","YUM repository"]},{"title":"Overview","text":"<p>Amazon Linux instances use the package manager <code>yum</code> to manage the softwares on the instances. Gravitee provides a repository with the major components of the API Manager. Follow below instructions to set up the access to that repository.</p>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-prerequisite-yum/#overview","tags":["APIM","Installation","Prerequisites","Amazon","YUM repository"]},{"title":"Instructions","text":"<ol> <li>Create a file called <code>/etc/yum.repos.d/graviteeio.repo</code>:</li> </ol> <pre><code>  sudo tee -a /etc/yum.repos.d/graviteeio.repo &lt;&lt;EOF\n  [graviteeio]\n  name=graviteeio\n  baseurl=https://packagecloud.io/graviteeio/rpms/el/7/\\$basearch\n  gpgcheck=0\n  enabled=1\n  gpgkey=https://packagecloud.io/graviteeio/rpms/gpgkey\n  sslverify=1\n  sslcacert=/etc/pki/tls/certs/ca-bundle.crt\n  metadata_expire=300\n  EOF\n</code></pre> <ol> <li> <p>Enable GPG signature handling (required by some of our RPM     packages):</p> <pre><code>    sudo yum install pygpgme yum-utils -y\n</code></pre>  <p>Note</p> <p>These packages are already in place on most Amazon Linux instances.</p>  </li> <li> <p>Refresh the local cache:</p> </li> </ol> <pre><code>      sudo yum -q makecache -y --disablerepo='*' --enablerepo='graviteeio'\n</code></pre>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-prerequisite-yum/#instructions","tags":["APIM","Installation","Prerequisites","Amazon","YUM repository"]},{"title":"Next steps","text":"<p>The next step is installing a Java 11 jre.</p>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-prerequisite-yum/#next-steps","tags":["APIM","Installation","Prerequisites","Amazon","YUM repository"]},{"title":"Install REST API","text":"","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-rest-api/","tags":["APIM","Installation","Prerequisites","Amazon","REST API"]},{"title":"Prerequisites","text":"<ul> <li>Machine up and running</li> <li>Gravitee YUM repository added</li> <li>Java 11 jre installed</li> <li>MongoDB installed and running</li> <li>Elasticsearch installed and running</li> </ul>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-rest-api/#prerequisites","tags":["APIM","Installation","Prerequisites","Amazon","REST API"]},{"title":"Security group","text":"<ul> <li>open port 8083</li> </ul>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-rest-api/#security-group","tags":["APIM","Installation","Prerequisites","Amazon","REST API"]},{"title":"Instructions","text":"<ol> <li>Install REST API:   <pre><code>sudo yum install graviteeio-apim-rest-api-3x -y\n</code></pre></li> <li>Enable REST API on startup:   <pre><code>sudo systemctl daemon-reload\nsudo systemctl enable graviteeio-apim-rest-api\n</code></pre></li> <li>Start REST API:   <pre><code>sudo systemctl start graviteeio-apim-rest-api\n</code></pre></li> <li>Verify:   <pre><code>sudo journalctl -f\n</code></pre>     Follow along with the startup process. If any of the prerequisites is missing, this is were you\u2019ll get error messages. You can also see the same in <code>/opt/graviteeio/apim/rest-api/logs/gravitee.log</code>.</li> <li>Verify some more:   <pre><code>sudo ss -lntp '( sport = 8083 )'\n</code></pre>     You should see that there\u2019s a process listening on that port.</li> <li>Verify some more still:   <pre><code>curl -X GET http://localhost:8083/management/organizations/DEFAULT/console\ncurl -X GET http://localhost:8083/portal/environments/DEFAULT/apis\n</code></pre>     If the installation is successful both of these return a json     document.</li> </ol>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-rest-api/#instructions","tags":["APIM","Installation","Prerequisites","Amazon","REST API"]},{"title":"Next steps","text":"<p>The next step is installing the Gravitee APIM Management UI.</p>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-rest-api/#next-steps","tags":["APIM","Installation","Prerequisites","Amazon","REST API"]},{"title":"Full stack installation","text":"","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-stack/","tags":["APIM","Installation","Prerequisites","Amazon","REST API"]},{"title":"Prerequisites","text":"<ul> <li>Machine up and running</li> </ul>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-stack/#prerequisites","tags":["APIM","Installation","Prerequisites","Amazon","REST API"]},{"title":"Security group","text":"<ul> <li>open port 8082</li> <li>open port 8083</li> <li>open port 8084</li> <li>open port 8085</li> </ul>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-stack/#security-group","tags":["APIM","Installation","Prerequisites","Amazon","REST API"]},{"title":"Instructions","text":"<ol> <li>Install all the prerequisites and Gravitee APIM components:   <pre><code>curl -L https://bit.ly/install-apim-3x | sudo bash\n</code></pre></li> <li>Fix a known post-installation issue. There is a known issue with the Portal UI configuration. You can     find a fix here.</li> <li>Verify:   <pre><code>sudo ss -lntp '( sport = 9200 )'\nsudo ss -lntp '( sport = 27017 )'\nsudo ss -lntp '( sport = 8082 )'\nsudo ss -lntp '( sport = 8083 )'\nsudo ss -lntp '( sport = 8084 )'\nsudo ss -lntp '( sport = 8085 )'\n</code></pre>     You should see that there are processes listening on those ports.</li> <li>Verify some more:   <pre><code>curl -X GET http://localhost:8082/\ncurl -X GET http://localhost:8083/management/organizations/DEFAULT/console\ncurl -X GET http://localhost:8083/portal/environments/DEFAULT/apis\n</code></pre>     If the installation is successful the first one returns: No context-path matches the request URI. The others return a json structure.</li> </ol> <p>Congratulations, you have a fully functional Gravitee APIM!</p>","location":"apim/installation-guide/amazon-linux/installation-guide-amazon-stack/#instructions","tags":["APIM","Installation","Prerequisites","Amazon","REST API"]},{"title":"Overview","text":"<p>The following sections explain how to configure the following aspects of APIM after installation:</p> <ul> <li> <p>Components</p> </li> <li> <p>Repositories</p> </li> <li> <p>Authentication</p> </li> <li> <p>Notifications</p> </li> </ul> <p>See also:</p> <ul> <li>link:{{ /apim/3.x/apim_how_to_configuration.html |     relative_url }}[How to configure a production-ready APIM     environment^]</li> </ul>","location":"apim/installation-guide/configuration/configuration-guide/"},{"title":"Overview","text":"<p>Caches are used to store different types of data in APIM.</p> <p>They use a Hazelcast^ implementation. You can tune the configuration in the <code>hazelcast.xml</code> file.</p>","location":"apim/installation-guide/configuration/installation-guide-cache/"},{"title":"Default configuration","text":"<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n\n&lt;hazelcast xmlns=\"http://www.hazelcast.com/schema/config\"\n           xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n           xsi:schemaLocation=\"http://www.hazelcast.com/schema/config\n           http://www.hazelcast.com/schema/config/hazelcast-config-4.1.xsd\"&gt;\n\n    &lt;network&gt;\n        &lt;join&gt;\n            &lt;!-- Auto-detection and multicast are disabled by default to avoid latency when starting local / standalone  gateway --&gt;\n            &lt;auto-detection enabled=\"false\"/&gt;\n            &lt;multicast enabled=\"false\" /&gt;\n        &lt;/join&gt;\n    &lt;/network&gt;\n\n    &lt;map name=\"apikeys\"&gt;\n        &lt;!-- Eviction is managed programmatically--&gt;\n        &lt;eviction eviction-policy=\"NONE\" size=\"0\"&gt;&lt;/eviction&gt;\n    &lt;/map&gt;\n\n    &lt;map name=\"subscriptions\"&gt;\n        &lt;!-- Eviction is managed programmatically--&gt;\n        &lt;eviction eviction-policy=\"NONE\" size=\"0\"&gt;&lt;/eviction&gt;\n    &lt;/map&gt;\n\n    &lt;map name=\"apis\"&gt;\n        &lt;!-- Eviction is managed programmatically--&gt;\n        &lt;eviction eviction-policy=\"NONE\" size=\"0\"&gt;&lt;/eviction&gt;\n    &lt;/map&gt;\n&lt;/hazelcast&gt;\n</code></pre> <p>Be careful when modifying the default configuration, it is designed with performance in mind.</p> <p>By default, the configuration contains 3 maps to cache API keys, subscriptions and APIs. These caches can be shared between nodes if you configure hazelcast to be able to contact the other nodes. There are multiple ways to configure hazelcast networking depending on your installation (regular VMs, Kubernetes, AWS, \u2026). The simplest way is enabling multicast:</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n\n&lt;hazelcast xmlns=\"http://www.hazelcast.com/schema/config\"\n           xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n           xsi:schemaLocation=\"http://www.hazelcast.com/schema/config\n           http://www.hazelcast.com/schema/config/hazelcast-config-4.1.xsd\"&gt;\n\n    &lt;network&gt;\n        &lt;join&gt;\n            &lt;auto-detection enabled=\"false\"/&gt;\n            &lt;!-- Enable multicast to allow hazelcast discovers other nodes --&gt;\n            &lt;multicast enabled=\"true\" /&gt;\n        &lt;/join&gt;\n    &lt;/network&gt;\n&lt;/hazelcast&gt;\n</code></pre> <p>You can find more information in the Hazelcast documentation^, also if you need to configure Hazelcast as cluster.</p> <p>We currently not recommend to enable the distribution mode with Hazelcast unless there are real needs to do so.</p> <p>We recommend to leave with the default configuration which works in standalone mode.</p> <p>The distribution mode is not relevant for most of usecases.</p>","location":"apim/installation-guide/configuration/installation-guide-cache/#default-configuration"},{"title":"How are cache resources managed in APIM?","text":"<p>API publishers can create cache resources:</p> <ul> <li> <p>to cache upstream of a response with the link:{{     /apim/3.x/apim_policies_cache.html | relative_url }}[Cache     policy^].</p> </li> <li> <p>to cache access tokens with the link:{{     /apim/3.x/apim_policies_oauth2.html | relative_url }}[OAuth2     policy^].</p> </li> </ul> <p>Default distribution comes with link:{{ /apim/3.x/apim_resources_cache.html | relative_url }}[Gravitee Resource Cache]. This plugin stores content in memory and is locally managed on each gateway node of the installation.</p> <p>Configuration of cache resources cannot be managed using the <code>hazelcast.xml</code> file. The configuration is directly defined on the cache resource. See link:{{ /apim/3.x/apim_resources_cache.html | relative_url }}[Resource Cache^].</p>","location":"apim/installation-guide/configuration/installation-guide-cache/#how-are-cache-resources-managed-in-apim"},{"title":"Need a persistent cache ?","text":"<p>Since 3.10, we provide a new link:{{ /apim/3.x/apim_resources_cache_redis.html | relative_url }}[Gravitee Resource Cache Redis] based on Redis. This plugin is not in distribution by default, but you can download plugin and follow link:{{ /apim/3.x/apim_installguide_docker_customize.html#install_an_additional_plugin | relative_url }}[instructions] to install it.</p>","location":"apim/installation-guide/configuration/installation-guide-cache/#need-a-persistent-cache"},{"title":"Overview","text":"<p>You can define dictionaries in APIM to reuse sets of properties in APIs. While API Publishers can create properties for their own APIs, dictionaries provide a way to manage properties independently of individual APIs, making it possible to apply them across APIs and maintain them globally by a different user profile, such as an administrator.</p> <p>Dictionary properties are based on key-value pairs. You can create two types of dictionaries:</p> <ul> <li> <p>Manual dictionaries, with static properties defined manually at     dictionary creation time</p> </li> <li> <p>Dynamic dictionaries, with properties updated continually, based on     a schedule and source URL defined at dictionary creation time</p> </li> </ul> <p>Dictionaries need to be deployed to APIM Gateway before you can use them. You can see the date and time the dictionary was last deployed in the dictionary list:</p> <p>image:{% link images/apim/3.x/installation/configuration/configure-dict-list.png %}[]</p> <p>You can access dictionary properties using the link:{{ /apim/3.x/apim_publisherguide_expression_language.html | relative_url }}[Expression Language^] <code>#dictionaries</code> statement.</p> <p>See also: link:{{ /apim/3.x/apim_publisherguide_design_studio_create.html#api-properties | relative_url }}[Define properties for your API flows^].</p>","location":"apim/installation-guide/configuration/installation-guide-configuration-dictionaries/"},{"title":"How are dictionaries used?","text":"<p>You can use dictionaries anywhere in APIM where link:{{ /apim/3.x/apim_publisherguide_expression_language.html | relative_url }}[Gravitee Expression Language^] is supported, such as when defining policies for API flows. You can access dictionary properties with the Expression Language statement <code>#dictionaries</code>.</p>","location":"apim/installation-guide/configuration/installation-guide-configuration-dictionaries/#how-are-dictionaries-used"},{"title":"Create a new dictionary","text":"<ol> <li> <p>Click Settings &gt; Dictionaries.</p> </li> <li> <p>Click the plus icon images:icons/plus-icon.png[role=\"icon\"].</p> </li> <li> <p>Enter a name and description for the dictionary.</p> </li> <li> <p>Select a Manual or Dynamic dictionary type.</p> </li> </ol>","location":"apim/installation-guide/configuration/installation-guide-configuration-dictionaries/#create-a-new-dictionary"},{"title":"Create a manual dictionary","text":"<p>Your manual dictionary is not available until you click DEPLOY.</p> <ol> <li> <p>Click CREATE, then specify the properties for the dictionary as     key-value pairs.</p> </li> <li> <p>Click SAVE PROPERTIES when you are done, and DEPLOY to     deploy your dictionary to APIM Gateway.</p> </li> </ol>","location":"apim/installation-guide/configuration/installation-guide-configuration-dictionaries/#create-a-manual-dictionary"},{"title":"Create a dynamic dictionary","text":"<p>Your dynamic dictionary does not start updating properties until you click START.</p> <ol> <li> <p>Specify the schedule for the trigger to create dynamic properties.</p> </li> <li> <p>In the Provider section, specify the details of the source of     the properties:</p> <ul> <li> <p>A Type of Custom (HTTP).</p> </li> <li> <p>The URL and method of the API providing the properties.</p> </li> <li> <p>The request body.</p> </li> <li> <p>One or more HTTP headers.</p> </li> <li> <p>The transformation to apply to the response, in JOLT format.</p> </li> </ul> </li> <li> <p>Click CREATE to create the dictionary.</p> </li> <li> <p>When you are ready to begin retrieving the dynamic properties, click     START.</p> <p>APIM retrieves the properties at the interval defined and lists them in the Properties section.</p> </li> <li> <p>Select any properties you want to delete and click DELETE.</p> </li> <li> <p>Click DEPLOY when you are ready to deploy your dictionary to     APIM Gateway.</p> </li> </ol> <p>The following example creates a list of properties based on extracting the names and versions from the JSON at the defined URL and assigning them to the property keys and values:</p> <p>image:{% link images/apim/3.x/installation/configuration/configure-dict-dynamic-property-def.png %}[]</p> <p>When you click START, the properties are added to the list according to the defined schedule:</p> <p>image:{% link images/apim/3.x/installation/configuration/configure-dict-dynamic-property-list.png %}[]</p>","location":"apim/installation-guide/configuration/installation-guide-configuration-dictionaries/#create-a-dynamic-dictionary"},{"title":"Overview","text":"<p>APIM includes three categories of notifications:</p> <ul> <li> <p>Portal\u2009\u2014\u2009notifications about the platform</p> </li> <li> <p>API\u2009\u2014\u2009notifications about a specific API</p> </li> <li> <p>Application\u2009\u2014\u2009notifications about a specific application</p> </li> </ul> <p>There are also three types of notifiers:</p> <ul> <li> <p>Portal\u2009\u2014\u2009this is the default notifier; messages are sent to     users logged in to APIM Portal</p> </li> <li> <p>Email\u2009\u2014\u2009you can configure an email notifier to send messages to     a specific list of email addresses</p> </li> <li> <p>Webhook\u2009\u2014\u2009you can configure a webhook notifier to send an HTTP     POST request to a specific URL</p> </li> </ul> <p>APIM includes a standard set of notifiers. You can also create new notifiers. For more details, see ???.</p>","location":"apim/installation-guide/configuration/installation-guide-configuration-notifications/"},{"title":"Subscribe to Portal notifications","text":"<p>To subscribe to Portal notifications:</p> <ol> <li> <p>In APIM Console, click Settings &gt; Notifications.</p> <p>image:{% link images/apim/3.x/installation/notification/graviteeio-installation-configuration-notifications-subscriptions-portal.png %}[Subscribe to portal notifications]</p> </li> <li> <p>Select the required notifications. For details, see Portal     notifications.</p> </li> <li> <p>Click SAVE.</p> </li> </ol>","location":"apim/installation-guide/configuration/installation-guide-configuration-notifications/#subscribe-to-portal-notifications"},{"title":"Subscribe to API notifications","text":"<p>To subscribe to notifications about a specific API:</p> <ol> <li> <p>In APIM Console, click APIs.</p> </li> <li> <p>Select the API and click Notifications.</p> <p>image:{% link images/apim/3.x/installation/notification/graviteeio-installation-configuration-notifications-subscriptions-api.png %}[Subscribe to API notifications]</p> </li> <li> <p>Select the required notifications. For details, see API     notifications.</p> </li> <li> <p>Click SAVE.</p> </li> </ol>","location":"apim/installation-guide/configuration/installation-guide-configuration-notifications/#subscribe-to-api-notifications"},{"title":"Subscribe to application notifications","text":"<p>To subscribe to notifications about a specific application:</p> <ol> <li> <p>In APIM Console, click Applications.</p> </li> <li> <p>Select the application and click Notifications.</p> <p>image:{% link images/apim/3.x/installation/notification/graviteeio-installation-configuration-notifications-subscriptions-application.png %}[Subscribe to application notifications]</p> </li> <li> <p>Select the required notifications. For details, see Application     notifications.</p> </li> <li> <p>Click SAVE.</p> </li> </ol>","location":"apim/installation-guide/configuration/installation-guide-configuration-notifications/#subscribe-to-application-notifications"},{"title":"Categories of notifications","text":"","location":"apim/installation-guide/configuration/installation-guide-configuration-notifications/#categories-of-notifications"},{"title":"Portal notifications","text":"<p>Name</p> <p>What triggers it?</p>   <p>First Login</p> <p>User logs in for the first time</p>   <p>Group invitation</p> <p>User is invited in a group</p>   <p>Message</p> <p>Custom message needs to be sent to an Environment Role (the message is sent in the notification)</p>   <p>New Support Ticket</p> <p>New support ticket is created</p>   <p>Password Reset</p> <p>Password is reset</p>   <p>User Created</p> <p>New user is created</p>   <p>User Registered</p> <p>User is registered</p>   <p>User Registration Request</p> <p>New user is created and automatic validation is disabled</p>","location":"apim/installation-guide/configuration/installation-guide-configuration-notifications/#portal-notifications"},{"title":"API notifications","text":"<p>Name</p> <p>What triggers it?</p>   <p>Accept API review</p> <p>API review is accepted</p>   <p>API Deprecated</p> <p>API is deprecated</p>   <p>API key Expired</p> <p>API key is expired</p>   <p>API key Renewed</p> <p>API key is renewed</p>   <p>API key Revoked</p> <p>API key is revoked</p>   <p>API Started</p> <p>API is started</p>   <p>API Stopped</p> <p>API is stopped</p>   <p>Ask for API review</p> <p>API is ready for review</p>   <p>Message</p> <p>Custom message needs to be sent to an Application Role (the message is sent in the notification)</p>   <p>New Rating</p> <p>New rating is submitted</p>   <p>New Rating Answer</p> <p>New answer is submitted</p>   <p>New Subscription</p> <p>Subscription is created</p>   <p>New Support Ticket</p> <p>New support ticket is created</p>   <p>Reject API review</p> <p>API review is rejected</p>   <p>Subscription Accepted</p> <p>Subscription is accepted</p>   <p>Subscription Closed</p> <p>Subscription is closed</p>   <p>Subscription Paused</p> <p>Subscription is paused</p>   <p>Subscription Rejected</p> <p>Subscription is rejected</p>   <p>Subscription Resumed</p> <p>Subscription is resumed</p>   <p>Subscription Transferred</p> <p>Subscription is transferred</p>","location":"apim/installation-guide/configuration/installation-guide-configuration-notifications/#api-notifications"},{"title":"Application notifications","text":"<p>Name</p> <p>What triggers it?</p>   <p>New Subscription</p> <p>Subscription is created</p>   <p>New Support Ticket</p> <p>New support ticket is created</p>   <p>Subscription Accepted</p> <p>Subscription is accepted</p>   <p>Subscription Closed</p> <p>Subscription is closed</p>   <p>Subscription Paused</p> <p>Subscription is paused</p>   <p>Subscription Rejected</p> <p>Subscription is rejected</p>   <p>Subscription Resumed</p> <p>Subscription is resumed</p>   <p>Subscription Transferred</p> <p>Subscription is transferred</p>","location":"apim/installation-guide/configuration/installation-guide-configuration-notifications/#application-notifications"},{"title":"Notifiers","text":"","location":"apim/installation-guide/configuration/installation-guide-configuration-notifications/#notifiers"},{"title":"Portal","text":"<p>The Portal notifier sends messages to logged in users. Notifications can be displayed by clicking the bell icon in the top menu of APIM Console.</p> <p>image::{% link images/apim/3.x/installation/notification/graviteeio-installation-configuration-notifications-portal-notifier-console.png %}[Notifications in the APIM Administration console, 300]</p> <p>In APIM Portal, notifications are displayed in a specific page, accessible from the user menu.</p> <p>image::{% link images/apim/3.x/installation/notification/graviteeio-installation-configuration-notifications-portal-notifier-portal.png %}[Notifications in the developer portal]</p> <p>The templates of portal notifications can be customized in Settings. For more information, see ???.</p>","location":"apim/installation-guide/configuration/installation-guide-configuration-notifications/#portal"},{"title":"Email","text":"<p>Email notifiers send an email to a specific list of email addresses. To create a new email notifier:</p> <ol> <li> <p>Click the plus icon image:{% link images/icons/plus-icon.png     %}[role=\"icon\"] .</p> </li> <li> <p>Choose the Default Email Notifier type and give your notifier a     name.</p> </li> <li> <p>Add one or more email addresses.</p> </li> <li> <p>Subscribe to the notifications you want.</p> </li> </ol> <p>When you create an API, a default email notifier is created. All notifications are selected and email are send to the primary owner.</p> <p>image::{% link images/apim/3.x/installation/notification/graviteeio-installation-configuration-notifications-email-notifier-api.png %}[Default configuration of an email notifier]</p> <p>The templates of email notifications can be customized in Settings. See ???</p>","location":"apim/installation-guide/configuration/installation-guide-configuration-notifications/#email"},{"title":"Webhook","text":"<p>Webhook notifiers send an HTTP POST request to a configured URL. The request contains two headers and a JSON body that represents the message. Headers are:</p> <ul> <li> <p><code>X-Gravitee-Event</code>\u2009\u2014\u2009contains the event id (e.g. <code>API_KEY_REVOKED</code>)</p> </li> <li> <p><code>X-Gravitee-Event-Scope</code>\u2009\u2014\u2009contains the category of the notification     (e.g. <code>API</code>)</p> </li> </ul> <p>The JSON body looks like this (depending on the category of the notification, some fields may not be present in the body): ```json { \"event\": \"\", \"scope\": \"\", \"api\": { \"id\": \"\", \"name\": \"\", \"version\": \"\" }, \"application\": { \"id\": \"\", \"name\": \"\" }, \"owner\": { \"id\": \"\", \"username\": \"\", \"owner\": \"\" }, \"plan\": { \"id\": \"\", \"name\": \"\", \"security\": \"\", \"plan\": \"\" }, \"subscription\": { \"id\": \"\", \"status\": \"\", \"subscription\": \"\" } } ```</p> <p>To create a new webhook notifier:</p> <ol> <li> <p>Click the plus icon image:{% link images/icons/plus-icon.png     %}[role=\"icon\"] .</p> </li> <li> <p>Choose the Default Webhook Notifier type and give your notifier     a name.</p> </li> <li> <p>Add the URL which APIM will call to send notifications.</p> </li> <li> <p>Subscribe to the notifications you want.</p> </li> </ol>","location":"apim/installation-guide/configuration/installation-guide-configuration-notifications/#webhook"},{"title":"Templates","text":"<p>Email and portal notification templates are based on HTML and YML files. They are located here:</p> <pre><code>templates:\n  path: ${gravitee.home}/templates\n</code></pre> <p>Starting from APIM version 3.4.0, you can override these templates in APIM Console.</p> <p>image::{% link images/apim/3.x/installation/notification/graviteeio-installation-configuration-notifications-templates-1.png %}[Templates edition in the settings]</p> <p>You can also customize:</p> <ul> <li> <p>Email templates that are sent for specific actions and not related     to a notification. Most of the time, these emails are for specific     users.</p> </li> <li> <p>The <code>header.html</code> file that is included by default in all email     templates.</p> </li> </ul> <p>image::{% link images/apim/3.x/installation/notification/graviteeio-installation-configuration-notifications-templates-2.png %}[Specific templates]</p>","location":"apim/installation-guide/configuration/installation-guide-configuration-notifications/#templates"},{"title":"Customize a template","text":"<p>For almost all notifications, you can configure both Portal and email notifications.</p> <p>To customize a template, toggle the switch Override default template and update the title and/or the content.</p> <p>image::{% link images/apim/3.x/installation/notification/graviteeio-installation-configuration-notifications-templates-edition-1.png %}[Portal template edition] image::{% link images/apim/3.x/installation/notification/graviteeio-installation-configuration-notifications-templates-edition-2.png %}[Email template edition]</p>","location":"apim/installation-guide/configuration/installation-guide-configuration-notifications/#customize-a-template"},{"title":"Attributes","text":"<p>You can use Freemarker template engine to add specific information to your templates (e.g. ${user.name} or ${api.metadata[foo-bar]}.</p> <p>Available attributes  </p>            Api Application Group Plan Owner/User Subscription     <p>name</p> <p>name</p> <p>name</p> <p>name</p> <p>username</p> <p>status</p>   <p>description</p> <p>description</p> <p>-</p> <p>description</p> <p>firstname</p> <p>request</p>   <p>version</p> <p>type</p> <p>-</p> <p>order</p> <p>lastname</p> <p>reason</p>   <p>role</p> <p>status</p> <p>-</p> <p>publishedAt (Date)</p> <p>displayName</p> <p>processedAt</p>   <p>metadata (Map)</p> <p>role</p> <p>-</p> <p>closedAt (Date)</p> <p>email</p> <p>startingAt</p>   <p>deployedAt (Date)</p> <p>-</p> <p>-</p> <p>-</p> <p>-</p> <p>endingAt</p>   <p>createdAt (Date)</p> <p>createdAt (Date)</p> <p>createdAt (Date)</p> <p>createdAt (Date)</p> <p>-</p> <p>closedAt</p>   <p>updatedAt (Date)</p> <p>updatedAt (Date)</p> <p>updatedAt (Date)</p> <p>updatedAt (Date)</p> <p>-</p> <p>subscribedAt</p>    <p>An example template is as follows:</p> <pre><code>&lt;html&gt;\n        &lt;body style=\"text-align: center;\"&gt;\n                &lt;header&gt;\n                        &lt;#include \"header.html\" /&gt;\n                &lt;/header&gt;\n                &lt;div style=\"margin-top: 50px; color: #424e5a;\"&gt;\n                        &lt;h3&gt;Hi ${owner.username},&lt;/h3&gt;\n                        &lt;p&gt;The API Key &lt;code&gt;${apiKey}&lt;/code&gt; has been expired.\n                &lt;/p&gt;\n        &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>","location":"apim/installation-guide/configuration/installation-guide-configuration-notifications/#attributes"},{"title":"Overview","text":"<p>This page describes how to configure APIM to allow users to connect using an APIM data source. This is required when you want to allow user registration.</p> <p>You define new users in APIM Console.</p> <p>Passwords are encoded using the BCrypt strong hashing function.</p> <p>To activate this provider, all you need to do is declare it. All data source information is then retrieved from the Management Repository configuration.</p> <pre><code>security:\n  providers:\n    - type: gravitee\n</code></pre>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-apim/"},{"title":"Overview","text":"<p>This page explains how to configure an APIM Portal connection with a GitHub^ account.</p> <p>GitHub authentication requires users to use a public email address to connect to the portal.</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-github/"},{"title":"Create a GitHub OAuth application","text":"<p>Before you can connect to APIM Portal using a GitHub account, you need to create a GitHub application to link to APIM.</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-github/#create-a-github-oauth-application"},{"title":"Create a new GitHub application","text":"<ol> <li> <p>Go to https://github.com/settings/developers.</p> </li> <li> <p>Click OAuth Apps.</p> </li> <li> <p>Click Register an application.</p> <p>image::{% link images/apim/3.x/installation/authentication/github_register_new_app.png %}[Register a new GitHub OAuth apps] . Enter the application details.</p> <p>image::{% link images/apim/3.x/installation/authentication/github_fill_app_form.png %}[Fill the form]</p> <p>The <code>Authorization callback URL</code> must exactly match the domain hosting APIM Portal. . Click Register application.</p> </li> </ol>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-github/#create-a-new-github-application"},{"title":"Retrieve the OAuth2 credentials","text":"<p>After you create the GitHub application, you can retrieve the OAuth2 client ID and secret.</p> <p>image::{% link images/apim/3.x/installation/authentication/github_oauth_credentials.png %}[Get Oauth2 credentials]</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-github/#retrieve-the-oauth2-credentials"},{"title":"Configure APIM","text":"<p>You can configure this provider both in APIM Console and in the <code>gravitee.yml</code> configuration file. Whichever you choose, the configuration is stored in the database. This means that APIM starts using your new configuration as soon as you click the Save button (if configuring in APIM Console) or restart APIM API (if configuring in the configuration file).</p> <p>If you configure the provider in the configuration file and then change the values in APIM Console, all changes are overwritten by the values in the configuration file next time you restart APIM API.</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-github/#configure-apim"},{"title":"APIM Console configuration","text":"<ol> <li> <p>Click Organization Settings &gt; Authentication.</p> </li> <li> <p>Click the plus icon image:{% link images/icons/plus-icon.png     %}[role=\"icon\"] and select the GitHub icon.</p> </li> <li> <p>If you want to use this provider to log in to APIM Portal, ensure     that Allow portal authentication to use this identity provider     is checked. To use it only for APIM Console, uncheck this option.</p> </li> <li> <p>Enter the details of the provider, including the OAuth2 credentials     created in the GitHub OAuth app.</p> <p>image::{% link images/apim/3.x/management-api-configuration-idp/new-github.png %}[Gravitee.io - New Github IDP] . Click CREATE. . Activate the provider for Portal or Console login, as described in link:{{ /apim/3.x/apim_installguide_authentication.html#activating-providers | relative_url }}[Activating providers^].</p> </li> </ol>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-github/#apim-console-configuration"},{"title":"<code>gravitee.yml</code> file configuration","text":"<p>Update the following section of the file with the GitHub OAuth2 app credentials.</p> <pre><code>security:\n  providers:\n    - type: github\n      clientId: xxxx-xxx-xxx-xxx\n      clientSecret: xxxx-xxx-xxx-xxx\n</code></pre>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-github/#graviteeyml-file-configuration"},{"title":"Test the connection","text":"","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-github/#test-the-connection"},{"title":"Log in to APIM Portal","text":"<ol> <li> <p>Click Sign in with GitHub.</p> <p>image::{% link images/apim/3.x/installation/authentication/github_login_form.png %}[Login Form]</p> </li> <li> <p>Allow access to the user account.</p> <p>image::{% link images/apim/3.x/installation/authentication/github_access_account.png %}[Login Form]</p> <p>You have successfully logged in:</p> <p>image::{% link images/apim/3.x/installation/authentication/github_login_success.png %}[Here we are !]</p> </li> </ol>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-github/#log-in-to-apim-portal"},{"title":"Overview","text":"<p>This page explains how to configure an APIM connection with a Google account.</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-google/"},{"title":"Create a Google OAuth client","text":"<p>Before you can connect to APIM with a Google account, you need to create an OAuth client ID.</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-google/#create-a-google-oauth-client"},{"title":"Check access to the Google+ API","text":"<p>Before you begin, you need to create a Google project with access to the Google+ API at https://console.developers.google.com/.</p> <p>image::{% link images/apim/3.x/installation/authentication/google_enable_google+_api.png %}[Check Google+ API access]</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-google/#check-access-to-the-google-api"},{"title":"Create a new client","text":"<ol> <li> <p>Go to https://console.developers.google.com/.</p> </li> <li> <p>In your project Credentials, click Create credentials and     select OAuth client ID.</p> <p>image::{% link images/apim/3.x/installation/authentication/google_create_client.png %}[Create a new OAuth client]</p> </li> <li> <p>Enter the client details.</p> <p>image::{% link images/apim/3.x/installation/authentication/google_fill_client_form.png %}[Fill the form]</p> <p>The <code>Authorized redirect URIs</code> value must exactly match the domain hosting APIM Portal.</p> </li> </ol>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-google/#create-a-new-client"},{"title":"Retrieve client credentials","text":"<p>After you create the client, you can retrieve its credentials for authentication configuration.</p> <p>image::{% link images/apim/3.x/installation/authentication/google_client_credentials.png %}[Get Client credentials]</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-google/#retrieve-client-credentials"},{"title":"Configure APIM","text":"<p>You can configure this provider both in APIM Console and in the <code>gravitee.yml</code> configuration file. Whichever you choose, the configuration is stored in the database. This means that APIM starts using your new configuration as soon as you click the Save button (if configuring in APIM Console) or restart APIM API (if configuring in the configuration file).</p> <p>If you configure the provider in the configuration file and then change the values in APIM Console, all changes are overwritten by the values in the configuration file next time you restart APIM API.</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-google/#configure-apim"},{"title":"APIM Console configuration","text":"<ol> <li> <p>Click Organization Settings &gt; Authentication.</p> </li> <li> <p>Click the plus icon image:{% link images/icons/plus-icon.png     %}[role=\"icon\"] and select the Google icon.</p> </li> <li> <p>If you want to use this provider to log in to APIM Portal, ensure     that Allow portal authentication to use this identity provider     is checked. To use it only for APIM Console, uncheck this option.</p> </li> <li> <p>Enter the details of the provider, including the credentials created     in the AM client.</p> <p>image::{% link images/apim/3.x/management-api-configuration-idp/new-google.png %}[Gravitee.io - New Google IDP] . Click CREATE. . Activate the provider for Portal or Console login, as described in link:{{ /apim/3.x/apim_installguide_authentication.html#activating-providers | relative_url }}[Activating providers^].</p> </li> </ol>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-google/#apim-console-configuration"},{"title":"<code>gravitee.yml</code> file configuration","text":"<p>Update the following section of the file with the Google client credentials.</p> <pre><code>security:\n  providers:\n    - type: google\n      clientId: xxxx-xxx-xxx-xxx\n      clientSecret: xxxx-xxx-xxx-xxx\n</code></pre>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-google/#graviteeyml-file-configuration"},{"title":"Test the connection","text":"","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-google/#test-the-connection"},{"title":"Log in to APIM Portal","text":"<ol> <li> <p>Click Sign in with Google.</p> <p>image::{% link images/apim/3.x/installation/authentication/google_login_form.png %}[Login Form]</p> </li> <li> <p>Choose the Google account.</p> <p>image::{% link images/apim/3.x/installation/authentication/google_choose_google_account.png %}[Login Form]</p> <p>You have successfully logged in:</p> <p>image::{% link images/apim/3.x/installation/authentication/google_login_success.png %}[]</p> </li> </ol>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-google/#log-in-to-apim-portal"},{"title":"Overview","text":"<p>This page explains how to configure APIM authentication using the Gravitee.io Access Management^ product.</p> <p>The examples below are based on Access Management 2.x (2.0.4 or above).</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-graviteeam/"},{"title":"Create a new client in Access Management","text":"<p>Before you can connect to APIM using Access Management (AM), you need to create a new client.</p> <p>See link:{{ /am/current/am_quickstart_app_setup.html | relative_url }}[Set up your first application^] in the AM documentation for guidance on setting up your first security domain and client application.</p> <p>The <code>Valid Redirect URIs</code> value must exactly match the domain hosting APIM Portal.</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-graviteeam/#create-a-new-client-in-access-management"},{"title":"Retrieve client credentials","text":"<p>After you create the client, you can retrieve its credentials for authentication configuration.</p> <p>image::{% link images/apim/3.x/installation/authentication/graviteeam_client_credentials.png %}[Get client credentials]</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-graviteeam/#retrieve-client-credentials"},{"title":"Configure APIM","text":"<p>You can configure this provider both in APIM Console and in the <code>gravitee.yml</code> configuration file. Whichever you choose, the configuration is stored in the database. This means that APIM starts using your new configuration as soon as you click the Save button (if configuring in APIM Console) or restart APIM API (if configuring in the configuration file).</p> <p>If you configure the provider in the configuration file and then change the values in APIM Console, all changes are overwritten by the values in the configuration file next time you restart APIM API.</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-graviteeam/#configure-apim"},{"title":"APIM Console configuration","text":"<ol> <li> <p>Click Organization Settings &gt; Authentication.</p> </li> <li> <p>Click the plus icon image:{% link images/icons/plus-icon.png     %}[role=\"icon\"] and select the Gravitee.io AM icon.</p> </li> <li> <p>If you want to use this provider to log in to APIM Portal, ensure     that Allow portal authentication to use this identity provider     is checked. To use it only for APIM Console, uncheck this option.</p> </li> <li> <p>Enter the details of the provider, including the credentials created     in the AM client.</p> <p>image::{% link images/apim/3.x/management-api-configuration-idp/new-am.png %}[Gravitee.io - New Gravitee.io AM IDP] . Click CREATE. . Activate the provider for Portal or Console login, as described in link:{{ /apim/3.x/apim_installguide_authentication.html#activating-providers | relative_url }}[Activating providers^].</p> </li> </ol>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-graviteeam/#apim-console-configuration"},{"title":"<code>gravitee.yml</code> file configuration","text":"<p>Update the following section of the file with the AM client credentials.</p> <pre><code>security:\n  providers:\n    - type: graviteeio_am\n      clientId: xxxx-xxx-xxx-xxx\n      clientSecret: xxxx-xxx-xxx-xxx\n      serverURL: https://gravitee.io/am\n      domain: gravitee\n      color: \"#3C3C3C\"\n      syncMappings: false\n      scopes:\n        - openid\n        - email\n      userMapping:\n        id: sub\n        email: email\n        lastname: family_name\n        firstname: given_name\n        picture: picture\n      groupMapping:\n        - condition: \"{#jsonPath(#profile, '$.identity_provider_id') == 'PARTNERS' &amp;&amp; #jsonPath(#profile, '$.job_id') != 'API_MANAGER'}\"\n          groups:\n            - Group 1\n            - Group 2\n      roleMapping:\n        - condition: \"{#jsonPath(#profile, '$.job_id') != 'API_MANAGER'}\"\n          roles:\n            - \"ORGANIZATION:USER\"\n            - \"ENVIRONMENT:API_CONSUMER\"                  #applied to the DEFAULT environment\n            - \"ENVIRONMENT:DEFAULT:API_CONSUMER\"          #applied to the DEFAULT environment\n            - \"ENVIRONMENT:&lt;ENVIRONMENT_ID&gt;:API_CONSUMER\" #applied to environment whose id is &lt;ENVIRONMENT_ID&gt;\n</code></pre>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-graviteeam/#graviteeyml-file-configuration"},{"title":"Test the configuration","text":"","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-graviteeam/#test-the-configuration"},{"title":"Create a user in AM","text":"<p>See link:{{ /am/current/am_quickstart_app_setup.html | relative_url }}[Set up your first application^] for guidance on setting up your new AM user.</p> <p>APIM requires an <code>email</code> profile to enable portal authentication. If you create an Inline identity provider in AM, you need to specify an email address in the Username field.</p> <p>image::{% link images/apim/3.x/installation/authentication/graviteeam_create_user.png %}[]</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-graviteeam/#create-a-user-in-am"},{"title":"Log in to APIM Portal","text":"<ol> <li> <p>Click Sign in with Gravitee.io AM.</p> <p>image::{% link images/apim/3.x/installation/authentication/graviteeam_login_form.png %}[]</p> </li> <li> <p>Enter your user credentials and click LOG IN.</p> <p>image::{% link images/apim/3.x/installation/authentication/graviteeam_login_form2.png %}[]</p> </li> <li> <p>Click AUTHORIZE on the approval page.</p> <p>image::{% link images/apim/3.x/installation/authentication/graviteeam_login_form3.png %}[]</p> <p>You have successfully logged in:</p> <p>image::{% link images/apim/3.x/installation/authentication/graviteeam_login_success.png %}[]</p> </li> </ol>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-graviteeam/#log-in-to-apim-portal"},{"title":"Configure in-memory authentication","text":"<p>[[gravitee-installation-authentication-inmemory]] = Configure in-memory authentication :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_installguide_authentication_inmemory.html :page-folder: apim/installation-guide/portal/authentication :page-description: Gravitee.io API Management - Portal - Authentication - In Memory :page-keywords: Gravitee.io, API Platform, API Management, API Gateway, oauth2, openid, documentation, manual, guide, reference, api :page-layout: apim3x</p> <p>== Overview This page describes how to set up authentication with in-memory accounts.</p> <p>== In-memory configuration</p> <p>This example shows a basic in-memory implementation, providing a simple and convenient way to declare advanced users of APIM, such as administrator users.</p> <p>NOTE: It is good practice to always have an administrator account which can log in to APIM even if other authentication methods are broken.</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-inmemory/"},{"title":"[source,yaml]","text":"","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-inmemory/#sourceyaml"},{"title":"Authentication and identity sources","text":"","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-inmemory/#authentication-and-identity-sources"},{"title":"Users can have following roles (authorities):","text":"","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-inmemory/#users-can-have-following-roles-authorities"},{"title":"USER: Can access portal and be a member of an API","text":"","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-inmemory/#user-can-access-portal-and-be-a-member-of-an-api"},{"title":"API_PUBLISHER: Can create and manage APIs","text":"","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-inmemory/#api_publisher-can-create-and-manage-apis"},{"title":"API_CONSUMER: Can create and manage Applications","text":"","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-inmemory/#api_consumer-can-create-and-manage-applications"},{"title":"ADMIN: Can manage global system","text":"<p>security:   # When using an authentication providers, use trustAll mode for TLS connections   # trustAll: false   providers:  # authentication providers     - type: memory       # allow search results to display the user email. Be careful, It may be contrary to the user privacy.</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-inmemory/#admin-can-manage-global-system"},{"title":"allow-email-in-search-results: true","text":"<pre><code>  # password encoding/hashing algorithm. One of:\n  # - bcrypt : passwords are hashed with bcrypt (supports only $2a$ algorithm)\n  # - none : passwords are not hashed/encrypted\n  # default value is bcrypt\n  password-encoding-algo: bcrypt\n  users:\n    - user:\n      username: user\n      #firstname:\n      #lastname:\n      # Passwords are encoded using BCrypt\n      # Password value: password\n      password: $2a$10$9kjw/SH9gucCId3Lnt6EmuFreUAcXSZgpvAYuW2ISv7hSOhHRH1AO\n      roles: ORGANIZATION:USER,ENVIRONMENT:USER\n      # Useful to receive notifications\n      #email:\n    - user:\n      username: admin\n      #firstname:\n      #lastname:\n      # Password value: admin\n      password: $2a$10$Ihk05VSds5rUSgMdsMVi9OKMIx2yUvMz7y9VP3rJmQeizZLrhLMyq\n      roles: ORGANIZATION:ADMIN,ENVIRONMENT:ADMIN\n      #email:\n    - user:\n      username: api1\n      #firstname:\n      #lastname:\n      # Password value: api1\n      password: $2a$10$iXdXO4wAYdhx2LOwijsp7.PsoAZQ05zEdHxbriIYCbtyo.y32LTji\n      # You can declare multiple roles using comma separator\n      roles: ORGANIZATION:USER,ENVIRONMENT:API_PUBLISHER\n      #email:\n    - user:\n      username: application1\n      #firstname:\n      #lastname:\n      # Password value: application1\n      password: $2a$10$2gtKPYRB9zaVaPcn5RBx/.3T.7SeZoDGs9GKqbo9G64fKyXFR1He.\n      roles: ORGANIZATION:USER,ENVIRONMENT:USER\n      #email:\n</code></pre>  <p>== Generate a new password</p> <p>If you use https://en.wikipedia.org/wiki/Bcrypt[bcrypt^] to hash passwords, you can generate new passwords with the https://httpd.apache.org/docs/current/en/programs/htpasswd.html[htpasswd^] command line, as shown in the following example (where <code>new_password</code> is your new password):</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-inmemory/#allow-email-in-search-results-true"},{"title":"[source,bash]","text":"","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-inmemory/#sourcebash"},{"title":"htpasswd -bnBC 10 \"\" new_password | tr -d ':\\n'","text":"","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-inmemory/#htpasswd-bnbc-10-new_password-tr-d-n"},{"title":"Configure Keycloak authentication","text":"<p>[[gravitee-installation-authentication-keycloak]] = Configure Keycloak authentication :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_installguide_authentication_keycloak.html :page-folder: apim/installation-guide/portal/authentication :page-description: Gravitee.io API Management - Portal - Authentication - Keycloak :page-keywords: Gravitee.io, API Platform, API Management, API Gateway, oauth2, openid, documentation, manual, guide, reference, api :page-layout: apim3x</p> <p>== Overview</p> <p>This page explains how to configure APIM to allow users to connect using https://www.keycloak.org/[Keycloak^].</p> <p>== Create a Keycloak client</p> <p>Before you can connect to the Gravitee.io portal using Keycloak, you need to create a new client.</p> <p>=== Create a new client</p> <p>. In Keycloak, create a new client. + image::{% link images/apim/3.x/installation/authentication/keycloak_create_client.png %}[Create a new client]</p> <p>. Enter the client details. + image::{% link images/apim/3.x/installation/authentication/keycloak_configure_client.png %}[Fill the form]</p> <p>WARNING: The <code>Valid Redirect URIs</code> value must exactly match the domain which is hosting APIM Portal.</p> <p>=== Retrieve client credentials</p> <p>After you create the client, you can retrieve its details for authentication configuration.</p> <p>image::{% link images/apim/3.x/installation/authentication/keycloak_client_credentials.png %}[Get Client credentials]</p> <p>== Configure APIM</p> <p>=== SSL support</p> <p>When using custom a Public Key Infrastructure (PKI) for your OAuth2 authentication provider, you may have to specify the certificate authority chain of your provider in APIM.</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-keycloak/"},{"title":"[source,bash]","text":"<p>export JAVA_OPTS=\"   -Djavax.net.ssl.trustStore=/opt/graviteeio-management-api/security/truststore.jks   -Djavax.net.ssl.trustStorePassword=\"  <p>Docker environment::</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-keycloak/#sourcebash"},{"title":"[source,yaml]","text":"<p>local_managementapi:     extends:       file: common.yml       service: managementapi     ports:       - \"8005:8083\"     volumes:       - ./conf/ssl/truststore.jks:/opt/graviteeio-management-api/security/truststore.jks:ro       - ./logs/management-api:/home/gravitee/logs     links:       - \"local_mongodb:demo-mongodb\"       - \"local_elasticsearch:demo-elasticsearch\"     environment:       - JAVA_OPTS=-Djavax.net.ssl.trustStore=/opt/graviteeio-management-api/security/truststore.jks -Djavax.net.ssl.trustStorePassword=       - gravitee_management_mongodb_uri=mongodb://demo-mongodb:27017/gravitee?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000       - gravitee_analytics_elasticsearch_endpoints_0=http://demo-elasticsearch:9200  <p>include::../../partial/management-api-configuration-idp-override.adoc[leveloffset=+2]</p> <p>==== APIM Console configuration</p> <p>. Click Organization Settings &gt; Authentication. . Click the plus icon image:{% link images/icons/plus-icon.png %}[role=\"icon\"] and select the OpenID Connect icon. . If you want to use this provider to log in to APIM Portal, ensure that Allow portal authentication to use this identity provider is checked. To use it only for APIM Console, uncheck this option. . Enter the details of the provider, including the credentials created in the AM client. + image::{% link images/apim/3.x/management-api-configuration-idp/new-oidc.png %}[Gravitee.io - New OIDC IDP] . Click CREATE. . Activate the provider for Portal or Console login, as described in link:{{ '/apim/3.x/apim_installguide_authentication.html#activating-providers' | relative_url }}[Activating providers^].</p> <p>==== <code>gravitee.yml</code> file configuration</p> <p>Update the following section of the file with the Keycloak client credentials.</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-keycloak/#sourceyaml"},{"title":"[source,yaml]","text":"<p>security:   providers:     - type: oidc       id: keycloak # not required if not present, the type is used       clientId: gravitee       clientSecret: 3aea136c-f056-49a8-80f4-a6ea521b0c94       tokenIntrospectionEndpoint: http://localhost:8080/auth/realms/master/protocol/openid-connect/token/introspect       tokenEndpoint: http://localhost:8080/auth/realms/master/protocol/openid-connect/token       authorizeEndpoint: http://localhost:8080/auth/realms/master/protocol/openid-connect/auth       userInfoEndpoint: http://localhost:8080/auth/realms/master/protocol/openid-connect/userinfo       userLogoutEndpoint: http://localhost:8080/auth/realms/master/protocol/openid-connect/logout       color: \"#0076b4\"       syncMappings: false       scopes:         - openid         - profile       userMapping:         id: sub         email: email         lastname: family_name         firstname: given_name         picture: picture       groupMapping:         - condition: \"{#jsonPath(#profile, '$.identity_provider_id') == 'PARTNERS' &amp;&amp; #jsonPath(#profile, '$.job_id') != 'API_MANAGER'}\"           groups:             - Group 1             - Group 2       roleMapping:         - condition: \"{#jsonPath(#profile, '$.job_id') != 'API_MANAGER'}\"           roles:             - \"ORGANIZATION:USER\"             - \"ENVIRONMENT:API_CONSUMER\"                  #applied to the DEFAULT environment             - \"ENVIRONMENT:DEFAULT:API_CONSUMER\"          #applied to the DEFAULT environment             - \"ENVIRONMENT::API_CONSUMER\" #applied to environment whose id is   <p>== Test the connection</p> <p>=== Create a new user in Keycloak</p> <p>. Create your new user. + image::{% link images/apim/3.x/installation/authentication/keycloak_users.png %}[Create a user] + . Enter the user details. + image::{% link images/apim/3.x/installation/authentication/keycloak_create_user.png %}[Fill the user form]</p> <p>. Define the user credentials. + image::{% link images/apim/3.x/installation/authentication/keycloak_create_user_credentials.png %}[Define user credentials]</p> <p>=== Log in to APIM Portal . Click Sign in with Keycloak. + image::{% link images/apim/3.x/installation/authentication/keycloak_login_form.png %}[Login Form]</p> <p>. Enter the Keycloak credentials and click Log In. + image::{% link images/apim/3.x/installation/authentication/keycloak_login_form2.png %}[Keycloak Login Form] + You have successfully logged in: + image::{% link images/apim/3.x/installation/authentication/keycloak_login_success.png %}[Here we are !]</p> <p>== Managing roles with keycloak</p> <p>Configure Keycloak and Gravitee to map your own organization with available built-in or your custom registered roles. </p> <p>=== Gravitee roles console</p> <p>. Consider built-in or create custom Gravitee roles. + image::{% link images/apim/3.x/installation/authentication/keycloak_mng-00-gravitee-default_roles.png %}[Gravitee console - roles page]</p> <p>=== Create and configure Keycloak Client scope . In your realm, go to the <code>Client scopes</code> page.</p> <p>. Set a special gravitee-client-groups https://oauth.net/2/scope/[Scope] that will contain users' roles. + image::{% link images/apim/3.x/installation/authentication/keycloak_mng-01-client_scopes-roles_add_client_scope.png %}[Keycloak console - Create scope]</p> <p>.  In the new client scope, set a mapper with Claim name \"groups\". + image::{% link images/apim/3.x/installation/authentication/keycloak_mng-02-client_scopes-mapper.png %}[Keycloak console - Add mapper to scope]</p> <p>. In your realm, go to the <code>Client</code> page, and select your Client. . Add the new configured scope in the <code>Client Scopes</code> tab. + image::{% link images/apim/3.x/installation/authentication/keycloak_mng-03-client-add_scope.png %}[Keycloak console - Add scope to client]</p> <p>=== Create Keycloak Client roles </p> <p>. In your client, create roles as needed by organization. + image::{% link images/apim/3.x/installation/authentication/keycloak_mng-04-client-add_roles.png %}[Keycloak console - Create client roles ]</p> <p>=== Configure Keycloack users with appropiate roles</p> <p>image::{% link images/apim/3.x/installation/authentication/keycloak_mng-roles-05-users-add_user_client_roles.png %}[Keycloak console - Add roles to user]</p> <p>=== Configure Gravitee role mappings</p> <p>Gravitee role mapping uses Spring Expression Language (https://docs.spring.io/spring-framework/docs/3.0.x/reference/expressions.html[SpEL^]) for writting conditions. The only available object in context is #profile set from https://www.oauth.com/oauth2-servers/signing-in-with-google/verifying-the-user-info/[userInfoEndpoint^].</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-keycloak/#sourceyaml_1"},{"title":"[source,yaml]","text":"<p>security:   providers:     - type: oidc       ...       roleMapping:         - condition: \"{(#jsonPath(#profile, '$.groups') matches 'gravitee-admin' )}\"           roles:             - \"ORGANIZATION:ADMIN\"             - \"ENVIRONMENT:ADMIN\"</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-keycloak/#sourceyaml_2"},{"title":"Overview","text":"<p>This page describes how to configure APIM to allow users to connect using LDAP/AD accounts.</p> <p>There are many ways in which the LDAP authentication sources can be configured.</p> <p>You need to be familiar with LDAP before trying to use it.</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-ldap/"},{"title":"LDAP configuration","text":"<pre><code># ===================================================================\n# LDAP SECURITY PROPERTIES\n#\n# This sample file declared one ldap authentication source\n# ===================================================================\nsecurity:\n  type: basic\n  providers:\n    - type: ldap\n      context:\n        username: \"uid=admin,ou=system\"\n        password: \"secret\"\n        url: \"ldap://localhost:389/dc=gravitee,dc=io\"\n        base: \"c=io,o=gravitee\"\n      authentication:\n        user:\n          base: \"ou=people\"\n          filter: \"uid={0}\"\n        group:\n          base: \"o=authorization groups\"\n          filter: \"member={0}\"\n          role:\n            attribute: \"cn\"\n            mapper: {\n              GRAVITEE-CONSUMERS: API_CONSUMER,\n              GRAVITEE-PUBLISHERS: API_PUBLISHER,\n              GRAVITEE-ADMINS: ADMIN,\n              GRAVITEE-USERS: USER\n            }\n      lookup:\n        user:\n          base: \"ou=people\"\n          filter: \"(&amp;(objectClass=myObjectClass)(|(cn=*{0}*)(uid={0})))\"\n</code></pre>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication-ldap/#ldap-configuration"},{"title":"Overview","text":"<p>APIM natively support several types of authentication for accessing APIM:</p> <ul> <li> <p>Authentication providers (such as in-memory, LDAP and databases)</p> </li> <li> <p>Social providers (such as GitHub and Google)</p> </li> <li> <p>A custom OAuth2 / OpenID authorization server</p> </li> </ul>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication/"},{"title":"Identity providers","text":"<p>You can specify as many identity providers as you want. APIM API loops through the providers in the order they are declared in the <code>providers</code> section of the <code>gravitee.yml</code> file until one of the authentication methods completes successfully.</p> <pre><code>security:\n  providers:\n    # First authentication source\n    - type: ldap\n      ...\n\n    # Second authentication source\n    - type: memory\n      ...\n\n    # Third authentication source\n    - type: gravitee\n      ...\n</code></pre>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication/#identity-providers"},{"title":"Configuring authentication in APIM","text":"<p>In this section, the organization scope roughly corresponds to APIM Console, and the environment scope roughly corresponds to APIM Portal. For a better understanding of the scope of application of identity providers, we recommend you read the link:{{ /apim/3.x/apim_adminguide_organizations_and_environments.html | relative_url }}[Organizations and environments] section of the Administration Guide.</p> <p>You can configure Social providers and define custom OAuth2 / OpenID authorization servers in APIM Console. All identity providers are defined at organization level. You can then choose whether to make each provider available at environment level as well.</p> <p>You can see which identity providers are defined in APIM Console as follows:</p> <ul> <li> <p>To view organization-level identity providers, click Organization     settings &gt; Authentication (note that this list also indicates     which providers are enabled for environment-level authentication)</p> </li> <li> <p>To view identity providers which are also enabled for     environment-level authentication, click Settings &gt;     Authentication</p> </li> </ul>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication/#configuring-authentication-in-apim"},{"title":"Creating providers with the required scope","text":"<p>You define new providers in APIM Console with the Organization settings &gt; Authentication menu entry. If you want the identity provider to be available at environment level as well, you can enable it for APIM Portal authentication when you specify its details.</p> <p>image::{% link images/apim/3.x/installation/authentication/provider-activation-portal-enablement.png %}[]</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication/#creating-providers-with-the-required-scope"},{"title":"Activating providers","text":"<p>Once a new provider is defined, you need to activate it in the organization and/or environment-level list by checking the Activated checkbox, to make it available to the relevant login window:</p> <p>image::{% link images/apim/3.x/installation/authentication/provider-organization-list-activate.png %}[]</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication/#activating-providers"},{"title":"Example","text":"<p>In this example, three providers have been defined\u2009\u2014\u2009Google, GitHub and GraviteeIO AM.</p> <ul> <li> <p>Only GitHub and GraviteeIO AM are activated for APIM Console     authentication (in the organization-level list).</p> </li> <li> <p>Only Google and GraviteeIO AM are enabled for APIM Portal     authentication.</p> </li> </ul> <p>image::{% link images/apim/3.x/installation/authentication/provider-organization-list.png %}[]</p> <p>You can see that GitHub and GraviteeIO AM are visible on the APIM Console login screen:</p> <p>image::{% link images/apim/3.x/installation/authentication/console-login-screen.png %}[]</p> <p>In the environment-level list, only Google and GraviteeIO AM appear, and only GraviteeIO AM is activated.</p> <p>image::{% link images/apim/3.x/installation/authentication/provider-environment-list.png %}[]</p> <p>As a result, you can only see GraviteeIO AM on the APIM Portal login screen:</p> <p>image::{% link images/apim/3.x/installation/authentication/portal-login-screen.png %}[]</p>","location":"apim/installation-guide/configuration/authentication/installation-guide-authentication/#example"},{"title":"Why Should I Enable OpenTracing?","text":"<p>Using OpenTracing allows Gravitee to trace every request that comes through the APIM Gateway, creating a deep level of insight on API policies and making debugging a cinch. Without OpenTracing, you\u2019ll only receive limited details \u2013 making monitoring and troubleshooting complicated and time-consuming.</p> <p>So, if you\u2019re looking for a way to simplify debugging, improve monitoring, and enhance visibility into requests across multiple services, Gravitee\u2019s OpenTracing solution with Jaeger as a tracer has you covered. Learn how to set up OpenTracing with the instructions below.</p>","location":"apim/installation-guide/configuration/gateway/configure-opentracing/"},{"title":"How To Enable OpenTracing","text":"<p>In the <code>gravitee.yml</code> file, enable tracing by adding the following configuration:</p> <pre><code>tracing:\n    enabled: true\n    type: jaeger\n    jaeger:\n    host: localhost\n    port: 14250\n</code></pre> <p>Here, you must change <code>enabled</code> from <code>false</code> to <code>true</code>.</p> <p>And that\u2019s it! You\u2019ve enabled OpenTracing on APIM Gateway.</p> <p>Want to try it yourself in Docker? link:{{ /apim/3.x/apim_opentracing_in_docker.html | relative_url }}[Click here] for more details.</p>","location":"apim/installation-guide/configuration/gateway/configure-opentracing/#how-to-enable-opentracing"},{"title":"General configuration","text":"<p>= Configure APIM Gateway :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_installguide_gateway_configuration.html :page-folder: apim/installation-guide/gateway :page-description: Gravitee.io API Management - Configuration - Gateway :page-keywords: Gravitee.io, API Platform, API Management, API Gateway, oauth2, openid, documentation, manual, guide, reference, api :page-layout: apim3x</p> <p>include::../../partial/how-to-configure.adoc[leveloffset=+1]</p> <p>== <code>gravitee.yml</code> configuration</p> <p>[[api-gateway-http-server]] === Configure HTTP Server</p> <p>You configure the HTTP Server configuration in the following section of the <code>gravitee.yml</code> file:</p>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/"},{"title":"[source,yaml]","text":"<p>http:   port: 8082   host: 0.0.0.0   idleTimeout: 0   tcpKeepAlive: true   compressionSupported: false   maxHeaderSize: 8192   maxChunkSize: 8192   instances: 0   requestTimeout: 30000   secured: false   alpn: false   ssl:     clientAuth: none # Supports none, request, requires     keystore:       path: ${gravitee.home}/security/keystore.jks       password: secret     truststore:       path: ${gravitee.home}/security/truststore.jks       password: secret</p>  <p>==== Enable HTTPS support First, you need to provide a keystore. If you do not have one, you can generate it:</p>  <p>keytool -genkey \\   -alias test \\   -keyalg RSA \\   -keystore server-keystore.jks \\   -keysize 2048 \\   -validity 360 \\   -dname CN=localhost \\   -keypass secret \\   -storepass secret</p>  <p>===== File keystore</p>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#sourceyaml"},{"title":"You then need to enable secure mode in <code>gravitee.yml</code> and provide a path pointing to the keystore containing the certificate and the associated private key:","text":"<p>http:   # ... skipped for simplicity   secured: true   ssl:     clientAuth: none # Supports none, request, requires     keystore:       path: /path/to/keystore.jks       password: adminadmin     truststore:       path:       password:</p>  <p>NOTE: since APIM v3.13.0, the keystore file is automatically watched for any modifications and reloaded without having to restart the gateway server.</p> <p>===== Kubernetes Secret/ConfigMap keystore</p> <p>Since v3.14.0, it is possible to load the keystore directly from Kubernetes secret or configmap by just specifying the appropriate kubernetes location.</p>  <p>http:   # ... skipped for simplicity   secured: true   ssl:     clientAuth: none # Supports none, request, requires     keystore:       type: pkcs12       kubernetes: /my-namespace/secrets/my-secret/keystore       password: adminadmin</p>  <p>The expected <code>http.ssl.keystore.kubernetes</code> is structured as follows: <code>/{namespace}/{type}/{name}/{key}</code> With:</p> <ul> <li><code>namespace</code>: the name of the targeted Kubernetes namespace</li> <li><code>type</code>: can be either <code>secrets</code> either <code>configmaps</code>, depending on the type of Kubernetes resources to retrieve</li> <li><code>name</code>: the name of the secret or configmap to retrieve</li> <li><code>key</code>: the name of the key holding the value to retrieve. The <code>key</code> is optional when using a standard <code>kubernetes.io/tls</code> secret (note: it only supports PEM cert &amp; key). The <code>key</code> is mandatory for any <code>Opaque</code> secret or configmap (note: they only support JKS &amp; PKC12 keystore type).</li> </ul> <p>NOTE: The keystore (or PEM cert &amp; key) stored in the Kubernetes secret or configmap is automatically watched for any modifications and reloaded without having to restart the gateway server.</p> <p>==== Enable HTTP/2 support</p> <p>First, enable HTTPS support as described in the section above.</p>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#you-then-need-to-enable-secure-mode-in-graviteeyml-and-provide-a-path-pointing-to-the-keystore-containing-the-certificate-and-the-associated-private-key"},{"title":"You then need to enable <code>alpn</code> in <code>gravitee.yml</code>:","text":"<p>http:   alpn: true   ...</p>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#you-then-need-to-enable-alpn-in-graviteeyml"},{"title":"You can now consume your API with both HTTP/1 and HTTP/2 protocols:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#you-can-now-consume-your-api-with-both-http1-and-http2-protocols"},{"title":"curl -k -v --http2 https://localhost:8082/my_api","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#curl-k-v-http2-httpslocalhost8082my_api"},{"title":"==== Enable WebSocket support","text":"<p>http:   websocket:     enabled: true</p>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#enable-websocket-support"},{"title":"You can now consume your API with both WS and WSS protocols:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#you-can-now-consume-your-api-with-both-ws-and-wss-protocols"},{"title":"curl ws://localhost:8082/my_websocket","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#curl-wslocalhost8082my_websocket"},{"title":"==== Enable certificate-based client authentication","text":"<p>http:   ssl:     clientAuth: none # Supports none, request, requires     truststore:       path: /path/to/truststore.jks       password: adminadmin</p>  <p>Available modes for <code>clientAuth</code> are:</p> <ul> <li>none: Client authentication is disabled (replacement of the <code>false</code> value)</li> <li>request: Client authentication is not required but can be if using link:apim_policies_ssl_enforcement.html[SSL enforcement policy]</li> <li>requires: Client authentication is required (replacement of <code>true</code> value)</li> </ul> <p>=== Configure the Plugins repository</p> <p>You can configure the APIM Gateway link:{{ '/apim/3.x/apim_devguide_plugins.html' | relative_url }}[plugins] directory.</p>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#enable-certificate-based-client-authentication"},{"title":"[source,yaml]","text":"<p>plugins:   path: ${gravitee.home}/plugins</p>  <p>=== Configure the Management repository</p> <p>The Management repository is used to store global configuration such as APIs, applications and apikeys. The default configuration uses MongoDB (single server). For more information about MongoDB configuration, see:</p> <p>http://api.mongodb.org/java/current/com/mongodb/MongoClientOptions.html[window=\\\"_blank\\\"]</p>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#sourceyaml_1"},{"title":"[source,yaml]","text":"<p>management:   type: mongodb   mongodb:     dbname: ${ds.mongodb.dbname}     host: ${ds.mongodb.host}     port: ${ds.mongodb.port}</p>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#sourceyaml_2"},{"title":"username:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#username"},{"title":"password:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#password"},{"title":"connectionsPerHost: 0","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#connectionsperhost-0"},{"title":"connectTimeout: 500","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#connecttimeout-500"},{"title":"maxWaitTime: 120000","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#maxwaittime-120000"},{"title":"socketTimeout: 500","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#sockettimeout-500"},{"title":"socketKeepAlive: false","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#socketkeepalive-false"},{"title":"maxConnectionLifeTime: 0","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#maxconnectionlifetime-0"},{"title":"maxConnectionIdleTime: 0","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#maxconnectionidletime-0"},{"title":"serverSelectionTimeout: 0","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#serverselectiontimeout-0"},{"title":"description: gravitee.io","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#description-graviteeio"},{"title":"heartbeatFrequency: 10000","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#heartbeatfrequency-10000"},{"title":"minHeartbeatFrequency: 500","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#minheartbeatfrequency-500"},{"title":"heartbeatConnectTimeout: 1000","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#heartbeatconnecttimeout-1000"},{"title":"heartbeatSocketTimeout: 20000","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#heartbeatsockettimeout-20000"},{"title":"localThreshold: 15","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#localthreshold-15"},{"title":"minConnectionsPerHost: 0","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#minconnectionsperhost-0"},{"title":"threadsAllowedToBlockForConnectionMultiplier: 5","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#threadsallowedtoblockforconnectionmultiplier-5"},{"title":"cursorFinalizerEnabled: true","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#cursorfinalizerenabled-true"},{"title":"SSL settings (Available in APIM 3.10.14+, 3.15.8+, 3.16.4+, 3.17.2+, 3.18+)","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#ssl-settings-available-in-apim-31014-3158-3164-3172-318"},{"title":"sslEnabled:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#sslenabled"},{"title":"keystore:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#keystore"},{"title":"path:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#path"},{"title":"type:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#type"},{"title":"password:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#password_1"},{"title":"keyPassword:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#keypassword"},{"title":"truststore:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#truststore"},{"title":"path:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#path_1"},{"title":"type:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#type_1"},{"title":"password:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#password_2"},{"title":"Deprecated SSL settings that will be removed in 3.19.0","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#deprecated-ssl-settings-that-will-be-removed-in-3190"},{"title":"sslEnabled:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#sslenabled_1"},{"title":"keystore:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#keystore_1"},{"title":"keystorePassword:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#keystorepassword"},{"title":"keyPassword:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#keypassword_1"},{"title":"Management repository: single MongoDB using URI","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#management-repository-single-mongodb-using-uri"},{"title":"For more information about MongoDB configuration using URI, please have a look to:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#for-more-information-about-mongodb-configuration-using-uri-please-have-a-look-to"},{"title":"- http://api.mongodb.org/java/current/com/mongodb/MongoClientURI.html","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#-httpapimongodborgjavacurrentcommongodbmongoclienturihtml"},{"title":"management:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#management"},{"title":"type: mongodb","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#type-mongodb"},{"title":"mongodb:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#mongodb"},{"title":"uri: mongodb://[username:password@]host1[:port1][,host2[:port2],...[,hostN[:portN]]][/[database][?options]]","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#uri-mongodbusernamepasswordhost1port1host2port2hostnportndatabaseoptions"},{"title":"Management repository: clustered MongoDB","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#management-repository-clustered-mongodb"},{"title":"management:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#management_1"},{"title":"type: mongodb","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#type-mongodb_1"},{"title":"mongodb:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#mongodb_1"},{"title":"servers:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#servers"},{"title":"- host: mongo1","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#-host-mongo1"},{"title":"port: 27017","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#port-27017"},{"title":"- host: mongo2","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#-host-mongo2"},{"title":"port: 27017","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#port-27017_1"},{"title":"dbname: ${ds.mongodb.dbname}","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#dbname-dsmongodbdbname"},{"title":"connectTimeout: 500","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#connecttimeout-500_1"},{"title":"socketTimeout: 250","text":"<p>=== Configure the Rate Limit repository</p> <p>When defining the &lt;&gt;, APIM Gateway needs to store data to share with other APIM Gateway instances.</p> <p>For Management repositories, you can define a custom prefix for the Rate Limit table or collection name.</p> <p>==== Store counters in MongoDB</p> <p>NOTE: If you want to use a custom prefix, you need to follow the following link:apim_installguide_repositories_mongodb.html#use_a_custom_prefix[instructions^].</p>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#sockettimeout-250"},{"title":"[source,yaml]","text":"<p>ratelimit:   type: mongodb   mongodb:     uri: mongodb://${ds.mongodb.host}/${ds.mongodb.dbname}     prefix: # collection prefix</p>  <p>==== Store counters in JDBC</p> <p>NOTE: If you want to use a custom prefix, you need to follow the following link:apim_installguide_repositories_jdbc.html#use_a_custom_prefix[instructions^].</p>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#sourceyaml_3"},{"title":"[source,yaml]","text":"<p>ratelimit:   type: jdbc   jdbc:     url: jdbc:postgresql://host:port/dbname     password: # password     username: # username     prefix:   # collection prefix</p>  <p>=== Configure the Reporters</p> <p>You can configure various aspects of reporters, such as reporting monitoring data, request metrics and health checks. All reporters are enabled by default. To stop a reporter, you need to add the property 'enabled: false'</p>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#sourceyaml_4"},{"title":"[source,yaml]","text":"<p>reporters:   elasticsearch:     endpoints:       - http://localhost:9200</p>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#sourceyaml_5"},{"title":"index: gravitee","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#index-gravitee"},{"title":"bulk:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#bulk"},{"title":"actions: 500           # Number of requests action before flush","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#actions-500-number-of-requests-action-before-flush"},{"title":"flush_interval: 1      # Flush interval in seconds","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#flush_interval-1-flush-interval-in-seconds"},{"title":"security:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#security"},{"title":"username:","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#username_1"},{"title":"password:","text":"<p>=== Configure services</p> <p>You can update the default APIM Gateway default values. All services are enabled by default. To stop a service, you need to add the property 'enabled: false' (you can see an example in the 'local' service).</p>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#password_3"},{"title":"[source,yaml]","text":"<p>services:   # Synchronization daemon used to keep the gateway state in sync with the configuration from the management repository   # Be aware that, by disabling it, the gateway will not be sync with the configuration done through management API and management UI   sync:     # Synchronization is done each 5 seconds     cron: '/5 *  *  '</p> <p># Service used to store and cache api-keys from the management repository to avoid direct repository communication   # while serving requests.   apikeyscache:     delay: 10000     unit: MILLISECONDS     threads: 3 # Threads core size used to retrieve api-keys from repository.</p> <p># Local registry service.   # This registry is used to load API Definition with json format from the file system. By doing so, you do not need   # to configure your API using the web console or the rest API (but you need to know and understand the json descriptor   # format to make it work....)   local:     enabled: false     path: ${gravitee.home}/apis # The path to API descriptors</p> <p># Gateway monitoring service.   # This service retrieves metrics like os / process / jvm metrics and send them to an underlying reporting service.   monitoring:     delay: 5000     unit: MILLISECONDS</p> <p># Endpoint healthcheck service.   healthcheck:     threads: 3 # Threads core size used to check endpoint availability</p>  <p>=== Configure sharding tags</p> <p>You can apply sharding on APIM Gateway instances either at the system property level or with <code>gravitee.yml</code>.</p> <p>In this example, we are configuring deployment only for APIs tagged as <code>product</code> or <code>store</code> and of those, we are excluding APIs tagged as <code>international</code>.</p>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#sourceyaml_6"},{"title":"[source,yaml]","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#sourceyaml_7"},{"title":"tags: 'product,store,!international'","text":"<p>=== Configure organizations and environments</p> <p>You can configure organizations and environments using their <code>hrids</code> on APIM Gateway instances either at the system property level or with <code>gravitee.yml</code>.</p> <p>Only APIs and dictionaries belonging to the configured organizations and environments will be loaded.</p> <p>If only <code>organizations</code> configuration is set, then all environments belonging to these organizations are used. If only <code>environments</code> configuration is set, then all environments matching the setting will be used, regardless their organization. If both <code>organizations</code> and <code>environments</code> are set, all environments matching the setting and belonging to these organizations will be used. If none of these fields is set, then all organizations and environment are used.</p> <p>In this example, we are configuring deployment only for <code>dev</code> and <code>integration</code> environments for <code>mycompany</code> organization.</p>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#tags-productstoreinternational"},{"title":"[source,yaml]","text":"<p>organizations: mycompany environments: dev,integration</p>  <p>=== Default configuration</p> <p>You can configure various default properties of APIM Gateway in your <code>gravitee.yml</code> file.</p>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#sourceyaml_8"},{"title":"[source,yaml]","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#sourceyaml_9"},{"title":"include::https://raw.githubusercontent.com/gravitee-io/gravitee-api-management/{{ site.products.apim._3x.version }}/gravitee-apim-gateway/gravitee-apim-gateway-standalone/gravitee-apim-gateway-standalone-distribution/src/main/resources/config/gravitee.yml[]","text":"","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-configuration/#includehttpsrawgithubusercontentcomgravitee-iogravitee-api-management-siteproductsapim_3xversion-gravitee-apim-gatewaygravitee-apim-gateway-standalonegravitee-apim-gateway-standalone-distributionsrcmainresourcesconfiggraviteeyml"},{"title":"Metrics","text":"<p>This section explains how to expose metrics to Prometheus.</p>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-metrics/"},{"title":"Enable the metrics service","text":"<p>You enable the metrics service in the <code>gravitee.yml</code> configuration file. Prometheus support is activated and exposed using the component\u2019s internal API.</p> <pre><code>services:\n  metrics:\n    enabled: true\n    prometheus:\n      enabled: true\n</code></pre> <p>By default, the internal component API is bound to <code>localhost</code> only, so it must not be invoked outside <code>localhost</code>. If you need to expose the API more widely, you may need to set the <code>services.core.http.host</code> property to the correct network interface. If you are running the application in a Docker container, set the IP to the IP address of the container. Each change requires a restart.</p>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-metrics/#enable-the-metrics-service"},{"title":"Configure labels","text":"<p>Labels are used to provide dimensionality to a metric. For instance, metrics related to a http request have a <code>http_path</code> label, which allows then to query timeseries for a specific path, or any other operation on timeseries.</p> <p>You can specify which labels you want in the configuration file:</p> <pre><code>services:\n  metrics:\n    enabled: true\n    labels:\n      - local\n      - remote\n      - http_method\n      - http_code\n      - http_path\n    prometheus:\n      enabled: true\n</code></pre> <p>The list of available labels can be found here: Label</p> <p>Enabling labels may result in a high cardinality in values, which can cause issues on the metrics backend (i.e. the gateway) and affect performance. So it must be used with care. In general, it is fine to enable labels when the set of possible values is bounded.</p> <p>Default values are <code>local</code>, <code>http_method</code> and <code>http_code</code>.</p> <p>Starting from APIM 3.10.0, Vert.x 4 is used and the metrics labels have been renamed. We have introduced a new field in prometheus configuration that you can configure to use old Vert.x 3 label names. Set it to 3.10, to use old labels.</p> <p>\"3.10\" in the configuration is related to Vert.x version and not APIM version.</p> <pre><code>services:\n  metrics:\n    prometheus:\n      naming:\n        version: 3.10\n</code></pre>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-metrics/#configure-labels"},{"title":"Prometheus configuration","text":"<p>The following example requests Prometheus scrape the formatted metrics available in the Gateway internal API.</p> <pre><code>scrape_configs:\n  - job_name: 'gio-gw'\n    basic_auth:\n      username: admin\n      password: adminadmin\n    metrics_path: /_node/metrics/prometheus\n    static_configs:\n      - targets: ['localhost:18082']\n</code></pre>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-metrics/#prometheus-configuration"},{"title":"Prometheus UI","text":"<p>By default when running Prometheus, the UI is exposed at http://localhost:9090/graph</p> <p>Show <code>http_client_connections</code> metrics</p> <p>image::{% link images/apim/3.x/installation/metrics/prometheus/metrics_prometheus_graph.png %}[Show <code>http_client_connections</code> metrics]</p> <p>The following example shows the memory consumed by the Gateway instance:</p> <p>Show <code>jvm_memory_used_bytes</code> metrics</p> <p>image::{% link images/apim/3.x/installation/metrics/prometheus/metrics_prometheus_graph_memory.png %}[Show <code>jvm_memory_used_bytes</code> metrics]</p>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-metrics/#prometheus-ui"},{"title":"Internal API","text":"<p>The APIM Management component comes with its own internal API, for monitoring and retrieving technical information about the component.</p>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-technical-api/"},{"title":"Configuration","text":"<p>You need to enable the API as a service in the <code>gravitee.yml</code> file and update any other required configuration.</p> <pre><code>services:\n  core:\n    http:\n      enabled: true\n      port: 18082\n      host: localhost\n      authentication:\n        type: basic\n        users:\n          admin: adminadmin\n</code></pre> <p>enabled Whether the service is enabled (default <code>true</code>).</p> <p>port The port the service listens on (default <code>{node_port}</code>). You must ensure you use a port which is not already in use by another APIM component.</p> <p>host The host (default <code>localhost</code>).</p> <p>authentication.type Authentication type for requests: <code>none</code> if no authentication is required or <code>basic</code> (default <code>basic</code>).</p> <p>authentication.users A list of <code>user: password</code> combinations. Only required if authentication type is <code>basic</code>.</p>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-technical-api/#configuration"},{"title":"Endpoints","text":"<p>Operation</p> <p>Description</p> <p>Example</p>   <p><code>GET /_node</code></p> <p>Gets generic node information</p> <pre><code>HTTP/1.1 200 OK\nContent-Type: application/json\n{\n    \"id\": \"a70b9fd9-9deb-4ccd-8b9f-d99deb6ccd32\",\n    \"metadata\": {},\n    \"name\": \"Gravitee.io - Management API\",\n    \"version\": {\n        \"BUILD_ID\": \"309\",\n        \"BUILD_NUMBER\": \"309\",\n        \"MAJOR_VERSION\": \"1.20.14\",\n        \"REVISION\": \"132e719ef314b40f352e6399034d68a9a95e95ef\"\n    }\n}</code></pre>   <p><code>GET /_node/health?probes=#probe1,#probe2</code></p> <p>Gets the health status of the component. Probes can be filtered using the optional <code>probes</code> query param. The parameter can handle a list of probes, separated by commas (<code>,</code>). If no query param, you get the health of all probes. If the return status is 200 then everything is ok, if 500, there is at least one error. This endpoint can be used by a load balancer, to determine if a component instance is not in the pool, for example.</p> <p>Some probes are not displayed by default. You have to explicitly use the query param to retrieve them. These probes are:</p> <p>- cpu</p> <p>- memory</p> <p>- api-sync</p> <p>Those probes are considered healthy if there are under a configurable threshold (default is 80%). To configure it, add in your <code>gravitee.yml</code>:</p> <p>[source, yml] ---- services: health: threshold: cpu: 80 memory: 80 ----</p> <p><code>GET /_node/health?probes=management-api,management-repository</code></p> <pre><code>HTTP/1.1 200 OK\nContent-Type: application/json\n\n{\n    \"management-api\": {\n        \"healthy\": true\n    },\n    \"management-repository\": {\n        \"healthy\": true\n    },\n    \"api-sync\": {\n        \"healthy\": true\n    },\n    \"api-sync\": {\n        \"healthy\": true\n    }\n}</code></pre>   <p><code>GET /_node/configuration</code></p> <p>Gets the node configuration from the <code>gravitee.yml</code> file and/or environment variables.</p> <pre><code>HTTP/1.1 200 OK\nContent-Type: application/json\n\n{\n    \"analytics.elasticsearch.endpoints[0]\": \"http://${ds.elastic.host}:${ds.elastic.port}\",\n    \"analytics.type\": \"elasticsearch\",\n    \"ds.elastic.host\": \"localhost\",\n    \"ds.elastic.port\": 9200,\n    ...\n}</code></pre>   <p><code>GET /_node/monitor</code></p> <p>Gets monitoring information from the JVM and the server.</p> <pre><code>HTTP/1.1 200 OK\nContent-Type: application/json\n\n{\n    \"jvm\": {\n        \"gc\": {\n            \"collectors\": [\n                {\n                    \"collectionCount\": 7,\n                    \"collectionTime\": 98,\n                    \"name\": \"young\"\n                },\n                {\n                    \"collectionCount\": 3,\n                    \"collectionTime\": 189,\n                    \"name\": \"old\"\n                }\n            ]\n        },\n        \"mem\": {\n    ...\n}</code></pre>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-technical-api/#endpoints"},{"title":"Component-specific endpoints","text":"<p>In addition to the main endpoints listed above, the API includes dedicated endpoints to get more information about the APIs deployed on the APIM Gateway instance.</p>         <p>Operation</p> <p>Description</p> <p>Example</p>   <p><code>GET /_node/apis</code></p> <p>Gets the APIs deployed on this APIM Gateway instance.</p> <pre><code>HTTP/1.1 200 OK\nContent-Type: application/json\n\n[\n    {\n        \"id\": \"5b7a30b5-8feb-4c11-ba30-b58feb6c112f\",\n        \"name\": \"Foo API\",\n        \"version\": \"1.0.0\"\n    },\n    {\n        \"id\": \"5da639b6-a3c7-4cc5-a639-b6a3c75cc5f9\",\n        \"name\": \"Bar API\",\n        \"version\": \"v1\"\n    }\n]</code></pre>   <p><code>GET /_node/apis/{api.id}</code></p> <p>Gets the API configuration for this APIM Gateway instance.</p> <pre><code>HTTP/1.1 200 OK\nContent-Type: application/json\n\n{\n    \"deployedAt\": 1552574408611,\n    \"enabled\": true,\n    \"id\": \"5b7a30b5-8feb-4c11-ba30-b58feb6c112f\",\n    \"name\": \"Foo API\",\n    \"pathMappings\": {},\n    \"paths\": {\n     ...\n}</code></pre>","location":"apim/installation-guide/configuration/gateway/installation-guide-gateway-technical-api/#component-specific-endpoints"},{"title":"Overview","text":"<p>To test out Gravitee\u2019s distributed tracing feature, use the instructions below.</p>","location":"apim/installation-guide/configuration/gateway/opentracing-in-docker/"},{"title":"1. Start The Jaeger Component","text":"<p>Start the Jaeger component with the Docker image by running this command:</p> <pre><code>docker run -d --name jaeger \\\n  -p 5775:5775/udp \\\n  -p 6831:6831/udp \\\n  -p 6832:6832/udp \\\n  -p 5778:5778 \\\n  -p 16686:16686 \\\n  -p 14268:14268 \\\n  -p 14250:14250 \\\n  -p 9411:9411 \\\n  jaegertracing/all-in-one:1.24\n</code></pre> <p>This is the Docker run command for installing Jaeger is direct from Jaegertracing.io and no customizations to the configuration are included.</p> <p>Visit the Jaeger website for more information on the Jaeger tracer from Uber.</p> <p>PRO-TIP: Running this Docker command will also provide access to the JaegerUI, which can be reached using its default port: http://localhost:16686.</p> <p>You can confirm Jaeger has been enabled and is running by checking Docker.</p>","location":"apim/installation-guide/configuration/gateway/opentracing-in-docker/#1-start-the-jaeger-component"},{"title":"2. Install The .ZIP File For The Jaeger Tracer Plugin","text":"<p>Since the Jaeger tracer is not bundled by default, click here and add the plugin for the Gravitee Jaeger Tracer .ZIP file to the configuration of your APIM Gateway instance.</p>","location":"apim/installation-guide/configuration/gateway/opentracing-in-docker/#2-install-the-zip-file-for-the-jaeger-tracer-plugin"},{"title":"3. Test OpenTracing","text":"<ol> <li> <p>Now that you have OpenTracing enabled, run your API Gateway and     APIM.</p> </li> <li> <p>Open APIM and choose an API that already has a policy assigned to it     (or create a test API and add any policies you like for this test).     Now, call your API.</p> </li> <li> <p>To see your calls, open the helpful, user-friendly JaegerUI by     visiting http://localhost:16686 (note that JaegerUI was     automatically installed earlier in the process). Click Search     and find the API you called.</p> </li> </ol> <p>image:{% link images/apim/3.x/installation/configuration/tracing-info-general.png %}[General tracing info from JaegerUI.]</p> <p>In these examples, you\u2019ll also notice that each policy traversed is listed on a different line to provide greater visibility and assist with debugging. You can even see timestamp info on the detailed view.</p> <p>image:{% link images/apim/3.x/installation/configuration/tracing-info-detailed.png %}[Detailed tracing info from JaegerUI.]</p>","location":"apim/installation-guide/configuration/gateway/opentracing-in-docker/#3-test-opentracing"},{"title":"Configure Environment Variables","text":"<p>You can configure the environment variables as needed in the Jaeger Gateway. For example,</p> <pre><code>gravitee_service_tracing_enabled: true\ngravitee_services_tracing_jaegar_host: localhost\ngravitee_services_tracing_jaeger_port: 14250\n</code></pre>","location":"apim/installation-guide/configuration/gateway/opentracing-in-docker/#configure-environment-variables"},{"title":"How To Enable OpenTracing Via Docker Compose","text":"<p>You can also enable OpenTracing using Jaeger as a tracer with this Docker Compose. Click here^ to access the <code>docker-compose.yml</code>.</p> <p>With this option enabled, you can continue to call your APIs through your gateway with the usual host: <code>http://localhost:8082/myapi</code>.</p>","location":"apim/installation-guide/configuration/gateway/opentracing-in-docker/#how-to-enable-opentracing-via-docker-compose"},{"title":"1. How To Run OpenTracing With Jaeger","text":"<ol> <li> <p>Since the Jaeger tracer is not bundled by default, you must     download the .ZIP file for the version you want to run (click     here     to download the .ZIP).</p> </li> <li> <p>After downloading, you must copy this into the     <code>opentracing-jaeger/.plugins</code> directory using the command below:</p> <p><code>APIM_VERSION={APIM_VERSION} docker-compose up -d</code></p> </li> <li> <p>Be sure to fetch last version of images by running this command:</p> <pre><code>export APIM_VERSION={APIM_VERSION} &amp;&amp; docker-compose down -v &amp;&amp; docker-compose pull &amp;&amp; docker-compose up\n</code></pre> </li> </ol>","location":"apim/installation-guide/configuration/gateway/opentracing-in-docker/#1-how-to-run-opentracing-with-jaeger"},{"title":"How Can I See My Traces?","text":"<p>Jaeger comes with a helpful, user-friendly UI that allows you to see your calls. To access this UI, visit http://localhost:16686.</p> <p>Then, select gio_apim_gateway in the Service list and click the Find Traces button.</p> <p>image:{% link images/apim/3.x/installation/configuration/jaeger-search.png %}[Jaeger search console and results.]</p>","location":"apim/installation-guide/configuration/gateway/opentracing-in-docker/#how-can-i-see-my-traces"},{"title":"Overview","text":"<p>You can configure dashboards in APIM Console to display different types of analytics in various formats. For each dashboard, you can choose the type of data displayed and the format of the display, such as a chart, map or table. You can also specify a filter, to display analytics only for the queries you want.</p> <p>You can create generic dashboards for the whole APIM platform, or specific dashboards for APIs and applications.</p> <ul> <li> <p>Platform-wide dashboards are viewable through the APIM Console     Dashboard menu option, by clicking the ANALYTICS tab.</p> </li> <li> <p>API dashboards are viewable through the APIs menu option, by     selecting an API and clicking Analytics.</p> </li> <li> <p>Application dashboards are viewable through the Applications     menu option, by selecting an application and clicking Analytics.</p> </li> </ul> <p>You can create multiple dashboards of each type with different configurations, and choose the order in which they are displayed in the menu.</p>","location":"apim/installation-guide/configuration/management-ui/installation-guide-dashboard-configuration/"},{"title":"Create or configure a dashboard","text":"<p>Dashboards are configured by adding and removing widgets, which are containers for different types and views of data.</p> <ol> <li> <p>link:{{ /apim/3.x/apim_quickstart_console_login.html |     relative_url }}[Log in to APIM Console^].</p> </li> <li> <p>Click Settings &gt; Analytics.</p> <p>image:{% link images/apim/3.x/installation/configuration/configure-dashboards.png %}[]</p> </li> <li> <p>You can now:</p> <ul> <li> <p>Add a new platform-wide dashboard by clicking ADD A NEW     DASHBOARD PLATFORM</p> </li> <li> <p>Add a new API-level dashboard by clicking ADD A NEW DASHBOARD     API</p> </li> <li> <p>Add a new application-level dashboard by clicking ADD A NEW     DASHBOARD APPLICATION</p> </li> <li> <p>Select a dashboard from one of the three dashboard lists to     configure it</p> </li> </ul> </li> <li> <p>Specify a query filter in the Query filter field if you want to     filter the API calls included in the analytics.</p> </li> <li> <p>Click the plus icon image:{% link images/icons/plus-icon.png     %}[role=\"icon\"] to add new widgets to the dashboard.</p> </li> <li> <p>Select the widget type from the list and specify the other values.</p> <p>image:{% link images/apim/3.x/installation/configuration/configure-dashboard-widgets.png %}[]</p> <p>Click ENABLE PREVIEW to preview your dashboard changes before saving.</p> <p>image:{% link images/apim/3.x/installation/configuration/configure-dashboards-preview.png %}[] . Add more widgets, as required. You can also edit or delete existing widgets. . Click SAVE.</p> </li> </ol> <p>By using the link:{{ /apim/3.x/apim_policies_assign_metrics.html | relative_url }}[Assign Metrics policy] in one of your APIs, you can use a custom field in the widget.</p> <p>See link:{{ /apim/3.x/apim_how_to_add_custom_metrics_in_dashboards.html | relative_url }}[How to add custom metrics in dashboards].</p>","location":"apim/installation-guide/configuration/management-ui/installation-guide-dashboard-configuration/#create-or-configure-a-dashboard"},{"title":"Update a dashboard","text":"<p>You can perform the following actions on any dashboard in the three dashboard lists:</p> <ul> <li> <p>Delete it with the delete icon image:{% link     images/icons/delete-icon.png %}[role=\"icon\"]</p> </li> <li> <p>Disable or enable it by toggling the enabled image:{% link     images/icons/enabled-icon.png %}[role=\"icon\"] and disabled     image:{% link images/icons/disabled-icon.png %}[role=\"icon\"] icons</p> </li> <li> <p>Move it up or down the list with the up image:{% link     images/icons/up-arrow-icon.png %}[role=\"icon\"] and down image:{%     link images/icons/down-arrow-icon.png %}[role=\"icon\"] arrows to     change its order of priority in the menu</p> </li> </ul>","location":"apim/installation-guide/configuration/management-ui/installation-guide-dashboard-configuration/#update-a-dashboard"},{"title":"Overview","text":"<p>There are 2 ways to configure APIM Console:</p> <ul> <li> <p>with a file named <code>constants.json</code></p> </li> <li> <p>with the values stored in the Management repository</p> </li> </ul> <p>You can use both together. The <code>constants.json</code> file overrides the repository configuration. For example, you can centralize all your configuration in the repository and override the <code>portal.entrypoint</code> with the <code>constants.json</code> file value to specify different values for different datacenters.</p> <p>The only mandatory value in the <code>constants.json</code> file is`:</p> <pre><code>{\n  \"baseURL\": \"gravitee_management_api_url\"\n}\n</code></pre> <p>It describes where the APIM API Management endpoint is, and must be set so APIM Console can send requests to it.</p>","location":"apim/installation-guide/configuration/management-ui/installation-guide-management-ui-configuration/"},{"title":"Default configuration","text":"","location":"apim/installation-guide/configuration/management-ui/installation-guide-management-ui-configuration/#default-configuration"},{"title":"Configuration endpoints","text":"","location":"apim/installation-guide/configuration/management-ui/installation-guide-management-ui-configuration/#configuration-endpoints"},{"title":"Organization settings","text":"<p>The following endpoint retrieves the organization configuration stored in the Management repository: <code>GET /management/organizations/{organizationId}/settings</code></p> <p>The following endpoint updates this configuration: <code>POST /management/organizations/{organizationId}/settings</code></p> <p>You must provide the complete JSON body shown below to update the configuration. Otherwise, default values are stored.</p> <p>JSON format  </p>  <pre><code>{\n  \"email\" : {\n    \"enabled\" : false,\n    \"host\" : \"smtp.my.domain\",\n    \"port\" : 587,\n    \"username\" : \"user@my.domain\",\n    \"password\" : \"password\",\n    \"protocol\" : \"smtp\",\n    \"subject\" : \"[Gravitee.io] %s\",\n    \"from\" : \"noreply@my.domain\",\n    \"properties\" : {\n      \"auth\" : false,\n      \"startTlsEnable\" : false,\n      \"sslTrust\" : \"\"\n    }\n  },\n  \"alert\" : {\n    \"enabled\" : false\n  },\n  \"authentication\" : {\n    \"google\" : {\n      \"clientId\" : \"googleplus_clientid\"\n    },\n    \"github\" : {\n      \"clientId\" : \"github_clientId\"\n    },\n    \"oauth2\" : {\n      \"clientId\" : \"oauth2_clientId\"\n    },\n    \"localLogin\" : {\n      \"enabled\" : true\n    }\n  },\n  \"cors\" : {\n    \"allowOrigin\" : [ \"*\" ],\n    \"allowHeaders\" : [ \"Cache-Control\", \"Pragma\", \"Origin\", \"Authorization\", \"Content-Type\", \"X-Requested-With\", \"If-Match\", \"X-Xsrf-Token\", \"X-Recaptcha-Token\" ],\n    \"allowMethods\" : [ \"OPTIONS\", \"GET\", \"POST\", \"PUT\", \"DELETE\", \"PATCH\" ],\n    \"exposedHeaders\" : [ \"ETag\", \"X-Xsrf-Token\" ],\n    \"maxAge\" : 1728000\n  },\n  \"reCaptcha\" : {\n    \"enabled\" : false,\n    \"siteKey\" : \"\"\n  },\n  \"scheduler\" : {\n    \"tasks\" : 10,\n    \"notifications\" : 10\n  },\n  \"logging\" : {\n    \"maxDurationMillis\" : 0,\n    \"audit\" : {\n      \"enabled\" : false,\n      \"trail\" : {\n        \"enabled\" : false\n      }\n    },\n    \"user\" : { }\n  },\n  \"maintenance\" : {\n    \"enabled\" : false\n  },\n  \"management\" : {\n    \"support\" : {\n      \"enabled\" : true\n    },\n    \"title\" : \"Gravitee.io Management\",\n    \"url\" : \"\",\n    \"userCreation\" : {\n      \"enabled\" : true\n    },\n    \"automaticValidation\" : {\n      \"enabled\" : true\n    }\n  },\n  \"newsletter\" : {\n    \"enabled\" : true\n  },\n  \"theme\" : {\n    \"name\" : \"default\",\n    \"logo\" : \"themes/assets/GRAVITEE_LOGO1-01.png\",\n    \"loader\" : \"assets/gravitee_logo_anim.gif\"\n  }\n}\n</code></pre>","location":"apim/installation-guide/configuration/management-ui/installation-guide-management-ui-configuration/#organization-settings"},{"title":"Environment settings","text":"<p>The following endpoint retrieves the organization configuration stored in the Management repository: <code>GET /management/organizations/{organizationId}/environments/{environmentId}/settings</code></p> <p>The following endpoint updates this configuration: <code>POST /management/organizations/{organizationId}/environments/{environmentId}/settings</code></p> <p>You must provide the complete JSON body shown below to update the configuration. Otherwise, default values are stored.</p> <p>JSON format  </p>  <pre><code>{\n  \"email\" : {\n    \"enabled\" : false,\n    \"host\" : \"smtp.my.domain\",\n    \"port\" : 587,\n    \"username\" : \"user@my.domain\",\n    \"password\" : \"password\",\n    \"protocol\" : \"smtp\",\n    \"subject\" : \"[Gravitee.io] %s\",\n    \"from\" : \"noreply@my.domain\",\n    \"properties\" : {\n      \"auth\" : false,\n      \"startTlsEnable\" : false,\n      \"sslTrust\" : \"\"\n    }\n  },\n  \"analytics\" : {\n    \"clientTimeout\" : 30000\n  },\n  \"api\" : {\n    \"labelsDictionary\" : [ ]\n  },\n  \"apiQualityMetrics\" : {\n    \"enabled\" : false,\n    \"functionalDocumentationWeight\" : 0,\n    \"technicalDocumentationWeight\" : 0,\n    \"descriptionWeight\" : 0,\n    \"descriptionMinLength\" : 100,\n    \"logoWeight\" : 0,\n    \"categoriesWeight\" : 0,\n    \"labelsWeight\" : 0,\n    \"healthcheckWeight\" : 0\n  },\n  \"apiReview\" : {\n    \"enabled\" : false\n  },\n  \"application\" : {\n    \"registration\" : {\n      \"enabled\" : true\n    },\n    \"types\" : {\n      \"simple\" : {\n        \"enabled\" : true\n      },\n      \"browser\" : {\n        \"enabled\" : true\n      },\n      \"web\" : {\n        \"enabled\" : true\n      },\n      \"native\" : {\n        \"enabled\" : true\n      },\n      \"backend_to_backend\" : {\n        \"enabled\" : true\n      }\n    }\n  },\n  \"authentication\" : {\n    \"google\" : {\n      \"clientId\" : \"googleplus_clientid\"\n    },\n    \"github\" : {\n      \"clientId\" : \"github_clientId\"\n    },\n    \"oauth2\" : {\n      \"clientId\" : \"oauth2_clientId\"\n    },\n    \"forceLogin\" : {\n      \"enabled\" : false\n    },\n    \"localLogin\" : {\n      \"enabled\" : true\n    }\n  },\n  \"company\" : {\n    \"name\" : \"Gravitee.io\"\n  },\n  \"cors\" : {\n    \"allowOrigin\" : [ \"*\" ],\n    \"allowHeaders\" : [ \"Cache-Control\", \"Pragma\", \"Origin\", \"Authorization\", \"Content-Type\", \"X-Requested-With\", \"If-Match\", \"X-Xsrf-Token\", \"X-Recaptcha-Token\" ],\n    \"allowMethods\" : [ \"OPTIONS\", \"GET\", \"POST\", \"PUT\", \"DELETE\", \"PATCH\" ],\n    \"exposedHeaders\" : [ \"ETag\", \"X-Xsrf-Token\" ],\n    \"maxAge\" : 1728000\n  },\n  \"dashboards\" : {\n    \"apiStatus\": {\n      \"enabled\": true\n    }\n  },\n  \"documentation\" : {\n    \"url\" : \"https://docs.gravitee.io\"\n  },\n  \"openAPIDocViewer\" : {\n    \"openAPIDocType\" : {\n      \"swagger\" : {\n        \"enabled\" : true\n      },\n      \"redoc\" : {\n        \"enabled\" : true\n      },\n      \"defaultType\" : \"Swagger\"\n    }\n  },\n  \"plan\" : {\n    \"security\" : {\n      \"apikey\" : {\n        \"enabled\" : true\n      },\n      \"customApiKey\" : {\n        \"enabled\" : false\n      },\n      \"oauth2\" : {\n        \"enabled\" : true\n      },\n      \"keyless\" : {\n        \"enabled\" : true\n      },\n      \"jwt\" : {\n        \"enabled\" : true\n      }\n    }\n  },\n  \"portal\" : {\n    \"entrypoint\" : \"https://api.company.com\",\n    \"apikeyHeader\" : \"X-Gravitee-Api-Key\",\n    \"support\" : {\n      \"enabled\" : true\n    },\n    \"url\" : \"\",\n    \"apis\" : {\n      \"tilesMode\" : {\n        \"enabled\" : true\n      },\n      \"categoryMode\" : {\n        \"enabled\" : true\n      },\n      \"apiHeaderShowTags\" : {\n        \"enabled\" : true\n      },\n      \"apiHeaderShowCategories\" : {\n        \"enabled\" : true\n      }\n    },\n    \"analytics\" : {\n      \"enabled\" : false,\n      \"trackingId\" : \"\"\n    },\n    \"rating\" : {\n      \"enabled\" : true,\n      \"comment\" : {\n        \"mandatory\" : false\n      }\n    },\n    \"userCreation\" : {\n      \"enabled\" : true,\n      \"automaticValidation\" : {\n        \"enabled\" : true\n      }\n    },\n    \"uploadMedia\" : {\n      \"enabled\" : true,\n      \"maxSizeInOctet\" : 1000000\n    }\n  },\n  \"reCaptcha\" : {\n    \"enabled\" : false,\n    \"siteKey\" : \"\"\n  },\n  \"scheduler\" : {\n    \"tasks\" : 10,\n    \"notifications\" : 10\n  }\n}\n</code></pre>","location":"apim/installation-guide/configuration/management-ui/installation-guide-management-ui-configuration/#environment-settings"},{"title":"Logo and loader","text":"<p>You can change the logo and the loader by updating the following values in <code>constants.json</code>:</p> <ul> <li> <p><code>theme.name</code> to your custom name</p> </li> <li> <p><code>theme.logo</code> to <code>themes/assets/your_logo.png</code></p> </li> <li> <p><code>theme.loader</code> to <code>assets/your_loader.gif</code></p> </li> </ul> <p>These parameters can be modified in the APIM Console Organization Settings &gt; Management &gt; Theme page.</p> <p>image::{% link images/apim/3.x/installation/management-ui/graviteeio-installation-management-ui-settings.png %}[]</p>","location":"apim/installation-guide/configuration/management-ui/installation-guide-management-ui-configuration/#logo-and-loader"},{"title":"Theme","text":"<p>You can customize the theme of APIM Console by modifying <code>default-theme.json</code> or <code>light-theme.json</code>.</p> <p>The <code>default-theme.json</code> file is as follows:</p>","location":"apim/installation-guide/configuration/management-ui/installation-guide-management-ui-configuration/#theme"},{"title":"Dashboard","text":"","location":"apim/installation-guide/configuration/management-ui/installation-guide-management-ui-configuration/#dashboard"},{"title":"Home","text":"<p>The Home dashboard is the default page users see when they first log in to APIM Console, or when they click the Dashboard menu option. You can configure the Home dashboard by modifying <code>home.json</code>.</p> <p>This file is located in the <code>/dashboards</code> folder of the Management API distribution folder.</p> <p>To customize the Home dashboard you can either modify this file or specify a new folder in the <code>gravitee.yml</code> file:</p> <p>```yaml # Console dashboards console: dashboards: path: ${gravitee.home}/dashboards ```</p> <p>By default, this section is commented out and the path is <code>${gravitee.home}/dashboards</code></p> <p>Charts are generated with Highcharts^. You can use the Highchart documentation to help you define the <code>chart</code> section of the JSON objects.</p> <p>For example:</p> <p>```json [ { \"row\": 0, \"col\": 0, \"sizeY\": 1, \"sizeX\": 1, \"title\": \"Number of APIs\", \"chart\": { \"type\": \"count\", \"data\": [ { \"key\": \"count\", \"label\": \"total\", \"color\": \"#42a5f5\" } ], \"request\": { \"type\": \"count\", \"field\": \"api\" } } }, \u2026 ] ``` === Api STATUS</p> <p>The api status page is a panel in the dashboard that displays the status of all apis.</p> <p>The tab is enabled by default but depending on the number of APIs, it may take a while to load. You can disable it in the settings section.</p>","location":"apim/installation-guide/configuration/management-ui/installation-guide-management-ui-configuration/#home"},{"title":"Configuration file","text":"<p>The configuration file for APIM Portal is <code>assets\\config.json</code>. You can see the default configuration in the example below.</p>","location":"apim/installation-guide/configuration/portal-ui/installation-guide-portal-ui-configuration/"},{"title":"Mandatory configuration","text":"<p>The only mandatory value in the <code>config.json</code> file is <code>baseURL</code>, which describes where the APIM API Portal endpoint is. You must set this value so that APIM Portal can send requests to it.</p>","location":"apim/installation-guide/configuration/portal-ui/installation-guide-portal-ui-configuration/#mandatory-configuration"},{"title":"Configure the APIM Portal theme","text":"<p>You can change the default theme of APIM Portal to your own custom theme.</p> <p>You customize the theme in APIM Console with the Settings &gt; Theme menu option.</p> <p>image::{% link images/apim/3.x/installation/portal-ui/graviteeio-portal-configuration-theme.png %}[]</p> <p>Whenever you change a setting, you can see the change reflected in the live preview to the right.</p> <p>To use the live preview, you must first configure a Portal URL in the Portal settings:</p> <p>image::{% link images/apim/3.x/installation/portal-ui/portal-url.png %}[]</p>","location":"apim/installation-guide/configuration/portal-ui/installation-guide-portal-ui-configuration/#configure-the-apim-portal-theme"},{"title":"Top menu","text":"<p>FULLSCREEN This button opens the preview in a new window, making it easier to edit if you have several screens. NOTE: This button is only visible if you configure a Portal URL, as described above.</p> <p>RESET This button allows you to reset the theme from the last backup.</p> <p>SAVE This button saves your theme.</p> <p>ENABLED This switch activates the theme in APIM Portal.</p> <p>RESTORE TO DEFAULT THEME This action overwrites your modifications with the theme provided by default.</p>","location":"apim/installation-guide/configuration/portal-ui/installation-guide-portal-ui-configuration/#top-menu"},{"title":"Basic customization","text":"<p>Some basic customization options are:</p> <p>Images Add your logos. Optional logo is used for the home page and the footer, but you can override this to use same logo for everything by clicking Use default logo.</p> <p>Homepage Add your Homepage background image.</p> <p>Colors Define your primary, neutral and font colors.</p> <p>Fonts Choose your font family and sizes. Medium sizes are used by default.</p>","location":"apim/installation-guide/configuration/portal-ui/installation-guide-portal-ui-configuration/#basic-customization"},{"title":"Advanced customization","text":"<p>If you want to customize further, you can define the graphic properties to expose for each component.</p> <p>Each component uses its own properties, but where possible, we group the properties into common variables such as the ones listed in ??? above.</p> <p>You can see common component colors, for example, by holding your mouse over the color bubble. For other property types, if a common property is used, you can see this in the placeholder field.</p>","location":"apim/installation-guide/configuration/portal-ui/installation-guide-portal-ui-configuration/#advanced-customization"},{"title":"Override theme files","text":"<p>APIM API comes with a default theme and two default logos:</p> <ul> <li> <p><code>definition.json</code></p> </li> <li> <p><code>logo.png</code></p> </li> <li> <p><code>logo-light.png</code></p> </li> </ul> <p>These files are located in the <code>/themes</code> folder of the API distribution folder.</p> <p>To customize the Portal theme you can either modify these three files or specify a new folder in the <code>gravitee.yml</code> file:</p> <p>```yaml # Portal themes portal: themes: path: ${gravitee.home}/themes ```</p> <p>By default, this configuration is commented out and the path is <code>${gravitee.home}/themes</code></p> <p>To help you to create your theme, you can use the editor in Settings &gt; Theme and export it to a JSON file with the EXPORT button in the top menu. However, there are two important things to keep in mind:</p> <ul> <li> <p>Images and logos cannot be changed using this method. You need to     edit the two files in the distribution.</p> </li> <li> <p>Exported themes do not have the same format as the provided     <code>definition.json</code> file. You will need to make some minor edits to     the exported theme.</p> </li> </ul> <p>Expected format ```json { \"data\": [ { \"name\": \"gv-theme\", \"css\": [ { \"name\": \"--gv-theme-color-darker\", \"description\": \"Primary darker color\", \"type\": \"color\", \"default\": \"#383E3F\", \"value\": \"#383E3F\" }, \u2026 ] }, \u2026 ] } ```</p>","location":"apim/installation-guide/configuration/portal-ui/installation-guide-portal-ui-configuration/#override-theme-files"},{"title":"Configure Reporters","text":"<p>Reporters are designed to record a variety of events occurring in the gateway, to a variety of outputs and formats, in their order of occurrence. This enables you to manage this data using a solution of your choice.</p> <p>The following event types are supported.</p>","location":"apim/installation-guide/configuration/reporters/installation-guide-reporters/"},{"title":"Event types","text":"<p>Type</p> <p>Description</p>   <p><code>request</code></p> <p>This event type provides common request and response metrics, such as response time, application, request ID, and more.</p>   <p><code>log</code></p> <p>This event type provides more detailed request and response metrics. It is reported when logging has been enabled at the API level.</p>   <p><code>healthcheck</code></p> <p>This event type allows for healthcheck events to be reported when a healthcheck endpoint has been configured and enabled on an API.</p>   <p><code>node</code></p> <p>This event type provides some system and JVM metrics for the node Gravitee is running on.</p>","location":"apim/installation-guide/configuration/reporters/installation-guide-reporters/#event-types"},{"title":"Available Reporters","text":"<p>Type</p> <p>Bundled</p> <p>Default</p>   <p>Elasticsearch</p> <p>\u2713</p> <p>\u2713</p>   <p>File</p> <p>\u2713</p> <p>\u00d7</p>   <p>TCP</p> <p>\u2713</p> <p>\u00d7</p>","location":"apim/installation-guide/configuration/reporters/installation-guide-reporters/#available-reporters"},{"title":"Configuring Reporters","text":"","location":"apim/installation-guide/configuration/reporters/installation-guide-reporters/#configuring-reporters"},{"title":"Elasticsearch Reporter","text":"<p>Configuration details for the elasticsearch reporter are available in the link:{{ /apim/3.x/apim_installguide_repositories_elasticsearch.html | relative_url }}[Elasticsearch Repository] documentation.</p>","location":"apim/installation-guide/configuration/reporters/installation-guide-reporters/#elasticsearch-reporter"},{"title":"File Reporter","text":"","location":"apim/installation-guide/configuration/reporters/installation-guide-reporters/#file-reporter"},{"title":"Configuration Parameters","text":"<p>Parameter name</p> <p>Description</p> <p>Default value</p>   <p><code>enabled</code></p> <p>This setting determines whether the file reporter should be started or not. The default value is <code>false</code>.</p> <p>false</p>   <p><code>fileName</code></p> <p>The path events should be written to. Use the <code>%s-yyyy_mm_dd</code> pattern to create one file per event type on a daily basis.</p> <p>#{systemProperties[gravitee.home]}/metrics/%s-yyyy_mm_dd}</p>   <p><code>output</code></p> <p>Output file type - json, message_pack, elasticsearch, csv.</p> <p>json</p>   <p><code>flushInterval</code></p> <p>File flush interval (in ms).</p> <p>1000</p>   <p><code>retainDays</code></p> <p>The number of days to retain files before deleting one.</p> <p>0 (to retain forever)</p>   <p><code>&lt;EVENT_TYPE&gt;.exclude</code></p> <p>Fields to exclude from the output. Available for <code>json</code> and <code>message_pack</code> outputs only.</p> <p>none</p>   <p><code>&lt;EVENT_TYPE&gt;.include</code></p> <p>Fields to include in the output. Available for <code>json</code> and <code>message_pack</code> outputs and only if excludes have been defined.</p> <p>none</p>   <p><code>&lt;EVENT_TYPE&gt;.rename</code></p> <p>Fields to rename when writing the output. Available for <code>json</code> and <code>message_pack</code> outputs only.</p> <p>none</p>    <p>&lt;EVENT_TYPE&gt; refers to the kind of event reported by the gateway and can be either <code>request</code>, <code>log</code>, <code>node</code> or <code>healthcheck</code>. Fields referenced as <code>exclude</code>, <code>include</code> and <code>rename</code> items all support jsonPath for accessing nested elements.</p>","location":"apim/installation-guide/configuration/reporters/installation-guide-reporters/#configuration-parameters"},{"title":"Example","text":"<p>The configuration example below excludes all fields from the request JSON file except the <code>api</code> and <code>application</code> fields, renames the <code>application</code> field to <code>app</code>, and excludes <code>log</code>, <code>node</code>, and <code>healthcheck</code> events from being reported.</p> <pre><code>reporters:\n  file:\n    enabled: true\n    fileName: ${gravitee.home}/metrics/%s-yyyy_mm_dd\n    output: json\n    request:\n      exclude:\n        - \"*\"\n      include:\n        - api\n        - application\n      rename:\n        application: app\n    log:\n      exclude: *\n    node:\n      exclude: *\n    healthcheck:\n      exclude: *\n</code></pre>","location":"apim/installation-guide/configuration/reporters/installation-guide-reporters/#example"},{"title":"TCP Reporter","text":"","location":"apim/installation-guide/configuration/reporters/installation-guide-reporters/#tcp-reporter"},{"title":"Configuration Parameters","text":"<p>Parameter name</p> <p>Description</p> <p>Default value</p>   <p><code>enabled</code></p> <p>This setting determines whether the TCP reporter should be started or not. The default value is <code>false</code>.</p> <p>false</p>   <p><code>output</code></p> <p>Format of the data written to the TCP socket - json, message_pack, elasticsearch, csv.</p> <p>json</p>   <p><code>host</code></p> <p>The TCP host where the event should be published. This can be a valid host name or an IP address.</p> <p>localhost</p>   <p><code>port</code></p> <p>The TCP port used to connect to the host.</p> <p>8123</p>   <p><code>connectTimeout</code></p> <p>Maximum time allowed to establish the TCP connection in milliseconds.</p> <p>10000</p>   <p><code>reconnectAttempts</code></p> <p>This setting determines how many times the socket should try to establish a connection in case of failure.</p> <p>10</p>   <p><code>reconnectInterval</code></p> <p>Time (in milliseconds) between socket connection attempts.</p> <p>500</p>   <p><code>retryTimeout</code></p> <p>If the max reconnect attempts have been reached, this setting determines how long (in milliseconds) the reporter should wait before trying to connect again.</p> <p>5000</p>","location":"apim/installation-guide/configuration/reporters/installation-guide-reporters/#configuration-parameters_1"},{"title":"Example","text":"<p>The following example uses the same configuration as the previous example above, however it writes the events to a TCP socket instead of a file.</p> <pre><code>reporters:\n  tcp:\n    enabled: true\n    host: localhost\n    port: 9001\n    output: json\n    request:\n      exclude:\n        - \"*\"\n      include:\n        - api\n        - application\n      rename:\n        application: app\n    log:\n      exclude: *\n    node:\n      exclude: *\n    healthcheck:\n      exclude: *\n</code></pre>","location":"apim/installation-guide/configuration/reporters/installation-guide-reporters/#example_1"},{"title":"Elasticsearch","text":"<p>[[gravitee-installation-repositories-elasticsearch]] = Elasticsearch :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_installguide_repositories_elasticsearch.html :page-folder: apim/installation-guide/repositories :page-description: Gravitee.io API Management - Repositories - Elasticsearch :page-keywords: Gravitee.io, API Platform, API Management, API Gateway, oauth2, openid, documentation, manual, guide, reference, api, elastic, es, elasticsearch, ilm :page-layout: apim3x</p> <p>The Elasticsearch connector is based on the HTTP API exposed by ES instances. This connector supports all versions of ES, from 5.x to 7.x, and OpenSearch v1.x.</p> <p>You can find more detail about supported versions of ElasticSearch at https://www.elastic.co/support/eol.</p> <p>WARNING: Gravitee.io no longer supports native ES client. Previous connectors provided by us are no longer supported.</p> <p>== Configuration</p> <p>=== APIM API configuration</p> <p>WARNING: The Elasticsearch client does not support URL schemes in format <code>http://USERNAME:PASSWORD@server.org</code>. You must provide the username and password using the <code>analytics.elasticsearch.security.username</code> and <code>analytics.elasticsearch.security.password</code> properties.</p>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/"},{"title":"[source,yaml]","text":"<p>analytics:   type: elasticsearch   elasticsearch:     endpoints:       - http://localhost:9200</p>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#sourceyaml"},{"title":"index: gravitee","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#index-gravitee"},{"title":"index_mode: daily    # \"daily\" indexes, suffixed with date. Or \"ilm\" managed indexes, without date","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#index_mode-daily-daily-indexes-suffixed-with-date-or-ilm-managed-indexes-without-date"},{"title":"security:","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#security"},{"title":"username:","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#username"},{"title":"password:","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#password"},{"title":"ssl:                        # for https es connection","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#ssl-for-https-es-connection"},{"title":"keystore:","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#keystore"},{"title":"type: jks               # required. also valid values are \"pem\", \"pfx\"","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#type-jks-required-also-valid-values-are-pem-pfx"},{"title":"path: path/to/jks         # only for only for jks / pkcs12","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#path-pathtojks-only-for-only-for-jks-pkcs12"},{"title":"password:  # only for only for jks / pkcs12","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#password-only-for-only-for-jks-pkcs12"},{"title":"certs: 'path/to/cert'      # only for pems","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#certs-pathtocert-only-for-pems"},{"title":"keys: 'path/to/key'        # only for pems  <p>=== API Gateway configuration [source,yaml]</p>  <p>reporters:   elasticsearch:     enabled: true # Is the reporter enabled or not (default to true)     endpoints:       - http://${ds.elastic.host}:${ds.elastic.port}</p>","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#keys-pathtokey-only-for-pems"},{"title":"index: gravitee","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#index-gravitee_1"},{"title":"index_mode: daily    # \"daily\" indexes, suffixed with date. Or \"ilm\" managed indexes, without date","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#index_mode-daily-daily-indexes-suffixed-with-date-or-ilm-managed-indexes-without-date_1"},{"title":"cluster: elasticsearch","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#cluster-elasticsearch"},{"title":"bulk:","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#bulk"},{"title":"actions: 1000           # Number of requests action before flush","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#actions-1000-number-of-requests-action-before-flush"},{"title":"flush_interval: 5       # Flush interval in seconds","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#flush_interval-5-flush-interval-in-seconds"},{"title":"concurrent_requests: 5  # Concurrent requests","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#concurrent_requests-5-concurrent-requests"},{"title":"settings:","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#settings"},{"title":"number_of_shards: 5","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#number_of_shards-5"},{"title":"number_of_replicas: 1","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#number_of_replicas-1"},{"title":"pipeline:","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#pipeline"},{"title":"plugins:","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#plugins"},{"title":"ingest: geoip","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#ingest-geoip"},{"title":"ssl:                        # for https es connection","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#ssl-for-https-es-connection_1"},{"title":"keystore:","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#keystore_1"},{"title":"type: jks               # required. also valid values are \"pem\", \"pfx\"","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#type-jks-required-also-valid-values-are-pem-pfx_1"},{"title":"path: path/to/jks         # only for only for jks / pkcs12","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#path-pathtojks-only-for-only-for-jks-pkcs12_1"},{"title":"password:  # only for only for jks / pkcs12","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#password-only-for-only-for-jks-pkcs12_1"},{"title":"certs: 'path/to/cert'      # only for pems","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#certs-pathtocert-only-for-pems_1"},{"title":"keys: 'path/to/key'        # only for pems  <p>== Index management with ES Curator</p> <p>ES Curator is a great tool for ES administration. For optimizing data footprint and ES performance you can define a retention window and periodically merge shards into only one segment.</p>","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#keys-pathtokey-only-for-pems_1"},{"title":"[source,bash]","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#sourcebash"},{"title":"/usr/bin/curator --config /opt/curator/curator.yml /opt/curator/action-curator.yml","text":"<p>curator.yml : [source,yaml]</p>  <p>client:   hosts:     - node1     - node2   port: 9200</p> <p>logging:   loglevel: INFO   logfile:   logformat: default   blacklist: ['elasticsearch', 'urllib3']</p>  <p>action-curator.yml : [source,yaml]</p>  <p>actions:   1:     action: forcemerge     description: \"Perform a forceMerge on selected indices to 'max_num_segments' per shard. Merge Days - 1 index for optimize disk space footprint on Elasticsearch TS\"     options:       max_num_segments: 1       continue_if_exception: True       ignore_empty_list: True     filters:     - filtertype: pattern       kind: prefix       value: '^(gravitee-).$'       exclude: False     - filtertype: age       source: name       direction: older       unit: days       unit_count: 1       timestring: '%Y.%m.%d'   2:     action: delete_indices     description: \"Delete selected indices older than 15d days\"     options:       continue_if_exception: True       ignore_empty_list: True     filters:     - filtertype: pattern       kind: prefix       value: '^(gravitee-).$'       exclude: False     - filtertype: age       source: name       direction: older       unit: days       unit_count: 15       timestring: '%Y.%m.%d'</p>  <p>NOTE: If you deploy ES Curator on every ES data node, you need to set <code>master_only: True</code> in the curator configuration file. This ensures the curator is run only once on the elected current master.</p> <p>== Index management with ES ILM</p> <p>IMPORTANT: To use ILM feature you need to use at least version 3.8.5 (for APIM 3.10.x) or 3.12.1 of the plugin (for APIM 3.15.x and upper).</p> <p>You can configure Index Lifecycle Management (ILM) policies to automatically manage indices according to your retention requirements. For example, you can use ILM to create a new index each day and archive the previous ones. You can check the documentation https://www.elastic.co/guide/en/elasticsearch/reference/current/set-up-lifecycle-policy.html#ilm-create-policy[here] for more information.</p> <p>By default, the <code>index_mode</code> configuration value is <code>daily</code>: Gravitee suffixes index names with the date.</p> <p>If you want to let ILM handles that, you can set <code>index_mode</code> to <code>ILM</code>. Gravitee will no longer adds a suffix to index names.</p> <p>You also need to tell your APIM Gateway which ILM policies to use.</p> <p>Here's an example of configuration for APIM Gateway: <pre><code>  elasticsearch:\n    enabled: true # Is the reporter enabled or not (default to true)\n    endpoints:\n      - http://${ds.elastic.host}:${ds.elastic.port}\n    lifecycle:\n      policies:\n        health: hot_delete_health # ILM policy for the gravitee-health-* indexes\n        monitor: hot_delete_monitor # ILM policy for the gravitee-monitor-* indexes\n        request: hot_delete_request # ILM policy for the gravitee-request-* indexes\n        log: hot_delete_log # ILM policy for the gravitee-log-* indexes\n    index_mode: ilm         # \"daily\" indexes, suffixed with date. Or \"ilm\" managed indexes, without date\n</code></pre></p>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-elasticsearch/#usrbincurator-config-optcuratorcuratoryml-optcuratoraction-curatoryml"},{"title":"Overview","text":"<p>This repository plugin is for connecting to SQL databases.</p>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-jdbc/"},{"title":"Supported databases","text":"<p>Database</p> <p>Version tested</p> <p>APIM Plugin</p> <p>JDBC Driver</p>   <p>Postgresql</p> <p>9 / 10 / 11 / 12 / 13</p> <p>Download the same version as your APIM platform</p> <p>Download page</p>   <p>MySQL</p> <p>5.6 / 5.7 / 8.0</p> <p>Download page</p>    <p>MariaDB</p> <p>10.1 / 10.2 / 10.3 / 10.4</p> <p>Download page</p>    <p>Microsoft SQL Server</p> <p>2017-CU12</p> <p>Download page</p>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-jdbc/#supported-databases"},{"title":"Install the JDBC plugin","text":"<p>Because the plugin is part of the default distribution from APIM version 3.5, you only need to complete these steps for version 3.4 or earlier.</p> <p>Repeat these steps on each component (APIM Gateway and APIM API) where the SQL database is used.</p> <ol> <li> <p>Download the plugin corresponding to your APIM version (take the     latest maintenance release).</p> </li> <li> <p>Place the zip file in the plugin directory for each component     (<code>$GRAVITEE_HOME/plugins</code>).</p> </li> <li> <p>Download the JDBC driver corresponding to your database version.</p> </li> <li> <p>Place the driver in <code>$GRAVITEE_HOME/plugins/ext/repository-jdbc</code>.</p> </li> <li> <p>Configure your <code>gravitee.yml</code> files, as described in the next     section.</p> </li> </ol>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-jdbc/#install-the-jdbc-plugin"},{"title":"Configuration","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-jdbc/#configuration"},{"title":"Mandatory configuration","text":"<pre><code>management:\n  type: jdbc             # repository type\n  jdbc:                  # jdbc repository\n    url:                 # jdbc url\n</code></pre>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-jdbc/#mandatory-configuration"},{"title":"Optional configuration","text":"<p>The example above shows the minimum configuration needed to get started with a JDBC database. You can configure the following additional properties to fine-tune your JDBC connection and control the behavior of your JDBC database.</p> <pre><code>management:\n  type: jdbc                    # repository type\n  jdbc:                         # jdbc repository\n    prefix:                     # tables prefix\n    url:                        # jdbc url\n    username:                   # jdbc username\n    password:                   # jdbc password\n    pool:\n        autoCommit:             # jdbc auto commit (default true)\n        connectionTimeout:      # jdbc connection timeout (default 10000)\n        idleTimeout:            # jdbc idle timeout (default 600000)\n        maxLifetime:            # jdbc max lifetime (default 1800000)\n        minIdle:                # jdbc min idle (default 10)\n        maxPoolSize:            # jdbc max pool size (default 10)\n</code></pre>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-jdbc/#optional-configuration"},{"title":"Use a custom prefix","text":"<p>From APIM 3.7, you can use a custom prefix for your table names. This is useful if you want to use the same databases for APIM and AM, for example.</p> <p>The following steps explain how to rename your tables with a custom prefix, using the prefix <code>prefix_</code> as an example.</p>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-jdbc/#use-a-custom-prefix"},{"title":"On a new installation","text":"<p>If you are installing APIM for the first time, you need to update the following two values in the APIM Gateway and APIM API <code>gravitee.yml</code> files:</p> <ul> <li> <p><code>management.jdbc.prefix</code></p> </li> <li> <p><code>ratelimit.jdbc.prefix</code></p> </li> </ul> <p>By default, these values are empty.</p>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-jdbc/#on-a-new-installation"},{"title":"Migrating an existing installation","text":"<p>Before running any scripts, you need to create a dump of your existing database. You need to repeat these steps on both APIM Gateway and APIM API.</p> <ol> <li> <p>Update values <code>management.jdbc.prefix</code> and <code>ratelimit.jdbc.prefix</code>     in your <code>gravitee.yml</code> configuration file.</p> </li> <li> <p>Run the application on a new database to generate     <code>prefix_databasechangelog</code>.</p> </li> <li> <p>Replace the content of the <code>databasechangelog</code> table with the     content you generated from <code>prefix_databasechangelog</code>.</p> </li> <li> <p>Rename your tables using format <code>prefix_tablename</code>.</p> </li> <li> <p>Rename your indexes using format <code>idx_prefix_indexname</code>.</p> </li> <li> <p>Rename your primary keys using format <code>pk_prefix_pkname</code>.</p> </li> </ol>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-jdbc/#migrating-an-existing-installation"},{"title":"MongoDB","text":"<p>= MongoDB :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_installguide_repositories_mongodb.html :page-folder: apim/installation-guide/repositories :page-description: Gravitee.io API Management - Repositories - MongoDB :page-keywords: Gravitee.io, API Platform, API Management, API Gateway, oauth2, openid, documentation, manual, guide, reference, api :page-layout: apim3x</p> <p>== Supported versions</p> <p>|=== |APIM Version |Version tested | APIM plugin</p> <p>|1.30.x to 3.9.x |3.6 / 4.0 / 4.2 .2+.|https://download.gravitee.io/#graviteeio-apim/plugins/repositories/gravitee-apim-repository-mongodb/[Download the same version as your APIM platform, window=\\\"_blank\\\"]</p> <p>|3.10.x |3.6 / 4.0 / 4.2 / 4.4 |===</p> <p>== Configuration https://www.mongodb.org/[MongoDB, window=\\\"_blank\\\"] is the default repository implementation used by APIM.</p> <p>=== Mandatory configuration</p>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-mongodb/"},{"title":"[source,yaml]","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-mongodb/#sourceyaml"},{"title":"===================================================================","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-mongodb/#_1"},{"title":"MINIMUM MONGO REPOSITORY PROPERTIES","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-mongodb/#minimum-mongo-repository-properties"},{"title":"MongoDB","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-mongodb/#_2"},{"title":"This is a minimal sample file declared connection to MongoDB","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-mongodb/#this-is-a-minimal-sample-file-declared-connection-to-mongodb"},{"title":"===================================================================","text":"<p>management:   type: mongodb             # repository type   mongodb:                  # mongodb repository     dbname:                 # mongodb name (default gravitee)     host:                   # mongodb host (default localhost)     port:                   # mongodb port (default 27017)</p>  <p>=== Optional configuration</p> <p>The example above shows the minimum configuration required to get started with a MongoDB database. You can configure the following additional properties to customize the behavior of a MongoDB database.</p>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-mongodb/#_3"},{"title":"[source,yaml]","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-mongodb/#sourceyaml_1"},{"title":"===================================================================","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-mongodb/#_4"},{"title":"MONGO REPOSITORY PROPERTIES","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-mongodb/#mongo-repository-properties"},{"title":"MongoDB","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-mongodb/#_5"},{"title":"This is a sample file declared all properties for MongoDB Repository","text":"","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-mongodb/#this-is-a-sample-file-declared-all-properties-for-mongodb-repository"},{"title":"===================================================================","text":"<p>management:   type: mongodb                 # repository type   mongodb:                      # mongodb repository     prefix:                     # collections prefix     dbname:                     # mongodb name (default gravitee)     host:                       # mongodb host (default localhost)     port:                       # mongodb port (default 27017)</p>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-mongodb/#_6"},{"title":"Client settings","text":"<pre><code>description:                # mongodb description (default gravitee.io)\nusername:                   # mongodb username (default null)\npassword:                   # mongodb password (default null)\nauthSource:                 # mongodb authentication source (when at least a user or a password is defined, default gravitee)\nreadPreference:              # possible values are 'nearest', 'primary', 'primaryPreferred', 'secondary', 'secondaryPreferred'\nreadPreferenceTags:          # list of read preference tags (https://docs.mongodb.com/manual/core/read-preference-tags/#std-label-replica-set-read-preference-tag-sets)\n</code></pre>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-mongodb/#client-settings"},{"title":"Write concern","text":"<pre><code>writeConcern:               # possible values are 1,2,3... (the number of node) or 'majority' (default is 1)\nwtimeout:                   # (default is 0)\njournal:                    # (default is true)\n</code></pre>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-mongodb/#write-concern"},{"title":"Socket settings","text":"<pre><code>connectTimeout:             # mongodb connection timeout (default 1000)\nsocketTimeout:              # mongodb socket timeout (default 1000)\n</code></pre>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-mongodb/#socket-settings"},{"title":"Cluster settings","text":"<pre><code>serverSelectionTimeout:     # mongodb server selection timeout (default 1000)\nlocalThreshold:             # mongodb local threshold (default 15)\n</code></pre>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-mongodb/#cluster-settings"},{"title":"Connection pool settings","text":"<pre><code>maxWaitTime:                # mongodb max wait time (default 120000)\nmaxConnectionLifeTime:      # mongodb max connection life time (default 0)\nmaxConnectionIdleTime:      # mongodb max connection idle time (default 0)\nconnectionsPerHost:         # mongodb max connections per host (default 100)\nminConnectionsPerHost:      # mongodb min connections per host (default 0)\n</code></pre>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-mongodb/#connection-pool-settings"},{"title":"Server settings","text":"<pre><code>heartbeatFrequency:         # mongodb heartbeat frequency (default 10000)\nminHeartbeatFrequency:      # mongodb min heartbeat frequency (default 500)\n</code></pre>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-mongodb/#server-settings"},{"title":"SSL settings (Available in APIM 3.10.14+, 3.15.8+, 3.16.4+, 3.17.2+, 3.18+)","text":"<pre><code>sslEnabled:                 # mongodb ssl mode (default false)\nkeystore:\n  path:                     # Path to the keystore (when sslEnabled is true, default null)\n  type:                     # Type of the keystore, supports jks, pem, pkcs12 (when sslEnabled is true, default null)\n  password:                 # KeyStore password (when sslEnabled is true, default null)\n  keyPassword:              # Password for recovering keys in the KeyStore (when sslEnabled is true, default null)\ntruststore:\n  path:                     # Path to the truststore (when sslEnabled is true, default null)\n  type:                     # Type of the truststore, supports jks, pem, pkcs12 (when sslEnabled is true, default null)\n  password:                 # Truststore password (when sslEnabled is true, default null)\n</code></pre>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-mongodb/#ssl-settings-available-in-apim-31014-3158-3164-3172-318"},{"title":"Deprecated SSL settings that will be removed in 3.19.0","text":"<pre><code>sslEnabled:                 # mongodb ssl mode (default false)\nkeystore:                   # path to KeyStore (when sslEnabled is true, default null)\nkeystorePassword:           # KeyStore password (when sslEnabled is true, default null)\nkeyPassword:                # password for recovering keys in the KeyStore (when sslEnabled is true, default null)\n</code></pre>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-mongodb/#deprecated-ssl-settings-that-will-be-removed-in-3190"},{"title":"[WARNING]","text":"<p>From version 3.10.0, Gravitee.io APIM uses the 4.1.2 version of the Java Driver. Therefore, some settings are no longer available.</p> <p><code>threadsAllowedToBlockForConnectionMultiplier</code> and <code>socketKeepAlive</code> have been deprecated in 3.12 and removed in 4.0.</p> <p><code>heartbeatConnectTimeout</code> and <code>heartbeatSocketTimeout</code> can't be used to configure the <code>MongoClient</code> object. Instead, <code>connectTimeout</code> and <code>socketTimeout</code> values are used to configure the heartbeat.</p> <p><code>cursorFinalizerEnabled</code> has been removed.</p> <p>See: + https://mongodb.github.io/mongo-java-driver/3.12/javadoc/com/mongodb/MongoClientOptions.html#getThreadsAllowedToBlockForConnectionMultiplier()</p> <p>https://mongodb.github.io/mongo-java-driver/3.12/javadoc/com/mongodb/MongoClientOptions.html#isSocketKeepAlive()</p>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-mongodb/#warning"},{"title":"https://github.com/mongodb/mongo-java-driver/blob/master/driver-core/src/main/com/mongodb/MongoClientSettings.java#L807-L814","text":"<p>[[use_a_custom_prefix]] == Use a custom prefix</p> <p>From APIM 3.7, you can use a custom prefix for your collection names. This is useful if you want to use the same databases for APIM and AM, for example.</p> <p>=== On a new installation</p> <p>If you are installing APIM for the first time, you need to update the following two values in the APIM Gateway and APIM API <code>gravitee.yml</code> files:</p> <ul> <li><code>management.mongodb.prefix</code></li> <li><code>ratelimit.mongodb.prefix</code></li> </ul> <p>By default, these values are empty.</p> <p>=== Migrating an existing installation</p> <p>NOTE: Before running any scripts, you must create a dump of your existing database. You need to repeat these steps on both APIM Gateway and APIM API.</p> <p>. To prefix your collections, you need to rename them. You can use following https://raw.githubusercontent.com/gravitee-io/gravitee-api-management/master/gravitee-apim-repository/gravitee-apim-repository-mongodb/src/main/resources/scripts/3.7.0/1-rename-collections-with-prefix.js[this script^], which renames all the collections by adding a prefix and rateLimitPrefix of your choice. . Update values <code>management.mongodb.prefix</code> and <code>ratelimit.mongodb.prefix</code> in the <code>gravitee.yml</code> file.</p> <p>== Index</p> <p>You can create an index using the https://github.com/gravitee-io/gravitee-api-management/blob/master/gravitee-apim-repository/gravitee-apim-repository-mongodb/src/main/resources/scripts/create-index.js[script, window=\\\"_blank\\\"] available from our MongoDB GitHub repository. You must use the correct version of this script for the version of APIM you are running.</p> <p>NOTE: If you use a custom prefix for collections, do not forget to set it on the first line of the script.</p> <p>== Security</p> <p>Sometimes you need to apply specific security constraints and rules to users accessing your database. The following table summarizes how to define fine-grained constraints per collection.</p> <p>|=== |Component|Read-only |Read-write</p> <p>|APIM Gateway |apis - keys - subscriptions - plans | events - ratelimit - commands</p> <p>|APIM API |- | all collections except ratelimit</p> <p>|===</p>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-mongodb/#httpsgithubcommongodbmongo-java-driverblobmasterdriver-coresrcmaincommongodbmongoclientsettingsjaval807-l814"},{"title":"Overview","text":"<p>This repository plugin is for connecting to Redis databases for Rate Limit feature.</p>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-redis/"},{"title":"Install the Rate Limit repository plugin","text":"<p>Repeat these steps on each component (APIM Gateway and APIM API) where the SQL database is used.</p> <ol> <li> <p>Download the plugin corresponding to your APIM version (take the     latest maintenance release).</p> </li> <li> <p>Place the zip file in the plugin directory for each component     (<code>$GRAVITEE_HOME/plugins</code>).</p> </li> <li> <p>Configure your <code>gravitee.yml</code> files, as described in the next     section.</p> </li> </ol>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-redis/#install-the-rate-limit-repository-plugin"},{"title":"Configure the Rate Limit repository plugin","text":"<pre><code># ===================================================================\n# MINIMUM REDIS REPOSITORY PROPERTIES\n#\n# This is a minimal sample file declared connection to Redis\n# ===================================================================\nratelimit:\n  type: redis               # repository type\n  redis:                    # redis repository\n    host:                   # redis host (default localhost)\n    port:                   # redis port (default 6379)\n    password:               # redis password (default null)\n    timeout:                # redis timeout (default -1)\n\n    # Following properties are REQUIRED ONLY when running Redis in sentinel mode\n    sentinel:\n      master:               # redis sentinel master host\n      password:             # redis sentinel master password\n      nodes: [              # redis sentinel node(s) list\n        {\n          host : localhost, # redis sentinel node host\n          port : 26379      # redis sentinel node port\n        },\n        {\n          host : localhost,\n          port : 26380\n        },\n        {\n          host : localhost,\n          port : 26381\n        }\n      ]\n</code></pre>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-redis/#configure-the-rate-limit-repository-plugin"},{"title":"Point of interest","text":"<p>If Redis Rate Limit repository is not accessible, the call to API will pass successfully. Do not forget to monitor your probe healthcheck to verify if Redis repository is healthy. You can find health endpoints here: link:{{ /apim/3.x/apim_installguide_rest_apis_technical_api.html#endpoints | relative_url }}[Installation Guide]</p>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories-redis/#point-of-interest"},{"title":"Introduction","text":"<p>In Gravitee.io APIM, repositories are used to store different type of data (different scopes). Repositories are configured in the <code>gravitee.yml</code> configuration file and can be different for each scope. For example, you can decide to store management data in MongoDB, rate limiting data in Redis and analytics data in Elasticsearch.</p>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories/"},{"title":"Supported storage","text":"<p>The following matrix shows scope and storage compatibility.</p>                                             <p>Management All the API Management platform management data, such as API definitions, users, applications and plans.</p> <p>Rate Limit Rate limiting data</p> <p>Analytics Analytics data</p>","location":"apim/installation-guide/configuration/repositories/installation-guide-repositories/#supported-storage"},{"title":"APIM API Configuration","text":"<p>There are three different ways to configure this component:</p> <ul> <li> <p>environment variables</p> </li> <li> <p>system properties</p> </li> <li> <p><code>gravitee.yml</code></p> </li> </ul> <p>The order in which they are listed above corresponds to their order of precedence. In other words, environment variables override the other two configuration types, and system properties override <code>gravitee.yml</code>.</p>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/"},{"title":"Environment variables","text":"<p>You can override the default APIM configuration (<code>gravitee.yml</code>) and system properties by defining environment variables.</p> <p>To override this property:</p> <pre><code>management:\n  mongodb:\n    dbname: myDatabase\n</code></pre> <p>Define one of the following variables:</p> <pre><code>GRAVITEE_MANAGEMENT_MONGODB_DBNAME=myDatabase\ngravitee_management_mongodb_dbname=myDatabase\n</code></pre> <p>Some properties are case-sensitive and cannot be written in uppercase (for example, <code>gravitee_security_providers_0_tokenIntrospectionEndpoint</code>). We advise you to define environment variables in lowercase. You must ensure you use the correct syntax for each property.</p> <p>In some systems, hyphens are not allowed in variable names. For example, you may need to write <code>gravitee_policy_api-key_header</code> as <code>gravitee_policy_apikey_header</code>. We recommend you check your system documentation.</p> <p>Some properties are arrays. For example:</p> <pre><code>analytics:\n  elasticsearch:\n    endpoints:\n      - https://my.first.endpoint.com\n      - https://my.second.endpoint.com\n\nsecurity:\n  providers:\n    - type: ldap\n      context-source-username: \"cn=Directory Manager\"\n      context-source-password: \"password\"\n</code></pre> <p>Below are some example of how to write your environment variables. In case of doubt, we recommend you try both.</p> <pre><code>gravitee_analytics_elasticsearch_endpoints_0=https://my.first.endpoint.com\ngravitee_analytics_elasticsearch_endpoints_1=https://my.second.endpoint.com\n\ngravitee_security_providers_0_type=ldap\ngravitee_security_providers_0_contextsourceusername=cn=Directory Manager\ngravitee_security_providers_0_contextsourcepassword=password\n</code></pre> <p>or</p> <pre><code>gravitee.analytics.elasticsearch.endpoints[0]=https://my.first.endpoint.com\ngravitee.analytics.elasticsearch.endpoints[1]=https://my.second.endpoint.com\n\ngravitee.security.providers[0]type=ldap\ngravitee.security.providers[0]context-source-username=cn=Directory Manager\ngravitee.security.providers[0]context-source-password=password\ngravitee.security.providers[0].users[1].password=password\n</code></pre>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/#environment-variables"},{"title":"System properties","text":"<p>You can override the default APIM configuration (<code>gravitee.yml</code>) by defining system properties.</p> <p>To override this property:</p> <pre><code>management:\n  mongodb:\n    dbname: myDatabase\n</code></pre> <p>Add this property to the JVM:</p> <pre><code>-Dmanagement.mongodb.dbname=myDatabase\n</code></pre>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/#system-properties"},{"title":"gravitee.yml","text":"<p>The <code>gravitee.yml</code> file, found in <code>GRAVITEE_HOME/config/</code>, is the default way to configure APIM.</p> <p>YAML (<code>yml</code>) format is very sensitive to indentation. Ensure you include the correct number of spaces and use spaces instead of tabs.</p>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/#graviteeyml"},{"title":"General configuration","text":"<p>The following sections show how to update the general settings in the <code>gravitee.yml</code> file.</p>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/#general-configuration"},{"title":"Configure HTTP Server","text":"<p>You configure the HTTP Server configuration in the following section of the <code>gravitee.yml</code> file:</p> <pre><code>jetty:\n  port: 8083\n  idleTimeout: 30000\n  acceptors: -1\n  selectors: -1\n  pool:\n    minThreads: 10\n    maxThreads: 200\n    idleTimeout: 60000\n    queueSize: 6000\n  jmx: false\n  statistics: false\n  accesslog:\n    enabled: true\n    path: ${gravitee.home}/logs/gravitee_accesslog_yyyy_mm_dd.log\n</code></pre>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/#configure-http-server"},{"title":"Enable HTTPS support","text":"<p>First, you need to provide a keystore. If you do not have one, you can generate it:</p> <pre><code>keytool -genkey \\\n  -alias test \\\n  -keyalg RSA \\\n  -keystore server-keystore.jks \\\n  -keysize 2048 \\\n  -validity 360 \\\n  -dname CN=localhost \\\n  -keypass secret \\\n  -storepass secret\n</code></pre> <p>You then need to enable secure mode in <code>gravitee.yml</code>:</p> <pre><code>jetty:\n  ...\n  secured: true\n  ssl:\n    keystore:\n      path: ${gravitee.home}/security/keystore.jks\n      password: secret\n    truststore:\n      path: ${gravitee.home}/security/truststore.jks\n      password: secret\n</code></pre> <p>Truststore and Keystore settings defined within the <code>jetty</code> section are only used to secure access to APIM API. These are not used by HTTP client calls for any other purpose (such as Fetch and DCR).</p>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/#enable-https-support"},{"title":"Configure the Management and Portal APIs","text":"<p>You can configure APIM API to start only the Management or Portal API. You can also change the API endpoints from their default values of <code>/management</code> and <code>/portal</code>.</p> <pre><code>http:\n  api:\n    # Configure the listening path for the API. Default to /\n#    entrypoint: /\n    # Configure Management API.\n#    management:\n#      enabled: true\n#      entrypoint: ${http.api.entrypoint}management\n#      cors: ...\n    # Configure Portal API.\n#    portal:\n#      enabled: true\n#      entrypoint: ${http.api.entrypoint}portal\n#      cors: ...\n</code></pre>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/#configure-the-management-and-portal-apis"},{"title":"CORS configuration","text":"<p>CORS (Cross-Origin Resource Sharing) is a mechanism that allows resources on a web page to be requested from another domain.</p> <p>For more information on CORS, take a look at the CORS specification^.</p> <p>You can configure CORS using <code>gravitee.yml</code>, environment variables or directly in APIM Console.</p>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/#cors-configuration"},{"title":"Configure in <code>gravitee.yml</code>","text":"<pre><code>http:\n  api:\n    # Configure the listening path for the API. Default to /\n#    entrypoint: /\n    # Configure Management API.\n#    management:\n#      enabled: true\n#      entrypoint: ${http.api.entrypoint}management\n#      cors:\n    # Allows to configure the header Access-Control-Allow-Origin (default value: *)\n    # '*' is a valid value but is considered as a security risk as it will be opened to cross origin requests from anywhere.\n#       allow-origin: http://developer.mycompany.com\n    # Allows to define how long the result of the preflight request should be cached for (default value; 1728000 [20 days])\n#       max-age: 864000\n    # Which methods to allow (default value: OPTIONS, GET, POST, PUT, DELETE)\n#      allow-methods: 'OPTIONS, GET, POST, PUT, DELETE'\n    # Which headers to allow (default values: Cache-Control, Pragma, Origin, Authorization, Content-Type, X-Requested-With, If-Match, X-Xsrf-Token)\n#      allow-headers: 'X-Requested-With'\n  # Configure Portal API.\n#    portal:\n#      enabled: true\n#      entrypoint: ${http.api.entrypoint}portal\n#      cors:\n    # Allows to configure the header Access-Control-Allow-Origin (default value: *)\n    # '*' is a valid value but is considered as a security risk as it will be opened to cross origin requests from anywhere.\n#       allow-origin: http://developer.mycompany.com\n    # Allows to define how long the result of the preflight request should be cached for (default value; 1728000 [20 days])\n#       max-age: 864000\n    # Which methods to allow (default value: OPTIONS, GET, POST, PUT, DELETE)\n#      allow-methods: 'OPTIONS, GET, POST, PUT, DELETE'\n    # Which headers to allow (default values: Cache-Control, Pragma, Origin, Authorization, Content-Type, X-Requested-With, If-Match, X-Xsrf-Token)\n#      allow-headers: 'X-Requested-With'\n</code></pre>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/#configure-in-graviteeyml"},{"title":"Configure the Plugins repository","text":"<p>You can configure the APIM Gateway plugins directory.</p> <pre><code>plugins:\n  path: ${gravitee.home}/plugins\n</code></pre>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/#configure-the-plugins-repository"},{"title":"Configure the Management repository","text":"<p>The Management repository is used to store global configuration such as APIs, applications and apikeys. The default configuration uses MongoDB (single server). For more information about MongoDB configuration, see:</p> <p>http://api.mongodb.org/java/current/com/mongodb/MongoClientOptions.html</p> <pre><code>management:\n  type: mongodb\n  mongodb:\n    dbname: ${ds.mongodb.dbname}\n    host: ${ds.mongodb.host}\n    port: ${ds.mongodb.port}\n#    username:\n#    password:\n#    connectionsPerHost: 0\n#    connectTimeout: 500\n#    maxWaitTime: 120000\n#    socketTimeout: 500\n#    socketKeepAlive: false\n#    maxConnectionLifeTime: 0\n#    maxConnectionIdleTime: 0\n#    serverSelectionTimeout: 0\n#    description: gravitee.io\n#    heartbeatFrequency: 10000\n#    minHeartbeatFrequency: 500\n#    heartbeatConnectTimeout: 1000\n#    heartbeatSocketTimeout: 20000\n#    localThreshold: 15\n#    minConnectionsPerHost: 0\n#    threadsAllowedToBlockForConnectionMultiplier: 5\n#    cursorFinalizerEnabled: true\n## SSL settings (Available in APIM 3.10.14+, 3.15.8+, 3.16.4+, 3.17.2+, 3.18+)\n#    sslEnabled:\n#    keystore:\n#      path:\n#      type:\n#      password:\n#      keyPassword:\n#    truststore:\n#      path:\n#      type:\n#      password:\n## Deprecated SSL settings that will be removed in 3.19.0\n#    sslEnabled:\n#    keystore:\n#    keystorePassword:\n#    keyPassword:\n\n# Management repository: single MongoDB using URI\n# For more information about MongoDB configuration using URI, please have a look to:\n# - http://api.mongodb.org/java/current/com/mongodb/MongoClientURI.html\n#management:\n#  type: mongodb\n#  mongodb:\n#    uri: mongodb://[username:password@]host1[:port1][,host2[:port2],...[,hostN[:portN]]][/[database][?options]]\n\n# Management repository: clustered MongoDB\n#management:\n#  type: mongodb\n#  mongodb:\n#    servers:\n#      - host: mongo1\n#        port: 27017\n#      - host: mongo2\n#        port: 27017\n#    dbname: ${ds.mongodb.dbname}\n#    connectTimeout: 500\n#    socketTimeout: 250\n</code></pre>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/#configure-the-management-repository"},{"title":"Configure the Analytics repository","text":"<p>The Analytics repository is used to store all reporting, metrics and health-checks stored by APIM Gateway instances. The default configuration uses Elasticsearch.</p> <pre><code>  type: elasticsearch\n  elasticsearch:\n    endpoints:\n      - http://localhost:9200\n#    index: gravitee\n#    security:\n#       username:\n#       password:\n</code></pre>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/#configure-the-analytics-repository"},{"title":"Default configuration","text":"<p>You can configure various default properties of APIM API in your <code>gravitee.yml</code> file.</p>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/#default-configuration"},{"title":"Authentication configuration","text":"<p>See the link:{{ /apim/3.x/apim_installguide_authentication.html | relative_url }}[Authentication configuration^] section.</p>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/#authentication-configuration"},{"title":"Configure in APIM Console","text":"<p>You configure CORS in the CORS section of the APIM Console and APIM Portal Settings pages:</p> <ul> <li>For APIM Portal, go to Settings &gt; Settings</li> </ul> <p>image::{% link images/apim/3.x/installation/configuration/graviteeio-installation-environment-configuration-cors.png %}[]</p> <ul> <li>For APIM Console, go to Organization Settings &gt; Settings</li> </ul> <p>image::{% link images/apim/3.x/installation/configuration/graviteeio-installation-organization-configuration-cors.png %}[]</p> <p>There is no inheritance between the two configurations.</p>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/#configure-in-apim-console"},{"title":"SMTP configuration","text":"<p>This section shows the SMTP configuration used for sending email.</p> <p>You can configure SMTP using <code>gravitee.yml</code>, environment variables or directly in APIM Console.</p>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/#smtp-configuration"},{"title":"Configure in <code>gravitee.yml</code>","text":"<pre><code>email:\n  host: smtp.my.domain\n  port: 465\n  from: noreply@my.domain\n  subject: \"[Gravitee.io] %s\"\n  username: user@my.domain\n  password: password\n</code></pre>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/#configure-in-graviteeyml_1"},{"title":"Configure in APIM Console","text":"<p>You configure SMTP in the SMTP section of the APIM Console and APIM Portal Settings pages:</p> <ul> <li>For APIM Portal, go to Settings &gt; Settings</li> </ul> <p>image::{% link images/apim/3.x/installation/configuration/graviteeio-installation-environment-configuration-smtp.png %}[]</p> <ul> <li>For APIM Console, go to Organization Settings &gt; Settings</li> </ul> <p>image::{% link images/apim/3.x/installation/configuration/graviteeio-installation-organization-configuration-smtp.png %}[]</p> <ul> <li> <p>If no email configuration is set for APIM Portal, then the APIM     Console configuration is used.</p> </li> <li> <p>If SMTP is configured with <code>gravitee.yml</code> or environment variables,     then that configuration will be used, even if settings exist in the     database.</p> </li> </ul>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/#configure-in-apim-console_1"},{"title":"Configure the GMAIL SMTP server","text":"<p>If required, you can configure the GMAIL SMTP server in <code>gravitee.yml</code> as follows:</p> <pre><code>email:\n  enabled: true\n  host: smtp.gmail.com\n  port: 587\n  from: user@gmail.com\n  subject: \"[Gravitee.io] %s\"\n  username: user@gmail.com\n  password: xxxxxxxx\n  properties:\n    auth: true\n    starttls.enable: true\n    ssl.trust: smtp.gmail.com\n</code></pre> <p>If you are using 2-Factor Authentication (which is recommended), you need to generate an application password: https://security.google.com/settings/security/apppasswords .</p>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/#configure-the-gmail-smtp-server"},{"title":"User configuration","text":"<p>You can configure various user options:</p> <p>user.login.defaultApplication boolean (default: true)\u2009\u2014\u2009creates a new application for all new users</p> <p>user.creation.token.expire-after number (default: 86400)\u2009\u2014\u2009number of seconds before the user registration token expires</p> <p>user.reference.secret 32 characters (default: s3cR3t4grAv1t33.1Ous3D4R3f3r3nc3)\u2009\u2014\u2009secret used to generate a unique anonymous reference to a user; You must change this value</p> <p>user.anonymize-on-delete:enabled boolean (default: false) - If true, the user firstname, lastname and email are anonymized when a user is deleted</p>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/#user-configuration"},{"title":"Management configuration","text":"<p>You can configure various management settings in the APIM Console Settings page with environment variables. For a complete list of these settings, see Management settings list below. Once you override these properties with environment variables, APIM Console configures them as read-only to prevent you overwriting the new values in the interface.</p> <ul> <li> <p>For array properties, separate your environment variable properties     with a comma. For example: <code>my_var=item1,item2,item3</code>.</p> </li> <li> <p>We recommend you prefix Gravitee variables with <code>gravitee.</code> to avoid     conflicts with other variables.</p> </li> </ul>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/#management-configuration"},{"title":"Example","text":"<p>For example, you can override the analytics client timeout with the following variables:</p> <pre><code>GRAVITEE_ANALYTICS_CLIENT_TIMEOUT=15000\nGRAVITEE.ANALYTICS.CLIENT.TIMEOUT=15000\ngravitee_analytics_client_timeout=15000\ngravitee.analytics.client.timeout=15000\n</code></pre>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/#example"},{"title":"Management settings list","text":"","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-configuration/#management-settings-list"},{"title":"Metrics","text":"<p>This section explains how to expose metrics to Prometheus.</p>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-metrics/"},{"title":"Enable the metrics service","text":"<p>You enable the metrics service in the <code>gravitee.yml</code> configuration file. Prometheus support is activated and exposed using the component\u2019s internal API.</p> <pre><code>services:\n  metrics:\n    enabled: true\n    prometheus:\n      enabled: true\n</code></pre> <p>By default, the internal component API is bound to <code>localhost</code> only, so it must not be invoked outside <code>localhost</code>. If you need to expose the API more widely, you may need to set the <code>services.core.http.host</code> property to the correct network interface. If you are running the application in a Docker container, set the IP to the IP address of the container. Each change requires a restart.</p>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-metrics/#enable-the-metrics-service"},{"title":"Configure labels","text":"<p>Labels are used to provide dimensionality to a metric. For instance, metrics related to a http request have a <code>http_path</code> label, which allows then to query timeseries for a specific path, or any other operation on timeseries.</p> <p>You can specify which labels you want in the configuration file:</p> <pre><code>services:\n  metrics:\n    enabled: true\n    labels:\n      - local\n      - remote\n      - http_method\n      - http_code\n      - http_path\n    prometheus:\n      enabled: true\n</code></pre> <p>The list of available labels can be found here: Label</p> <p>Enabling labels may result in a high cardinality in values, which can cause issues on the metrics backend (i.e. the gateway) and affect performance. So it must be used with care. In general, it is fine to enable labels when the set of possible values is bounded.</p> <p>Default values are <code>local</code>, <code>http_method</code> and <code>http_code</code>.</p> <p>Starting from APIM 3.10.0, Vert.x 4 is used and the metrics labels have been renamed. We have introduced a new field in prometheus configuration that you can configure to use old Vert.x 3 label names. Set it to 3.10, to use old labels.</p> <p>\"3.10\" in the configuration is related to Vert.x version and not APIM version.</p> <pre><code>services:\n  metrics:\n    prometheus:\n      naming:\n        version: 3.10\n</code></pre>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-metrics/#configure-labels"},{"title":"Prometheus configuration","text":"<p>The following example requests Prometheus scrape the formatted metrics available in the Gateway internal API.</p> <pre><code>scrape_configs:\n  - job_name: 'gio-gw'\n    basic_auth:\n      username: admin\n      password: adminadmin\n    metrics_path: /_node/metrics/prometheus\n    static_configs:\n      - targets: ['localhost:18082']\n</code></pre>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-metrics/#prometheus-configuration"},{"title":"Prometheus UI","text":"<p>By default when running Prometheus, the UI is exposed at http://localhost:9090/graph</p> <p>Show <code>http_client_connections</code> metrics</p> <p>image::{% link images/apim/3.x/installation/metrics/prometheus/metrics_prometheus_graph.png %}[Show <code>http_client_connections</code> metrics]</p> <p>The following example shows the memory consumed by the Gateway instance:</p> <p>Show <code>jvm_memory_used_bytes</code> metrics</p> <p>image::{% link images/apim/3.x/installation/metrics/prometheus/metrics_prometheus_graph_memory.png %}[Show <code>jvm_memory_used_bytes</code> metrics]</p>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-metrics/#prometheus-ui"},{"title":"Brute Force attacks","text":"<p>Brute Force attacks consist of submitting lots authentication requests based on many passwords with the expectation of guessing one right. More details can be found at https://en.wikipedia.org/wiki/Brute-force_attack. Even with OAuth 2.0 activated you can leave behind a login form for in-memory or local users. Some tools can help you to prevent malicious actions by banning IPs.</p>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-security/"},{"title":"Fail2Ban","text":"<p>This section explains how to secure the APIM UI components (Management and Portal) and APIM APIs against brute force attacks using Fail2Ban. For instructions on installing Fail2Ban, see the Fail2Ban website: https://www.fail2ban.org.</p>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-security/#fail2ban"},{"title":"Configuration","text":"<p>APIM API logs all authentication failures in the Gravitee log file. Follow the steps below to configure Fail2Ban to work with the Gravitee log file.</p> <p>Each time you modify Fail2Ban configuration resources you need to restart the service.</p> <ol> <li> <p>Configure a Fail2Ban filter to extract Gravitee authentication     failure events.</p> <pre><code>2019-05-03 16:03:03.304 [gravitee-listener-31] WARN  i.g.m.s.l.AuthenticationFailureListener - Authentication failed event for : admin - IP : 10.50.24.18\n</code></pre> </li> <li> <p>Add a configuration file to declare filters:     <code>/etc/fail2ban/filter.d/gravitee.conf</code>.</p> <pre><code>[Definition]\nfailregex = .*Authentication failed event for.*IP : &lt;HOST&gt;\nignoreregex =\n</code></pre> </li> <li> <p>Add Fail2Ban actions to <code>gravitee.conf</code>. Actions are <code>iptables</code> or     <code>firewalld</code> commands.</p> <pre><code>[INCLUDES]\n\nbefore = iptables-common.conf\n\n[Definition]\n\n# Option:  actionstart\n# Notes.:  command executed once at the start of Fail2Ban.\n# Values:  CMD\n#\nactionstart = &lt;iptables&gt; -N f2b-&lt;name&gt;\n              &lt;iptables&gt; -A f2b-&lt;name&gt; -j &lt;returntype&gt;\n              &lt;iptables&gt; -I &lt;chain&gt; -p &lt;protocol&gt; --dport &lt;port&gt; -j f2b-&lt;name&gt;\n\n# Option:  actionstop\n# Notes.:  command executed once at the end of Fail2Ban\n# Values:  CMD\n#\nactionstop = &lt;iptables&gt; -D &lt;chain&gt; -p &lt;protocol&gt; --dport &lt;port&gt; -j f2b-&lt;name&gt;\n             &lt;iptables&gt; -F f2b-&lt;name&gt;\n             &lt;iptables&gt; -X f2b-&lt;name&gt;\n\n# Option:  actioncheck\n# Notes.:  command executed once before each actionban command\n# Values:  CMD\n#\nactioncheck = &lt;iptables&gt; -n -L &lt;chain&gt; | grep -q 'f2b-&lt;name&gt;[ \\t]'\n\n# Option:  actionban\n# Notes.:  command executed when banning an IP. Take care that the\n#          command is executed with Fail2Ban user rights.\n# Tags:    See jail.conf(5) man page\n# Values:  CMD\n#\nactionban = &lt;iptables&gt; -I f2b-&lt;name&gt; 1 -p tcp -m string --algo bm --string 'X-Forwarded-For: &lt;ip&gt;' -j DROP\n\n# Option:  actionunban\n# Notes.:  command executed when unbanning an IP. Take care that the\n#          command is executed with Fail2Ban user rights.\n# Tags:    See jail.conf(5) man page\n# Values:  CMD\n#\nactionunban = &lt;iptables&gt; -D f2b-&lt;name&gt; -p tcp -m string --algo bm --string 'X-Forwarded-For: &lt;ip&gt;' -j DROP\n\n[Init]\n</code></pre> </li> <li> <p>Declare the new Gravitee Fail2Ban block in the main configuration     file, with the required parameters.</p> <pre><code>[gravitee]\nbanaction = gravitee\nlogpath = /opt/gravitee-io-management-api/logs/management_api.log\nfilter = gravitee\nenabled = true\nmaxretry = 3\n</code></pre> </li> </ol>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-security/#configuration"},{"title":"Internal API","text":"<p>The APIM API component comes with its own internal API, for monitoring and retrieving technical information about the component.</p>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-technical-api/"},{"title":"Configuration","text":"<p>You need to enable the API as a service in the <code>gravitee.yml</code> file and update any other required configuration.</p> <pre><code>services:\n  core:\n    http:\n      enabled: true\n      port: 18083\n      host: localhost\n      authentication:\n        type: basic\n        users:\n          admin: adminadmin\n</code></pre> <p>enabled Whether the service is enabled (default <code>true</code>).</p> <p>port The port the service listens on (default <code>{node_port}</code>). You must ensure you use a port which is not already in use by another APIM component.</p> <p>host The host (default <code>localhost</code>).</p> <p>authentication.type Authentication type for requests: <code>none</code> if no authentication is required or <code>basic</code> (default <code>basic</code>).</p> <p>authentication.users A list of <code>user: password</code> combinations. Only required if authentication type is <code>basic</code>.</p>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-technical-api/#configuration"},{"title":"Endpoints","text":"<p>Operation</p> <p>Description</p> <p>Example</p>   <p><code>GET /_node</code></p> <p>Gets generic node information</p> <pre><code>HTTP/1.1 200 OK\nContent-Type: application/json\n{\n    \"id\": \"a70b9fd9-9deb-4ccd-8b9f-d99deb6ccd32\",\n    \"metadata\": {},\n    \"name\": \"Gravitee.io - Management API\",\n    \"version\": {\n        \"BUILD_ID\": \"309\",\n        \"BUILD_NUMBER\": \"309\",\n        \"MAJOR_VERSION\": \"1.20.14\",\n        \"REVISION\": \"132e719ef314b40f352e6399034d68a9a95e95ef\"\n    }\n}</code></pre>   <p><code>GET /_node/health?probes=#probe1,#probe2</code></p> <p>Gets the health status of the component. Probes can be filtered using the optional <code>probes</code> query param. The parameter can handle a list of probes, separated by commas (<code>,</code>). If no query param, you get the health of all probes. If the return status is 200 then everything is ok, if 500, there is at least one error. This endpoint can be used by a load balancer, to determine if a component instance is not in the pool, for example.</p> <p>Some probes are not displayed by default. You have to explicitly use the query param to retrieve them. These probes are:</p> <p>- cpu</p> <p>- memory</p> <p>- api-sync</p> <p>Those probes are considered healthy if there are under a configurable threshold (default is 80%). To configure it, add in your <code>gravitee.yml</code>:</p> <p>[source, yml] ---- services: health: threshold: cpu: 80 memory: 80 ----</p> <p><code>GET /_node/health?probes=management-api,management-repository</code></p> <pre><code>HTTP/1.1 200 OK\nContent-Type: application/json\n\n{\n    \"management-api\": {\n        \"healthy\": true\n    },\n    \"management-repository\": {\n        \"healthy\": true\n    },\n    \"api-sync\": {\n        \"healthy\": true\n    },\n    \"api-sync\": {\n        \"healthy\": true\n    }\n}</code></pre>   <p><code>GET /_node/configuration</code></p> <p>Gets the node configuration from the <code>gravitee.yml</code> file and/or environment variables.</p> <pre><code>HTTP/1.1 200 OK\nContent-Type: application/json\n\n{\n    \"analytics.elasticsearch.endpoints[0]\": \"http://${ds.elastic.host}:${ds.elastic.port}\",\n    \"analytics.type\": \"elasticsearch\",\n    \"ds.elastic.host\": \"localhost\",\n    \"ds.elastic.port\": 9200,\n    ...\n}</code></pre>   <p><code>GET /_node/monitor</code></p> <p>Gets monitoring information from the JVM and the server.</p> <pre><code>HTTP/1.1 200 OK\nContent-Type: application/json\n\n{\n    \"jvm\": {\n        \"gc\": {\n            \"collectors\": [\n                {\n                    \"collectionCount\": 7,\n                    \"collectionTime\": 98,\n                    \"name\": \"young\"\n                },\n                {\n                    \"collectionCount\": 3,\n                    \"collectionTime\": 189,\n                    \"name\": \"old\"\n                }\n            ]\n        },\n        \"mem\": {\n    ...\n}</code></pre>","location":"apim/installation-guide/configuration/rest-apis/installation-guide-rest-apis-technical-api/#endpoints"},{"title":"Compose (EE)","text":"<p>= Docker Compose Installation :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_installation_guide_docker_compose_ee.html :page-folder: apim/installation-guide/docker :page-layout: apim3x :page-description: Gravitee.io API Management - Installation Guide - Docker - Compose - Enterprise Edition :page-keywords: Gravitee.io, API Management, apim, guide, manual, docker, compose, linux, enterprise edition, ee :page-toc: false :page-liquid: :table-caption!:</p> <p>// author: Tom Geudens</p> <p>== Setup Before you can get into the actual installation, a couple of things need to be set up</p> <p>. Docker + Is assumed to be installed.</p> <p>. Docker Compose + Is assumed to be installed.</p> <p>. Persistence + Containers are great, but you do want persistence in case they need to be restarted. You are going to persist the MongoDB data, the Elasticsearch data and provide locations for additional plugins (both for the Gateway and the REST API). It is assumed in this page that these will live under a filesystem mounted at <code>/gravitee</code> on the host system.  + [source,bash]</p>  <p>mkdir /gravitee/mongodb mkdir /gravitee/mongodb/data mkdir /gravitee/elasticsearch mkdir /gravitee/elasticsearch/data mkdir /gravitee/apim-gateway mkdir /gravitee/apim-gateway/plugins mkdir /gravitee/apim-gateway/logs mkdir /gravitee/apim-management-api mkdir /gravitee/apim-management-api/plugins mkdir /gravitee/apim-management-api/logs mkdir /gravitee/apim-management-ui mkdir /gravitee/apim-management-ui/logs mkdir /gravitee/apim-portal-ui mkdir /gravitee/apim-portal-ui/logs</p>  <p>. License + The Enterprise installation assumes you have a license. For more information on getting one, check https://www.gravitee.io/pricing. It is assumed below that you have a <code>/gravitee/license.key</code> file.</p> <p>NOTE: As was indicated before, your architecture may differ and thus require a different setup.</p> <p>== Compose First you need to download the docker-compose.yml file. [source,bash]</p>","location":"apim/installation-guide/docker/installation-guide-docker-compose-ee/"},{"title":"curl -L https://raw.githubusercontent.com/gravitee-io/gravitee-docker/master/apim/3.x/docker-compose.yml -o \"docker-compose.yml\"","text":"<p>Next you should create an environment file (<code>.env</code>) that overrides the default product versions in the compose file with those for the Enterprise edition. [source]</p>","location":"apim/installation-guide/docker/installation-guide-docker-compose-ee/#curl-l-httpsrawgithubusercontentcomgravitee-iogravitee-dockermasterapim3xdocker-composeyml-o-docker-composeyml"},{"title":"APIM_VERSION={{ site.products.apim._3x.version }}-ee","text":"<p>And then you should modify the docker-compose.yml file to match your own architecture and preferences. You'll find a reference to each part of the compose file below and the changes necessary to match our basic architecture.</p> <p>NOTE: You must make at least the changes that provide the <code>license.key</code> file to the containers.</p> <p>Once you are happy with things ... start the whole setup in one go [source,bash]</p>","location":"apim/installation-guide/docker/installation-guide-docker-compose-ee/#apim_version-siteproductsapim_3xversion-ee"},{"title":"docker-compose up -d","text":"<p>== Reference - Volumes In the file you'll find this ... [source,yaml]</p>  <p>volumes:   data-elasticsearch:   data-mongo:</p>  <p>As we are using a plain filesystem at <code>/gravitee</code>, you can remove those lines.</p> <p>== Reference - MongoDB In the file you'll find this ... [source,yaml]</p>  <p>mongodb:     image: mongo:${MONGODB_VERSION:-3.6}     container_name: gio_apim_mongodb     restart: always     volumes:       - data-mongo:/data/db       - ./logs/apim-mongodb:/var/log/mongodb     networks:       - storage</p>  <p>And you turn it into this [source,yaml]</p>  <p>mongodb:     image: mongo:${MONGODB_VERSION:-3.6}     container_name: gio_apim_mongodb     restart: always     volumes:       - /gravitee/mongodb/data:/data/db     networks:       - storage</p>  <p>NOTE: Accessing the logs of the MongoDB container should be done through <code>docker logs gio_apim_mongodb</code>.</p> <p>== Reference - Elasticsearch In the file you'll find this ... [source,yaml]</p>  <p>elasticsearch:     image: docker.elastic.co/elasticsearch/elasticsearch:${ELASTIC_VERSION:-7.7.0}     container_name: gio_apim_elasticsearch     restart: always     volumes:       - data-elasticsearch:/usr/share/elasticsearch/data     environment:       - http.host=0.0.0.0       - transport.host=0.0.0.0       - xpack.security.enabled=false       - xpack.monitoring.enabled=false       - cluster.name=elasticsearch       - bootstrap.memory_lock=true       - discovery.type=single-node       - \"ES_JAVA_OPTS=-Xms512m -Xmx512m\"     ulimits:       memlock:         soft: -1         hard: -1       nofile: 65536     networks:       - storage</p>  <p>And you turn it into this [source,yaml]</p>  <p>elasticsearch:     image: docker.elastic.co/elasticsearch/elasticsearch:${ELASTIC_VERSION:-7.7.0}     container_name: gio_apim_elasticsearch     restart: always     volumes:       - /gravitee/elasticsearch/data:/usr/share/elasticsearch/data     environment:       - http.host=0.0.0.0       - transport.host=0.0.0.0       - xpack.security.enabled=false       - xpack.monitoring.enabled=false       - cluster.name=elasticsearch       - bootstrap.memory_lock=true       - discovery.type=single-node       - \"ES_JAVA_OPTS=-Xms512m -Xmx512m\"     ulimits:       memlock:         soft: -1         hard: -1       nofile: 65536     networks:       - storage</p>  <p>NOTE: Accessing the logs of the Elasticsearch container should be done through <code>docker logs gio_apim_elasticsearch</code></p> <p>== Reference - API Management Gateway In the file you'll find this ... [source,yaml]</p>  <p>gateway:     image: graviteeio/apim-gateway:${APIM_VERSION:-3}     container_name: gio_apim_gateway     restart: always     ports:       - \"8082:8082\"     depends_on:       - mongodb       - elasticsearch     volumes:       - ./logs/apim-gateway:/opt/graviteeio-gateway/logs     environment:       - gravitee_management_mongodb_uri=mongodb://mongodb:27017/gravitee?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000       - gravitee_ratelimit_mongodb_uri=mongodb://mongodb:27017/gravitee?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000       - gravitee_reporters_elasticsearch_endpoints_0=http://elasticsearch:9200     networks:       - storage       - frontend</p>  <p>And you turn it into this [source,yaml]</p>  <p>gateway:     image: graviteeio/apim-gateway:${APIM_VERSION:-3}     container_name: gio_apim_gateway     restart: always     ports:       - \"8082:8082\"     depends_on:       - mongodb       - elasticsearch     volumes:       - /gravitee/apim-gateway/logs:/opt/graviteeio-gateway/logs       - /gravitee/apim-gateway/plugins:/opt/graviteeio-gateway/plugins-ext       - /gravitee/license.key:/opt/graviteeio-gateway/license/license.key         environment:       - gravitee_management_mongodb_uri=mongodb://mongodb:27017/gravitee?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000       - gravitee_ratelimit_mongodb_uri=mongodb://mongodb:27017/gravitee?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000       - gravitee_reporters_elasticsearch_endpoints_0=http://elasticsearch:9200       - gravitee_plugins_path_0=/opt/graviteeio-gateway/plugins       - gravitee_plugins_path_1=/opt/graviteeio-gateway/plugins-ext     networks:       - storage       - frontend</p>  <p>== Reference - API Management REST API In the file you'll find this ... [source,yaml]</p>  <p>management_api:     image: graviteeio/apim-management-api:${APIM_VERSION:-3}     container_name: gio_apim_management_api     restart: always     ports:       - \"8083:8083\"     links:       - mongodb       - elasticsearch     depends_on:       - mongodb       - elasticsearch     volumes:       - ./logs/apim-management-api:/opt/graviteeio-management-api/logs     environment:       - gravitee_management_mongodb_uri=mongodb://mongodb:27017/gravitee?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000       - gravitee_analytics_elasticsearch_endpoints_0=http://elasticsearch:9200     networks:       - storage       - frontend</p>  <p>And you turn it into this [source,yaml]</p>  <p>management-api:     image: graviteeio/apim-management-api:${APIM_VERSION:-3}     container_name: gio_apim_management_api     restart: always     ports:       - \"8083:8083\"     depends_on:       - mongodb       - elasticsearch     volumes:       - /gravitee/apim-management-api/logs:/opt/graviteeio-management-api/logs       - /gravitee/apim-management-api/plugins:/opt/graviteeio-management-api/plugins-ext       - /gravitee/license.key:/opt/graviteeio-management-api/license/license.key         environment:       - gravitee_management_mongodb_uri=mongodb://mongodb:27017/gravitee?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000       - gravitee_analytics_elasticsearch_endpoints_0=http://elasticsearch:9200       - gravitee_plugins_path_0=/opt/graviteeio-management-api/plugins       - gravitee_plugins_path_1=/opt/graviteeio-management-api/plugins-ext     networks:       - storage       - frontend</p>  <p>== Reference - API Management Management UI In the file you'll find this ... [source,yaml]</p>  <p>management_ui:     image: graviteeio/apim-management-ui:${APIM_VERSION:-3}     container_name: gio_apim_management_ui     restart: always     ports:       - \"8084:8080\"     depends_on:       - management_api     environment:       - MGMT_API_URL=http://localhost:8083/management/organizations/DEFAULT/environments/DEFAULT/     volumes:       - ./logs/apim-management-ui:/var/log/nginx     networks:       - frontend</p>  <p>And you turn it into this [source,yaml]</p>  <p>management-ui:     image: graviteeio/apim-management-ui:${APIM_VERSION:-3}     container_name: gio_apim_management_ui     restart: always     ports:       - \"8084:8080\"     depends_on:       - management-api     environment:       - MGMT_API_URL=http://localhost:8083/management/organizations/DEFAULT/environments/DEFAULT/     volumes:       - /gravitee/apim-management-ui/logs:/var/log/nginx     networks:       - frontend</p>  <p>== Reference - API Management Portal UI In the file you'll find this ... [source,yaml]</p>  <p>portal_ui:     image: graviteeio/apim-portal-ui:${APIM_VERSION:-3}     container_name: gio_apim_portal_ui     restart: always     ports:       - \"8085:8080\"     depends_on:       - management_api     environment:       - PORTAL_API_URL=http://localhost:8083/portal/environments/DEFAULT     volumes:       - ./logs/apim-portal-ui:/var/log/nginx     networks:       - frontend</p>  <p>And you turn it into this [source,yaml]</p>  <p>portal-ui:     image: graviteeio/apim-portal-ui:${APIM_VERSION:-3}     container_name: gio_apim_portal_ui     restart: always     ports:       - \"8085:8080\"     depends_on:       - management-api     environment:       - PORTAL_API_URL=http://localhost:8083/portal/environments/DEFAULT     volumes:       - /gravitee/apim-portal-ui/logs:/var/log/nginx     networks:       - frontend</p>","location":"apim/installation-guide/docker/installation-guide-docker-compose-ee/#docker-compose-up-d"},{"title":"Setup","text":"<p>Before you can get into the actual installation, a couple of things need to be set up</p> <ol> <li> <p>Docker</p> <p>Is assumed to be installed.</p> </li> <li> <p>Docker Compose</p> <p>Is assumed to be installed.</p> </li> <li> <p>Persistence</p> <p>Containers are great, but you do want persistence in case they need to be restarted. You are going to persist the MongoDB data, the Elasticsearch data and provide locations for additional plugins (both for the Gateway and the REST API). It is assumed in this page that these will live under a filesystem mounted at <code>/gravitee</code> on the host system.</p> <pre><code>mkdir /gravitee/mongodb\nmkdir /gravitee/mongodb/data\nmkdir /gravitee/elasticsearch\nmkdir /gravitee/elasticsearch/data\nmkdir /gravitee/apim-gateway\nmkdir /gravitee/apim-gateway/plugins\nmkdir /gravitee/apim-gateway/logs\nmkdir /gravitee/apim-management-api\nmkdir /gravitee/apim-management-api/plugins\nmkdir /gravitee/apim-management-api/logs\nmkdir /gravitee/apim-management-ui\nmkdir /gravitee/apim-management-ui/logs\nmkdir /gravitee/apim-portal-ui\nmkdir /gravitee/apim-portal-ui/logs\n</code></pre> </li> </ol> <p>As was indicated before, your architecture may differ and thus require a different setup.</p>","location":"apim/installation-guide/docker/installation-guide-docker-compose/"},{"title":"Compose","text":"<p>First you need to download the docker-compose.yml file.</p> <pre><code>curl -L https://raw.githubusercontent.com/gravitee-io/gravitee-docker/master/apim/3.x/docker-compose.yml -o \"docker-compose.yml\"\n</code></pre> <p>Next, you should modify this file to match your own architecture and preferences. You\u2019ll find a reference to each part of the compose file below and the changes necessary to match our basic architecture.</p> <p>You can perfectly use the file as is if you just want to get going. It will not use the filesystem setup mentioned above though.</p> <p>Once you are happy with things \u2026 start the whole setup in one go</p> <pre><code>docker-compose up -d\n</code></pre>","location":"apim/installation-guide/docker/installation-guide-docker-compose/#compose"},{"title":"Reference - Volumes","text":"<p>In the file you\u2019ll find this \u2026</p> <pre><code>volumes:\n  data-elasticsearch:\n  data-mongo:\n</code></pre> <p>As we are using a plain filesystem at <code>/gravitee</code>, you can remove those lines.</p>","location":"apim/installation-guide/docker/installation-guide-docker-compose/#reference-volumes"},{"title":"Reference - MongoDB","text":"<p>In the file you\u2019ll find this \u2026</p> <pre><code>  mongodb:\n    image: mongo:${MONGODB_VERSION:-3.6}\n    container_name: gio_apim_mongodb\n    restart: always\n    volumes:\n      - data-mongo:/data/db\n      - ./logs/apim-mongodb:/var/log/mongodb\n    networks:\n      - storage\n</code></pre> <p>And you turn it into this</p> <pre><code>  mongodb:\n    image: mongo:${MONGODB_VERSION:-3.6}\n    container_name: gio_apim_mongodb\n    restart: always\n    volumes:\n      - /gravitee/mongodb/data:/data/db\n    networks:\n      - storage\n</code></pre> <p>Accessing the logs of the MongoDB container should be done through <code>docker logs gio_apim_mongodb</code>.</p>","location":"apim/installation-guide/docker/installation-guide-docker-compose/#reference-mongodb"},{"title":"Reference - Elasticsearch","text":"<p>In the file you\u2019ll find this \u2026</p> <pre><code>  elasticsearch:\n    image: docker.elastic.co/elasticsearch/elasticsearch:${ELASTIC_VERSION:-7.7.0}\n    container_name: gio_apim_elasticsearch\n    restart: always\n    volumes:\n      - data-elasticsearch:/usr/share/elasticsearch/data\n    environment:\n      - http.host=0.0.0.0\n      - transport.host=0.0.0.0\n      - xpack.security.enabled=false\n      - xpack.monitoring.enabled=false\n      - cluster.name=elasticsearch\n      - bootstrap.memory_lock=true\n      - discovery.type=single-node\n      - \"ES_JAVA_OPTS=-Xms512m -Xmx512m\"\n    ulimits:\n      memlock:\n        soft: -1\n        hard: -1\n      nofile: 65536\n    networks:\n      - storage\n</code></pre> <p>And you turn it into this</p> <pre><code>  elasticsearch:\n    image: docker.elastic.co/elasticsearch/elasticsearch:${ELASTIC_VERSION:-7.7.0}\n    container_name: gio_apim_elasticsearch\n    restart: always\n    volumes:\n      - /gravitee/elasticsearch/data:/usr/share/elasticsearch/data\n    environment:\n      - http.host=0.0.0.0\n      - transport.host=0.0.0.0\n      - xpack.security.enabled=false\n      - xpack.monitoring.enabled=false\n      - cluster.name=elasticsearch\n      - bootstrap.memory_lock=true\n      - discovery.type=single-node\n      - \"ES_JAVA_OPTS=-Xms512m -Xmx512m\"\n    ulimits:\n      memlock:\n        soft: -1\n        hard: -1\n      nofile: 65536\n    networks:\n      - storage\n</code></pre> <p>Accessing the logs of the Elasticsearch container should be done through <code>docker logs gio_apim_elasticsearch</code></p>","location":"apim/installation-guide/docker/installation-guide-docker-compose/#reference-elasticsearch"},{"title":"Reference - API Management Gateway","text":"<p>In the file you\u2019ll find this \u2026</p> <pre><code>  gateway:\n    image: graviteeio/apim-gateway:${APIM_VERSION:-3}\n    container_name: gio_apim_gateway\n    restart: always\n    ports:\n      - \"8082:8082\"\n    depends_on:\n      - mongodb\n      - elasticsearch\n    volumes:\n      - ./logs/apim-gateway:/opt/graviteeio-gateway/logs\n    environment:\n      - gravitee_management_mongodb_uri=mongodb://mongodb:27017/gravitee?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000\n      - gravitee_ratelimit_mongodb_uri=mongodb://mongodb:27017/gravitee?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000\n      - gravitee_reporters_elasticsearch_endpoints_0=http://elasticsearch:9200\n    networks:\n      - storage\n      - frontend\n</code></pre> <p>And you turn it into this</p> <pre><code>  gateway:\n    image: graviteeio/apim-gateway:${APIM_VERSION:-3}\n    container_name: gio_apim_gateway\n    restart: always\n    ports:\n      - \"8082:8082\"\n    depends_on:\n      - mongodb\n      - elasticsearch\n    volumes:\n      - /gravitee/apim-gateway/logs:/opt/graviteeio-gateway/logs\n      - /gravitee/apim-gateway/plugins:/opt/graviteeio-gateway/plugins-ext\n    environment:\n      - gravitee_management_mongodb_uri=mongodb://mongodb:27017/gravitee?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000\n      - gravitee_ratelimit_mongodb_uri=mongodb://mongodb:27017/gravitee?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000\n      - gravitee_reporters_elasticsearch_endpoints_0=http://elasticsearch:9200\n      - gravitee_plugins_path_0=/opt/graviteeio-gateway/plugins\n      - gravitee_plugins_path_1=/opt/graviteeio-gateway/plugins-ext\n    networks:\n      - storage\n      - frontend\n</code></pre>","location":"apim/installation-guide/docker/installation-guide-docker-compose/#reference-api-management-gateway"},{"title":"Reference - API Management REST API","text":"<p>In the file you\u2019ll find this \u2026</p> <pre><code>  management_api:\n    image: graviteeio/apim-management-api:${APIM_VERSION:-3}\n    container_name: gio_apim_management_api\n    restart: always\n    ports:\n      - \"8083:8083\"\n    links:\n      - mongodb\n      - elasticsearch\n    depends_on:\n      - mongodb\n      - elasticsearch\n    volumes:\n      - ./logs/apim-management-api:/opt/graviteeio-management-api/logs\n    environment:\n      - gravitee_management_mongodb_uri=mongodb://mongodb:27017/gravitee?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000\n      - gravitee_analytics_elasticsearch_endpoints_0=http://elasticsearch:9200\n    networks:\n      - storage\n      - frontend\n</code></pre> <p>And you turn it into this</p> <pre><code>  management-api:\n    image: graviteeio/apim-management-api:${APIM_VERSION:-3}\n    container_name: gio_apim_management_api\n    restart: always\n    ports:\n      - \"8083:8083\"\n    depends_on:\n      - mongodb\n      - elasticsearch\n    volumes:\n      - /gravitee/apim-management-api/logs:/opt/graviteeio-management-api/logs\n      - /gravitee/apim-management-api/plugins:/opt/graviteeio-management-api/plugins-ext\n    environment:\n      - gravitee_management_mongodb_uri=mongodb://mongodb:27017/gravitee?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000\n      - gravitee_analytics_elasticsearch_endpoints_0=http://elasticsearch:9200\n      - gravitee_plugins_path_0=/opt/graviteeio-management-api/plugins\n      - gravitee_plugins_path_1=/opt/graviteeio-management-api/plugins-ext\n    networks:\n      - storage\n      - frontend\n</code></pre>","location":"apim/installation-guide/docker/installation-guide-docker-compose/#reference-api-management-rest-api"},{"title":"Reference - API Management Management UI","text":"<p>In the file you\u2019ll find this \u2026</p> <pre><code>  management_ui:\n    image: graviteeio/apim-management-ui:${APIM_VERSION:-3}\n    container_name: gio_apim_management_ui\n    restart: always\n    ports:\n      - \"8084:8080\"\n    depends_on:\n      - management_api\n    environment:\n      - MGMT_API_URL=http://localhost:8083/management/organizations/DEFAULT/environments/DEFAULT/\n    volumes:\n      - ./logs/apim-management-ui:/var/log/nginx\n    networks:\n      - frontend\n</code></pre> <p>And you turn it into this</p> <pre><code>  management-ui:\n    image: graviteeio/apim-management-ui:${APIM_VERSION:-3}\n    container_name: gio_apim_management_ui\n    restart: always\n    ports:\n      - \"8084:8080\"\n    depends_on:\n      - management-api\n    environment:\n      - MGMT_API_URL=http://localhost:8083/management/organizations/DEFAULT/environments/DEFAULT/\n    volumes:\n      - /gravitee/apim-management-ui/logs:/var/log/nginx\n    networks:\n      - frontend\n</code></pre>","location":"apim/installation-guide/docker/installation-guide-docker-compose/#reference-api-management-management-ui"},{"title":"Reference - API Management Portal UI","text":"<p>In the file you\u2019ll find this \u2026</p> <pre><code>  portal_ui:\n    image: graviteeio/apim-portal-ui:${APIM_VERSION:-3}\n    container_name: gio_apim_portal_ui\n    restart: always\n    ports:\n      - \"8085:8080\"\n    depends_on:\n      - management_api\n    environment:\n      - PORTAL_API_URL=http://localhost:8083/portal/environments/DEFAULT\n    volumes:\n      - ./logs/apim-portal-ui:/var/log/nginx\n    networks:\n      - frontend\n</code></pre> <p>And you turn it into this</p> <pre><code>  portal-ui:\n    image: graviteeio/apim-portal-ui:${APIM_VERSION:-3}\n    container_name: gio_apim_portal_ui\n    restart: always\n    ports:\n      - \"8085:8080\"\n    depends_on:\n      - management-api\n    environment:\n      - PORTAL_API_URL=http://localhost:8083/portal/environments/DEFAULT\n    volumes:\n      - /gravitee/apim-portal-ui/logs:/var/log/nginx\n    networks:\n      - frontend\n</code></pre>","location":"apim/installation-guide/docker/installation-guide-docker-compose/#reference-api-management-portal-ui"},{"title":"Customize","text":"<p>= Customize :page-toc: false :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_installation_guide_docker_customize.html :page-folder: apim/installation-guide/docker :page-layout: apim3x :page-description: Gravitee.io API Management - Installation Guide - Docker - Customize :page-keywords: Gravitee.io, API Management, apim, guide, manual, docker, customize, linux :page-toc: false :page-liquid:</p> <p>== Overview</p> <p>This section explains how to customize your Docker installation. These procedures are intended for users who are already familiar with Docker.</p> <p>== Install an additional plugin</p> <p>APIM Docker images contain the default plugins. In order to add a custom plugin, it needs to be in the folder mapped to the <code>plugins-ext</code> folder of the image. In our architecture that is in:</p>","location":"apim/installation-guide/docker/installation-guide-docker-customize/"},{"title":"[source]","text":"<p>/gravitee/apim-gateway/plugins /gravitee/apim-management-api/plugins</p>  <p>NOTE: Some plugins need to be installed on both the gateway and the management API. Please verify the specific plugin's documentation for the details.</p> <p>=== Use Redis as the datastore for rate-limit counters</p> <p>This requires a couple of additional environment parameters on starting the gateway container</p>","location":"apim/installation-guide/docker/installation-guide-docker-customize/#source"},{"title":"[source]","text":"<p>--env gravitee_ratelimit_type=redis \\   --env gravitee_ratelimit_redis_host=gravitee-redis \\   --env gravitee_ratelimit_redis_port=6379   </p>  <p>and you can then drop the equivalent parameter for mongodb</p>","location":"apim/installation-guide/docker/installation-guide-docker-customize/#source_1"},{"title":"[source]","text":"","location":"apim/installation-guide/docker/installation-guide-docker-customize/#source_2"},{"title":"--env gravitee_ratelimit_mongodb_uri=\"mongodb://gravitee-mongo:27017/gravitee-apim?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000\" \\","text":"<p>NOTE: Your hostname and port may differ!</p> <p>=== Use JDBC connection as the datastore for management</p> <p>This requires a couple of additional environment parameters on starting the gateway container</p>","location":"apim/installation-guide/docker/installation-guide-docker-customize/#-env-gravitee_ratelimit_mongodb_urimongodbgravitee-mongo27017gravitee-apimserverselectiontimeoutms5000connecttimeoutms5000sockettimeoutms5000"},{"title":"[source]","text":"<p>--env gravitee_management_type=jdbc \\   --env gravitee_management_jdbc_url=jdbc:mysql://gravitee-mysql:3306/gravitee?useSSL=false&amp;user=mysql_users&amp;password=mysql_password \\</p>  <p>and you can then drop the equivalent parameter for mongodb</p>","location":"apim/installation-guide/docker/installation-guide-docker-customize/#source_3"},{"title":"[source]","text":"","location":"apim/installation-guide/docker/installation-guide-docker-customize/#source_4"},{"title":"--env gravitee_management_mongodb_uri=\"mongodb://gravitee-mongo:27017/gravitee-apim?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000\" \\","text":"<p>NOTE: Your hostname and port may differ!</p>","location":"apim/installation-guide/docker/installation-guide-docker-customize/#-env-gravitee_management_mongodb_urimongodbgravitee-mongo27017gravitee-apimserverselectiontimeoutms5000connecttimeoutms5000sockettimeoutms5000"},{"title":"Setup","text":"<p>Before you can get into the actual installation, a couple of things need to be set up</p> <ol> <li> <p>Docker</p> <p>Is assumed to be installed.</p> </li> <li> <p>Persistence</p> <p>Containers are great, but you do want persistence in case they need to be restarted. You are going to persist the MongoDB data, the Elasticsearch data and provide locations for additional plugins (both for the Gateway and the REST API). It is assumed in this page that these will live under a filesystem mounted at <code>/gravitee</code> on the host system.</p> <pre><code>mkdir /gravitee/mongodb\nmkdir /gravitee/mongodb/data\nmkdir /gravitee/elasticsearch\nmkdir /gravitee/elasticsearch/data\nmkdir /gravitee/apim-gateway\nmkdir /gravitee/apim-gateway/plugins\nmkdir /gravitee/apim-gateway/logs\nmkdir /gravitee/apim-management-api\nmkdir /gravitee/apim-management-api/plugins\nmkdir /gravitee/apim-management-api/logs\nmkdir /gravitee/apim-management-ui\nmkdir /gravitee/apim-management-ui/logs\nmkdir /gravitee/apim-portal-ui\nmkdir /gravitee/apim-portal-ui/logs\n</code></pre> </li> <li> <p>Network</p> <p>To provide an easy way for the containers to talk in this setup, create two docker networks. One for storage communication, one for frontend communication. The combination of this network and giving names to the containers will allow you to specify connections easily.</p> <pre><code>docker network create graviteestorage\ndocker network create graviteefrontend\n</code></pre> </li> <li> <p>License</p> <p>The Enterprise installation assumes you have a license. For more information on getting one, check https://www.gravitee.io/pricing. It is assumed below that you have a <code>/gravitee/license.key</code> file.</p> </li> </ol> <p>As was indicated before, your architecture may differ and thus require a different setup.</p>","location":"apim/installation-guide/docker/installation-guide-docker-images-ee/"},{"title":"Install MongoDB","text":"Assumptions       <p>container</p> <p>MongoDB^</p>   <p>network</p> <p>graviteestorage</p>   <p>persistence</p> <p>/gravitee/mongodb/data</p>    <p>Assumptions</p> <p>Instructions</p> <pre><code>docker pull mongo:3.6\ndocker run --name gravitee-mongo \\\n  --net graviteestorage \\\n  --volume /gravitee/mongodb/data:/data/db \\\n  --detach mongo:3.6\n</code></pre>","location":"apim/installation-guide/docker/installation-guide-docker-images-ee/#install-mongodb"},{"title":"Install Elasticsearch","text":"Assumptions       <p>container</p> <p>Elasticsearch^</p>   <p>network</p> <p>graviteestorage</p>   <p>persistence</p> <p>/gravitee/elasticsearch/data</p>    <p>Assumptions</p> <p>Instructions</p> <pre><code>docker pull docker.elastic.co/elasticsearch/elasticsearch:7.7.0\ndocker run --name gravitee-elasticsearch \\\n  --net graviteestorage \\\n  --env http.host=0.0.0.0 \\\n  --env transport.host=0.0.0.0 \\\n  --env xpack.security.enabled=false \\\n  --env xpack.monitoring.enabled=false \\\n  --env cluster.name=gravitee-elasticsearch \\\n  --env bootstrap.memory_lock=true \\\n  --env discovery.type=single-node \\\n  --env \"ES_JAVA_OPTS=-Xms512m -Xmx512m\" \\\n  --volume /gravitee/elasticsearch/data:/usr/share/elasticsearch/data \\\n  --detach docker.elastic.co/elasticsearch/elasticsearch:7.7.0\n</code></pre>","location":"apim/installation-guide/docker/installation-guide-docker-images-ee/#install-elasticsearch"},{"title":"Install API Management Gateway","text":"Assumptions       <p>container</p> <p>Gateway^</p>   <p>network</p> <p>graviteestorage</p>   <p>network</p> <p>graviteefrontend</p>   <p>persistence</p> <p>/gravitee/apim-gateway/plugins</p>   <p>persistence</p> <p>/gravitee/apim-gateway/logs</p>   <p>license</p> <p>/gravitee/license.key</p>    <p>Assumptions</p> <p>Instructions</p> <pre><code>docker pull graviteeio/apim-gateway:{{ site.products.apim._3x.version }}-ee\n\ndocker run --publish 8082:8082 \\\n  --volume /gravitee/apim-gateway/plugins:/opt/graviteeio-gateway/plugins-ext \\\n  --volume /gravitee/apim-gateway/logs:/opt/graviteeio-gateway/logs \\\n  --volume /gravitee/license.key:/opt/graviteeio-gateway/license/license.key \\\n  --env gravitee_management_mongodb_uri=\"mongodb://gravitee-mongo:27017/gravitee-apim?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000\" \\\n  --env gravitee_ratelimit_mongodb_uri=\"mongodb://gravitee-mongo:27017/gravitee-apim?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000\" \\\n  --env gravitee_reporters_elasticsearch_endpoints_0=\"http://gravitee-elasticsearch:9200\" \\\n  --env gravitee_plugins_path_0=/opt/graviteeio-gateway/plugins \\\n  --env gravitee_plugins_path_1=/opt/graviteeio-gateway/plugins-ext \\\n  --net graviteestorage \\\n  --name gravitee-apim-gateway \\\n  --detach graviteeio/apim-gateway:{{ site.products.apim._3x.version }}-ee\n\ndocker network connect graviteefrontend gravitee-apim-gateway\n</code></pre>","location":"apim/installation-guide/docker/installation-guide-docker-images-ee/#install-api-management-gateway"},{"title":"Install API Management REST API","text":"Assumptions       <p>container</p> <p>REST API^</p>   <p>network</p> <p>graviteestorage</p>   <p>network</p> <p>graviteefrontend</p>   <p>persistence</p> <p>/gravitee/apim-management-api/plugins</p>   <p>persistence</p> <p>/gravitee/apim-management-api/logs</p>   <p>license</p> <p>/gravitee/license.key</p>    <p>Assumptions</p> <p>Instructions</p> <pre><code>docker pull graviteeio/apim-management-api:{{ site.products.apim._3x.version }}-ee\n\ndocker run --publish 8083:8083 \\\n  --volume /gravitee/apim-management-api/plugins:/opt/graviteeio-management-api/plugins-ext \\\n  --volume /gravitee/apim-management-api/logs:/opt/graviteeio-management-api/logs \\\n  --volume /gravitee/license.key:/opt/graviteeio-management-api/license/license.key \\\n  --env gravitee_management_mongodb_uri=\"mongodb://gravitee-mongo:27017/gravitee-apim?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000\" \\\n  --env gravitee_analytics_elasticsearch_endpoints_0=\"http://gravitee-elasticsearch:9200\" \\\n  --env gravitee_plugins_path_0=/opt/graviteeio-management-api/plugins \\\n  --env gravitee_plugins_path_1=/opt/graviteeio-management-api/plugins-ext \\\n  --net graviteestorage \\\n  --name gravitee-apim-management-api \\\n  --detach graviteeio/apim-management-api:{{ site.products.apim._3x.version }}-ee\n\ndocker network connect graviteefrontend gravitee-apim-management-api\n</code></pre>","location":"apim/installation-guide/docker/installation-guide-docker-images-ee/#install-api-management-rest-api"},{"title":"Install API Management Management UI","text":"Assumptions       <p>container</p> <p>Management UI^</p>   <p>network</p> <p>graviteefrontend</p>   <p>persistence</p> <p>/gravitee/apim-management-ui/logs</p>    <p>Assumptions</p> <p>Instructions</p> <pre><code>docker pull graviteeio/apim-management-ui:latest\ndocker run --publish 8084:8080 \\\n  --volume /gravitee/apim-management-ui/logs:/var/log/nginx \\\n  --net graviteefrontend \\\n  --name gravitee-apim-management-ui \\\n  --env MGMT_API_URL=http://localhost:8083/management/organizations/DEFAULT/environments/DEFAULT \\\n  --detach graviteeio/apim-management-ui:latest\n</code></pre>","location":"apim/installation-guide/docker/installation-guide-docker-images-ee/#install-api-management-management-ui"},{"title":"Install API Management Portal UI","text":"Assumptions       <p>container</p> <p>Portal UI^</p>   <p>network</p> <p>graviteefrontend</p>   <p>persistence</p> <p>/gravitee/apim-portal-ui/logs</p>    <p>Assumptions</p> <p>Instructions</p> <pre><code>docker pull graviteeio/apim-portal-ui:latest\ndocker run --publish 8085:8080 \\\n  --volume /gravitee/apim-portal-ui/logs:/var/log/nginx \\\n  --net graviteefrontend \\\n  --name gravitee-apim-portal-ui \\\n  --env PORTAL_API_URL=http://localhost:8083/portal/environments/DEFAULT \\\n  --detach graviteeio/apim-portal-ui:latest\n</code></pre>","location":"apim/installation-guide/docker/installation-guide-docker-images-ee/#install-api-management-portal-ui"},{"title":"Setup","text":"<p>Before you can get into the actual installation, a couple of things need to be set up</p> <ol> <li> <p>Docker</p> <p>Is assumed to be installed.</p> </li> <li> <p>Persistence</p> <p>Containers are great, but you do want persistence in case they need to be restarted. You are going to persist the MongoDB data, the Elasticsearch data and provide locations for additional plugins (both for the Gateway and the REST API). It is assumed in this page that these will live under a filesystem mounted at <code>/gravitee</code> on the host system.</p> <pre><code>mkdir /gravitee/mongodb\nmkdir /gravitee/mongodb/data\nmkdir /gravitee/elasticsearch\nmkdir /gravitee/elasticsearch/data\nmkdir /gravitee/apim-gateway\nmkdir /gravitee/apim-gateway/plugins\nmkdir /gravitee/apim-gateway/logs\nmkdir /gravitee/apim-management-api\nmkdir /gravitee/apim-management-api/plugins\nmkdir /gravitee/apim-management-api/logs\nmkdir /gravitee/apim-management-ui\nmkdir /gravitee/apim-management-ui/logs\nmkdir /gravitee/apim-portal-ui\nmkdir /gravitee/apim-portal-ui/logs\n</code></pre> </li> <li> <p>Network</p> <p>To provide an easy way for the containers to talk in this setup, create two docker networks. One for storage communication, one for frontend communication. The combination of this network and giving names to the containers will allow you to specify connections easily.</p> <pre><code>docker network create graviteestorage\ndocker network create graviteefrontend\n</code></pre> </li> </ol> <p>As was indicated before, your architecture may differ and thus require a different setup.</p>","location":"apim/installation-guide/docker/installation-guide-docker-images/"},{"title":"Install MongoDB","text":"Assumptions       <p>container</p> <p>MongoDB^</p>   <p>network</p> <p>graviteestorage</p>   <p>persistence</p> <p>/gravitee/mongodb/data</p>    <p>Assumptions</p> <p>Instructions</p> <pre><code>docker pull mongo:3.6\ndocker run --name gravitee-mongo \\\n  --net graviteestorage \\\n  --volume /gravitee/mongodb/data:/data/db \\\n  --detach mongo:3.6\n</code></pre>","location":"apim/installation-guide/docker/installation-guide-docker-images/#install-mongodb"},{"title":"Install Elasticsearch","text":"Assumptions       <p>container</p> <p>Elasticsearch^</p>   <p>network</p> <p>graviteestorage</p>   <p>persistence</p> <p>/gravitee/elasticsearch/data</p>    <p>Assumptions</p> <p>Instructions</p> <pre><code>docker pull docker.elastic.co/elasticsearch/elasticsearch:7.7.0\ndocker run --name gravitee-elasticsearch \\\n  --net graviteestorage \\\n  --env http.host=0.0.0.0 \\\n  --env transport.host=0.0.0.0 \\\n  --env xpack.security.enabled=false \\\n  --env xpack.monitoring.enabled=false \\\n  --env cluster.name=gravitee-elasticsearch \\\n  --env bootstrap.memory_lock=true \\\n  --env discovery.type=single-node \\\n  --env \"ES_JAVA_OPTS=-Xms512m -Xmx512m\" \\\n  --volume /gravitee/elasticsearch/data:/usr/share/elasticsearch/data \\\n  --detach docker.elastic.co/elasticsearch/elasticsearch:7.7.0\n</code></pre>","location":"apim/installation-guide/docker/installation-guide-docker-images/#install-elasticsearch"},{"title":"Install API Management Gateway","text":"Assumptions       <p>container</p> <p>Gateway^</p>   <p>network</p> <p>graviteestorage</p>   <p>network</p> <p>graviteefrontend</p>   <p>persistence</p> <p>/gravitee/apim-gateway/plugins</p>   <p>persistence</p> <p>/gravitee/apim-gateway/logs</p>    <p>Assumptions</p> <p>Instructions</p> <pre><code>docker pull graviteeio/apim-gateway:latest\n\ndocker run --publish 8082:8082 \\\n  --volume /gravitee/apim-gateway/plugins:/opt/graviteeio-gateway/plugins-ext \\\n  --volume /gravitee/apim-gateway/logs:/opt/graviteeio-gateway/logs \\\n  --env gravitee_management_mongodb_uri=\"mongodb://gravitee-mongo:27017/gravitee-apim?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000\" \\\n  --env gravitee_ratelimit_mongodb_uri=\"mongodb://gravitee-mongo:27017/gravitee-apim?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000\" \\\n  --env gravitee_reporters_elasticsearch_endpoints_0=\"http://gravitee-elasticsearch:9200\" \\\n  --env gravitee_plugins_path_0=/opt/graviteeio-gateway/plugins \\\n  --env gravitee_plugins_path_1=/opt/graviteeio-gateway/plugins-ext \\\n  --net graviteestorage \\\n  --name gravitee-apim-gateway \\\n  --detach graviteeio/apim-gateway:latest\n\ndocker network connect graviteefrontend gravitee-apim-gateway\n</code></pre>","location":"apim/installation-guide/docker/installation-guide-docker-images/#install-api-management-gateway"},{"title":"Install API Management REST API","text":"Assumptions       <p>container</p> <p>REST API^</p>   <p>network</p> <p>graviteestorage</p>   <p>network</p> <p>graviteefrontend</p>   <p>persistence</p> <p>/gravitee/apim-management-api/plugins</p>   <p>persistence</p> <p>/gravitee/apim-management-api/logs</p>    <p>Assumptions</p> <p>Instructions</p> <pre><code>docker pull graviteeio/apim-management-api:latest\n\ndocker run --publish 8083:8083 \\\n  --volume /gravitee/apim-management-api/plugins:/opt/graviteeio-management-api/plugins-ext \\\n  --volume /gravitee/apim-management-api/logs:/opt/graviteeio-management-api/logs \\\n  --env gravitee_management_mongodb_uri=\"mongodb://gravitee-mongo:27017/gravitee-apim?serverSelectionTimeoutMS=5000&amp;connectTimeoutMS=5000&amp;socketTimeoutMS=5000\" \\\n  --env gravitee_analytics_elasticsearch_endpoints_0=\"http://gravitee-elasticsearch:9200\" \\\n  --env gravitee_plugins_path_0=/opt/graviteeio-management-api/plugins \\\n  --env gravitee_plugins_path_1=/opt/graviteeio-management-api/plugins-ext \\\n  --net graviteestorage \\\n  --name gravitee-apim-management-api \\\n  --detach graviteeio/apim-management-api:latest\n\ndocker network connect graviteefrontend gravitee-apim-management-api\n</code></pre>","location":"apim/installation-guide/docker/installation-guide-docker-images/#install-api-management-rest-api"},{"title":"Install API Management Management UI","text":"Assumptions       <p>container</p> <p>Management UI^</p>   <p>network</p> <p>graviteefrontend</p>   <p>persistence</p> <p>/gravitee/apim-management-ui/logs</p>    <p>Assumptions</p> <p>Instructions</p> <pre><code>docker pull graviteeio/apim-management-ui:latest\ndocker run --publish 8084:8080 \\\n  --volume /gravitee/apim-management-ui/logs:/var/log/nginx \\\n  --net graviteefrontend \\\n  --name gravitee-apim-management-ui \\\n  --env MGMT_API_URL=http://localhost:8083/management/organizations/DEFAULT/environments/DEFAULT \\\n  --detach graviteeio/apim-management-ui:latest\n</code></pre>","location":"apim/installation-guide/docker/installation-guide-docker-images/#install-api-management-management-ui"},{"title":"Install API Management Portal UI","text":"Assumptions       <p>container</p> <p>Portal UI^</p>   <p>network</p> <p>graviteefrontend</p>   <p>persistence</p> <p>/gravitee/apim-portal-ui/logs</p>    <p>Assumptions</p> <p>Instructions</p> <pre><code>docker pull graviteeio/apim-portal-ui:latest\ndocker run --publish 8085:8080 \\\n  --volume /gravitee/apim-portal-ui/logs:/var/log/nginx \\\n  --net graviteefrontend \\\n  --name gravitee-apim-portal-ui \\\n  --env PORTAL_API_URL=http://localhost:8083/portal/environments/DEFAULT \\\n  --detach graviteeio/apim-portal-ui:latest\n</code></pre>","location":"apim/installation-guide/docker/installation-guide-docker-images/#install-api-management-portal-ui"},{"title":"Introduction","text":"<p>Installation using Docker requires some familiarity with, you guessed it, Docker^. The below options will set up Gravitee.io API Management (APIM) with all its prerequisites on a single machine. Your desired architecture may look different!</p> <p>image::{% link images/apim/3.x/installation/docker/apim_simple_docker_architecture.png %}[APIM simple docker architecture]</p> <p>Four options are provided:</p> <ul> <li> <p>link:{{ /apim/3.x/apim_installation_guide_docker_images.html |     relative_url }}[Install with the images]</p> </li> <li> <p>link:{{     /apim/3.x/apim_installation_guide_docker_images_ee.html |     relative_url }}[Install with the images (APIM enterprise     edition)]</p> </li> </ul>","location":"apim/installation-guide/docker/installation-guide-docker-introduction/"},{"title":"Overview","text":"<p>Hybrid architectures (i.e. a combination of on-premise and cloud deployments) present unique technical and/or cost constraints when it comes to deploying APIM components in different data centers.</p> <p>The APIM hybrid deployment solution (in the form of hybrid components, or plugins) overcomes these constraints, giving you the freedom to define your architecture and deployment vision however you want.</p>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v1/"},{"title":"Architecture","text":"<p>The following diagram shows a typical hybrid APIM architecture:</p> <p>Deployment architecture</p> <p>image::{% link images/apim/3.x/installation/hybrid/hybrid_deployment_architecture.png %}[Hybrid deployment architecture]</p>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v1/#architecture"},{"title":"Configuration","text":"<p>For APIM Gateway to work in this setup, you need two components:</p> <ul> <li> <p>A bridge API Gateway (shown in green in the diagram) which exposes     extra HTTP services for bridging HTTP calls to the underlying     repository (which can be any of our supported repositories: MongoDB,     JDBC and so on)</p> </li> <li> <p>A standard APIM Gateway (shown in red on the schema) with the     default repository plugin switched to a new HTTP bridge repository     plugin</p> </li> </ul> <p>In this infrastructure the standard APIM Gateway can communicate with the bridge API Gateway through a secure HTTP/S channel, and your cloud data center does not need to have a datastore installed.</p> <p>What we describe as a bridge API Gateway is, in fact, a standard APIM Gateway augmented with a new plugin.</p>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v1/#configuration"},{"title":"APIM Gateway - HTTP bridge (server)","text":"","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v1/#apim-gateway-http-bridge-server"},{"title":"Installation","text":"<p>To expose the new HTTP API, you need to install a new plugin inside the <code>plugins</code> directory of APIM Gateway. This plugin can be found at https://download.gravitee.io/#graviteeio-apim/plugins/repositories/gravitee-apim-repository-gateway-bridge-http-server/</p> <p>This plugin is disabled by default from APIM 3.13.0.</p> <pre><code>$ wget -O ${GRAVITEEIO_HOME}/plugins https://download.gravitee.io/graviteeio-apim/plugins/repositories/gravitee-apim-repository-gateway-bridge-http-server/gravitee-apim-repository-gateway-bridge-http-server-${PLUGIN_VERSION}.zip\n</code></pre> <p>You can safely remove all plugins that start with the following names - these are not used on a bridge server gateway but are available by default in the APIM Gateway:</p> <ul> <li> <p>gravitee-apim-gateway-services-sync*</p> </li> <li> <p>gravitee-policy-*</p> </li> <li> <p>gravitee-resource-*</p> </li> </ul>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v1/#installation"},{"title":"Configuration","text":"<p>You configure the new plugin in the <code>gravitee.yml</code> file.</p> <pre><code>services:\n  bridge:\n    http:\n      enabled: true\n      port: 18092\n      host: localhost\n      authentication:\n        # authentication type to be used for the core services\n        # - none : to disable authentication\n        # - basic : to use basic authentication\n        # default is \"basic\"\n        type: basic\n        users:\n          admin: adminadmin\n      secured: true\n      ssl:\n        clientAuth: false\n        keystore:\n          type: # can be jks / pem / pkcs12\n          path:\n          password:\n          certs: # Required for pem\n            -  /path/to/cert\n          keys:\n            -  /path/to/key\n        trustore:\n          type: # can be jks / pem / pkcs12\n          path:\n          password:\n</code></pre>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v1/#configuration_1"},{"title":"Check the APIM Gateway node is running","text":"<p>You can test that your APIM Gateway node is running by sending an HTTP request to port <code>8082</code> on <code>localhost</code>:</p> <pre><code>$ curl -X GET http://localhost:18092/_bridge/apis\n</code></pre> <p>You should receive a response containing an empty array or a list of APIs.</p>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v1/#check-the-apim-gateway-node-is-running"},{"title":"APIM Gateway - HTTP repository (client)","text":"","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v1/#apim-gateway-http-repository-client"},{"title":"Installation","text":"<p>To consume the HTTP bridge, you need to replace default repository plugins (usually a MongoDB repository) with a new HTTP repository in the APIM Gateway <code>plugins</code> directory. This plugin can be found at https://download.gravitee.io/#graviteeio-apim/plugins/repositories/gravitee-apim-repository-gateway-bridge-http-client/</p> <pre><code>$ wget -O ${GRAVITEEIO_HOME}/plugins https://download.gravitee.io/graviteeio-apim/plugins/repositories/gravitee-apim-repository-gateway-bridge-http-client/gravitee-apim-repository-gateway-bridge-http-client-${PLUGIN_VERSION}.zip\n</code></pre>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v1/#installation_1"},{"title":"Configuration","text":"<p>You configure the new plugin in the <code>gravitee.yml</code> file in the APIM Gateway <code>config</code> directory.</p> <pre><code>management:\n  type: http\n  http:\n    url: http://localhost:18092/\n    keepAlive: true\n    idleTimeout: 30000\n    connectTimeout: 10000\n    authentication:\n      basic:\n        username: admin\n        password: adminadmin\n    ssl:\n      trustAll: true\n      verifyHostname: true\n      keystore:\n        type: # can be jks / pem / pkcs12\n        path:\n        password:\n      trustore:\n        type: # can be jks / pem / pkcs12\n        path:\n        password:\n</code></pre>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v1/#configuration_2"},{"title":"Start the APIM Gateways","text":"<p>Start both APIM Gateways. Your consumers will be able to call APIM Gateway with the HTTP repository as usual.</p>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v1/#start-the-apim-gateways"},{"title":"APIM Hybrid Deployment Guide","text":"<p>Introduction</p> <p>This documentation page relates to the installation of the client (On-Prem / Private Cloud) part of the API Management platform in a Hybrid architecture (SaaS + On-prem / Private cloud).</p>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v2/","tags":["Hybrid","APIM installation","APIM deployment"]},{"title":"Architecture","text":"<p>Architecture</p> <p>You can find all architecture information (components descriptions, diagrams) in the architecture section.</p>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v2/#architecture","tags":["Hybrid","APIM installation","APIM deployment"]},{"title":"Hybrid Architecture Self-Hosted (Hybrid) gateway","text":"","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v2/#hybrid-architecture-self-hosted-hybrid-gateway","tags":["Hybrid","APIM installation","APIM deployment"]},{"title":"Installation","text":"Kubernetes (Helm)DockerBinaries    <p>Online documentation and assets</p> <ul> <li>Install APIM on Kubernetes with the Helm Chart</li> <li>Deploy a Hybrid architecture in Kubernetes</li> <li>Gravitee.io Helm Charts</li> </ul>   <p>Prerequisites</p> <ul> <li>Kubectl</li> <li>Helm v3</li> </ul>  <p>Steps :</p> <ol> <li>Add the Gravitee.io Helm charts repository.   <pre><code>helm repo add graviteeio https://helm.gravitee.io\n</code></pre></li> <li>Install using the <code>values.yaml</code> file. Here is the full <code>values.yaml</code> example, please customize it following the Configuration sections.   <pre><code>helm install graviteeio-apim3x graviteeio/apim3  \\\n--create-namespace  \\\n--namespace gravitee-apim  \\\n-f values.yaml\n</code></pre></li> </ol>  <p>Enterprise License</p> <p>If you are using enterprise plugins, you have to install a license file.</p> <p>Please chose one of these options</p> <ul> <li>Add the <code>license.key</code> in the <code>values.yml</code> file</li> <li>Add a helm install command parameter <code>--set license.key=</code></li> </ul> <p>and provide the B64 encoded license :</p> <ul> <li>linux: <code>base64 -w 0 license.key</code></li> <li>macOS: <code>base64 license.key</code></li> <li>windows (certutil): <code>certutil -encode license.key tmp.b64 &amp;&amp; findstr /v /c:- tmp.b64 &gt; license.b64 &amp;&amp; del tmp.b64</code> and copy the context of the license.b64 generated file.</li> </ul>     <p>Online documentation</p> <ul> <li>APIM Docker installation</li> </ul>  <p>Local file structure</p> <pre><code>.\n\u251c\u2500\u2500 config\n\u2502   \u251c\u2500\u2500 gateway\n\u2502   \u2502   \u2514\u2500\u2500 gravitee.yml # (1)\n\u2502   \u2514\u2500\u2500 logstash\n\u2502       \u2514\u2500\u2500 logstash.conf # (2)\n\u251c\u2500\u2500 docker-compose.yml\n\u251c\u2500\u2500 logs\n\u2502   \u2514\u2500\u2500 apim-gateway-dev\n\u2514\u2500\u2500 plugins # (3)\n    \u251c\u2500\u2500 gravitee-apim-repository-hazelcast-3.18.3.zip\n    \u2514\u2500\u2500 gravitee-apim-repository-redis-3.18.3.zip\n</code></pre> <ol> <li>If you prefer to override the default <code>gravitee.yml</code> configuration file, instead of using the environement variables in the <code>docker-compose.yml</code> file.</li> <li>Logstash configuration file.</li> <li>Additional plugins location.</li> </ol> <p>Download plugins</p> <ul> <li>gravitee-apim-repository-redis-3.18.3.zip</li> <li>gravitee-apim-repository-hazelcast-3.18.3.zip</li> </ul>   <p>Download plugins</p> <ul> <li>gravitee-apim-repository-redis-3.18.3.zip</li> </ul>  <p>Online documentation</p> <ul> <li>APIM VMs installation</li> </ul>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v2/#installation","tags":["Hybrid","APIM installation","APIM deployment"]},{"title":"Configuration","text":"<p>There is at least 3 connections to configure :</p> <ul> <li>The connection to the SaaS Management plane with the Bridge Gateway.</li> <li>The connection to push Analytics and Logs with file or tcp reporter pushing data for logstash to send them to the SaaS storage.</li> <li>The connection the local rate limits database.</li> <li>[Optional] The connection to the SaaS Alert Engine.</li> </ul>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v2/#configuration","tags":["Hybrid","APIM installation","APIM deployment"]},{"title":"Management","text":"Kubernetes (Helm)DockerGateway with <code>gravitee.yml</code> file   <p>Into the <code>values.yaml</code> configuration file :</p> values.yaml<pre><code>management:\n  type: http\ngateway:\n  management:\n    http:\n      url: https://bridge-gateway-url:bridge-gateway-port\n      username: kubernetes://&lt;namespace&gt;/secrets/&lt;my-secret-name&gt;/&lt;my-secret-key&gt;\n      password: kubernetes://&lt;namespace&gt;/secrets/&lt;my-secret-name&gt;/&lt;my-secret-key&gt;\n      # ssl:\n      #   trustall: true\n      #   verifyHostname: true\n      #   keystore:\n      #     type: jks # Supports jks, pem, pkcs12\n      #     path: ${gravitee.home}/security/keystore.jks\n      #     password: secret\n      #   truststore:\n      #     type: jks # Supports jks, pem, pkcs12\n      #     path: ${gravitee.home}/security/truststore.jks\n      #     password: secret\n      # proxy:\n      #   host: bridge-gateway-proxy-host\n      #   port: bridge-gateway-proxy-port\n</code></pre>  <p>Online documentation</p> <ul> <li>Install APIM on Kubernetes with the Helm Chart</li> <li>Deploy a Hybrid architecture in Kubernetes</li> <li>Gravitee.io Helm Charts</li> </ul>    docker-compose.yml<pre><code>version: '3.5'\n\nservices:\n  gateway:\n    image: graviteeio/apim-gateway:${APIM_VERSION:-3.18.3}\n    container_name: gio_apim_gateway\n    restart: always\n    ports:\n      - \"8082:8082\"\n    environment:\n      # --- BRIDGE GATEWAYS ---\n      - gravitee_management_type=http\n      - gravitee_management_http_url=https://bridge-gateway-url:bridge-gateway-port\n      - gravitee_management_http_authentication_basic_username=bridge-gateway-username\n      - gravitee_management_http_authentication_basic_password=bridge-gateway-password\n      # - gravitee_management_http_proxy_host=bridge-gateway-proxy-host\n      # - gravitee_management_http_proxy_port=bridge-gateway-proxy-port\n</code></pre>   <p>Into the <code>gravitee.yml</code> configuration file :</p> gravitee.yml<pre><code>management:\n  type: http\n  http:\n    url: https://bridge-gateway-url:bridge-gateway-port\n    keepAlive: true\n    idleTimeout: 30000\n    connectTimeout: 10000\n    authentication:\n      basic:\n        username: bridge-gateway-username\n        password: bridge-gateway-password\n    proxy:\n      host: bridge-gateway-proxy-host\n      port: bridge-gateway-proxy-port\n    ssl:\n      trustAll: true\n      verifyHostname: true\n      keystore:\n        type: # can be jks / pem / pkcs12\n        path:\n        password:\n      trustore:\n        type: # can be jks / pem / pkcs12\n        path:\n        password:\n</code></pre>  <p>Online documentation</p> <ul> <li>APIM hybrid deployment</li> </ul>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v2/#management","tags":["Hybrid","APIM installation","APIM deployment"]},{"title":"Analytics and Logs","text":"Kubernetes (Helm)DockerGateway with <code>gravitee.yml</code> file","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v2/#analytics-and-logs","tags":["Hybrid","APIM installation","APIM deployment"]},{"title":"Files","text":"<p>Into the <code>values.yaml</code> configuration file :</p> values.yaml<pre><code>gateway:\n  reporters:\n    tcp:\n      enabled: true\n      host: logstash\n      port: 8379\n      output: elasticsearch\n</code></pre>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v2/#files","tags":["Hybrid","APIM installation","APIM deployment"]},{"title":"Direct (TCP)","text":"<p>Warning</p> <p>Choosing the direct connection may result in a loss of data. If the connection between the gateway and logstash is broken the newly generated analytics and logs data will be lost.</p>  <p>Into the <code>values.yaml</code> configuration file :</p> values.yaml<pre><code>gateway:\n  reporters:\n    tcp:\n      enabled: true\n      host: logstash\n      port: 8379\n      output: elasticsearch\n</code></pre>  <p>Online documentation</p> <ul> <li>APIM hybrid deployment</li> <li>Full <code>values.yaml</code> example</li> </ul>    docker-compose.yml<pre><code>version: '3.5'\n\nservices:\n  gateway:\n    image: graviteeio/apim-gateway:${APIM_VERSION:-3.18.3}\n    container_name: gio_apim_gateway\n    restart: always\n    ports:\n      - \"8082:8082\"\n    environment:\n      # --- LOGSTASH ---\n      - gravitee_reporters_elasticsearch_enabled=false\n      - gravitee_reportealert-engine-usernamers_tcp_enabled=true\n      - gravitee_reporters_tcp_host=logstash\n      - gravitee_reporters_tcp_port=8379\n      - gravitee_reporters_tcp_output=elasticsearch\n</code></pre>   gravitee.yml<pre><code>reporters:\n  elasticsearch:\n    enabled: false # Is the reporter enabled or not (default to true)\n  tcp:\n    enabled: true\n    host: logstash-host\n    port: logstash-port\n    output: elasticsearch\n</code></pre>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v2/#direct-tcp","tags":["Hybrid","APIM installation","APIM deployment"]},{"title":"Rate limits","text":"Kubernetes (Helm)DockerGateway with <code>gravitee.yml</code> file   values.yaml<pre><code>ratelimit:\n  type: redis\nmanagement:\n  ratelimit:\n    redis:\n      host: redis-host\n      port: 6379\n      password: redis-password\n</code></pre>  <p>Online documentation</p> <ul> <li>APIM hybrid deployment</li> <li>Full <code>values.yaml</code> example</li> </ul>    docker-compose.yml<pre><code>version: '3.5'\n\nservices:\n  gateway:\n    image: graviteeio/apim-gateway:${APIM_VERSION:-3.18.3}\n    container_name: gio_apim_gateway\n    restart: always\n    ports:\n      - \"8082:8082\"\n    environment:\n      # --- RATE LIMIT REPO ---\n      - gravitee_ratelimit_type=redis\n      - gravitee_ratelimit_redis_host=redis-host\n      - gravitee_ratelimit_redis_port=6379\n      - gravitee_ratelimit_redis_password=${REDIS_PASS:-redis-password}\n</code></pre>   gravitee.yml<pre><code>ratelimit:\n  # type: hazelcast\n  type: redis\n  redis:\n    host: redis-host\n    port: 6379\n    password: redis-password\n</code></pre>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v2/#rate-limits","tags":["Hybrid","APIM installation","APIM deployment"]},{"title":"Alert Engine","text":"Kubernetes (Helm)DockerGateway with <code>gravitee.yml</code> file   <p>Into the <code>values.yaml</code> configuration file :</p> values.yaml<pre><code>alerts:\n  enabled: true\n  endpoints:\n    - https://alert-engine-url:alert-engine-port\n  security:\n    enabled: true\n    username: alert-engine-username\n    password: alert-engine-password\n</code></pre>  <p>Online documentation</p> <ul> <li>Integrate AE with API Management</li> <li>Install APIM on Kubernetes with the Helm Chart</li> <li>Deploy a Hybrid architecture in Kubernetes</li> <li>Gravitee.io Helm Charts</li> </ul>    docker-compose.yml<pre><code>version: '3.5'\n\nservices:\n  gateway:\n    image: graviteeio/apim-gateway:${APIM_VERSION:-3.18.3}\n    container_name: gio_apim_gateway\n    restart: always\n    ports:\n      - \"8082:8082\"\n    environment:\n      # --- ALERT ENGINE ---\n      - gravitee_alerts_alertengine_enabled=true\n      - gravitee_alerts_alertengine_ws_discovery=true\n      - gravitee_alerts_alertengine_ws_endpoints_0=https://alert-engine-url:alert-engine-port\n      - gravitee_alerts_alertengine_ws_security_username=alert-engine-username\n      - gravitee_alerts_alertengine_ws_security_password=alert-engine-password\n</code></pre>   gravitee.yml<pre><code>alerts:\n  alert-engine:\n    enabled: true\n    ws:\n      discovery: true\n      endpoints:\n        - https://alert-engine-url:alert-engine-port\n      security:\n        username: alert-engine-username\n        password: alert-engine-password\n</code></pre>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v2/#alert-engine","tags":["Hybrid","APIM installation","APIM deployment"]},{"title":"Full example","text":"Kubernetes (Helm)Docker(VMs) Gateway with <code>gravitee.yml</code> file   <p>Into the <code>values.yaml</code> configuration file :</p> values.yaml<pre><code>management:\n  type: http\ngateway:\n  management:\n    http:\n      url: https://bridge-gateway-url:bridge-gateway-port\n      username: kubernetes://&lt;namespace&gt;/secrets/&lt;my-secret-name&gt;/&lt;my-secret-key&gt;\n      password: kubernetes://&lt;namespace&gt;/secrets/&lt;my-secret-name&gt;/&lt;my-secret-key&gt;\n  reporters:\n    elasticsearch:\n      enabled: false\n    tcp:\n      enabled: true\n      host: gravitee-logstash\n      port: 8379\n      output: elasticsearch\n  ratelimit:\n    redis:\n      host: gravitee-redis-master\n      port: 6379\n      password: redis-password\nratelimit:\n  type: redis\nalerts:\n  enabled: true\n  endpoints:\n    - https://alert-engine-url:alert-engine-port\n  security:\n    enabled: true\n    username: alert-engine-username\n    password: alert-engine-password\napi:\n  enabled: false\nportal:\n  enabled: false\nui:\n  enabled: false\n# For enterprise plugin only, you will need a license\n# license:\n#   name: licensekey\n</code></pre>  <p>Online documentation</p> <ul> <li>Install APIM on Kubernetes with the Helm Chart</li> <li>Deploy a Hybrid architecture in Kubernetes</li> <li>Gravitee.io Helm Charts - Values Template</li> </ul>    docker-compose.yml<pre><code>version: '3.5'\n\nservices:\n  gateway:\n    image: graviteeio/apim-gateway:${APIM_VERSION:-3.18.3}\n    container_name: gio_apim_gateway\n    restart: always\n    ports:\n      - \"8082:8082\"\n    depends_on:\n      - rate-limit\n      - logstash\n    volumes:\n      # --- LOCAL LOG FILES ---\n      - ./logs/apim-gateway-dev:/opt/graviteeio-gateway/logs\n      # --- EE LICENSE FILE ---\n      # - ${GIO_LICENSE}:/opt/graviteeio-gateway/license/license.key\n      # --- ADDITIONAL PLUGINS ---\n      - ./plugins:/opt/graviteeio-gateway/plugins-ext\n      - ./config/gateway/gravitee.yml:/opt/graviteeio-gateway/config/gravitee.yml:ro\n    environment:\n      # --- PLUGINS LOCATIONS ---\n      - gravitee_plugins_path_0=/opt/graviteeio-gateway/plugins\n      - gravitee_plugins_path_1=/opt/graviteeio-gateway/plugins-ext\n      # --- COCKPIT ORGS &amp; ENVS ---\n      - gravitee_organizations=dorian-se\n      - gravitee_environments=dev\n      # --- SHARDING TAGS &amp; TENANTS ---\n      - gravitee_tags=internal\n      # - gravitee_tenant=xxx\n      # --- BRIDGE GATEWAYS ---\n      - gravitee_management_type=http\n      - gravitee_management_http_url=https://bridge-gateway-url:bridge-gateway-port\n      - gravitee_management_http_authentication_basic_username=bridge-gateway-username\n      - gravitee_management_http_authentication_basic_password=bridge-gateway-password\n      # --- RATE LIMIT REPO ---\n      - gravitee_ratelimit_type=redis\n      - gravitee_ratelimit_redis_host=rate-limit\n      - gravitee_ratelimit_redis_port=6379\n      - gravitee_ratelimit_redis_password=${REDIS_PASS:-redis-password}\n      # - gravitee_ratelimit_type=hazelcast\n      # --- LOGSTASH ---\n      - gravitee_reporters_elasticsearch_enabled=false\n      - gravitee_reportealert-engine-usernamers_tcp_enabled=true\n      - gravitee_reporters_tcp_host=logstash\n      - gravitee_reporters_tcp_port=8379\n      - gravitee_reporters_tcp_output=elasticsearch\n      # --- ALERT ENGINE ---\n      # - gravitee_alerts_alertengine_enabled=true\n      # - gravitee_alerts_alertengine_ws_discovery=true\n      # - gravitee_alerts_alertengine_ws_endpoints_0=https://alert-engine-url:alert-engine-port\n      # - gravitee_alerts_alertengine_ws_security_username=alert-engine-username\n      # - gravitee_alerts_alertengine_ws_security_password=alert-engine-password\n      # --- SECRETS ---\n      - gravitee_api_properties_encryption_secret=your-own-api-32-caracters-secret\n\n  rate-limit:\n    # https://hub.docker.com/_/redis?tab=tags\n    image: redis:${REDIS_VERSION:-7.0.4-alpine3.16}\n    container_name: gio_ratelimit_redis\n    hostname: redis\n    restart: always\n    ports:\n      - '6379:6379'\n    command: redis-server --requirepass ${REDIS_PASS:-redis-password}\n    volumes:\n      - redis_data:/data\n\n  logstash:\n    # https://www.docker.elastic.co/r/logstash/logstash-oss\n    image: docker.elastic.co/logstash/logstash-oss:8.3.2\n    ports:\n      - \"8379:8379\"\n    volumes:\n      - ./config/logstash:/usr/share/logstash/pipeline:ro\n    environment:\n      LS_JAVA_OPTS: \"-Xmx256m -Xms256m\"\n\nvolumes:\n  redis_data:\n    driver: local\n</code></pre>   gravitee.yml<pre><code>############################################################################################################\n#################################### Gravitee.IO Gateway - Configuration ###################################\n############################################################################################################\n\n############################################################################################################\n# This file is the general configuration of Gravitee.IO Gateway:\n# - Properties (and respective default values) in comment are provided for information.\n# - You can reference other property by using ${property.name} syntax\n# - gravitee.home property is automatically set-up by launcher and refers to the installation path. Do not override it !\n#\n# Please have a look to http://docs.gravitee.io/ for more options and fine-grained granularity\n############################################################################################################\n\norganizations: cockpit-org-hrid\nenvironments: cockpit-env-hrid\ntags: your, sharding, tags #example: internal\n\nplugins:\n  path:\n    - /opt/graviteeio-gateway/plugins\n    - /opt/graviteeio-gateway/plugins-ext\n\nmanagement:\n  type: http\n  http:\n    url: https://bridge-gateway-url:bridge-gateway-port\n    authentication:\n      basic:\n        username: bridge-gateway-username\n        password: bridge-gateway-password\n\nratelimit:\n  # type: hazelcast\n  type: redis\n  redis:\n    host: redis-host\n    port: 6379\n    password: redis-password\n\ncache:\n  type: ehcache\n\nreporters:\n  elasticsearch:\n    enabled: false # Is the reporter enabled or not (default to true)\n  tcp:\n    enabled: true\n    host: logstash-host\n    port: logstash-port\n    output: elasticsearch\n\nservices:\n  core:\n    http:\n      enabled: true\n      port: 18082\n      host: localhost\n      authentication:\n        type: basic\n        users:\n          admin: internal-api-password\n\n  sync:\n    delay: 5000\n    unit: MILLISECONDS\n    distributed: false # By enabling this mode, data synchronization process is distributed over clustered API gateways.\n    bulk_items: 100 # Defines the number of items to retrieve during synchronization (events, plans, api keys, ...).\n\n  local:\n    enabled: false\n    path: ${gravitee.home}/apis # The path to API descriptors\n\n  monitoring:\n    delay: 5000\n    unit: MILLISECONDS\n    distributed: false # By enabling this mode, data monitoring gathering process is distributed over clustered API gateways.\n\n  metrics:\n    enabled: false\n    prometheus:\n      enabled: true\n\n  tracing:\n    enabled: false\n\napi:\n  properties:\n    encryption:\n      secret: your-own-api-32-caracters-secret\n\nalerts:\n  alert-engine:\n    enabled: true\n    ws:\n      discovery: true\n      endpoints:\n        - https://alert-engine-url:alert-engine-port\n      security:\n        username: alert-engine-username\n        password: alert-engine-password\n\nclassloader:\n  legacy:\n    enabled: false\n</code></pre>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v2/#full-example","tags":["Hybrid","APIM installation","APIM deployment"]},{"title":"Redis","text":"","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v2/#redis","tags":["Hybrid","APIM installation","APIM deployment"]},{"title":"Installation","text":"Kubernetes (Helm)DockerVM    <p>Bitnami helm charts</p> <p>Redis Bitnami helm charts</p>  <p>TL;DR <pre><code>helm repo add redis https://charts.bitnami.com/bitnami\n\nhelm install gravitee-redis redis/redis  \\\n--set architecture=standalone  \\\n--create-namespace \\\n--namespace gravitee-apim\n</code></pre></p> <p>Get the generated redis password <code>echo $(kubectl get secret --namespace gravitee-apim gravitee-redis -o jsonpath=\"{.data.redis-password}\" | base64 -d)</code></p>  <p>Production Architecture</p> <p>Redis Bitnami Cluster topologies to go \"Master-Replicas\" or \"Master-Replicas with Sentinel\"</p>    docker-compose.yml<pre><code>version: '3.5'\n\nservices:\n  rate-limit:\n    # https://hub.docker.com/_/redis?tab=tags\n    image: redis:${REDIS_VERSION:-7.0.5-alpine3.17}\n    container_name: gio_ratelimit_redis\n    hostname: redis\n    restart: always\n    ports:\n      - '6379:6379'\n    command: redis-server --requirepass ${REDIS_PASS:-redis-password}\n    volumes:\n      - redis_data:/data\n\nvolumes:\n  redis_data:\n    driver: local\n</code></pre>   <ul> <li>Installing Redis from redis.io</li> </ul>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v2/#installation_1","tags":["Hybrid","APIM installation","APIM deployment"]},{"title":"Configuration","text":"<p>Easy peasy</p> <p>No specific configuration is needed.</p>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v2/#configuration_1","tags":["Hybrid","APIM installation","APIM deployment"]},{"title":"Logstash","text":"","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v2/#logstash","tags":["Hybrid","APIM installation","APIM deployment"]},{"title":"Installation","text":"Kubernetes (Helm)DockerVM    <p>Helm charts</p> <ul> <li>Official helm charts</li> <li>Logstash Bitnami helm charts</li> </ul>  <p>TL;DR using the official helm chart <pre><code>helm repo add elastic https://helm.elastic.co\n\nhelm install gravitee-logstash elastic/logstash  \\\n--create-namespace \\\n--namespace gravitee-apim  \\\n-f values.yaml\n</code></pre></p>   docker-compose.yml<pre><code>version: '3.5'\n\nservices:\n  logstash:\n    # https://www.docker.elastic.co/r/logstash/logstash-oss\n    image: docker.elastic.co/logstash/logstash-oss:8.3.2\n    ports:\n      - \"8379:8379\"\n    volumes:\n      - ./config/logstash:/usr/share/logstash/pipeline:ro\n    environment:\n      LS_JAVA_OPTS: \"-Xmx256m -Xms256m\"\n</code></pre>   <ul> <li>Download Logstash OSS</li> </ul>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v2/#installation_2","tags":["Hybrid","APIM installation","APIM deployment"]},{"title":"Configuration","text":"Kubernetes (Helm)logstash.conf    <p>Helm charts</p> <p>Official <code>values.yml</code></p>  values.yaml<pre><code>logstashPipeline:\nlogstash.conf: |\n    input {\n      tcp {\n          port =&gt; 8379\n          codec =&gt; \"json\"\n      }\n    }\n\n    filter {\n        if [type] != \"request\" {\n            mutate { remove_field =&gt; [\"path\", \"host\"] }\n        }\n    }\n\n    output {\n      s3 {\n        access_key_id =&gt; \"${S3_ACEESS_KEY_ID}\"\n        secret_access_key =&gt; \"${S3_SECRET_ACCESS_KEY}\"\n        region =&gt; \"${S3_REGION}\"\n        bucket =&gt; \"${S3_BUCKET_NAME}\"\n        size_file =&gt; 10485760\n        codec =&gt; \"json_lines\"\n      }\n    }\n\nfullnameOverride: gravitee-logstash\n\nextraPorts:\n  - name: tcp-input\n    containerPort: 8379\n\nservice:\n  type: ClusterIP\n  ports:\n    - name: tcp-input\n      port: 8379\n      protocol: TCP\n      targetPort: 8379\n</code></pre>   logstash.conf<pre><code>input {\n  tcp {\n      port =&gt; 8379\n      codec =&gt; \"json\"\n  }\n}\n\nfilter {\n    if [type] != \"request\" {\n        mutate { remove_field =&gt; [\"path\", \"host\"] }\n    }\n}\n\noutput {\n  s3 {\n    access_key_id =&gt; \"${S3_ACEESS_KEY_ID}\"\n    secret_access_key =&gt; \"${S3_SECRET_ACCESS_KEY}\"\n    region =&gt; \"${S3_REGION}\"\n    bucket =&gt; \"${S3_BUCKET_NAME}\"\n    size_file =&gt; 10485760\n    codec =&gt; \"json_lines\"\n  }\n}\n</code></pre>     <p>Online documentation</p> <ul> <li>Configuring Logstash</li> </ul>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-deployment-v2/#configuration_2","tags":["Hybrid","APIM installation","APIM deployment"]},{"title":"Overview","text":"<p>This section describes how to install an APIM hybrid deployment using Kubernetes Helm charts.</p> <p>We assume familiarity with Google Cloud Platform (GCP), Kubernetes (K8s) and Helm. We also recommend you read the Introduction to APIM hybrid deployment^ first.</p>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-kubernetes/"},{"title":"Target architecture","text":"<p>In this example, we will demonstrate how to deploy APIM in two different GCP regions and two different K8s clusters:</p> <ul> <li> <p>A Management cluster (pictured on the left)\u2009\u2014\u2009running APIM API,     the two APIM UI components, and a bridge Gateway</p> </li> <li> <p>A Gateway cluster (pictured on the right)\u2009\u2014\u2009running APIM Gateway</p> </li> </ul> <p>image::{% link images/apim/3.x/installation/hybrid/hybrid_deployment_k8s.png %}[]</p> <p>In this schema, we can see that:</p> <ul> <li> <p>MongoDB is used for all the management data (API definitions,     subscriptions, API keys, etc.)</p> </li> <li> <p>ElasticSearch is also deployed in the Management cluster</p> </li> <li> <p>Redis is used to manage rate-limit and quota counters within the     Gateway cluster</p> </li> </ul> <p>Before you continue, keep in mind that the bridge Gateway (the red box in the left-hand region of the schema) is simply an APIM Gateway instance with additional capabilities. This is essential to understanding how we are deploying the bridge. For more information, see APIM hybrid deployment^.</p>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-kubernetes/#target-architecture"},{"title":"Deploying with Helm","text":"<p>You can find everything you need to deploy this hybrid architecture at Gravitee.io Helm Charts^.</p>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-kubernetes/#deploying-with-helm"},{"title":"Before you begin","text":"<p>Before you deploy APIM, ensure the two GCP clusters exist and that Helm is installed on both clusters:</p> <p>image::{% link images/apim/3.x/installation/hybrid/hybrid_k8s_clusters.png %}[]</p> <p>The following examples use the names in the illustration above, but you can name your clusters whatever you like and replace the names with your own.</p>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-kubernetes/#before-you-begin"},{"title":"Deploy the Management cluster","text":"<ol> <li> <p>The first step is to initialize the cluster with some prerequisites:</p> <pre><code>&gt; gcloud container clusters get-credentials hybrid-mgmt-eu --zone=europe-west1-b\n\n// Create namespace\n&gt; kubectl create namespace graviteeio\n\n// Nginx ingress controller is required for Gravitee APIM chart\n&gt; helm install --name nginx-ingress --namespace graviteeio stable/nginx-ingress --set rbac.create=true --set controller.publishService.enabled=true\n\n// Add Gravitee.io Helm repository\n&gt; helm repo add graviteeio https://helm.gravitee.io\n</code></pre> </li> <li> <p>Deploy the management APIM instance, which includes components APIM     Console, APIM Portal, APIM API and the bridge Gateway (which will be     used as a bridge between the two clusters):</p> <pre><code>&gt; helm install \u2014 name graviteeio-apim3 \u2014 namespace graviteeio \\\n -f values-bridge-http-server.yaml \\\n -f values-hybrid-management-eu.yaml \\\n graviteeio/apim3\n</code></pre> <p>The <code>values-hybrid-management-eu.yaml</code> file looks like this:</p> <pre><code>mongo:\n    uri: mongodb+srv://xxxxxx:xxxxx@demo.xxxxx.gcp.mongodb.net/gio-apim-hybrid?retryWrites=true&amp;w=majority\n\nes:\n    endpoints:\n        - https://xxxxxxxxx-elasticsearch.services.elasticcloud.com/\n    index: demo_hybrid_apim\n    security:\n        enabled: true\n        username: xxxxxx\n        password: xxxxxx\n\napi:\n    ingress:\n        management:\n            path: /management\n            hosts:\n                - demo-hybrid-apim-api.cloud.gravitee.io\n            tls:\n            -   hosts:\n                    - demo-hybrid-apim-api.cloud.gravitee.io\n                secretName: cloud-gravitee-cert\n        portal:\n            path: /portal\n            hosts:\n                - demo-hybrid-apim-api.cloud.gravitee.io\n            tls:\n            -   hosts:\n                    - demo-hybrid-apim-api.cloud.gravitee.io\n                secretName: cloud-gravitee-cert\n\ngateway:\n    ingress:\n        enabled: false\n    services:\n        bridge:\n            enabled: true\n            username: xxxxxxxxx\n            password: xxxxxxxxx\n            service:\n                externalPort: 92\n                internalPort: 18092\n            ingress:\n                enabled: true\n                path: /\n                hosts:\n                    - demo-hybrid-apim-bridge.cloud.gravitee.io\n                annotations:\n                    kubernetes.io/ingress.class: nginx\n                    nginx.ingress.kubernetes.io/ssl-redirect: \"false\"\n                    nginx.ingress.kubernetes.io/enable-rewrite-log: \"true\"\n                    nginx.ingress.kubernetes.io/configuration-snippet: \"etag on;\\nproxy_pass_header ETag;\\nproxy_set_header if-match \\\"\\\";\\n\"\n                tls:\n                -   secretName: cloud-gravitee-cert\n                    hosts:\n                        - demo-hybrid-apim-bridge.cloud.gravitee.io\n\nui:\n    ingress:\n        path: /\n        hosts:\n            - demo-hybrid-apim-console.cloud.gravitee.io\n        annotations:\n            nginx.ingress.kubernetes.io/rewrite-target: /\n        tls:\n        -   hosts:\n                - demo-hybrid-apim-console.cloud.gravitee.io\n            secretName: cloud-gravitee-cert\n\nportal:\n    ingress:\n        path: /\n        hosts:\n            - demo-hybrid-apim-portal.cloud.gravitee.io\n        tls:\n        -   hosts:\n                - demo-hybrid-apim-portal.cloud.gravitee.io\n            secretName: cloud-gravitee-cert\n</code></pre> <p>From this file, we can see that:</p> <ul> <li> <p>the Gateway is not exposed through the ingress controller (it is     not accepting API calls for the bridge Gateway)</p> </li> <li> <p>we have enabled the bridge service for the Gateway and declared     a new ingress to expose it to remote clusters</p> </li> </ul> </li> </ol> <p>image::{% link images/apim/3.x/installation/hybrid/hybrid_deployment_ingress.png %}[]</p>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-kubernetes/#deploy-the-management-cluster"},{"title":"Deploy the Gateway cluster","text":"<ol> <li> <p>Again, we need to initialize the cluster with some prerequisites:</p> <pre><code>&gt; gcloud container clusters get-credentials hybrid-gw-eu --zone=europe-west2-b\n// Create namespace\n&gt; kubectl create namespace graviteeio\n// Nginx ingress controller is required for Gravitee APIM chart\n&gt; helm install --name nginx-ingress --namespace graviteeio stable/nginx-ingress --set rbac.create=true --set controller.publishService.enabled=true\n// Add Gravitee.io Helm repository\n&gt; helm repo add graviteeio https://helm.gravitee.io\n</code></pre> </li> <li> <p>Now we deploy APIM, but only the APIM Gateway component:</p> <pre><code>&gt; helm install \u2014 name graviteeio-apim3 \u2014 namespace graviteeio \\\n -f values-bridge-http-client.yaml \\\n -f values-hybrid-gw-eu.yaml \\\n graviteeio/apim3\n</code></pre> <p>The <code>values-hybrid-management-gw-eu.yaml</code> file looks like this:</p> <pre><code>mongo:\n    uri: mongodb+srv://xxxxxx:xxxxx@demo.xxxxx.gcp.mongodb.net/gio-apim-hybrid?retryWrites=true&amp;w=majority\nes:\n    endpoints:\n        - https://xxxxxxxxx-elasticsearch.services.elasticcloud.com/\n    index: demo_hybrid_apim\n    security:\n        enabled: true\n        username: xxxxxx\n        password: xxxxxx\nmanagement:\n    type: http\napi:\n    enabled: false\ngateway:\n    management:\n        http:\n            version: 3.3.1\n            url: https://demo-hybrid-apim-bridge.cloud.gravitee.io/\n            username: xxxxxxxxx\n            password: xxxxxxxxx\n    ingress:\n        path: /\n        hosts:\n            - demo-hybrid-apim-gw.cloud.gravitee.io\n        tls:\n        -   hosts:\n                - demo-hybrid-apim-gw.cloud.gravitee.io\n            secretName: cloud-gravitee-cert\nui:\n    enabled: false\nportal:\n    enabled: false\n</code></pre> <p>From this file, we can see that:</p> <ul> <li> <p>All the management components have been disabled to prevent     their deployment\u2009\u2014\u2009APIM API, APIM Console and APIM Portal</p> </li> <li> <p>We have enabled <code>http</code> management mode for the Gateway, and we     use this link to mount all the required information in the     Gateway to be able to process API calls</p> </li> </ul> </li> </ol> <p>image::{% link images/apim/3.x/installation/hybrid/hybrid_deployment_http.png %}[]</p> <p>If you have a look at the Gateway pod logs, you will see something like this:</p> <pre><code>08:27:29.394 [graviteeio-node] [] INFO  i.g.g.r.p.RepositoryPluginHandler - Register a new repository plugin: repository-bridge-http-client [io.gravitee.repository.bridge.client.HttpBridgeRepository]\n08:27:29.402 [graviteeio-node] [] INFO  i.g.g.r.p.RepositoryPluginHandler - Repository [MANAGEMENT] loaded by http\n08:27:30.999 [graviteeio-node] [] INFO  i.g.r.b.client.http.WebClientFactory - Validate Bridge Server connection ...\n08:27:32.888 [vert.x-eventloop-thread-1] [] INFO  i.g.r.b.client.http.WebClientFactory - Bridge Server connection successful.\n</code></pre> <p>We can now open up APIM Console and see our two Gateways running:</p> <p>image::{% link images/apim/3.x/installation/hybrid/hybrid_deployment_gateways.png %}[]</p> <p>Success! Your hybrid deployment is now up and running and ready to manage your first API.</p>","location":"apim/installation-guide/hybrid/installation-guide-hybrid-kubernetes/#deploy-the-gateway-cluster"},{"title":"How to configure","text":"<p>There are three different ways to configure this component:</p> <ul> <li> <p>environment variables</p> </li> <li> <p>system properties</p> </li> <li> <p><code>gravitee.yml</code></p> </li> </ul> <p>The order in which they are listed above corresponds to their order of precedence. In other words, environment variables override the other two configuration types, and system properties override <code>gravitee.yml</code>.</p>","location":"apim/installation-guide/partial/how-to-configure/"},{"title":"Environment variables","text":"<p>You can override the default APIM configuration (<code>gravitee.yml</code>) and system properties by defining environment variables.</p> <p>To override this property:</p> <pre><code>management:\n  mongodb:\n    dbname: myDatabase\n</code></pre> <p>Define one of the following variables:</p> <pre><code>GRAVITEE_MANAGEMENT_MONGODB_DBNAME=myDatabase\ngravitee_management_mongodb_dbname=myDatabase\n</code></pre> <p>Some properties are case-sensitive and cannot be written in uppercase (for example, <code>gravitee_security_providers_0_tokenIntrospectionEndpoint</code>). We advise you to define environment variables in lowercase. You must ensure you use the correct syntax for each property.</p> <p>In some systems, hyphens are not allowed in variable names. For example, you may need to write <code>gravitee_policy_api-key_header</code> as <code>gravitee_policy_apikey_header</code>. We recommend you check your system documentation.</p> <p>Some properties are arrays. For example:</p> <pre><code>analytics:\n  elasticsearch:\n    endpoints:\n      - https://my.first.endpoint.com\n      - https://my.second.endpoint.com\n\nsecurity:\n  providers:\n    - type: ldap\n      context-source-username: \"cn=Directory Manager\"\n      context-source-password: \"password\"\n</code></pre> <p>Below are some example of how to write your environment variables. In case of doubt, we recommend you try both.</p> <pre><code>gravitee_analytics_elasticsearch_endpoints_0=https://my.first.endpoint.com\ngravitee_analytics_elasticsearch_endpoints_1=https://my.second.endpoint.com\n\ngravitee_security_providers_0_type=ldap\ngravitee_security_providers_0_contextsourceusername=cn=Directory Manager\ngravitee_security_providers_0_contextsourcepassword=password\n</code></pre> <p>or</p> <pre><code>gravitee.analytics.elasticsearch.endpoints[0]=https://my.first.endpoint.com\ngravitee.analytics.elasticsearch.endpoints[1]=https://my.second.endpoint.com\n\ngravitee.security.providers[0]type=ldap\ngravitee.security.providers[0]context-source-username=cn=Directory Manager\ngravitee.security.providers[0]context-source-password=password\ngravitee.security.providers[0].users[1].password=password\n</code></pre>","location":"apim/installation-guide/partial/how-to-configure/#environment-variables"},{"title":"System properties","text":"<p>You can override the default APIM configuration (<code>gravitee.yml</code>) by defining system properties.</p> <p>To override this property:</p> <pre><code>management:\n  mongodb:\n    dbname: myDatabase\n</code></pre> <p>Add this property to the JVM:</p> <pre><code>-Dmanagement.mongodb.dbname=myDatabase\n</code></pre>","location":"apim/installation-guide/partial/how-to-configure/#system-properties"},{"title":"gravitee.yml","text":"<p>The <code>gravitee.yml</code> file, found in <code>GRAVITEE_HOME/config/</code>, is the default way to configure APIM.</p> <p>YAML (<code>yml</code>) format is very sensitive to indentation. Ensure you include the correct number of spaces and use spaces instead of tabs.</p>","location":"apim/installation-guide/partial/how-to-configure/#graviteeyml"},{"title":"Management api configuration idp override","text":"<p>You can configure this provider both in APIM Console and in the <code>gravitee.yml</code> configuration file. Whichever you choose, the configuration is stored in the database. This means that APIM starts using your new configuration as soon as you click the Save button (if configuring in APIM Console) or restart APIM API (if configuring in the configuration file).</p> <p>If you configure the provider in the configuration file and then change the values in APIM Console, all changes are overwritten by the values in the configuration file next time you restart APIM API.</p>","location":"apim/installation-guide/partial/management-api-configuration-idp-override/"},{"title":"Install APIM Gateway","text":"<p>= Install APIM Gateway :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_installguide_redhat_gateway.html :page-folder: apim/installation-guide/redhat :page-layout: apim3x :page-description: Gravitee.io API Management - Installation Guide - Red Hat or CentOS - API Gateway :page-keywords: Gravitee.io, API Platform, API Management, API Gateway, oauth2, openid, documentation, manual, guide, reference, api</p> <p>:gravitee-component-name: APIM Gateway :gravitee-package-name: graviteeio-apim-gateway-3x :gravitee-service-name: graviteeio-apim-gateway</p> <p>== Prerequisites</p> <p>The following steps assume you have configured your package management system as described in &lt;&gt;. <p>== Install the {gravitee-component-name} package</p> <p>To install the last stable version of {gravitee-component-name}, run the following command:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-gateway/"},{"title":"[source,bash,subs=\"attributes\"]","text":"","location":"apim/installation-guide/red-hat/installation-guide-redhat-gateway/#sourcebashsubsattributes"},{"title":"sudo yum install -y","text":"<p>== Run {gravitee-component-name}</p> <p>These steps assume that you are using the default settings.</p> <p>To configure {gravitee-component-name} to start automatically when the system boots up, run the following commands:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-gateway/#sudo-yum-install-y"},{"title":"[source,bash,subs=\"attributes\"]","text":"<p>sudo systemctl daemon-reload sudo systemctl enable {gravitee-service-name}</p>  <p>To start and stop {gravitee-component-name}, run the following commands:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-gateway/#sourcebashsubsattributes_1"},{"title":"[source,bash,subs=\"attributes\"]","text":"<p>sudo systemctl start {gravitee-service-name} sudo systemctl stop {gravitee-service-name}</p>  <p>NOTE: These commands provide no feedback as to whether {gravitee-component-name} started successfully. This information is written to the log files located in <code>/opt/graviteeio/apim/gateway/logs/</code>.</p> <p>== View the logs</p> <p>When <code>systemd</code> logging is enabled, the logging information is available using the <code>journalctl</code> commands.</p> <p>To tail the journal, run the following command:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-gateway/#sourcebashsubsattributes_2"},{"title":"[source,bash,subs=\"attributes\"]","text":"","location":"apim/installation-guide/red-hat/installation-guide-redhat-gateway/#sourcebashsubsattributes_3"},{"title":"sudo journalctl -f","text":"<p>To list journal entries for the {gravitee-component-name} service, run the following command:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-gateway/#sudo-journalctl-f"},{"title":"[source,bash,subs=\"attributes\"]","text":"","location":"apim/installation-guide/red-hat/installation-guide-redhat-gateway/#sourcebashsubsattributes_4"},{"title":"sudo journalctl --unit","text":"<p>To list journal entries for the {gravitee-component-name} service starting from a given time, run the following command:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-gateway/#sudo-journalctl-unit"},{"title":"[source,bash,subs=\"attributes\"]","text":"","location":"apim/installation-guide/red-hat/installation-guide-redhat-gateway/#sourcebashsubsattributes_5"},{"title":"sudo journalctl --unit {gravitee-service-name} --since  \"2020-01-30 12:13:14\"","text":"","location":"apim/installation-guide/red-hat/installation-guide-redhat-gateway/#sudo-journalctl-unit-gravitee-service-name-since-2020-01-30-121314"},{"title":"Overview","text":"<p>This section explains how to install APIM on Red Hat Enterprise Linux, CentOS Linux or Oracle Linux using the <code>yum</code> package manager.</p> <p>RPM install is not supported on distributions with old versions of RPM, such as SLES 11 and CentOS 5\u2009\u2014\u2009in this case, you need to link:{{ /apim/3.x/apim_installguide_gateway_install_zip.html | relative_url }}[install API Management with .zip] instead.</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-introduction/"},{"title":"Configure the package management system (<code>yum</code>)","text":"<ol> <li> <p>Create a file called <code>graviteeio.repo</code> in location     <code>/etc/yum.repos.d/</code> so that you can install APIM directly using     <code>yum</code>:</p> <pre><code>[graviteeio]\nname=graviteeio\nbaseurl=https://packagecloud.io/graviteeio/rpms/el/7/$basearch\ngpgcheck=0\nenabled=1\ngpgkey=https://packagecloud.io/graviteeio/rpms/gpgkey\nsslverify=1\nsslcacert=/etc/pki/tls/certs/ca-bundle.crt\nmetadata_expire=300\n</code></pre> </li> <li> <p>Enable GPG signature handling, which is required by some of our RPM     packages:</p> <pre><code>sudo yum install pygpgme yum-utils\n</code></pre> </li> <li> <p>Before continuing, you may need to refresh your local cache:</p> <pre><code>sudo yum -q makecache -y --disablerepo='*' --enablerepo='graviteeio'\n</code></pre> </li> </ol> <p>Your repository is now ready to use.</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-introduction/#configure-the-package-management-system-yum"},{"title":"Install the APIM components","text":"<p>You can choose to install the full APIM stack or install the components one by one:</p> <ul> <li> <p>link:{{ /apim/3.x/apim_installguide_redhat_stack.html |     relative_url }}[Install the full APIM stack] (includes all     components below)</p> </li> <li> <p>link:{{ /apim/3.x/apim_installguide_redhat_gateway.html |     relative_url }}[Install APIM Gateway]</p> </li> <li> <p>link:{{ /apim/3.x/apim_installguide_redhat_management_api.html     | relative_url }}[Install APIM API]</p> </li> <li> <p>link:{{ /apim/3.x/apim_installguide_redhat_management_ui.html     | relative_url }}[Install APIM Console]</p> </li> <li> <p>link:{{ /apim/3.x/apim_installguide_redhat_portal.html |     relative_url }}[Install APIM Portal]</p> </li> </ul>","location":"apim/installation-guide/red-hat/installation-guide-redhat-introduction/#install-the-apim-components"},{"title":"Install APIM API","text":"<p>= Install APIM API :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_installguide_redhat_management_api.html :page-folder: apim/installation-guide/redhat :page-layout: apim3x :page-description: Gravitee.io API Management - Installation Guide - Red Hat or CentOS - Management API :page-keywords: Gravitee.io, API Platform, API Management, API Gateway, oauth2, openid, documentation, manual, guide, reference, api</p> <p>:gravitee-component-name: APIM API :gravitee-package-name: graviteeio-apim-rest-api-3x :gravitee-service-name: graviteeio-apim-rest-api</p> <p>== Prerequisites</p> <p>The following steps assume you have configured your package management system as described in &lt;&gt;. <p>== Install the {gravitee-component-name} package</p> <p>To install the last stable version of {gravitee-component-name}, run the following command:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-management-api/"},{"title":"[source,bash,subs=\"attributes\"]","text":"","location":"apim/installation-guide/red-hat/installation-guide-redhat-management-api/#sourcebashsubsattributes"},{"title":"sudo yum install -y","text":"<p>== Run {gravitee-component-name}</p> <p>These steps assume that you are using the default settings.</p> <p>To configure {gravitee-component-name} to start automatically when the system boots up, run the following commands:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-management-api/#sudo-yum-install-y"},{"title":"[source,bash,subs=\"attributes\"]","text":"<p>sudo systemctl daemon-reload sudo systemctl enable {gravitee-service-name}</p>  <p>To start and stop {gravitee-component-name}, run the following commands:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-management-api/#sourcebashsubsattributes_1"},{"title":"[source,bash,subs=\"attributes\"]","text":"<p>sudo systemctl start {gravitee-service-name} sudo systemctl stop {gravitee-service-name}</p>  <p>NOTE: These commands provide no feedback as to whether {gravitee-component-name} started successfully. This information is written to the log files located in <code>/opt/graviteeio/apim/rest-api/logs/</code>.</p> <p>== View the logs</p> <p>When <code>systemd</code> logging is enabled, the logging information is available using the <code>journalctl</code> commands.</p> <p>To tail the journal, run the following command:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-management-api/#sourcebashsubsattributes_2"},{"title":"[source,bash,subs=\"attributes\"]","text":"","location":"apim/installation-guide/red-hat/installation-guide-redhat-management-api/#sourcebashsubsattributes_3"},{"title":"sudo journalctl -f","text":"<p>To list journal entries for the {gravitee-component-name} service, run the following command:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-management-api/#sudo-journalctl-f"},{"title":"[source,bash,subs=\"attributes\"]","text":"","location":"apim/installation-guide/red-hat/installation-guide-redhat-management-api/#sourcebashsubsattributes_4"},{"title":"sudo journalctl --unit","text":"<p>To list journal entries for the {gravitee-component-name} service starting from a given time, run the following command:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-management-api/#sudo-journalctl-unit"},{"title":"[source,bash,subs=\"attributes\"]","text":"","location":"apim/installation-guide/red-hat/installation-guide-redhat-management-api/#sourcebashsubsattributes_5"},{"title":"sudo journalctl --unit {gravitee-service-name} --since  \"2020-01-30 12:13:14\"","text":"","location":"apim/installation-guide/red-hat/installation-guide-redhat-management-api/#sudo-journalctl-unit-gravitee-service-name-since-2020-01-30-121314"},{"title":"Install APIM Console","text":"<p>= Install APIM Console :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_installguide_redhat_management_ui.html :page-folder: apim/installation-guide/redhat :page-layout: apim3x :page-description: Gravitee.io API Management - Installation Guide - Red Hat or CentOS - Management UI :page-keywords: Gravitee.io, API Platform, API Management, API Gateway, oauth2, openid, documentation, manual, guide, reference, api</p> <p>:gravitee-component-name: APIM Console :gravitee-package-name: graviteeio-apim-management-ui-3x :gravitee-service-name: graviteeio-apim-management-ui</p> <p>== Prerequisites</p> <p>Before you install {gravitee-component-name}, you must complete the following configuration. You must also ensure APIM API is installed and running.</p> <p>=== Install Nginx</p> <p>To install Nginx, run the following command:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-management-ui/"},{"title":"[source,bash,subs=\"attributes\"]","text":"<p>sudo yum install epel-release sudo yum install nginx</p>  <p>=== Configure your package management system</p> <p>Ensure you have configured your package management system, as described in &lt;&gt;. <p>== Install the {gravitee-component-name} package</p> <p>To install the last stable version of {gravitee-component-name}, run the following command:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-management-ui/#sourcebashsubsattributes"},{"title":"[source,bash,subs=\"attributes\"]","text":"","location":"apim/installation-guide/red-hat/installation-guide-redhat-management-ui/#sourcebashsubsattributes_1"},{"title":"sudo yum install -y","text":"<p>== Run {gravitee-component-name}</p> <p>NOTE: {gravitee-component-name} is based on Nginx.</p> <p>To configure {gravitee-component-name} to start automatically when the system boots up, run the following commands:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-management-ui/#sudo-yum-install-y"},{"title":"[source,bash,subs=\"attributes\"]","text":"<p>sudo systemctl daemon-reload sudo systemctl enable nginx</p>  <p>To start and stop Nginx, run the following commands:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-management-ui/#sourcebashsubsattributes_2"},{"title":"[source,bash,subs=\"attributes\"]","text":"<p>sudo systemctl start nginx sudo systemctl stop nginx</p>  <p>== View the logs</p> <p>When <code>systemd</code> logging is enabled, the logging information is available using the <code>journalctl</code> commands.</p> <p>To tail the journal, run the following command:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-management-ui/#sourcebashsubsattributes_3"},{"title":"[source,shell]","text":"","location":"apim/installation-guide/red-hat/installation-guide-redhat-management-ui/#sourceshell"},{"title":"sudo journalctl -f","text":"<p>To list journal entries for the Nginx service, run the following command:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-management-ui/#sudo-journalctl-f"},{"title":"[source,shell]","text":"","location":"apim/installation-guide/red-hat/installation-guide-redhat-management-ui/#sourceshell_1"},{"title":"sudo journalctl --unit nginx","text":"<p>To list journal entries for the Nginx service starting from a given time, run the following command:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-management-ui/#sudo-journalctl-unit-nginx"},{"title":"[source,shell]","text":"","location":"apim/installation-guide/red-hat/installation-guide-redhat-management-ui/#sourceshell_2"},{"title":"sudo journalctl --unit nginx --since  \"2020-01-30 12:13:14\"","text":"","location":"apim/installation-guide/red-hat/installation-guide-redhat-management-ui/#sudo-journalctl-unit-nginx-since-2020-01-30-121314"},{"title":"Install APIM Portal","text":"<p>= Install APIM Portal :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_installguide_redhat_portal.html :page-folder: apim/installation-guide/redhat :page-layout: apim3x :page-description: Gravitee.io API Management - Installation Guide - Red Hat or CentOS - Portal :page-keywords: Gravitee.io, API Platform, API Management, API Gateway, oauth2, openid, documentation, manual, guide, reference, api</p> <p>:gravitee-component-name: APIM Portal :gravitee-package-name: graviteeio-apim-portal-ui-3x :gravitee-service-name: graviteeio-apim-portal-ui</p> <p>== Prerequisites Before you install {gravitee-component-name}, you must complete the following configuration. You must also ensure APIM API is installed and running.</p> <p>=== Install Nginx</p> <p>To install Nginx, run the following command:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-portal/"},{"title":"[source,bash,subs=\"attributes\"]","text":"<p>sudo yum install epel-release sudo yum install nginx</p>  <p>=== Configure your package management system</p> <p>Ensure you have configured your package management system, as described in &lt;&gt;. <p>== Install the {gravitee-component-name} package</p> <p>To install the last stable version of {gravitee-component-name}, run the following command:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-portal/#sourcebashsubsattributes"},{"title":"[source,bash,subs=\"attributes\"]","text":"","location":"apim/installation-guide/red-hat/installation-guide-redhat-portal/#sourcebashsubsattributes_1"},{"title":"sudo yum install -y","text":"<p>== Run {gravitee-component-name}</p> <p>NOTE: {gravitee-component-name} is based on Nginx.</p> <p>To configure {gravitee-component-name} to start automatically when the system boots up, run the following commands:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-portal/#sudo-yum-install-y"},{"title":"[source,bash,subs=\"attributes\"]","text":"<p>sudo systemctl daemon-reload sudo systemctl enable nginx</p>  <p>To start and stop Nginx, run the following commands:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-portal/#sourcebashsubsattributes_2"},{"title":"[source,bash,subs=\"attributes\"]","text":"<p>sudo systemctl start nginx sudo systemctl stop nginx</p>  <p>== View the logs</p> <p>When <code>systemd</code> logging is enabled, the logging information is available using the <code>journalctl</code> commands.</p> <p>To tail the journal, run the following command:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-portal/#sourcebashsubsattributes_3"},{"title":"[source,shell]","text":"","location":"apim/installation-guide/red-hat/installation-guide-redhat-portal/#sourceshell"},{"title":"sudo journalctl -f","text":"<p>To list journal entries for the Nginx service, run the following command:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-portal/#sudo-journalctl-f"},{"title":"[source,shell]","text":"","location":"apim/installation-guide/red-hat/installation-guide-redhat-portal/#sourceshell_1"},{"title":"sudo journalctl --unit nginx","text":"<p>To list journal entries for the Nginx service starting from a given time, run the following command:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-portal/#sudo-journalctl-unit-nginx"},{"title":"[source,shell]","text":"","location":"apim/installation-guide/red-hat/installation-guide-redhat-portal/#sourceshell_2"},{"title":"sudo journalctl --unit nginx --since  \"2020-01-30 12:13:14\"","text":"","location":"apim/installation-guide/red-hat/installation-guide-redhat-portal/#sudo-journalctl-unit-nginx-since-2020-01-30-121314"},{"title":"Install full APIM stack","text":"<p>= Install the full APIM stack :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_installguide_redhat_stack.html :page-folder: apim/installation-guide/redhat :page-layout: apim3x :page-description: Gravitee.io API Management - Installation Guide - Red Hat or CentOS - API Management :page-keywords: Gravitee.io, API Platform, API Management, API Gateway, oauth2, openid, documentation, manual, guide, reference, api</p> <p>:gravitee-package-name: graviteeio-apim-3x</p> <p>== Overview</p> <p>This section describes how to install the full APIM stack, including all the components and, optionally, dependencies (MongoDB, Elasticsearch).</p> <ul> <li>link:{{ '/apim/3.x/apim_installguide_redhat_gateway.html' | relative_url }}[Install APIM Gateway]</li> <li>link:{{ '/apim/3.x/apim_installguide_redhat_management_api.html' | relative_url }}[Install APIM API]</li> <li>link:{{ '/apim/3.x/apim_installguide_redhat_management_ui.html' | relative_url }}[Install APIM Console]</li> <li>link:{{ '/apim/3.x/apim_installguide_redhat_portal.html' | relative_url }}[Install APIM Portal]</li> </ul> <p>== Prerequisites</p> <p>Before you install the full APIM stack, you must complete the following configuration.</p> <p>=== Install Nginx</p> <p>To install Nginx, run the following commands:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-stack/"},{"title":"[source,bash,subs=\"attributes\"]","text":"<p>sudo yum install epel-release sudo yum install nginx</p>  <p>=== Configure your package management system</p> <p>Ensure you have configured your package management system, as described in &lt;&gt;. <p>== Install the APIM package (no dependencies)</p> <p>To install the APIM package only, run the following command:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-stack/#sourcebashsubsattributes"},{"title":"[source,bash,subs=\"attributes\"]","text":"","location":"apim/installation-guide/red-hat/installation-guide-redhat-stack/#sourcebashsubsattributes_1"},{"title":"sudo yum install","text":"<p>== Install the APIM package with dependencies</p> <p>=== Configure dependency repositories</p> <p>Before you install the APIM package, you may need to add third-party repositories.</p> <p>==== MongoDB</p> <p>NOTE: For guidance on installing and configuring MongoDB, see the link:https://docs.mongodb.com/v3.6/tutorial/install-mongodb-on-red-hat/[MongoDB Installation documentation, window=\\\"_blank\\\"].</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-stack/#sudo-yum-install"},{"title":"[source,bash]","text":"<p>echo \"[mongodb-org-3.6] name=MongoDB Repository baseurl=https://repo.mongodb.org/yum/redhat/\\$releasever/mongodb-org/3.6/x86_64/ gpgcheck=1 enabled=1 gpgkey=https://www.mongodb.org/static/pgp/server-3.6.asc\" | sudo tee /etc/yum.repos.d/mongodb-org-3.6.repo &gt; /dev/null</p> <p>sudo yum install -y mongodb-org sudo systemctl start mongod</p>  <p>==== Elasticsearch 7.x</p> <p>NOTE: For guidance on installing and configuring Elasticsearch, see the link:https://www.elastic.co/guide/en/elasticsearch/reference/7.6/rpm.html#rpm-repo[Elasticsearch Installation documentation, window=\\\"_blank\\\"].</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-stack/#sourcebash"},{"title":"[source,bash]","text":"<p>echo \"[elasticsearch-7.x] name=Elasticsearch repository for 7.x packages baseurl=https://artifacts.elastic.co/packages/7.x/yum gpgcheck=1 gpgkey=https://artifacts.elastic.co/GPG-KEY-elasticsearch enabled=1 autorefresh=1 type=rpm-md\" | sudo tee /etc/yum.repos.d/elasticsearch.repo &gt; /dev/null sudo yum install -y elasticsearch sudo systemctl start elasticsearch</p>  <p>=== Install APIM</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-stack/#sourcebash_1"},{"title":"[source,bash,subs=\"attributes\"]","text":"","location":"apim/installation-guide/red-hat/installation-guide-redhat-stack/#sourcebashsubsattributes_2"},{"title":"curl -L https://bit.ly/install-apim-3x | bash","text":"<p>== Run APIM with <code>systemd</code></p> <p>To start up the APIM components, run the following commands:</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-stack/#curl-l-httpsbitlyinstall-apim-3x-bash"},{"title":"[source,bash,subs=\"attributes\"]","text":"<p>sudo systemctl daemon-reload sudo systemctl start {gravitee-package-name}-gateway {gravitee-package-name}-management-api sudo systemctl restart nginx</p>  <p>== Check the APIM components are running</p> <p>When all components are started, you can run a quick test by checking these URLs:</p> <p>|=== |Component |URL</p> <p>|APIM Gateway |http://localhost:8082/</p> <p>|APIM API |http://localhost:8083/management/organizations/DEFAULT/environments/DEFAULT/apis</p> <p>|APIM Management |http://localhost:8084/</p> <p>|APIM Portal |http://localhost:8085/</p> <p>|===</p>","location":"apim/installation-guide/red-hat/installation-guide-redhat-stack/#sourcebashsubsattributes_3"},{"title":"Important","text":"<p>If you are using mongoDB, it is strongly recommended to run the scripts to upgrade your database before starting the new version of the gravitee REST APIs. Otherwise, you could experience data corruption issues.</p> <p>Mongo version MUST be at least 3.6</p>","location":"apim/installation-guide/upgrades/3.0.0/readme/"},{"title":"General","text":"","location":"apim/installation-guide/upgrades/3.0.0/readme/#general"},{"title":"Organization &amp; Environment","text":"<p>In this new version Gravitee comes with a new way of managing your environments. By default, Gravitee is configured with a first Organization: ``` organization { id: DEFAULT, name: Default organization } ``` And a first Environment in this Organization: ``` environment { id: DEFAULT, name: Default environment, organization: DEFAULT } ```</p> <p>It will allow you to manage more than one environment for each instance of Gravitee.</p>","location":"apim/installation-guide/upgrades/3.0.0/readme/#organization-environment"},{"title":"Breaking Changes","text":"","location":"apim/installation-guide/upgrades/3.0.0/readme/#breaking-changes"},{"title":"API-Key policy","text":"<p>In this new version, if api-keys used to call an API is invalid or has expired, the gateway will fail with a 401 (instead of 403 in previous versions of Gravitee).</p>","location":"apim/installation-guide/upgrades/3.0.0/readme/#api-key-policy"},{"title":"Management API","text":"<p>If you are using the REST API directly, please note that you will have to adapt the URL from <code>https://host/management/</code> to <code>https://host/management/organizations/DEFAULT/environments/DEFAULT/</code></p> <p>The resource <code>/views/default</code> has been deleted since a view does not have a default field anymore.</p>","location":"apim/installation-guide/upgrades/3.0.0/readme/#management-api"},{"title":"Management UI","text":"<p>The actual portal has been replaced by a brand new version, with its own location. As a consequence, the URL of the management UI has been modified to remove the /management part.</p> <p>For instance, to access the Platform Overview page, you should use <code>https://host/\\#!/platform</code> instead of <code>https://host/#!/management/platform</code></p>","location":"apim/installation-guide/upgrades/3.0.0/readme/#management-ui"},{"title":"Memberships, roles and role mappings","text":"<p>One major breaking change in this new version is the replacement of MANAGEMENT and PORTAL scopes by ENVIRONNMENT and ORGANIZATION scopes. It\u2019s not just a renaming but a dispatch of permissions among these 2 news scopes. As a consequence, all existing memberships, roles, groups and Identity Providers role mappings should be updated.</p> <ul> <li> <p>Memberhips, roles and groups have to be updated with migration     scripts here</p> </li> <li> <p>Role Mappings for Identity Providers stored in database will be     updated with a specific upgrader. See Upgrader</p> </li> <li> <p>Role mappings defined in the gravitee.yml file have to be     updated with these new scopes.</p> </li> </ul> <p>Here\u2019s a correlation table of permissions before and after migration :</p>         Permission Name Scope Name before migration Scope name after migration     <p>INSTANCE</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>GROUP</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>TAG</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>TENANT</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>API</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>ROLE</p> <p>MANAGEMENT</p> <p>ORGANIZATION</p>   <p>APPLICATION</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>PLATFORM</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>AUDIT</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>NOTIFICATION</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>USER</p> <p>MANAGEMENT</p> <p>ORGANIZATION</p>   <p>MESSAGE</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>DICTIONARY</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>ALERT</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>ENTRYPOINT</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>SETTINGS</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>DASHBOARD</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>QUALITY_RULE</p> <p>MANAGEMENT</p> <p>ENVIRONMENT</p>   <p>METADATA</p> <p>PORTAL</p> <p>ENVIRONMENT</p>   <p>DOCUMENTATION</p> <p>PORTAL</p> <p>ENVIRONMENT</p>   <p>APPLICATION</p> <p>PORTAL</p> <p>ENVIRONMENT</p>   <p>VIEW</p> <p>PORTAL</p> <p>ENVIRONMENT</p>   <p>TOP_APIS</p> <p>PORTAL</p> <p>ENVIRONMENT</p>   <p>SETTINGS</p> <p>PORTAL</p> <p>ENVIRONMENT</p>   <p>API_HEADER</p> <p>PORTAL</p> <p>ENVIRONMENT</p>   <p>IDENTITY_PROVIDER</p> <p>PORTAL</p> <p>ENVIRONMENT</p>   <p>CLIENT_REGISTRATION_PROVIDER</p> <p>PORTAL</p> <p>ENVIRONMENT</p>","location":"apim/installation-guide/upgrades/3.0.0/readme/#memberships-roles-and-role-mappings"},{"title":"Repository","text":"","location":"apim/installation-guide/upgrades/3.0.0/readme/#repository"},{"title":"Mongodb","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.0.0/1-collections-linked-to-environment-or-organization.js This script adds new fields that refer the default environment or the default organization.</p> <p>/apim/3.x/mongodb/3.0.0/2-roles-groups-and-memberships-migration.js This script migrates permission values in roles since MANAGEMENT roles and PORTAL roles have been merged and dispatched into new ENVIRONMENT and ORGANIZATION roles. It also updates memberships and groups by adding or removing columns. All previous indexes for roles and memberships will be deleted and replaced by new indexes.</p> <p>/apim/3.x/mongodb/3.0.0/3-replace-apiArray-by-unique-api.js This script adds a new field that refers the api and remove the api array. All previous indexes for plans will be deleted and replaced by new indexes.</p> <p>/apim/3.x/mongodb/3.0.0/4-remove-devMode.js This script removes the devMode parameter, since the legacy portal has been replaced.</p> <p>/apim/3.x/mongodb/3.0.0/5-remove-orphan-documentation-pages.js Due to a bug in a previous version of gravitee when importing APIs, orphan pages may have been created. Orphan pages are all pages with a parentId but no page with such id exists. In some situation, this can lead to errors when accessing portal or apis documentation. You may use this script to find and remove orphan pages.</p> <p>Note: You can make a dry run by commenting line 6 and uncommenting line 5.</p> <p>/apim/3.x/mongodb/3.0.0/6-remove-ALL-view-and-defaultView-field.js This script removes the All view, since the legacy portal has been replaced and the new portal does not need this default view anymore. The script also updates existing views to remove defaultView field.</p>","location":"apim/installation-guide/upgrades/3.0.0/readme/#mongodb"},{"title":"Upgrader","text":"","location":"apim/installation-guide/upgrades/3.0.0/readme/#upgrader"},{"title":"Identity providers","text":"<p>Because of the evolution of the roles and their scope, role mappings in Identity Providers must be updated. To achieve this, a specific service has been created and will be launched at APIM startup. As this is not necessary to launch this service more than once, it can be disabled with some configuration.</p> <pre><code>services:\n  # v3 upgrader service. Can be disabled after first launch.\n  v3-upgrader:\n    enabled: true\n</code></pre>","location":"apim/installation-guide/upgrades/3.0.0/readme/#identity-providers"},{"title":"Docker","text":"<p>Docker images for Gravitee.io APIM have been renamed to follow the same conventions as the others Gravitee.io modules.</p> <p>In the case of Gravitee.io APIM, all the images have been prefixed by <code>-apim</code>.</p> <p>For example, for the API gateway <code>graviteeio/gateway</code> has been replaced by <code>graviteeio/apim-gateway</code>.</p> <p>Please have a look to the documentation at: https://docs.gravitee.io/apim/3.x/apim_installguide_docker_images.html</p>","location":"apim/installation-guide/upgrades/3.0.0/readme/#docker"},{"title":"Breaking Changes","text":"","location":"apim/installation-guide/upgrades/3.0.10/readme/"},{"title":"Management API","text":"<p>Starting with this version, <code>Apis</code> resources require authentication even for the GET method.</p> <p>If you are using the REST API directly, please note that you should adapt your application.</p> <p><code>Apis</code> resources start with the path <code>/management/organizations/DEFAULT/environments/DEFAULT/apis/</code></p>","location":"apim/installation-guide/upgrades/3.0.10/readme/#management-api"},{"title":"Portal API","text":"<p>Starting with this version, <code>Apis</code>, <code>Pages</code> and <code>Categories</code> resources that were public for GET method require authentication if the users have to sign in to access the portal. (forceLogin = true)</p> <p>If you are using the REST API directly, please note that you should adapt your application.</p> <ul> <li> <p><code>Apis</code> resources start with the path     <code>/portal/environments/DEFAULT/apis</code></p> </li> <li> <p><code>Pages</code> resources start with the path     <code>/portal/environments/DEFAULT/pages</code></p> </li> <li> <p><code>Categories</code> resources start with the path     <code>/portal/environments/DEFAULT/categories</code></p> </li> </ul>","location":"apim/installation-guide/upgrades/3.0.10/readme/#portal-api"},{"title":"View renamed to Categories","text":"<p>In the new portal, views are called categories. But in the management console, they are still called views. To be consistent, the term View is replaced by Category in the whole platform.</p> <p>Linked to this issue: #3843</p>","location":"apim/installation-guide/upgrades/3.0.2/readme/"},{"title":"Mongodb","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>upgrades/3.x/3.0.2/mongodb/1-rename-view-in-category.js This script renames a field in apis collection, rename views collection, change 3 parameters, replace view by category in audits collection and convert documentation view LINK to ctagory LINK</p>","location":"apim/installation-guide/upgrades/3.0.2/readme/#mongodb"},{"title":"Breaking changes","text":"<p>The <code>portalURL</code> parameter in the gravitee.yml file has been removed. It has become useless with this issue #4144.</p> <p>As this <code>portalURL</code> stands for the former portal, it will be replaced by the <code>management.url</code> parameter in the console settings. This parameter will be initialized with the former <code>portalURL</code> value if it still exists in your gravitee.yml. Otherwise, the default value of <code>management.url</code> is http://localhost:3000</p> <p>The <code>portal.url</code> parameter in the console settings will also have a default value : http://localhost:4100</p>","location":"apim/installation-guide/upgrades/3.0.7/readme/"},{"title":"Docker images","text":"<p>All the UI based docker images (APIM Console, APIM Portal) are now using HTTP port 8080 and HTTPS port 8443 by default to avoid the need of a root account to use 80/443 to improve the security of our platform.</p>","location":"apim/installation-guide/upgrades/3.1.0/readme/"},{"title":"Breaking changes","text":"<p>From with this version, the name of some components of Gravitee.io APIM changes. As a consequence, the following plugins are renamed :</p>        <p>before 3.10.0</p> <p>after 3.10.0</p>   <p>gravitee.repository.mongodb-x.y.z.zip</p> <p>gravitee.apim.repository.mongodb-x.y.z.zip</p>   <p>gravitee.repository.jdbc-x.y.z.zip</p> <p>gravitee.apim.repository.jdbc-x.y.z.zip</p>   <p>gravitee.repository.redis-x.y.z.zip</p> <p>gravitee.apim.repository.redis-x.y.z.zip</p>   <p>gravitee.repository.hazelcast-x.y.z.zip</p> <p>gravitee.apim.repository.hazelcast-x.y.z.zip</p>   <p>gravitee.repository.gateway.bridge.http.client-x.y.z.zip</p> <p>gravitee.apim.repository.gateway.bridge.http.client-x.y.z.zip</p>   <p>gravitee.repository.gateway.bridge.http.server-x.y.z.zip</p> <p>gravitee.apim.repository.gateway.bridge.http.server-x.y.z.zip</p>    <p>These plugins have also been moved in another folder on https://download.gravitee.io. For instance, the MongoDB plugin is now available using this link:</p> <p>https://download.gravitee.io/graviteeio-apim/plugins/repositories/gravitee-apim-repository-mongodb/gravitee-apim-repository-mongodb-3.10.0.zip</p> <p>In future versions, others plugins will be renamed. Stay tuned!</p>","location":"apim/installation-guide/upgrades/3.10.0/readme/"},{"title":"Breaking changes","text":"<p>From this version, the name of the APIM Rest APIs component changes. As a consequence:</p> <ol> <li> <p>The APIM Rest API component available on     https://download.gravitee.io is now     <code>gravitee-*apim*-rest-api-x.y.z.zip</code> instead of     <code>gravitee-management-rest-api-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Rest API folder within the full distribution     zip file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim*-rest-api-x.y.z</code> instead of     <code>graviteeio-rest-api-x.y.z</code></p> </li> </ol> <p>In future versions, others plugins &amp; components might be renamed. Stay tuned!</p>","location":"apim/installation-guide/upgrades/3.10.1/readme/"},{"title":"Repository","text":"","location":"apim/installation-guide/upgrades/3.10.1/readme/#repository"},{"title":"Mongodb","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.10.1/1-upgrade-parameters-for-theme-console.js This script upgrade default value of <code>theme.logo</code> in parameters</p>","location":"apim/installation-guide/upgrades/3.10.1/readme/#mongodb"},{"title":"Breaking Change","text":"","location":"apim/installation-guide/upgrades/3.10.13/readme/"},{"title":"Docker Images - Enterprise Edition","text":"<p>To reduce the number of security vulnerabilities and ensure a better maintenance in the future, the base Docker images used for the Enterprise Edition have changed.</p> <p>As of 3.10.13, APIM Gateway EE and Management API EE base Docker images are moving from Ubuntu to Alpine with JDK 17. It means users creating their own Docker images based on the one provided by Gravitee.io might need to update their Dockerfile to make them compatible with the Alpine distribution.</p> <p>Notes: Community Edition users will not be affected as the base images were already Alpine ones.</p>","location":"apim/installation-guide/upgrades/3.10.13/readme/#docker-images-enterprise-edition"},{"title":"Breaking changes","text":"<p>From this version, and for the next 3.10.x versions, the name of the Elasticsearch repository component changes. As a consequence, the Elasticsearch repository component available on https://download.gravitee.io is now <code>gravitee-*apim*-repository-elasticsearch-x.y.z.zip</code></p> <p>instead of <code>gravitee-repository-elasticsearch-x.y.z.zip</code></p> <p>This plugin has also been moved in another folder: https://download.gravitee.io/#graviteeio-apim/plugins/repositories/gravitee-apim-repository-elasticsearch/.</p> <p>You can download directly the Elasticsearch repository using this link: https://download.gravitee.io/graviteeio-apim/plugins/repositories/gravitee-apim-repository-elasticsearch/gravitee-apim-repository-elasticsearch-3.10.15.zip</p>","location":"apim/installation-guide/upgrades/3.10.15/readme/"},{"title":"Breaking changes","text":"","location":"apim/installation-guide/upgrades/3.10.19/readme/"},{"title":"API key and JWT plans","text":"<p>The security chain (the internal process that selects the executable plan for the incoming request and applies the related security rules) parses all active plans to select and execute the relevant one.</p> <p>Prior to this version:</p> <ul> <li> <p>The API key plan was executed if the request contained an API key.</p> </li> <li> <p>The JWT plan was executed if the request contained a Bearer token.</p> </li> </ul> <p>From this version:</p> <p>The security chain has been improved to select and execute plans more efficiently. As a result, API keys and JWT plans are now only executed if there is an active subscription related to the provided security token. If there is no relevant subscription, the currently parsed plans are not executed and the security chain moves to parse the next available plans. The process continues until the security chain parses plans related to the provided security token and these plans are executed, or until all available plans are parsed without a match.</p> <p>Specific examples of this change are provided in the table below:</p>          <p>API plans</p> <p>Request</p> <p>Prior to this version</p> <p>From this version</p>   <p>API key plan + Keyless plan</p> <p>Request contains an invalid API key</p> <p>API key plan is executed = HTTP 401 unauthorized</p> <p>Keyless plan is executed</p>   <p>JWT plan 1 + JWT plan 2</p> <p>Request contains a Bearer token valid for JWT plan 2</p> <p>JWT plan 1 is executed = HTTP 401 unauthorized</p> <p>JWT plan 2 is executed</p>","location":"apim/installation-guide/upgrades/3.10.19/readme/#api-key-and-jwt-plans"},{"title":"Breaking changes","text":"","location":"apim/installation-guide/upgrades/3.10.4/readme/"},{"title":"Management Web UI","text":"<p>From with this version, the name of the APIM Console component changes. As a consequence:</p> <ol> <li> <p>The APIM Console component available on     https://download.gravitee.io is now     <code>gravitee-*apim-console*-webui-x.y.z.zip</code> instead of     <code>gravitee-management-webui-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Console folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim-console*-ui-x.y.z</code> instead of     <code>graviteeio-management-ui-x.y.z</code></p> </li> </ol>","location":"apim/installation-guide/upgrades/3.10.4/readme/#management-web-ui"},{"title":"Portal Web UI","text":"<p>From with this version, the name of the APIM Portal component changes. As a consequence:</p> <ol> <li> <p>The APIM Portal component available on     https://download.gravitee.io is now     <code>gravitee-*apim*-portal-webui-x.y.z.zip</code> instead of     <code>gravitee-portal-webui-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Portal folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim*-portal-ui-x.y.z</code> instead of     <code>graviteeio-portal-ui-x.y.z</code></p> </li> </ol> <p>In future versions, others plugins &amp; components might be renamed. Stay tuned!</p>","location":"apim/installation-guide/upgrades/3.10.4/readme/#portal-web-ui"},{"title":"Breaking changes","text":"","location":"apim/installation-guide/upgrades/3.10.8/readme/"},{"title":"Gateway","text":"<p>From with this version, the name of the APIM Gateway component changes. As a consequence:</p> <ol> <li> <p>The APIM Gateway component available on     https://download.gravitee.io is now     <code>gravitee-*apim-gateway*-x.y.z.zip</code> instead of     <code>gravitee-gateway-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Gateway folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim-gateway*-x.y.z</code> instead of     <code>graviteeio-gateway-x.y.z</code></p> </li> </ol>","location":"apim/installation-guide/upgrades/3.10.8/readme/#gateway"},{"title":"Plans anomalies in database","text":"","location":"apim/installation-guide/upgrades/3.10.8/readme/#plans-anomalies-in-database"},{"title":"TLDR","text":"<p>In Gravitee &lt; 3.10.8, some processes have caused database inconsistencies, regarding plans and flows.</p> <p>Gravitee 3.10.8, introduces an automated process to detect and fix those anomalies.</p> <p>By default, this process will run in dry mode and won\u2019t do any database modification. Check the <code>gravitee-upgraders.log</code> file to see if any of your API is concerned, and how it will be fixed.</p> <p>After check, fix those database anomalies by disabling the dry mode.</p>","location":"apim/installation-guide/upgrades/3.10.8/readme/#tldr"},{"title":"What are those database anomalies ?","text":"<p>In Gravitee &lt; 3.10.8, some processes have caused inconsistencies in database, regarding plans and flows.</p> <p>Concerned processes are :</p> <ul> <li> <p>import an API</p> </li> <li> <p>promote an API</p> </li> <li> <p>duplicate an API</p> </li> <li> <p>rollback an API</p> </li> </ul> <p>For concerned APIs, plans and flows displayed in console doesn\u2019t reflect the ones runned by gateway.</p>","location":"apim/installation-guide/upgrades/3.10.8/readme/#what-are-those-database-anomalies"},{"title":"How to fix it ?","text":"<p>Gravitee 3.10.8, introduces an automated process to detect and fix those anomalies.</p> <p>This process will run on management API startup. By default, it will run in dry mode, to detect and list anomalies without fixing them in database.</p> <p>After you checked those anomalies have to be fixed, you can disable the dry mode, and restart your API to update your database.</p>","location":"apim/installation-guide/upgrades/3.10.8/readme/#how-to-fix-it"},{"title":"My APIs are concerned ?","text":"<p>On management API startup, you will see this trace in the console, or the dedicated <code>gravitee-upgraders.log</code> log file.</p> <p>If no anomaly was detected :</p> <pre><code>14:19:43.171 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - Starting PlansDataFixUpgrader execution with dry-run enabled\n14:19:43.352 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - No plan data anomaly found\n14:19:43.360 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - Finishing PlansDataFixUpgrader execution\n</code></pre> <p>If anomalies were detected :</p> <pre><code>14:51:50.890 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - Starting PlansDataFixUpgrader execution with dry-run enabled\n14:51:50.979 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader -\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader - ##############################################################\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader - #                           WARNING                          #\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader - ##############################################################\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader -\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader - We detected database anomalies in your plans data.\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader -\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader - THIS IS A DRY RUN. DATABASE WON'T BE UPDATED.\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader - To fix anomalies, disable the dry run mode.\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader - Below, a list of changes that would happen without dry run\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader - See related documentation : https://docs.gravitee.io/apim/3.x/apim_installguide_migration.html#upgrade_to_3_10_8\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader -\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader - ##############################################################\n14:51:50.980 [main] WARN  i.g.r.a.s.i.u.PlansDataFixUpgrader -\n14:51:50.980 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - Plans anomalies found for API \"Movies\" (99999999-6595-9999-8a7e-796595985132) :\n14:51:50.981 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - - Will create plan \"Gold-Recreated\" for API \"Movies\" (99999999-6595-9999-8a7e-796595985132), which is missing in plans table\n14:51:50.982 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - - Will create plan \"Free-Recreated\" for API \"Movies\" (99999999-6595-9999-8a7e-796595985132), which is missing in plans table\n14:51:50.982 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - - Will close plan \"Free\" (66664545-1234-1234-1234-1234567891425), cause it's absent from api definition\n14:51:51.019 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - Plans anomalies found for API \"Horses\" (0456455556-5465-5465-4894955554) :\n14:51:51.019 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - - Will create plan \"LimitedUsage-Recreated\" for API \"Horses\" (0456455556-5465-5465-4894955554), which is missing in plans table\n14:51:51.025 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - Plans anomalies found for API \"Petstore\" (121112-1211-1111-121121211) :\n14:51:51.025 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - - Will create plan \"Silver-Recreated\" for API \"Petstore\" (121112-1211-1111-121121211), which is missing in plans table\n14:51:51.058 [main] INFO  i.g.r.a.s.i.u.PlansDataFixUpgrader - Finishing PlansDataFixUpgrader execution\n</code></pre>","location":"apim/installation-guide/upgrades/3.10.8/readme/#my-apis-are-concerned"},{"title":"How anomalies are fixed ?","text":"<p>This process will fix your API plans data.</p> <p>But it won\u2019t change the runtime behavior of your APIs in the gateway, until you redeploy them manually from console.</p>","location":"apim/installation-guide/upgrades/3.10.8/readme/#how-anomalies-are-fixed"},{"title":"Some plans were considered by gateway, but were not visible in console :","text":"<p>They will be recreated in console, and you will see new plans appear :</p> <ul> <li> <p>with name suffixed by \"-Recreated\"</p> </li> <li> <p>with description \"This plan has been recreated during a data fix     process. See documentation : \u2026\"</p> </li> </ul> <p>Those plans will be in <code>deprecated</code> state, without any subscription. It will allow you to check those plans and their flows, and close them if relevant.</p>","location":"apim/installation-guide/upgrades/3.10.8/readme/#some-plans-were-considered-by-gateway-but-were-not-visible-in-console"},{"title":"Some plans visible in console were not considered by gateway :","text":"<p>Those plans will be closed, as they were not actually used during API runtime.</p>","location":"apim/installation-guide/upgrades/3.10.8/readme/#some-plans-visible-in-console-were-not-considered-by-gateway"},{"title":"I\u2019m ready. How to disable the dry mode and fix data ?","text":"<p>To fix data in your database, turn off the dry-mode, setting the <code>services.plans-data-fix-upgrader.dryRun</code> parameter to false. Then, restart the management API.</p>","location":"apim/installation-guide/upgrades/3.10.8/readme/#im-ready-how-to-disable-the-dry-mode-and-fix-data"},{"title":"Further configuration ?","text":"<p>You can configure this process in gravitee.yml, for example :</p> <pre><code>services:\n  plans-data-fix-upgrader:\n    enabled: true\n    dryRun: true\n    notifyApiOwner: false\n</code></pre> <p>Possible configuration keys are :</p>         <p>Key</p> <p>Description</p> <p>Default value</p>   <p>enabled</p> <p>If set to false, the process won\u2019t execute</p> <p>true</p>   <p>dryRun</p> <p>If set to true, the process won\u2019t make any database change, but only list changes.</p> <p>true</p>   <p>notifyApiOwner</p> <p>If set to true, an email notification will be send to the api owner for each fixed API.</p> <p>false</p>","location":"apim/installation-guide/upgrades/3.10.8/readme/#further-configuration"},{"title":"Elastic Search reporter plugins configuration","text":"<p>Before Gravitee 3.10.9 :</p> <ul> <li> <p>For ES&gt;=7, GeoIp and UserAgent plugins are enabled by default in     Gravitee, and can\u2019t be disabled</p> </li> <li> <p>For ES&lt;7, those plugins are disabled by default and can be     enabled in Gravitee configuration.</p> </li> </ul> <p>Since Gravitee 3.10.9, it behave the same way for all ES versions : GeoIp and UserAgent plugins are be enabled by default, and can be disabled by overriding default <code>reporters.elasticsearch.pipeline.plugins.ingest</code> configuration.</p> <p>If your Gravitee configuration enables a plugin which is not available on your ES instance, you will get this kind of error message on gateway startup :</p> <p><code>Unable to create ES pipeline 'gravitee_pipeline': status[400] response[{\"error\":{\"root_cause\":[{\"reason\":\"No processor type exists with name [geoip]\",\"processor_type\":\"geoip\"}]</code></p> <p>And then, you have to override <code>reporters.elasticsearch.pipeline.plugins.ingest</code> default configuration, to remove unrelevant plugin.</p>","location":"apim/installation-guide/upgrades/3.10.9/readme/"},{"title":"Breaking changes","text":"<p>From with this version, the name of the APIM Rest APIs component changes. As a consequence:</p> <ol> <li> <p>The APIM Rest API component available on     https://download.gravitee.io is now     <code>gravitee-*apim*-rest-api-x.y.z.zip</code> instead of     <code>gravitee-management-rest-api-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Rest API folder within the full distribution     zip file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim*-rest-api-x.y.z</code> instead of     <code>graviteeio-rest-api-x.y.z</code></p> </li> </ol> <p>In future versions, others plugins &amp; components might be renamed. Stay tuned!</p>","location":"apim/installation-guide/upgrades/3.11.0/readme/"},{"title":"Security update","text":"<p>From this version, API properties can be encrypted.</p> <p>Encryption key is located in gravitee.yml of Rest APIs and gateway.</p> <p>You should not use this default key, and set your own custom 32 bytes length secret.</p> <p>```\u1ef3ml # Encrypt API properties using this secret api: properties: encryption: secret: vvLJ4Q8Khvv9tm2tIPdkGEdmgKUruAL6 ```</p>","location":"apim/installation-guide/upgrades/3.11.0/readme/#security-update"},{"title":"Repository","text":"","location":"apim/installation-guide/upgrades/3.11.1/readme/"},{"title":"Mongodb","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.11.1/1-event-debug-migration.js This script removes the <code>API_ID</code> property for events of type <code>DEBUG</code>.</p>","location":"apim/installation-guide/upgrades/3.11.1/readme/#mongodb"},{"title":"Breaking changes","text":"","location":"apim/installation-guide/upgrades/3.11.2/readme/"},{"title":"Management Web UI","text":"<p>From with this version, the name of the APIM Console component changes. As a consequence:</p> <ol> <li> <p>The APIM Console component available on     https://download.gravitee.io is now     <code>gravitee-*apim-console*-webui-x.y.z.zip</code> instead of     <code>gravitee-management-webui-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Console folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim-console*-ui-x.y.z</code> instead of     <code>graviteeio-management-ui-x.y.z</code></p> </li> </ol>","location":"apim/installation-guide/upgrades/3.11.2/readme/#management-web-ui"},{"title":"Portal Web UI","text":"<p>From with this version, the name of the APIM Portal component changes. As a consequence:</p> <ol> <li> <p>The APIM Portal component available on     https://download.gravitee.io is now     <code>gravitee-*apim*-portal-webui-x.y.z.zip</code> instead of     <code>gravitee-portal-webui-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Portal folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim*-portal-ui-x.y.z</code> instead of     <code>graviteeio-portal-ui-x.y.z</code></p> </li> </ol> <p>In future versions, others plugins &amp; components might be renamed. Stay tuned!</p>","location":"apim/installation-guide/upgrades/3.11.2/readme/#portal-web-ui"},{"title":"Breaking Change","text":"<p>Policy plugin <code>gravitee-policy-apikey</code> prior to version 2.3.0 is no longer compatible with APIM 3.12.0.</p> <p>Starting in version 3.12.0, you must use <code>gravitee-policy-apikey</code> &gt;= 2.3.0.</p>","location":"apim/installation-guide/upgrades/3.12.0/readme/"},{"title":"Default Settings Change Announcement","text":"<p>HTTP Bridge Service will be disabled by default starting in version 3.13.</p> <p>If you are using this feature, do not forget to update your settings.</p> <p>For more information, click here for documentation.</p>","location":"apim/installation-guide/upgrades/3.12.0/readme/#default-settings-change-announcement"},{"title":"API Keys","text":"","location":"apim/installation-guide/upgrades/3.12.0/readme/#api-keys"},{"title":"Model Change","text":"<p>Before this version, API keys contained a key attribute, which is both the value of the key and also the database ID.</p> <p>Starting in version 3.12.0, APIKeys now contain distinct attributes:</p> <ul> <li> <p>key: API key value</p> </li> <li> <p>ID: API key database unique ID</p> </li> </ul> <p>The 3 Portal API endpoints listed below now expose distinct IDs and keys in the HTTP response (previously, the key attribute was exposed as ID) :</p> <ul> <li> <p>GET /subscriptions/{subscription.id}</p> </li> <li> <p>POST /subscriptions/{subscription.id}</p> </li> <li> <p>POST /subscriptions/{subscription.id}/_renew</p> </li> </ul>","location":"apim/installation-guide/upgrades/3.12.0/readme/#model-change"},{"title":"Deprecated Endpoints","text":"<p>The Rest API endpoints listed below are now deprecated, and will be removed in a future version.</p>        <p>Deprecated Endpoint</p> <p>Replace With</p>   <p>PUT /apis/{api.id}/keys/{apiKey.key}</p> <p>PUT /apis/{api.id}/subscriptions/{subscription.id}/apikeys/{apiKey.id}</p>   <p>DELETE /apis/{api.id}/keys/{apiKey.key}</p> <p>DELETE /apis/{api.id}/subscriptions/{subscription.id}/apikeys/{apiKey.id}</p>   <p>POST /apis/{api.id}/keys/_verify?apiKey={apiKey.key}</p> <p>GET /apis/{api.id}/subscriptions/_canCreate?application={application.id}&amp;key={apiKey.key}</p>   <p>DELETE /apis/{api.id}/subscriptions/{subscription.id}/keys/{apiKey.key}</p> <p>DELETE /apis/{api.id}/subscriptions/{subscription.id}/apikeys/{apiKey.id}</p>   <p>GET /apis/{api.id}/subscriptions/{subscription.id}/keys</p> <p>GET /apis/{api.id}/subscriptions/{subscription.id}/apikeys</p>   <p>POST /apis/{api.id}/subscriptions/{subscription.id}</p> <p>POST /apis/{api.id}/subscriptions/{subscription.id}/apikeys/_renew</p>   <p>POST /apis/{api.id}/subscriptions/{subscription.id}/keys/{apiKey.key}/_reactivate</p> <p>POST /apis/{api.id}/subscriptions/{subscription.id}/apikeys/{apiKey.id}/_reactivate</p>   <p>GET /applications/{application.id}/subscriptions/{subscription.id}/keys</p> <p>GET /applications/{application.id}/subscriptions/{subscription.id}/apikeys</p>   <p>POST /applications/{application.id}/subscriptions/{subscription.id}</p> <p>POST /applications/{application.id}/subscriptions/{subscription.id}/apikeys/_renew</p>   <p>DELETE /applications/{application.id}/subscriptions/{subscription.id}/keys/{apiKey.key}</p> <p>DELETE /applications/{application.id}/subscriptions/{subscription.id}/apikeys/{apiKey.id}</p>","location":"apim/installation-guide/upgrades/3.12.0/readme/#deprecated-endpoints"},{"title":"Repository","text":"","location":"apim/installation-guide/upgrades/3.12.0/readme/#repository"},{"title":"MongoDB","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.12.0/api-keys-migration.js This script adds key and api columns in api keys keys table.</p>","location":"apim/installation-guide/upgrades/3.12.0/readme/#mongodb"},{"title":"Breaking changes","text":"","location":"apim/installation-guide/upgrades/3.12.1/readme/"},{"title":"Management Web UI","text":"<p>From with this version, the name of the APIM Console component changes. As a consequence:</p> <ol> <li> <p>The APIM Console component available on     https://download.gravitee.io is now     <code>gravitee-*apim-console*-webui-x.y.z.zip</code> instead of     <code>gravitee-management-webui-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Console folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim-console*-ui-x.y.z</code> instead of     <code>graviteeio-management-ui-x.y.z</code></p> </li> </ol>","location":"apim/installation-guide/upgrades/3.12.1/readme/#management-web-ui"},{"title":"Portal Web UI","text":"<p>From with this version, the name of the APIM Portal component changes. As a consequence:</p> <ol> <li> <p>The APIM Portal component available on     https://download.gravitee.io is now     <code>gravitee-*apim*-portal-webui-x.y.z.zip</code> instead of     <code>gravitee-portal-webui-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Portal folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim*-portal-ui-x.y.z</code> instead of     <code>graviteeio-portal-ui-x.y.z</code></p> </li> </ol> <p>In future versions, others plugins &amp; components might be renamed. Stay tuned!</p>","location":"apim/installation-guide/upgrades/3.12.1/readme/#portal-web-ui"},{"title":"Breaking changes","text":"","location":"apim/installation-guide/upgrades/3.12.5/readme/"},{"title":"Gateway","text":"<p>From with this version, the name of the APIM Gateway component changes. As a consequence:</p> <ol> <li> <p>The APIM Gateway component available on     https://download.gravitee.io is now     <code>gravitee-*apim-gateway*-x.y.z.zip</code> instead of     <code>gravitee-gateway-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Gateway folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim-gateway*-x.y.z</code> instead of     <code>graviteeio-gateway-x.y.z</code></p> </li> </ol>","location":"apim/installation-guide/upgrades/3.12.5/readme/#gateway"},{"title":"Breaking changes","text":"","location":"apim/installation-guide/upgrades/3.13.0/readme/"},{"title":"Gateway","text":"<p>HTTP Bridge Service is now disabled by default starting.</p> <p>If you are using this feature, do not forget to update your settings.</p> <p>For more information, click here for documentation.</p>","location":"apim/installation-guide/upgrades/3.13.0/readme/#gateway"},{"title":"Management Web UI","text":"<p>From with this version, the name of the APIM Console component changes. As a consequence:</p> <ol> <li> <p>The APIM Console component available on     https://download.gravitee.io is now     <code>gravitee-*apim-console*-webui-x.y.z.zip</code> instead of     <code>gravitee-management-webui-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Console folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim-console*-ui-x.y.z</code> instead of     <code>graviteeio-management-ui-x.y.z</code></p> </li> </ol>","location":"apim/installation-guide/upgrades/3.13.0/readme/#management-web-ui"},{"title":"Portal Web UI","text":"<p>From with this version, the name of the APIM Portal component changes. As a consequence:</p> <ol> <li> <p>The APIM Portal component available on     https://download.gravitee.io is now     <code>gravitee-*apim*-portal-webui-x.y.z.zip</code> instead of     <code>gravitee-portal-webui-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Portal folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim*-portal-ui-x.y.z</code> instead of     <code>graviteeio-portal-ui-x.y.z</code></p> </li> </ol> <p>In future versions, others plugins &amp; components might be renamed. Stay tuned!</p>","location":"apim/installation-guide/upgrades/3.13.0/readme/#portal-web-ui"},{"title":"Breaking changes","text":"","location":"apim/installation-guide/upgrades/3.13.2/readme/"},{"title":"Gateway","text":"<p>From with this version, the name of the APIM Gateway component changes. As a consequence:</p> <ol> <li> <p>The APIM Gateway component available on     https://download.gravitee.io is now     <code>gravitee-*apim-gateway*-x.y.z.zip</code> instead of     <code>gravitee-gateway-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Gateway folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim-gateway*-x.y.z</code> instead of     <code>graviteeio-gateway-x.y.z</code></p> </li> </ol>","location":"apim/installation-guide/upgrades/3.13.2/readme/#gateway"},{"title":"Breaking changes","text":"","location":"apim/installation-guide/upgrades/3.14.0/readme/"},{"title":"Gateway","text":"<p>From with this version, the name of the APIM Gateway component changes. As a consequence:</p> <ol> <li> <p>The APIM Gateway component available on     https://download.gravitee.io is now     <code>gravitee-*apim-gateway*-x.y.z.zip</code> instead of     <code>gravitee-gateway-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Gateway folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim-gateway*-x.y.z</code> instead of     <code>graviteeio-gateway-x.y.z</code></p> </li> </ol>","location":"apim/installation-guide/upgrades/3.14.0/readme/#gateway"},{"title":"Gateway bridge upgrade","text":"<p>On hybrid architectures where gateway bridge feature is enabled, gateways have to be upgraded in this order :</p> <ol> <li> <p>The bridge server gateway</p> </li> <li> <p>The bridge client gateway</p> </li> </ol> <p>More information on the gateway bridge feature can be found here.</p>","location":"apim/installation-guide/upgrades/3.14.0/readme/#gateway-bridge-upgrade"},{"title":"Elastic Search reporter plugins configuration","text":"<p>Before Gravitee 3.14 :</p> <ul> <li> <p>For ES&gt;=7, GeoIp and UserAgent plugins are enabled by default in     Gravitee, and can\u2019t be disabled</p> </li> <li> <p>For ES&lt;7, those plugins are disabled by default and can be     enabled in Gravitee configuration.</p> </li> </ul> <p>Since Gravitee 3.14, it behave the same way for all ES versions : GeoIp and UserAgent plugins are be enabled by default, and can be disabled by overriding default <code>reporters.elasticsearch.pipeline.plugins.ingest</code> configuration.</p> <p>If your Gravitee configuration enables a plugin which is not available on your ES instance, you will get this kind of error message on gateway startup :</p> <p><code>Unable to create ES pipeline 'gravitee_pipeline': status[400] response[{\"error\":{\"root_cause\":[{\"reason\":\"No processor type exists with name [geoip]\",\"processor_type\":\"geoip\"}]</code></p> <p>And then, you have to override <code>reporters.elasticsearch.pipeline.plugins.ingest</code> default configuration, to remove unrelevant plugin.</p>","location":"apim/installation-guide/upgrades/3.14.0/readme/#elastic-search-reporter-plugins-configuration"},{"title":"Breaking Change","text":"","location":"apim/installation-guide/upgrades/3.15.0/readme/"},{"title":"Management API","text":"<p>Since they were deprecated since version 3.12.0, the Rest API endpoints listed below have been removed.</p>        <p>Removed Endpoint</p> <p>Replace With</p>   <p>PUT /apis/{api.id}/keys/{apiKey.key}</p> <p>PUT /apis/{api.id}/subscriptions/{subscription.id}/apikeys/{apiKey.id}</p>   <p>DELETE /apis/{api.id}/keys/{apiKey.key}</p> <p>DELETE /apis/{api.id}/subscriptions/{subscription.id}/apikeys/{apiKey.id}</p>   <p>POST /apis/{api.id}/keys/_verify?apiKey={apiKey.key}</p> <p>GET /apis/{api.id}/subscriptions/_canCreate?application={application.id}&amp;key={apiKey.key}</p>   <p>DELETE /apis/{api.id}/subscriptions/{subscription.id}/keys/{apiKey.key}</p> <p>DELETE /apis/{api.id}/subscriptions/{subscription.id}/apikeys/{apiKey.id}</p>   <p>GET /apis/{api.id}/subscriptions/{subscription.id}/keys</p> <p>GET /apis/{api.id}/subscriptions/{subscription.id}/apikeys</p>   <p>POST /apis/{api.id}/subscriptions/{subscription.id}</p> <p>POST /apis/{api.id}/subscriptions/{subscription.id}/apikeys/_renew</p>   <p>POST /apis/{api.id}/subscriptions/{subscription.id}/keys/{apiKey.key}/_reactivate</p> <p>POST /apis/{api.id}/subscriptions/{subscription.id}/apikeys/{apiKey.id}/_reactivate</p>   <p>GET /applications/{application.id}/subscriptions/{subscription.id}/keys</p> <p>GET /applications/{application.id}/subscriptions/{subscription.id}/apikeys</p>   <p>POST /applications/{application.id}/subscriptions/{subscription.id}</p> <p>POST /applications/{application.id}/subscriptions/{subscription.id}/apikeys/_renew</p>   <p>DELETE /applications/{application.id}/subscriptions/{subscription.id}/keys/{apiKey.key}</p> <p>DELETE /applications/{application.id}/subscriptions/{subscription.id}/apikeys/{apiKey.id}</p>","location":"apim/installation-guide/upgrades/3.15.0/readme/#management-api"},{"title":"Deprecation of path-based API creation","text":"<p>The path-based approach to create APIs will be removed in our next LTS and has been deprecated. From now on, this mode is disabled by default but can still be re-activated from your organization settings.</p>","location":"apim/installation-guide/upgrades/3.15.0/readme/#deprecation-of-path-based-api-creation"},{"title":"Gateway","text":"","location":"apim/installation-guide/upgrades/3.15.0/readme/#gateway"},{"title":"Custom policy breaking changes","text":"<p>We\u2019ve made huge improvements on the v3.15.0 in order to considerably decrease the memory and cpu resources required to serve the traffic on the gateway. For that, we rework some parts of the gateway which have impacts on few policies we maintain and could have impact on your custom policies you may have developed.</p> <p>To summarize, here is the short list of the possible breaking changes that could impact you:</p> <ol> <li> <p>Rework the way request and response headers are internally managed</p> </li> <li> <p>Policy class loading</p> </li> </ol> <p>Details on each breaking changes are given below.</p> <p>All policies maintained by Gravitee\u2019s teams are already ready to work with APIM v3.15.0. You may consider upgrading your custom policies if they match one of the following cases:</p> <ul> <li> <p>Your policy relies on a static object instance that was previously     instantiated per api and will become shared starting from the     v3.15.0 of APIM</p> </li> <li> <p>Your policy manipulate request or response headers and should move     to new way to manage headers.</p> </li> </ul> <p>For each of these cases, please find the appropriate actions below.</p>","location":"apim/installation-guide/upgrades/3.15.0/readme/#custom-policy-breaking-changes"},{"title":"Http headers","text":"<p>Starting from 3.15.0 we rework the way the request and response headers are manage to make them even performant than ever.</p> <p>For that reason, if your custom policy relies on headers make sure to upgrade it by replacing <code>io.gravitee.common.http.HttpHeaders</code> with the new headers class <code>io.gravitee.gateway.api.http.HttpHeaders</code> and migrate the few methods where name changed a bit:</p> <ul> <li> <p><code>new HttpHeaders()</code> \u2192 <code>HttpHeaders.create()</code></p> </li> <li> <p><code>headers.containsKey(\"key\")</code> \u2192 <code>headers.contains(\"key\")</code></p> </li> <li> <p><code>headers.get(\"key\")</code> \u2192 <code>headers.getAll(\"key\")</code> (previous get     returned a list)</p> </li> </ul>","location":"apim/installation-guide/upgrades/3.15.0/readme/#http-headers"},{"title":"Policy class loading","text":"<p>We\u2019ve made huge improvements on the v3.15.0 by reworking the way policies are loaded when deploying an api on the APIM gateway. While previously, one ClassLoader were instantiated per deployed api, we decided to shift to a single ClassLoader instance to avoid memory pressure, especially when deploying a lot of apis. Also, policy instances are now reused across all the requests instead of re-instantiate them on each call.</p> <p>For that, we had to adapt some policies we support in order to make sure they work with the new class loading and policy instantiation mechanisms. Basically, policy instances are now considered as fully stateless and must get rid of any state which cannot be shared across the whole platform.</p> <p>All the policies we support were already stateless. However, few changes have been made on some of them to move from static maps to cache instances that can be safely accessed and revoked concurrently.</p> <p>For all custom policies you may have developed, we strongly recommend adopting the same strategy by avoiding usage of static instances in your policies. If you are unable to adapt your policy before the migration to v3.15.0, there is still the possibility to explicitly switch back to the previous class loading behavior by setting the following configuration:</p> <p>```yaml classloader: legacy: enabled: true ```</p> <p>We highly recommend adopting the new class loading strategy as soon as possible as it may not be maintained in the future versions.</p>","location":"apim/installation-guide/upgrades/3.15.0/readme/#policy-class-loading"},{"title":"Breaking changes","text":"","location":"apim/installation-guide/upgrades/3.15.14/readme/"},{"title":"API key and JWT plans","text":"<p>The security chain (the internal process that selects the executable plan for the incoming request and applies the related security rules) parses all active plans to select and execute the relevant one.</p> <p>Prior to this version:</p> <ul> <li> <p>The API key plan was executed if the request contained an API key.</p> </li> <li> <p>The JWT plan was executed if the request contained a Bearer token.</p> </li> </ul> <p>From this version:</p> <p>The security chain has been improved to select and execute plans more efficiently. As a result, API keys and JWT plans are now only executed if there is an active subscription related to the provided security token. If there is no relevant subscription, the currently parsed plans are not executed and the security chain moves to parse the next available plans. The process continues until the security chain parses plans related to the provided security token and these plans are executed, or until all available plans are parsed without a match.</p> <p>Specific examples of this change are provided in the table below:</p>          <p>API plans</p> <p>Request</p> <p>Prior to this version</p> <p>From this version</p>   <p>API key plan + Keyless plan</p> <p>Request contains an invalid API key</p> <p>API key plan is executed = HTTP 401 unauthorized</p> <p>Keyless plan is executed</p>   <p>JWT plan 1 + JWT plan 2</p> <p>Request contains a Bearer token valid for JWT plan 2</p> <p>JWT plan 1 is executed = HTTP 401 unauthorized</p> <p>JWT plan 2 is executed</p>","location":"apim/installation-guide/upgrades/3.15.14/readme/#api-key-and-jwt-plans"},{"title":"Breaking Change","text":"","location":"apim/installation-guide/upgrades/3.15.6/readme/"},{"title":"Docker Images - Enterprise Edition","text":"<p>To reduce the number of security vulnerabilities and ensure a better maintenance in the future, the base Docker images used for the Enterprise Edition have changed.</p> <p>As of 3.15.6, APIM Gateway EE and Management API EE base Docker images are moving from Ubuntu to Alpine with JDK 17. It means users creating their own Docker images based on the one provided by Gravitee.io might need to update their Dockerfile to make them compatible with the Alpine distribution.</p> <p>Notes: Community Edition users will not be affected as the base images were already Alpine ones.</p>","location":"apim/installation-guide/upgrades/3.15.6/readme/#docker-images-enterprise-edition"},{"title":"Breaking changes","text":"<p>From this version, and for the next 3.15.x versions, the name of the Elasticsearch repository component changes. As a consequence, the Elasticsearch repository component available on https://download.gravitee.io is now <code>gravitee-*apim*-repository-elasticsearch-x.y.z.zip</code></p> <p>instead of <code>gravitee-repository-elasticsearch-x.y.z.zip</code></p> <p>This plugin has also been moved in another folder: https://download.gravitee.io/#graviteeio-apim/plugins/repositories/gravitee-apim-repository-elasticsearch/.</p> <p>You can download directly the Elasticsearch repository using this link: https://download.gravitee.io/graviteeio-apim/plugins/repositories/gravitee-apim-repository-elasticsearch/gravitee-apim-repository-elasticsearch-3.15.9.zip</p>","location":"apim/installation-guide/upgrades/3.15.9/readme/"},{"title":"API definition import process changes","text":"<p>Gravitee 3.16.0 introduces a new crossId in API definition, which identifies entities across environments. This improves the API import and promotion processes reliability.</p> <p>If you are using the API import from JSON definition feature, we highly recommend updating your API definitions by re-exporting your API.</p> <p>Otherwise, if you import an API definition which doesn\u2019t contain crossId, Gravitee will do the best-effort to import your API definition without it.</p>","location":"apim/installation-guide/upgrades/3.16.0/readme/"},{"title":"Deprecations","text":"<p>The Rest API endpoints listed below are deprecated since Gravitee v3.0.9, and will be removed in a future version.</p>        <p>Deprecated Endpoint</p> <p>Replace With</p>   <p>POST /apis/{api.id}/import</p> <p>POST /apis/import</p>   <p>POST /apis/{api.id}/import/swagger</p> <p>PUT /apis/{api.id}/import/swagger</p>","location":"apim/installation-guide/upgrades/3.16.0/readme/#deprecations"},{"title":"Breaking Change","text":"","location":"apim/installation-guide/upgrades/3.16.2/readme/"},{"title":"Docker Images - Enterprise Edition","text":"<p>To reduce the number of security vulnerabilities and ensure a better maintenance in the future, the base Docker images used for the Enterprise Edition have changed.</p> <p>As of 3.16.2, APIM Gateway EE and Management API EE base Docker images are moving from Ubuntu to Alpine with JDK 17. It means users creating their own Docker images based on the one provided by Gravitee.io might need to update their Dockerfile to make them compatible with the Alpine distribution.</p> <p>Notes: Community Edition users will not be affected as the base images were already Alpine ones.</p>","location":"apim/installation-guide/upgrades/3.16.2/readme/#docker-images-enterprise-edition"},{"title":"Breaking changes","text":"<p>From this version, and for the next 3.17.x versions, the name of the Elasticsearch repository component changes. As a consequence, the Elasticsearch repository component available on https://download.gravitee.io is now <code>gravitee-*apim*-repository-elasticsearch-x.y.z.zip</code></p> <p>instead of <code>gravitee-repository-elasticsearch-x.y.z.zip</code></p> <p>This plugin has also been moved in another folder: https://download.gravitee.io/#graviteeio-apim/plugins/repositories/gravitee-apim-repository-elasticsearch/.</p> <p>You can download directly the Elasticsearch repository using this link: https://download.gravitee.io/graviteeio-apim/plugins/repositories/gravitee-apim-repository-elasticsearch/gravitee-apim-repository-elasticsearch-3.16.5.zip</p>","location":"apim/installation-guide/upgrades/3.16.5/readme/"},{"title":"Breaking Changes","text":"","location":"apim/installation-guide/upgrades/3.17.0/readme/"},{"title":"Management API Documentation","text":"<p>From this version, APIM\u2019s Management API documentation is now using OpenAPI v3 format, instead of the old Swagger v2 format.</p> <p>As a consequence, the specification of this API is now accessible from:</p> <ul> <li> <p><code>{host:port}/management/openapi.yaml</code></p> </li> <li> <p><code>{host:port}/management/openapi.json</code></p> </li> </ul> <p>To allow a smooth transition, the old URL (<code>{host:port}/management/swagger.json</code>) will remain available until 3.18.0.</p>","location":"apim/installation-guide/upgrades/3.17.0/readme/#management-api-documentation"},{"title":"Docker Images - Enterprise Edition","text":"<p>To reduce the number of security vulnerabilities and ensure a better maintenance in the future, the base Docker images used for the Enterprise Edition have changed.</p> <p>As of 3.17.0, APIM Gateway EE and Management API EE base Docker images are moving from Ubuntu to Alpine with JDK 17. It means users creating their own Docker images based on the one provided by Gravitee.io might need to update their Dockerfile to make them compatible with the Alpine distribution.</p> <p>Notes: Community Edition users will not be affected as the base images were already Alpine ones.</p>","location":"apim/installation-guide/upgrades/3.17.0/readme/#docker-images-enterprise-edition"},{"title":"Upgrade Order","text":"<p>In order to achieve a 0 downtime upgrade, APIM has to be upgraded before upgrading the gateways.</p> <p>On hybrid architectures where gateway bridge feature is enabled, gateways have to be upgraded in this order :</p> <ol> <li> <p>The bridge server gateway</p> </li> <li> <p>The bridge client gateway</p> </li> </ol>","location":"apim/installation-guide/upgrades/3.17.0/readme/#upgrade-order"},{"title":"Deprecated Bridge Endpoints","text":"<p>Since bridge client rely on their own internals to fulfil API key requests, the ``/apis/{api.id}/keys/{api.key}`` endpoint has been deprecated on the bridge server and will be removed in a future version.</p> <p>The ``/keys/_search`` endpoint has been deprecated and replaced with ``/keys/_findByCriteria`` endpoint. It will be removed in a future version.</p> <p>More information on the gateway bridge feature can be found here.</p>","location":"apim/installation-guide/upgrades/3.17.0/readme/#deprecated-bridge-endpoints"},{"title":"The mongodb upgrade scripts have been moved","text":"<p>For the sake of improving our documentation management process, we have started decommissioning our release repository (which contained among other things this guide).</p> <p>As a part of this change, our mongodb upgrade scripts are not hosted inside the release repository anymore and have been moved to the gravitee-api-management repository.</p>","location":"apim/installation-guide/upgrades/3.17.0/readme/#the-mongodb-upgrade-scripts-have-been-moved"},{"title":"MongoDB","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.17.0/api-keys-cleanup.js This script performs some cleanup on the keys collection in order to avoid issues while moving to the new model.</p>","location":"apim/installation-guide/upgrades/3.17.0/readme/#mongodb"},{"title":"Breaking changes","text":"<p>From this version, and for the next 3.17.x versions, the name of the Elasticsearch repository component changes. As a consequence, the Elasticsearch repository component available on https://download.gravitee.io is now  </p> <p><code>gravitee-*apim*-repository-elasticsearch-x.y.z.zip</code> </p> <p>instead of  </p> <p><code>gravitee-repository-elasticsearch-x.y.z.zip</code></p> <p>This plugin has also been moved in another folder: https://download.gravitee.io/#graviteeio-apim/plugins/repositories/gravitee-apim-repository-elasticsearch/.  </p> <p>You can download directly the Elasticsearch repository using this link: https://download.gravitee.io/graviteeio-apim/plugins/repositories/gravitee-apim-repository-elasticsearch/gravitee-apim-repository-elasticsearch-3.17.3.zip</p>","location":"apim/installation-guide/upgrades/3.17.3/readme/"},{"title":"Breaking changes","text":"","location":"apim/installation-guide/upgrades/3.18.0/readme/"},{"title":"Environment Audits","text":"<p>Endpoint: <code>[GET] management/organizations/{orgId}/environments/{envId}/apis/{api}/audit</code> (link:{{ /apim/3.x/management-api/ | relative_url | append: current_version | append: /index.html#operation/getApiAudits }}[API audits^]).</p> <p>Before this version, the Management API allowed getting all audits of all environments and organizations with this endpoint.</p> <p>As of 3.18.0, a GET request will return the audits of the environment specified in the url and no longer return organization audits. To get organization audits you need to use the following endpoint: <code>[GET] management/organizations/{orgId}/audit</code>.</p> <p>The query params <code>envLog:boolean</code> &amp; <code>orgLog:boolean</code> are removed. Now to get only environment or organization audit you have to use the query params <code>referenceType:string</code> with <code>ENVIRONMENT</code> or <code>ORGANIZATION</code>. You can also filter by environment id with <code>environment:string</code> query params.</p>","location":"apim/installation-guide/upgrades/3.18.0/readme/#environment-audits"},{"title":"Platform alerts on multi-environments APIM","text":"<p>Before this version, platform alerts were common to all environments. That led to inconsistencies while handling platform alerts on multi-environments APIM.</p> <p>From this version, platform alerts are scoped to the environment. For example, if you create an alert on your <code>production</code> environment, it is related only to this environment.</p> <p>Old platform alerts existing before Gravitee upgrade will be linked to the default environment. You will see them disappear from your others (non-default) environments, and will have to recreate them manually if relevant.</p>","location":"apim/installation-guide/upgrades/3.18.0/readme/#platform-alerts-on-multi-environments-apim"},{"title":"System Roles Edition","text":"<p>To provide more flexibility in the way roles are managed, some system roles have been made editable. From now on, the permissions of the following roles can be edited:</p> <ol> <li> <p>The Environment Admin Role.</p> </li> <li> <p>The API Primary Owner Role</p> </li> <li> <p>The Application Primary Owner Role</p> </li> </ol> <p>The Organization Admin Role remains a read-only role. If any accidental loss of access happened to one of the roles listed above, the Organization Admin Role will be the only one able to revert the changes.</p> <p>This mode is deactivated by default, you can toggle it on via <code>gravitee.yml</code> :</p> <pre><code>console:\n  systemRoleEdition:\n    enabled: true\n</code></pre> <p>Updating permissions for system roles should be done carefully to avoid any unexpected behavior.</p>","location":"apim/installation-guide/upgrades/3.18.0/readme/#system-roles-edition"},{"title":"Plugin renaming","text":"<p>From this version, and for the next 3.18.x versions and greater, the name of the Elasticsearch repository component changes. As a consequence, the Elasticsearch repository component available on https://download.gravitee.io is now <code>gravitee-*apim*-repository-elasticsearch-x.y.z.zip</code></p> <p>instead of <code>gravitee-repository-elasticsearch-x.y.z.zip</code></p> <p>This plugin has also been moved in another folder: https://download.gravitee.io/#graviteeio-apim/plugins/repositories/gravitee-apim-repository-elasticsearch/.</p> <p>You can download directly the Elasticsearch repository using this link: https://download.gravitee.io/graviteeio-apim/plugins/repositories/gravitee-apim-repository-elasticsearch/gravitee-apim-repository-elasticsearch-3.18.0.zip</p>","location":"apim/installation-guide/upgrades/3.18.0/readme/#plugin-renaming"},{"title":"MySQL","text":"<p>In 3.18.0, the MySQL Java driver has been updated to 8.0.29. As a consequence, TLS 1.0 and 1.1 are no longer supported.</p>","location":"apim/installation-guide/upgrades/3.18.0/readme/#mysql"},{"title":"Plans data","text":"<p>Since this version, APIM improves plans data storage, and uses the <code>plans</code> database collection as the unique source of plans data.</p> <p>Before trusting data in <code>plans</code> collection, we have to ensure their reliability.</p> <p>In 3.10, an upgrader was introduced to fix data, but was running in dry-run mode per default.</p> <p>This upgrader will run once again during APIM 3.18 startup, with dry-run mode disabled : if relevant, it will fix plans data in your database as it\u2019s explained in this documentation</p>","location":"apim/installation-guide/upgrades/3.18.0/readme/#plans-data"},{"title":"Breaking changes","text":"","location":"apim/installation-guide/upgrades/3.18.5/readme/"},{"title":"Portal API","text":"<p>Endpoint: <code>[GET] portal/environments/{envId}/applications</code>.</p> <p>For performance reasons, calling <code>/applications?size=-1</code> will no longer return the number of subscribers and the only information available in the owner of each application will be:</p> <ul> <li> <p>id</p> </li> <li> <p>displayName</p> </li> <li> <p>email</p> </li> </ul>","location":"apim/installation-guide/upgrades/3.18.5/readme/#portal-api"},{"title":"Breaking changes","text":"","location":"apim/installation-guide/upgrades/3.18.7/readme/"},{"title":"API key and JWT plans","text":"<p>The security chain (the internal process that selects the executable plan for the incoming request and applies the related security rules) parses all active plans to select and execute the relevant one.</p> <p>Prior to this version:</p> <ul> <li> <p>The API key plan was executed if the request contained an API key.</p> </li> <li> <p>The JWT plan was executed if the request contained a Bearer token.</p> </li> </ul> <p>From this version:</p> <p>The security chain has been improved to select and execute plans more efficiently. As a result, API keys and JWT plans are now only executed if there is an active subscription related to the provided security token. If there is no relevant subscription, the currently parsed plans are not executed and the security chain moves to parse the next available plans. The process continues until the security chain parses plans related to the provided security token and these plans are executed, or until all available plans are parsed without a match.</p> <p>Specific examples of this change are provided in the table below:</p>          <p>API plans</p> <p>Request</p> <p>Prior to this version</p> <p>From this version</p>   <p>API key plan + Keyless plan</p> <p>Request contains an invalid API key</p> <p>API key plan is executed = HTTP 401 unauthorized</p> <p>Keyless plan is executed</p>   <p>JWT plan 1 + JWT plan 2</p> <p>Request contains a Bearer token valid for JWT plan 2</p> <p>JWT plan 1 is executed = HTTP 401 unauthorized</p> <p>JWT plan 2 is executed</p>","location":"apim/installation-guide/upgrades/3.18.7/readme/#api-key-and-jwt-plans"},{"title":"Breaking Changes","text":"","location":"apim/installation-guide/upgrades/3.2.0/readme/"},{"title":"Portal UI","text":"<p>The variables css of <code>gv-link</code> component has been modified to improve the theme\u2019s customization. Now the component uses :</p> <ul> <li> <p>Active border color <code>--gv-link-active--bdc</code> instead of Active border     bottom color <code>--gv-link-active--bdbc</code></p> </li> <li> <p>Active border style <code>--gv-link-active--bds</code> instead of Active border     bottom style <code>--gv-link-active--bdbs</code></p> </li> <li> <p>Active border width <code>--gv-link-active--bdw</code> instead of Active border     bottom width <code>--gv-link-active--bdbw</code></p> </li> </ul> <p>For example, if you has set <code>--gv-link-active--bdbw=3px</code>, now you should set <code>--gv-link-active--bdw=0 0 3px 0</code></p>","location":"apim/installation-guide/upgrades/3.2.0/readme/#portal-ui"},{"title":"Repository","text":"","location":"apim/installation-guide/upgrades/3.3.0/readme/"},{"title":"Mongodb","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.3.0/1-update-users-and-identityProviders.js This script replaces referenceId and referenceType with organizationId for <code>users</code> and <code>identity_providers</code> collections.</p> <p>/apim/3.x/mongodb/3.3.0/2-update-json-validation-policy-scopes.js This script replaces REQUEST and RESPONSE with REQUEST_CONTENT and RESPONSE_CONTENT for json-validation policy configuration in <code>apis</code> collections.</p>","location":"apim/installation-guide/upgrades/3.3.0/readme/#mongodb"},{"title":"Deprecation","text":"","location":"apim/installation-guide/upgrades/3.3.0/readme/#deprecation"},{"title":"Management API","text":"<p>Starting with this version, <code>User</code> and <code>IdentityProvider</code> are now linked to an organization and not to an environment. As a consequence, the Management REST API has been updated. If you are using the REST API directly, please note that you should adapt your URL for these resources as they will no longer be accessible from version 4.x In the meantime, these resources will be tagged as <code>Deprecated</code>.</p>        Deprecated in 3.3.0, deleted in 4.x Since 3.3.0         <p>/organizations/DEFAULT/environments/DEFAULT/configuration/identities</p> <p>/organizations/DEFAULT/configuration/identities</p>       <p>/organizations/DEFAULT/environments/DEFAULT/configuration/rolescopes</p> <p>/organizations/DEFAULT/configuration/rolescopes</p>                   <p>/organizations/DEFAULT/environments/DEFAULT/search/users</p> <p>/organizations/DEFAULT/search/users</p>   <p>/organizations/DEFAULT/environments/DEFAULT/user</p> <p>/organizations/DEFAULT/user</p>   <p>/organizations/DEFAULT/environments/DEFAULT/user/subscribeNewsletter</p> <p>/organizations/DEFAULT/user/subscribeNewsletter</p>   <p>/organizations/DEFAULT/environments/DEFAULT/user/avatar</p> <p>/organizations/DEFAULT/user/avatar</p>   <p>/organizations/DEFAULT/environments/DEFAULT/user/login</p> <p>/organizations/DEFAULT/user/login</p>   <p>/organizations/DEFAULT/environments/DEFAULT/user/logout</p> <p>/organizations/DEFAULT/user/logout</p>   <p>/organizations/DEFAULT/environments/DEFAULT/user/tasks</p> <p>/organizations/DEFAULT/user/tasks</p>   <p>/organizations/DEFAULT/environments/DEFAULT/user/tags</p> <p>/organizations/DEFAULT/user/tags</p>   <p>/organizations/DEFAULT/environments/DEFAULT/user/notifications</p> <p>/organizations/DEFAULT/user/notifications</p>   <p>/organizations/DEFAULT/environments/DEFAULT/user/tokens</p> <p>/organizations/DEFAULT/user/tokens</p>       <p>/organizations/DEFAULT/environments/DEFAULT/users</p> <p>/organizations/DEFAULT/users</p>                               <p>/organizations/DEFAULT/environments/DEFAULT/users/registration</p> <p>/organizations/DEFAULT/users/registration</p>   <p>/organizations/DEFAULT/environments/DEFAULT/users/registration/finalize</p> <p>/organizations/DEFAULT/users/registration/finalize</p>","location":"apim/installation-guide/upgrades/3.3.0/readme/#management-api"},{"title":"Repository","text":"","location":"apim/installation-guide/upgrades/3.4.0/readme/"},{"title":"Mongodb","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.4.0/1-update-audit-to-replace-PORTAL-with_ORGANIZATION-and-ENVIRONMENT.js This script convert PORTAL audit into ENVIRONMENT audits or ORGANIZATION audits regarding some conditions.</p> <p>/apim/3.x/mongodb/3.4.0/2-update-default-role-REVIEWER.js This script add new permissions to the default REVIEWER role.</p>","location":"apim/installation-guide/upgrades/3.4.0/readme/#mongodb"},{"title":"Breaking Changes","text":"","location":"apim/installation-guide/upgrades/3.5.0/readme/"},{"title":"Environment variables","text":"<p>Some environment variables have been doubled for the portal and the console, see correspondence table:</p>         <p>before 3.5.0</p> <p>after 3.5.0 (for portal)</p> <p>after 3.5.0 (for console)</p>   <p>authentication.localLogin.enabled</p> <p>portal.authentication.localLogin.enabled</p> <p>console.authentication.localLogin.enabled</p>   <p>scheduler.tasks</p> <p>portal.scheduler.tasks</p> <p>console.scheduler.tasks</p>   <p>scheduler.notifications</p> <p>portal.scheduler.notifications</p> <p>console.scheduler.notifications</p>   <p>reCaptcha.enabled</p> <p>portal.reCaptcha.enabled</p> <p>console.reCaptcha.enabled</p>   <p>reCaptcha.siteKey</p> <p>portal.reCaptcha.siteKey</p> <p>console.reCaptcha.siteKey</p>   <p>portal.support.enabled</p> <p>portal.support.enabled</p> <p>console.support.enabled</p>   <p>portal.userCreation.enabled</p> <p>portal.userCreation.enabled</p> <p>console.userCreation.enabled</p>   <p>portal.userCreation.automaticValidation.enabled</p> <p>portal.userCreation.automaticValidation.enabled</p> <p>console.userCreation.automaticValidation.enabled</p>   <p>http.cors.allow-origin</p> <p>portal.http.cors.allow-origin</p> <p>console.http.cors.allow-origin</p>   <p>http.cors.allow-headers</p> <p>portal.http.cors.allow-headers</p> <p>console.http.cors.allow-headers</p>   <p>http.cors.allow-methods</p> <p>portal.http.cors.allow-methods</p> <p>console.http.cors.allow-methods</p>   <p>http.cors.exposed-headers</p> <p>portal.http.cors.exposed-headers</p> <p>console.http.cors.exposed-headers</p>   <p>http.cors.max-age</p> <p>portal.http.cors.max-age</p> <p>console.http.cors.max-age</p>","location":"apim/installation-guide/upgrades/3.5.0/readme/#environment-variables"},{"title":"Distribution","text":"<p>From this version, Gravitee.IO APIM is distributed with MongoDB and JDBC plugins, as well as Hybrid HTTP plugin (gateway-bridge-http), in the <code>full</code> ZIP. You no longer have to choose between the \"full\" or \"full-jdbc\" ZIP file.</p>","location":"apim/installation-guide/upgrades/3.5.0/readme/#distribution"},{"title":"Repository","text":"","location":"apim/installation-guide/upgrades/3.5.0/readme/#repository"},{"title":"Mongodb","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.5.01-duplicate-some-parameters-for-console.js This script duplicates some parameters for the console to have different behaviors between portal and console. It also modifies the _id of each mongo document to add referenceId and referenceType.</p>","location":"apim/installation-guide/upgrades/3.5.0/readme/#mongodb"},{"title":"Breaking Changes","text":"","location":"apim/installation-guide/upgrades/3.5.11/readme/"},{"title":"Management API","text":"<p>If you are using the REST API directly, please note that now these requests need authentication:</p>","location":"apim/installation-guide/upgrades/3.5.11/readme/#management-api"},{"title":"-","text":"","location":"apim/installation-guide/upgrades/3.5.11/readme/#-"},{"title":"-","text":"","location":"apim/installation-guide/upgrades/3.5.11/readme/#-_1"},{"title":"-","text":"","location":"apim/installation-guide/upgrades/3.5.11/readme/#-_2"},{"title":"-","text":"","location":"apim/installation-guide/upgrades/3.5.11/readme/#-_3"},{"title":"Repository","text":"","location":"apim/installation-guide/upgrades/3.5.14/readme/"},{"title":"Mongodb","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.5.14/1-fix-cors-env-vars.js This script migrate CORS environment variables for portal and console. (See below).</p>","location":"apim/installation-guide/upgrades/3.5.14/readme/#mongodb"},{"title":"Breaking Changes","text":"","location":"apim/installation-guide/upgrades/3.5.14/readme/#breaking-changes"},{"title":"Environment variables","text":"<p>Some environment variables have been doubled for the portal and the console, see correspondence table:</p>         <p>before 3.5.14</p> <p>after 3.5.14 (for portal)</p> <p>after 3.5.14 (for console)</p>   <p>portal.http.cors.allow-origin</p> <p>http.api.portal.cors.allow-origin</p> <p>X</p>   <p>console.http.cors.allow-origin</p> <p>X</p> <p>http.api.management.cors.allow-origin</p>   <p>portal.http.cors.allow-headers</p> <p>http.api.portal.cors.allow-headers</p> <p>X</p>   <p>console.http.cors.allow-headers</p> <p>X</p> <p>http.api.management.cors.allow-header</p>   <p>portal.http.cors.allow-methods</p> <p>http.api.portal.cors.allow-methods</p> <p>X</p>   <p>console.http.cors.allow-methods</p> <p>X</p> <p>http.api.management.cors.allow-methods</p>   <p>portal.http.cors.exposed-headers</p> <p>http.api.portal.cors.exposed-headers</p> <p>X</p>   <p>console.http.cors.exposed-headers</p> <p>X</p> <p>http.api.management.cors.exposed-headers</p>   <p>portal.http.cors.max-age</p> <p>http.api.portal.cors.max-age</p> <p>X</p>   <p>console.http.cors.max-age</p> <p>X</p> <p>http.api.management.cors.max-age</p>","location":"apim/installation-guide/upgrades/3.5.14/readme/#environment-variables"},{"title":"Breaking changes","text":"<p>From with this version, the name of some components of Gravitee.io APIM changes. As a consequence, the following plugins are renamed :</p>        <p>before 3.5.18</p> <p>after 3.5.18</p>   <p>gravitee.repository.mongodb-3.5.x.zip</p> <p>gravitee.apim.repository.mongodb-3.5.x.zip</p>   <p>gravitee.repository.jdbc-3.5.x.zip</p> <p>gravitee.apim.repository.jdbc-3.5.x.zip</p>   <p>gravitee.repository.redis-3.5.x.zip</p> <p>gravitee.apim.repository.redis-3.5.x.zip</p>   <p>gravitee.repository.hazelcast-3.5.x.zip</p> <p>gravitee.apim.repository.hazelcast-3.5.x.zip</p>   <p>gravitee.repository.gateway.bridge.http.client-3.5.x.zip</p> <p>gravitee.apim.repository.gateway.bridge.http.client-3.5.x.zip</p>   <p>gravitee.repository.gateway.bridge.http.server-3.5.x.zip</p> <p>gravitee.apim.repository.gateway.bridge.http.server-3.5.x.zip</p>    <p>These plugins have also been moved in another folder on https://download.gravitee.io. For instance, the MongoDB plugin is now available using this link:</p> <p>https://download.gravitee.io/graviteeio-apim/plugins/repositories/gravitee-apim-repository-mongodb/gravitee-apim-repository-mongodb-3.5.18.zip</p> <p>In future versions, others plugins will be renamed. Stay tuned!</p>","location":"apim/installation-guide/upgrades/3.5.18/readme/"},{"title":"Breaking changes","text":"","location":"apim/installation-guide/upgrades/3.5.19/readme/"},{"title":"Threat protection policies","text":"<p>From this version, configuration form for JSON Threat Protection Policy and XML Threat Protection Policy changes: <code>null</code> is no longer authorized, only <code>-1</code> is accepted for a no limit setting.</p>","location":"apim/installation-guide/upgrades/3.5.19/readme/#threat-protection-policies"},{"title":"Impacts","text":"<ul> <li> <p>If some fields are set to <code>null</code> in your db, and if you want to edit     this policy configuration through APIM Console, then the form     will replace them by the default value. Please, be careful when     updating your policy if you do not want the default values to be     applied.</p> </li> <li> <p>If some fields are set to <code>null</code> in your db, and if you want to edit     this policy configuration through REST API, an error message     will appear if you do not set an explicit value for those fields in     your request payload.</p> </li> </ul>","location":"apim/installation-guide/upgrades/3.5.19/readme/#impacts"},{"title":"Management Rest API","text":"<p>From with this version, the name of the APIM Rest APIs component changes. As a consequence:</p> <ol> <li> <p>The APIM Rest API component available on     https://download.gravitee.io is now     <code>gravitee-*apim*-rest-api-x.y.z.zip</code> instead of     <code>gravitee-management-rest-api-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Rest API folder within the full distribution     zip file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim*-rest-api-x.y.z</code> instead of     <code>graviteeio-rest-api-x.y.z</code></p> </li> </ol> <p>In future versions, others plugins &amp; components might be renamed. Stay tuned!</p>","location":"apim/installation-guide/upgrades/3.5.19/readme/#management-rest-api"},{"title":"Improvements","text":"<p>Some performance improvements have been made (#6066). As a consequence, the scheduled service used to automatically close expired subscriptions now runs every hour instead of every 5 seconds</p>","location":"apim/installation-guide/upgrades/3.5.19/readme/#improvements"},{"title":"Repository","text":"","location":"apim/installation-guide/upgrades/3.5.2/readme/"},{"title":"Mongodb","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.5.2/1-add-DEFAULT-referenceId-in-memberships.js This script add the \"DEFAULT\" <code>referenceId</code> for memberships with <code>null</code> one. This bug impacts users created when using social authentication since version 3.5.0.</p>","location":"apim/installation-guide/upgrades/3.5.2/readme/#mongodb"},{"title":"Breaking changes","text":"","location":"apim/installation-guide/upgrades/3.5.21/readme/"},{"title":"Management Web UI","text":"<p>From with this version, the name of the APIM Console component changes. As a consequence:</p> <ol> <li> <p>The APIM Console component available on     https://download.gravitee.io is now     <code>gravitee-*apim-console*-webui-x.y.z.zip</code> instead of     <code>gravitee-management-webui-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Console folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim-console*-ui-x.y.z</code> instead of     <code>graviteeio-management-ui-x.y.z</code></p> </li> </ol>","location":"apim/installation-guide/upgrades/3.5.21/readme/#management-web-ui"},{"title":"Portal Web UI","text":"<p>From with this version, the name of the APIM Portal component changes. As a consequence:</p> <ol> <li> <p>The APIM Portal component available on     https://download.gravitee.io is now     <code>gravitee-*apim*-portal-webui-x.y.z.zip</code> instead of     <code>gravitee-portal-webui-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Portal folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim*-portal-ui-x.y.z</code> instead of     <code>graviteeio-portal-ui-x.y.z</code></p> </li> </ol> <p>In future versions, others plugins &amp; components might be renamed. Stay tuned!</p>","location":"apim/installation-guide/upgrades/3.5.21/readme/#portal-web-ui"},{"title":"Breaking changes","text":"","location":"apim/installation-guide/upgrades/3.5.25/readme/"},{"title":"Gateway","text":"<p>From with this version, the name of the APIM Gateway component changes. As a consequence:</p> <ol> <li> <p>The APIM Gateway component available on     https://download.gravitee.io is now     <code>gravitee-*apim-gateway*-x.y.z.zip</code> instead of     <code>gravitee-gateway-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Gateway folder within the full distribution zip     file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim-gateway*-x.y.z</code> instead of     <code>graviteeio-gateway-x.y.z</code></p> </li> </ol>","location":"apim/installation-guide/upgrades/3.5.25/readme/#gateway"},{"title":"Elasticsearch","text":"<p>With Elasticsearch version above 7.x, <code>geoip</code> and <code>user_agent</code> plugins are automatically enabled.</p>","location":"apim/installation-guide/upgrades/3.6.0/readme/"},{"title":"APIM API","text":"<p>Two new configuration keys have been added to the <code>gravitee.yml</code> file, they should be set with the URLs of the UI console and the management API: ```yml console: ui: url: gravitee_apim_ui_url # TO UPDATE WITH YOUR OWN URL api: url: gravitee_apim_management_api_url # TO UPDATE WITH YOUR OWN URL ```</p> <p>NB: For Gravitee Cockpit to work properly these URLs are mandatory, they will be used by Cockpit to interact with your APIM installation.</p>","location":"apim/installation-guide/upgrades/3.6.0/readme/#apim-api"},{"title":"Repository","text":"<p>Since 3.7, you have the ability to configure a prefix for your tables or collections name.</p> <p>Rate limit configuration has to be defined in both Gateway and Management <code>gravitee.yml</code> files.</p> <p>With this centralized configuration, you can disable the liquibase phase of the gateway, if you do not want it to modify your dbms.</p> <p>If you choose to use prefix, follow these instructions.</p>","location":"apim/installation-guide/upgrades/3.7.0/readme/"},{"title":"Mongodb","text":"","location":"apim/installation-guide/upgrades/3.7.0/readme/#mongodb"},{"title":"New installation","text":"<p>You just have to modify the <code>gravitee.yml</code> files of gateway and console to configure <code>management.mongodb.prefix</code> and <code>ratelimit.mongodb.prefix</code>. Default value is empty.</p>","location":"apim/installation-guide/upgrades/3.7.0/readme/#new-installation"},{"title":"Migrate an existing installation","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>If you want to prefix your collections, you will have to rename them. You can use the following script.</p> <p>Check documentation at https://docs.gravitee.io/apim/3.x/apim_installguide_repositories_mongodb.html</p> <p>This script rename all the collections adding the <code>prefix</code> and <code>rateLimitPrefix</code>.</p> <p>For the following steps, we admit you choose this prefix: prefix_</p> <ol> <li> <p>Modify <code>gravitee.yml</code> to configure <code>management.mongodb.prefix</code> and     <code>ratelimit.mongodb.prefix</code> if needed.</p> </li> <li> <p>Run the following script to rename your collections:     /apim/3.x/mongodb/3.7.0/1-rename-collections-with-prefix.js</p> </li> <li> <p>Run your instances!</p> </li> </ol>","location":"apim/installation-guide/upgrades/3.7.0/readme/#migrate-an-existing-installation"},{"title":"JDBC","text":"","location":"apim/installation-guide/upgrades/3.7.0/readme/#jdbc"},{"title":"New installation","text":"<p>You just have to modify the <code>gravitee.yml</code> files of gateway and console to configure <code>management.jdbc.prefix</code> and <code>ratelimit.jdbc.prefix</code>. Default value is empty.</p>","location":"apim/installation-guide/upgrades/3.7.0/readme/#new-installation_1"},{"title":"Migrate an existing installation","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>If you want to prefix your tables, you will have to rename them. Check documentation at https://docs.gravitee.io/apim/3.x/apim_installguide_repositories_jdbc.html</p> <p>For the following steps, we admit you choose this prefix: prefix_</p> <ol> <li> <p>Modify <code>gravitee.yml</code> to configure <code>management.jdbc.prefix</code> and     <code>ratelimit.jdbc.prefix</code> if needed.</p> </li> <li> <p>Run the application on a new database to generate     <code>prefix_databasechangelog</code></p> </li> <li> <p>Replace the content of <code>databasechangelog</code> table by the generated     one from <code>prefix_databasechangelog</code></p> </li> <li> <p>Rename your tables following this syntax: prefix_tablename</p> </li> <li> <p>Rename your indexes following this syntax: idx_prefix_indexname</p> </li> <li> <p>Rename your primary keys following this syntax: pk_prefix_pkname</p> </li> <li> <p>Run your instances!</p> </li> </ol>","location":"apim/installation-guide/upgrades/3.7.0/readme/#migrate-an-existing-installation_1"},{"title":"Repository","text":"","location":"apim/installation-guide/upgrades/3.8.0/readme/"},{"title":"Mongodb","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.8.0/1-page-acl-migration.js This script replaces excluded_groups by visibility, excludedAccessControls and accessControls collection.</p>","location":"apim/installation-guide/upgrades/3.8.0/readme/#mongodb"},{"title":"Breaking changes","text":"<p>From with this version, the name of some components of Gravitee.io APIM changes. As a consequence, the following plugins are renamed :</p>        <p>before 3.8.6</p> <p>after 3.8.6</p>   <p>gravitee.repository.mongodb-3.8.x.zip</p> <p>gravitee.apim.repository.mongodb-3.8.x.zip</p>   <p>gravitee.repository.jdbc-3.8.x.zip</p> <p>gravitee.apim.repository.jdbc-3.8.x.zip</p>   <p>gravitee.repository.redis-3.8.x.zip</p> <p>gravitee.apim.repository.redis-3.8.x.zip</p>   <p>gravitee.repository.hazelcast-3.8.x.zip</p> <p>gravitee.apim.repository.hazelcast-3.8.x.zip</p>   <p>gravitee.repository.gateway.bridge.http.client-3.8.x.zip</p> <p>gravitee.apim.repository.gateway.bridge.http.client-3.8.x.zip</p>   <p>gravitee.repository.gateway.bridge.http.server-3.8.x.zip</p> <p>gravitee.apim.repository.gateway.bridge.http.server-3.8.x.zip</p>    <p>These plugins have also been moved in another folder on https://download.gravitee.io. For instance, the MongoDB plugin is now available using this link:</p> <p>https://download.gravitee.io/graviteeio-apim/plugins/repositories/gravitee-apim-repository-mongodb/gravitee-apim-repository-mongodb-3.8.6.zip</p> <p>In future versions, others plugins will be renamed. Stay tuned!</p>","location":"apim/installation-guide/upgrades/3.8.6/readme/"},{"title":"Warning","text":"<p>For JDBC users only, please don\u2019t upgrade to 3.9.0 since we detected a critical bug in a liquibase script that could lead to data loss. This will be fixed in 3.9.1. We apologize for this inconvenience.</p> <p>GitHub issue: 5711</p>","location":"apim/installation-guide/upgrades/3.9.0/readme/"},{"title":"Breaking changes","text":"<p>From this version, in order to propose a better swagger descriptor, all enum values returned by the APIM API are in uppercase.</p> <p>Lowercase and uppercase values are still accepted in incoming requests.</p>","location":"apim/installation-guide/upgrades/3.9.0/readme/#breaking-changes"},{"title":"Memory management","text":"<p>Starting from this new version, the default Xms and Xmx parameters has been fixed to 256m. Previous value was too high and does not reflect real memory usage for both the API Gateway and Management API.</p> <p>If, for some reasons, you need to increase those default values, you can set the <code>GIO_MIN_MEM</code> and <code>GIO_MAX_MEM</code> environment variables in your scripts. Those variables are then \"injected\" into the JAVA_OPTS during bootstrap.</p>","location":"apim/installation-guide/upgrades/3.9.0/readme/#memory-management"},{"title":"APIM API - Tags and Tenants","text":"<p>This version changes permissions' scope from <code>ENVIRONMENT</code> to <code>ORGANIZATION</code> for:</p> <ul> <li> <p>TAG</p> </li> <li> <p>TENANT</p> </li> <li> <p>ENTRYPOINT</p> </li> </ul> <p>These permissions are now readonly for the scope <code>ENVIRONMENT</code>. They will be deleted on version 3.10. If you are using these permissions, please update them for the scope <code>ORGANIZATION</code>.</p>","location":"apim/installation-guide/upgrades/3.9.0/readme/#apim-api-tags-and-tenants"},{"title":"Repository","text":"","location":"apim/installation-guide/upgrades/3.9.0/readme/#repository"},{"title":"Mongodb","text":"<p>Before running any script, please create a dump of your existing database.</p> <p>/apim/3.x/mongodb/3.9.0/1-tags-and-tenants-migration.js This script adds referenceId set to DEFAULT and referenceType set to ORGANIZATION to tags, tenants and entrypoint collections.</p> <p>/apim/3.x/mongodb/3.9.0/2-events-migration.js This script modifies events, so an event can be linked to more than one environment.</p>","location":"apim/installation-guide/upgrades/3.9.0/readme/#mongodb"},{"title":"Important: Alert Engine","text":"<p>For users of Gravitee Enterprise Edition with Alert Engine, please check your gravitee configuration to ensure that the alert engine feature is explictly enable. Starting from this version, the alert engine connector is disabled by default if the option <code>alerts.alert-engine-enabled</code> is missing from the gravitee.yaml. (see https://docs.gravitee.io/ae/apim_installation.html#configuration)</p>","location":"apim/installation-guide/upgrades/3.9.2/readme/"},{"title":"Breaking changes","text":"<p>From with this version, the name of some components of Gravitee.io APIM changes. As a consequence, the following plugins are renamed :</p>        <p>before 3.9.3</p> <p>after 3.9.3</p>   <p>gravitee.repository.mongodb-3.9.x.zip</p> <p>gravitee.apim.repository.mongodb-3.9.x.zip</p>   <p>gravitee.repository.jdbc-3.9.x.zip</p> <p>gravitee.apim.repository.jdbc-3.9.x.zip</p>   <p>gravitee.repository.redis-3.9.x.zip</p> <p>gravitee.apim.repository.redis-3.9.x.zip</p>   <p>gravitee.repository.hazelcast-3.9.x.zip</p> <p>gravitee.apim.repository.hazelcast-3.9.x.zip</p>   <p>gravitee.repository.gateway.bridge.http.client-3.9.x.zip</p> <p>gravitee.apim.repository.gateway.bridge.http.client-3.9.x.zip</p>   <p>gravitee.repository.gateway.bridge.http.server-3.9.x.zip</p> <p>gravitee.apim.repository.gateway.bridge.http.server-3.9.x.zip</p>    <p>These plugins have also been moved in another folder on https://download.gravitee.io. For instance, the MongoDB plugin is now available using this link:</p> <p>https://download.gravitee.io/graviteeio-apim/plugins/repositories/gravitee-apim-repository-mongodb/gravitee-apim-repository-mongodb-3.9.3.zip</p> <p>In future versions, others plugins will be renamed. Stay tuned!</p>","location":"apim/installation-guide/upgrades/3.9.3/readme/"},{"title":"Breaking changes","text":"","location":"apim/installation-guide/upgrades/3.9.4/readme/"},{"title":"Threat protection policies","text":"<p>From this version, configuration form for JSON Threat Protection Policy and XML Threat Protection Policy changes: <code>null</code> is no longer authorized, only <code>-1</code> is accepted for a no limit setting.</p>","location":"apim/installation-guide/upgrades/3.9.4/readme/#threat-protection-policies"},{"title":"Impacts","text":"<ul> <li> <p>If some fields are set to <code>null</code> in your db, and if you want to edit     this policy configuration through APIM Console, then the form     will replace them by the default value. Please, be careful when     updating your policy if you do not want the default values to be     applied.</p> </li> <li> <p>If some fields are set to <code>null</code> in your db, and if you want to edit     this policy configuration through REST API, an error message     will appear if you do not set an explicit value for those fields in     your request payload.</p> </li> </ul>","location":"apim/installation-guide/upgrades/3.9.4/readme/#impacts"},{"title":"Management Rest API","text":"<p>From with this version, the name of the APIM Rest APIs component changes. As a consequence:</p> <ol> <li> <p>The APIM Rest API component available on     https://download.gravitee.io is now     <code>gravitee-*apim*-rest-api-x.y.z.zip</code> instead of     <code>gravitee-management-rest-api-x.y.z.zip</code></p> </li> <li> <p>The name of the APIM Rest API folder within the full distribution     zip file (graviteeio-full-x.y.z.zip) is now     <code>graviteeio-*apim*-rest-api-x.y.z</code> instead of     <code>graviteeio-rest-api-x.y.z</code></p> </li> </ol> <p>In future versions, others plugins &amp; components might be renamed. Stay tuned!</p>","location":"apim/installation-guide/upgrades/3.9.4/readme/#management-rest-api"},{"title":"Install APIM Gateway","text":"<p>= Install APIM Gateway :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_installguide_gateway_install_zip.html :page-folder: apim/installation-guide/with-zip :page-layout: apim3x :page-description: Gravitee.io API Management - Gateway - Installation with .zip :page-keywords: Gravitee.io, API Platform, API Management, API Gateway, oauth2, openid, documentation, manual, guide, reference, api</p> <p>== Prerequisites</p> <p>Your environment must meet the requirements listed below before you install APIM Gateway.</p> <p>=== JDK</p> <p>APIM Gateway requires at least Java 11. You can check your Java version as follows:</p>","location":"apim/installation-guide/with-zip/installation-guide-gateway-install-zip/"},{"title":"[source,bash]","text":"<p>$ java -version $ echo $JAVA_HOME</p>  <p>NOTE: You can download the latest OpenJDK from the https://jdk.java.net/archive/[OpenJDK Download Site, window=\\\"_blank\\\"].</p> <p>=== MongoDB and Elasticsearch</p> <p>The default APIM Gateway distribution requires link:{{ '/apim/3.x/apim_installguide_repositories_mongodb.html' | relative_url }}[MongoDB, window=\\\"_blank\\\"] to poll environment configuration and link:{{ '/apim/3.x/apim_installguide_repositories_elasticsearch.html' | relative_url }}[Elasticsearch, window=\\\"_blank\\\"] for reporting and analytics. See the vendor documentation for supported versions.</p> <p>NOTE: You can download MongoDB from https://www.mongodb.org/downloads#production[MongoDB Download Site, window=\\\"_blank\\\"] and Elasticsearch from https://www.elastic.co/downloads/elasticsearch[Elastic Download Site, window=\\\"_blank\\\"]</p> <p>== Download and extract the <code>.zip</code> archive</p> <p>Note that the archive includes the binaries for all the APIM components, so if you previously downloaded it to install another component, you do not need to download it again.</p> <p>. Download the binaries https://download.gravitee.io/graviteeio-apim/distributions/graviteeio-full-{{ site.products.apim._3x.version }}.zip[here, window=\\\"_blank\\\"] or from the https://gravitee.io/downloads/api-management[Gravitee downloads page, window=\\\"_blank\\\"].</p>","location":"apim/installation-guide/with-zip/installation-guide-gateway-install-zip/#sourcebash"},{"title":"[source,bash]","text":"","location":"apim/installation-guide/with-zip/installation-guide-gateway-install-zip/#sourcebash_1"},{"title":"$ curl -L https://download.gravitee.io/graviteeio-apim/distributions/graviteeio-full-{{ site.products.apim._3x.version }}.zip -o gravitee-standalone-distribution-{{ site.products.apim._3x.version }}.zip","text":"<p>[start=2] . Extract the <code>graviteeio-gateway-xxx</code> directory from the archive and place it in the required location.</p>","location":"apim/installation-guide/with-zip/installation-guide-gateway-install-zip/#curl-l-httpsdownloadgraviteeiograviteeio-apimdistributionsgraviteeio-full-siteproductsapim_3xversion-zip-o-gravitee-standalone-distribution-siteproductsapim_3xversion-zip"},{"title":"[source,bash]","text":"","location":"apim/installation-guide/with-zip/installation-guide-gateway-install-zip/#sourcebash_2"},{"title":"$ unzip gravitee-standalone-distribution-{{ site.products.apim._3x.version }}.zip","text":"<p>== Check the installation === Run APIM Gateway from the command line</p> <p>By default, APIM Gateway runs in the foreground, prints its logs to standard output (stdout), and can be stopped by pressing Ctrl-C.</p> <p>Run APIM Gateway from the command line as follows:</p>","location":"apim/installation-guide/with-zip/installation-guide-gateway-install-zip/#unzip-gravitee-standalone-distribution-siteproductsapim_3xversion-zip"},{"title":"[source,bash]","text":"<p>$ cd graviteeio-gateway-{{ site.products.apim._3x.version }} $ ./bin/gravitee</p>  <p>Once APIM Gateway is running, you will see this log:</p> <p>[source,bash] [subs=\"attributes\"] ... 11:01:53.162 [gravitee] [] INFO  i.g.g.standalone.node.GatewayNode - Gravitee.io - Gateway id[2e05c0fa-8e48-4ddc-85c0-fa8e48bddc11] version[{{ site.products.apim._3x.version }}] pid[24930] build[175] jvm[Oracle Corporation/Java HotSpot(TM) 64-Bit Server VM/25.121-b13] started in 15837 ms. ...</p> <p>=== Check APIM Gateway is running</p> <p>You can test that APIM Gateway is running by sending an HTTP request to port <code>8082</code> on <code>localhost</code>:</p>","location":"apim/installation-guide/with-zip/installation-guide-gateway-install-zip/#sourcebash_3"},{"title":"[source,bash]","text":"","location":"apim/installation-guide/with-zip/installation-guide-gateway-install-zip/#sourcebash_4"},{"title":"$ curl -X GET http://localhost:8082/","text":"<p>You will receive a response something like this:</p>","location":"apim/installation-guide/with-zip/installation-guide-gateway-install-zip/#curl-x-get-httplocalhost8082"},{"title":"[source,bash]","text":"","location":"apim/installation-guide/with-zip/installation-guide-gateway-install-zip/#sourcebash_5"},{"title":"No context-path matches the request URI.","text":"<p>== Run APIM Gateway as a daemon</p> <p>To run APIM Gateway as a daemon, specify <code>-d</code> on the command line and record the process ID in a file using option <code>-p</code>:</p>","location":"apim/installation-guide/with-zip/installation-guide-gateway-install-zip/#no-context-path-matches-the-request-uri"},{"title":"[source,bash]","text":"","location":"apim/installation-guide/with-zip/installation-guide-gateway-install-zip/#sourcebash_6"},{"title":"$ ./bin/gravitee -d -p=/var/run/gio.pid","text":"<p>You can find log messages in the <code>$GRAVITEE_HOME/logs/</code> directory.</p> <p>To shut down APIM Gateway, kill the process ID recorded in the <code>pid</code> file:</p>","location":"apim/installation-guide/with-zip/installation-guide-gateway-install-zip/#bingravitee-d-pvarrungiopid"},{"title":"[source,bash]","text":"","location":"apim/installation-guide/with-zip/installation-guide-gateway-install-zip/#sourcebash_7"},{"title":"$ kill <code>cat /var/run/gio.pid</code>","text":"<p>== APIM Gateway directory structure</p> <p>The <code>.zip</code> (and <code>.tar.gz</code>) package is entirely self-contained. All files and directories are, by default, contained within <code>$GRAVITEE_HOME</code>, the directory created when extracting the archive.</p> <p>[width=\"100%\",cols=\"20%,80%\",frame=\"topbot\",options=\"header\"] |====================== |Location    |Description |bin       |Binary scripts including <code>gravitee</code> to start a node |config    |Configuration files including <code>gravitee.yml</code> |lib       |Libraries (Gravitee.io libraries and third party libraries) |logs      |Log files |plugins   |Plugin files |======================</p>","location":"apim/installation-guide/with-zip/installation-guide-gateway-install-zip/#kill-cat-varrungiopid"},{"title":"Install APIM Console","text":"<p>= Install APIM Console :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_installguide_management_ui_install_zip.html :page-folder: apim/installation-guide/with-zip :page-description: Gravitee.io API Management - Management UI - Installation with .zip :page-keywords: Gravitee.io, API Platform, API Management, API Gateway, oauth2, openid, documentation, manual, guide, reference, api :page-layout: apim3x</p> <p>== Prerequisites</p> <p>Your environment must meet the requirements listed below before you install APIM Console.</p> <p>NOTE: Before you begin, ensure APIM API is installed and running.</p> <p>=== Browsers</p> <p>APIM Console is supported with the two most recent versions of all modern internet browsers.</p> <p>== Download and extract the <code>.zip</code> archive</p> <p>You can download the binaries https://gravitee.io/downloads/api-management[here, window=\\\"_blank\\\"] or from the https://download.gravitee.io/graviteeio-apim/distributions/graviteeio-full-{{ site.products.apim._3x.version }}.zip[Gravitee Downloads page, window=\\\"_blank\\\"].</p> <p>[source,bash] [subs=\"attributes\"] $ curl -L https://download.gravitee.io/graviteeio-apim/distributions/graviteeio-full-{{ site.products.apim._3x.version }}.zip -o gravitee-standalone-distribution-{{ site.products.apim._3x.version }}.zip</p> <p>Once you have downloaded the archive, extract the <code>graviteeio-apim-console-ui-xxx</code> directory and place it in the required location.</p> <p>[source,bash] [subs=\"attributes\"] $ unzip gravitee-standalone-distribution-{{ site.products.apim._3x.version }}.zip</p> <p>== Deploy or run APIM Console</p> <p>=== Deploy APIM Console is a client-side only AngularJS application and can be deployed on any HTTP server, such as https://httpd.apache.org/[Apache] or http://nginx.org/[Nginx].</p> <p>=== Run with Python</p> <p>[source,bash] [subs=\"attributes\"] $ cd graviteeio-apim-console-ui-{{ site.products.apim._3x.version }} $ python3 -m http.server $ Serving HTTP on 0.0.0.0 port 8000 ...</p> <p>=== Run with Node.js</p> <p>[source,bash] [subs=\"attributes\"] $ npm install http-server -g $ cd graviteeio-apim-console-ui-{{ site.products.apim._3x.version }} $ http-server</p>","location":"apim/installation-guide/with-zip/installation-guide-management-ui-install-zip/"},{"title":"Prerequisites","text":"<p>Your environment must meet the requirements listed below before you install APIM Portal.</p> <p>Before you begin, ensure APIM API is installed and running.</p>","location":"apim/installation-guide/with-zip/installation-guide-portal-ui-install-zip/"},{"title":"Browsers","text":"<p>APIM Portal is supported with the two most recent versions of all modern internet browsers.</p>","location":"apim/installation-guide/with-zip/installation-guide-portal-ui-install-zip/#browsers"},{"title":"Download and extract the <code>.zip</code> archive","text":"<p>The binaries are available from Downloads page or via https://download.gravitee.io/graviteeio-apim/distributions/graviteeio-full-{{ site.products.apim._3x.version }}.zip[Download].</p> <pre><code>$ curl -L https://download.gravitee.io/graviteeio-apim/distributions/graviteeio-full-{{ site.products.apim._3x.version }}.zip -o gravitee-standalone-distribution-{{ site.products.apim._3x.version }}.zip\n</code></pre> <p>Once file has been downloaded, you just have to unpack it in the right place</p> <pre><code>$ unzip gravitee-standalone-distribution-{{ site.products.apim._3x.version }}.zip\n</code></pre>","location":"apim/installation-guide/with-zip/installation-guide-portal-ui-install-zip/#download-and-extract-the-zip-archive"},{"title":"Deploy","text":"<p>The portal is a client-side only Angular application and can be deployed on any HTTP server like Apache or Nginx.</p>","location":"apim/installation-guide/with-zip/installation-guide-portal-ui-install-zip/#deploy"},{"title":"Run with Node.js","text":"<pre><code>$ npm install angular-http-server -g\n$ cd graviteeio-apim-portal-ui-{{ site.products.apim._3x.version }}\n$ angular-http-server\n$ Listening on 8080\n</code></pre>","location":"apim/installation-guide/with-zip/installation-guide-portal-ui-install-zip/#run-with-nodejs"},{"title":"Install APIM API","text":"<p>= Install APIM API :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_installguide_rest_apis_install_zip.html :page-folder: apim/installation-guide/with-zip :page-description: Gravitee.io API Management - Management API - Installation with .zip :page-keywords: Gravitee.io, API Platform, API Management, API Gateway, oauth2, openid, documentation, manual, guide, reference, api :page-layout: apim3x</p> <p>== Overview</p> <p>APIM API includes nodes for both of the UI components (APIM Management and APIM Portal). You must install the relevant APIM API node first before you can use the corresponding UI component.</p> <p>This section describes how to install APIM API and test the nodes are running.</p> <p>== Prerequisites</p> <p>Your environment must meet the requirements listed below before you install the APIM API.</p> <p>=== JDK</p> <p>The APIM API requires at least Java 11. Before you install it, check your Java version as follows:</p>","location":"apim/installation-guide/with-zip/installation-guide-rest-apis-install-zip/"},{"title":"[source,bash]","text":"<p>java -version echo $JAVA_HOME</p>  <p>NOTE: You can download the latest OpenJDK from https://jdk.java.net/archive/[OpenJDK Download Site, window=\\\"_blank\\\"].</p> <p>=== MongoDB and Elasticsearch</p> <p>The default APIM API distribution requires link:{{ '/apim/3.x/apim_installguide_repositories_mongodb.html' | relative_url }}[MongoDB] to store mandatory data and link:{{ '/apim/3.x/apim_installguide_repositories_elasticsearch.html' | relative_url }}[Elasticsearch] to store reporting data.</p> <p>NOTE: You can download MongoDB from the https://www.mongodb.org/downloads#production[MongoDB download site, window=\\\"_blank\\\"] and Elasticsearch from the https://www.elastic.co/downloads/elasticsearch[Elasticsearch download site, window=\\\"_blank\\\"].</p> <p>== Download and extract the <code>.zip</code> archive</p> <p>Note that the archive includes the binaries for all the APIM components, so if you previously downloaded it to install another component, you do not need to download it again.</p> <p>. Download the binaries https://download.gravitee.io/graviteeio-apim/distributions/graviteeio-full-{{ site.products.apim._3x.version }}.zip[here] or from the https://gravitee.io/downloads/api-management[Gravitee downloads page].</p>","location":"apim/installation-guide/with-zip/installation-guide-rest-apis-install-zip/#sourcebash"},{"title":"[source,bash]","text":"","location":"apim/installation-guide/with-zip/installation-guide-rest-apis-install-zip/#sourcebash_1"},{"title":"$ curl -L https://download.gravitee.io/graviteeio-apim/distributions/graviteeio-full-{{ site.products.apim._3x.version }}.zip -o gravitee-standalone-distribution-{{ site.products.apim._3x.version }}.zip","text":"<p>[start=2] . Extract the <code>graviteeio-apim-rest-api-xxx</code> directory from the archive and place it in the required location.</p>","location":"apim/installation-guide/with-zip/installation-guide-rest-apis-install-zip/#curl-l-httpsdownloadgraviteeiograviteeio-apimdistributionsgraviteeio-full-siteproductsapim_3xversion-zip-o-gravitee-standalone-distribution-siteproductsapim_3xversion-zip"},{"title":"[source,bash]","text":"","location":"apim/installation-guide/with-zip/installation-guide-rest-apis-install-zip/#sourcebash_2"},{"title":"$ unzip gravitee-standalone-distribution-{{ site.products.apim._3x.version }}.zip","text":"<p>== Run APIM API from the command line</p> <p>You start APIM API from the command line as follows:</p>","location":"apim/installation-guide/with-zip/installation-guide-rest-apis-install-zip/#unzip-gravitee-standalone-distribution-siteproductsapim_3xversion-zip"},{"title":"[source,bash]","text":"<p>$ cd graviteeio-apim-rest-api-{{ site.products.apim._3x.version }} $ ./bin/gravitee</p>  <p>By default, APIM API runs in the foreground, prints its logs to standard output (stdout), and can be stopped by pressing Ctrl-C.</p> <p>NOTE: Both APIM API nodes run by default. You can configure APIM to run only one or the other, as described in the link:{{ '/apim/3.x/apim_installguide_rest_apis_configuration.html' | relative_url }}[APIM API configuration] section.</p> <p>Once APIM API is running, you will see a log such as this one:</p> <p>[source,bash] [subs=\"attributes\"] ... 11:01:53.162 [main] INFO  i.g.r.a.s.node.GraviteeApisNode - Gravitee.io - Rest APIs id[2e05c0fa-8e48-4ddc-85c0-fa8e48bddc11] version[{{ site.products.apim._3x.version }}] pid[24930] build[175] jvm[AdoptOpenJDK/OpenJDK 64-Bit Server VM/12.0.1+12] started in 8042 ms. ...</p> <p>== Check Management API is running</p> <p>You can test that your Management API node is running by sending an HTTP request to port <code>8083</code> on <code>localhost</code>:</p>","location":"apim/installation-guide/with-zip/installation-guide-rest-apis-install-zip/#sourcebash_3"},{"title":"[source,bash]","text":"","location":"apim/installation-guide/with-zip/installation-guide-rest-apis-install-zip/#sourcebash_4"},{"title":"$ curl -X GET http://localhost:8083/management/organizations/DEFAULT/environments/DEFAULT/apis","text":"<p>You will receive a response something like this:</p>","location":"apim/installation-guide/with-zip/installation-guide-rest-apis-install-zip/#curl-x-get-httplocalhost8083managementorganizationsdefaultenvironmentsdefaultapis"},{"title":"[source,json]","text":"","location":"apim/installation-guide/with-zip/installation-guide-rest-apis-install-zip/#sourcejson"},{"title":"[]","text":"<p>== Check Portal API is running</p> <p>You can test that your Portal API node is running by sending an HTTP request to port <code>8083</code> on <code>localhost</code>:</p>","location":"apim/installation-guide/with-zip/installation-guide-rest-apis-install-zip/#_1"},{"title":"[source,bash]","text":"","location":"apim/installation-guide/with-zip/installation-guide-rest-apis-install-zip/#sourcebash_5"},{"title":"$ curl -X GET http://localhost:8083/portal/environments/DEFAULT/apis","text":"<p>You will receive a response something like this:</p>","location":"apim/installation-guide/with-zip/installation-guide-rest-apis-install-zip/#curl-x-get-httplocalhost8083portalenvironmentsdefaultapis"},{"title":"[source,json]","text":"<p>{   \"data\" : [ ],   \"metadata\" : {     \"data\" : {       \"total\" : 0     }   } }</p>  <p>== Run APIM API as a daemon</p> <p>To run APIM API as a daemon, specify <code>-d</code> on the command line and record the process ID in a file using option <code>-p</code>:</p>","location":"apim/installation-guide/with-zip/installation-guide-rest-apis-install-zip/#sourcejson_1"},{"title":"[source,bash]","text":"","location":"apim/installation-guide/with-zip/installation-guide-rest-apis-install-zip/#sourcebash_6"},{"title":"$ ./bin/gravitee -d -p=/var/run/gio.pid","text":"<p>You can find log messages in the <code>$GRAVITEE_HOME/logs/</code> directory.</p> <p>To shut down APIM API, kill the process ID recorded in the <code>pid</code> file:</p>","location":"apim/installation-guide/with-zip/installation-guide-rest-apis-install-zip/#bingravitee-d-pvarrungiopid"},{"title":"[source,bash]","text":"","location":"apim/installation-guide/with-zip/installation-guide-rest-apis-install-zip/#sourcebash_7"},{"title":"$ kill <code>cat /var/run/gio.pid</code>","text":"<p>== APIM API directory structure</p> <p>The <code>.zip</code> and (<code>.tar.gz</code>) package is entirely self-contained. All files and directories are, by default, contained within <code>$GRAVITEE_HOME</code>, the directory created when extracting the archive.</p> <p>[width=\"100%\",cols=\"20%,80%\",frame=\"topbot\",options=\"header\"] |====================== |Location  |Description |bin       |Binary scripts including <code>gravitee</code> to start a node |config    |Configuration files including <code>gravitee.yml</code> |lib       |Libraries (Gravitee.io libraries and third party libraries) |logs      |Log file location |plugins   |Plugin file location |data      |Search engine metadata |templates |API templates |======================</p>","location":"apim/installation-guide/with-zip/installation-guide-rest-apis-install-zip/#kill-cat-varrungiopid"},{"title":"Gravitee Kubernetes Operator - API reference","text":"<p>The GKO API reference documentation is automatically generated and updated in the GKO repository.</p>","location":"apim/kubernetes/apim-kubernetes-operator-api-reference/","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","API reference"]},{"title":"Gravitee Kubernetes Operator - Architecture","text":"","location":"apim/kubernetes/apim-kubernetes-operator-architecture/","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Architecture"]},{"title":"About Gravitee Kubernetes Operators","text":"<p>A Kubernetes operator is a method of packaging, deploying, and managing a Kubernetes application. A Kubernetes application is both deployed on Kubernetes and managed using the Kubernetes API and <code>kubectl</code> tooling.</p> <p>In this context, a Kubernetes operator is an application-specific controller that extends the functionality of the Kubernetes API to create, configure, and manage application instances.</p>","location":"apim/kubernetes/apim-kubernetes-operator-architecture/#about-gravitee-kubernetes-operators","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Architecture"]},{"title":"Architecture overview","text":"<p>The current functionality of the Gravitee Kubernetes Operator (GKO) allows for three main deployment scenarios, as described below.</p> <p>To learn how to deploy GKO on a remote cluster, see the Remote cluster deployment section.</p>","location":"apim/kubernetes/apim-kubernetes-operator-architecture/#architecture-overview","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Architecture"]},{"title":"Standard deployment","text":"<p>In the standard deployment scenario, the Management API and the API Gateway are deployed in the same Kubernetes cluster.</p> <p>With this workflow, the GKO listens for Custom Resource Definitions (CRDs). For each custom resource, an API is pushed to the Management API using the import endpoint. The API Gateway deploys the APIs accordingly.</p> <p>The following diagram illustrates the standard deployment architectural approach:</p> <p></p>","location":"apim/kubernetes/apim-kubernetes-operator-architecture/#standard-deployment","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Architecture"]},{"title":"Deployment on multiple clusters","text":"<p>In this scenario, the assimption is that both of the following requirements should be met:</p> <ol> <li>The user manages multiple Kubernetes clusters with a different set of APIs for each cluster.</li> <li>All APIs are managed using a single API Console.</li> </ol> <p>To make this work with GKO, it should be installed on all the required clusters.</p> <p>The following diagram illustrates the multi-cluster deployment architectural approach:</p> <p></p>","location":"apim/kubernetes/apim-kubernetes-operator-architecture/#deployment-on-multiple-clusters","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Architecture"]},{"title":"Deployment on multiple environments","text":"<p>In this scenario, a single GKO is deployed that can publish APIs to different environments (logical or physical). This is managed directly from the API Definition custom resource, which refers a Management Context custom resource.</p>  <p>Note</p> <p>Note that in this case different APIs are published on each of the environments. This is because APIs use the <code>ManagementContext</code> CRD, which can reference any Management API, however an <code>ApiDefinition</code> CRD can only have one Management Context.</p>  <p>The following diagram illustrates the multi-environment deployment architectural approach:</p> <p></p>","location":"apim/kubernetes/apim-kubernetes-operator-architecture/#deployment-on-multiple-environments","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Architecture"]},{"title":"Gravitee Kubernetes Operator changelog","text":"","location":"apim/kubernetes/apim-kubernetes-operator-changelog/","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Changelog"]},{"title":"Version 0.2.0 (2022-11-09)","text":"<ul> <li> <p>add rbac marker for secret lists     (9ed5735)</p> </li> <li> <p>import api with disabled health check     (8698633)</p> </li> <li> <p>import API with logging     (5b28322)</p> </li> <li> <p>import api with several endpoint groups     (c308730)</p> </li> </ul>  <ul> <li>reference secret in context     (6d3acf6)</li> </ul>","location":"apim/kubernetes/apim-kubernetes-operator-changelog/#version-020-2022-11-09","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Changelog"]},{"title":"Version 0.1.1 (2022-10-28)","text":"","location":"apim/kubernetes/apim-kubernetes-operator-changelog/#version-011-2022-10-28","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Changelog"]},{"title":"Features","text":"<ul> <li>reconcile api resources on context updates     (c820c14)</li> </ul>","location":"apim/kubernetes/apim-kubernetes-operator-changelog/#features","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Changelog"]},{"title":"Bug Fixes","text":"<ul> <li> <p>add enabled in health check model     (c3098e3)</p> </li> <li> <p>align endpoint mapping with apim     (568c879)</p> </li> <li> <p>change fail over data type     (0fbe2bd)</p> </li> <li> <p>import api with life cycle state     (5293ddd)</p> </li> <li> <p>merge create and update of api definition     (1e677f0)</p> </li> <li> <p>rename cors fields to match v3 definition     (3ebd4d0)</p> </li> </ul>","location":"apim/kubernetes/apim-kubernetes-operator-changelog/#bug-fixes","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Changelog"]},{"title":"Version 0.1.0 (2022-10-07)","text":"<ul> <li> <p>add events on api resource     (da695a7)</p> </li> <li> <p>add organization and environment to management context     (869be0d)</p> </li> <li> <p>delete an api definition     (8b763be)</p> </li> <li> <p>start and stop api     (a58756f)</p> </li> <li> <p>create and update an api definition     (005ece9)</p> </li> </ul>","location":"apim/kubernetes/apim-kubernetes-operator-changelog/#version-010-2022-10-07","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Changelog"]},{"title":"Custom Resource Definitions (CRDs) reference","text":"","location":"apim/kubernetes/apim-kubernetes-operator-definitions/","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Custom Resource Definitions","CRDs"]},{"title":"Overview","text":"<p>The Gravitee Kubernetes Operator comes with three Custom Resource Definitions (CRDs) - <code>ManagementContext</code>, <code>ApiDefinition</code>, and <code>ApiResource</code>. These are described below.</p>","location":"apim/kubernetes/apim-kubernetes-operator-definitions/#overview","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Custom Resource Definitions","CRDs"]},{"title":"<code>ManagementContext</code>","text":"<p>The <code>ManagementContext</code> custom resource represents the configuration for a Management API.</p> <p>Resources:</p> <ul> <li>The <code>ManagementContext</code> CRD code is available on GitHub.</li> <li>The <code>ManagementContext</code> CRD API reference is documented here.</li> <li>You can learn how to use the <code>ManagementContext</code> resource in this section.</li> </ul> <p>The <code>ManagementContext</code> refers to a remote Management API. You can have as many <code>ManagementContext</code> resources as you want, however you need to reference the relevant <code>ManagementContext</code> from the API Definition in order to indicate to the GKO where the API should be published.</p>","location":"apim/kubernetes/apim-kubernetes-operator-definitions/#managementcontext","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Custom Resource Definitions","CRDs"]},{"title":"Examples","text":"<p>A basic example of an <code>ManagementContext</code> resource is shown below:</p> <pre><code>    apiVersion: gravitee.io/v1alpha1\n    kind: ManagementContext\n    metadata:\n      name: dev-mgmt-ctx\n    spec:\n      baseUrl: http://localhost:8083\n      auth:\n        credentials:\n          username: admin\n          password: admin\n</code></pre> <p>The next example shows the same resource but with a Personal Token:</p> <pre><code>    apiVersion: gravitee.io/v1alpha1\n    kind: ManagementContext\n    metadata:\n      name: dev-mgmt-ctx\n    spec:\n      baseUrl: http://localhost:8083\n      auth:\n        bearerToken: xxxx-yyyy-zzzz\n</code></pre> <p>You can then refer to the <code>ManagementContext</code> from the API, as shown in the example below:</p> <pre><code>    apiVersion: gravitee.io/v1alpha1\n    kind: ApiDefinition\n    metadata:\n      name: basic-api-example\n    spec:\n      name: \"K8s Basic Example\"\n      contextRef:\n        name: \"dev-mgmt-ctx\"\n        namespace: \"default\"\n      version: \"1.1\"\n      description: \"Basic api managed by Gravitee Kubernetes Operator\"\n      proxy:\n        virtual_hosts:\n          - path: \"/k8s-basic\"\n        groups:\n          - endpoints:\n              - name: \"Default\"\n                target: \"https://api.gravitee.io/echo\"\n</code></pre> <p>Read more about <code>ManagementContext</code> here.</p>","location":"apim/kubernetes/apim-kubernetes-operator-definitions/#examples","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Custom Resource Definitions","CRDs"]},{"title":"<code>ApiDefinition</code>","text":"<p>The <code>APIDefinition</code> custom resource represents the configuration for a single proxied API and its versions. It is similar to a YAML representation of an API Definition in JSON format.</p> <p>Resources:</p> <ul> <li>The <code>ApiDefinition</code> CRD code is available on GitHub.</li> <li>The <code>ApiDefinition</code> CRD API reference is documented here.</li> <li>You can learn how to use the <code>ApiDefinition</code> resource in this section.</li> </ul>","location":"apim/kubernetes/apim-kubernetes-operator-definitions/#apidefinition","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Custom Resource Definitions","CRDs"]},{"title":"Workflow","text":"<p>The following workflow is applied when a new <code>ApiDefinition</code> resource is added to the cluster:</p> <ol> <li>The GKO listens for <code>ApiDefinition</code> resources.</li> <li>The GKO performs some required changes, such as computing automatically IDs or CrossIDs (for API or Plan).</li> <li>The GKO converts the definition to JSON format.</li> <li>The GKO compares the definition to the existing definition. If something has changed, the GKO pushes the definition to the Management API (if a <code>ManagementContext</code> is provided).</li> <li>The GKO deploys the API to the API Gateway.</li> </ol>","location":"apim/kubernetes/apim-kubernetes-operator-definitions/#workflow","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Custom Resource Definitions","CRDs"]},{"title":"Examples","text":"<p>A basic example of an <code>ApiDefinition</code> resource is shown below:</p> <pre><code>    apiVersion: gravitee.io/v1alpha1\n    kind: ApiDefinition\n    metadata:\n      name: basic-api-example\n    spec:\n      name: \"K8s Basic Example\"\n      version: \"1.0\"\n      description: \"Basic api managed by Gravitee Kubernetes Operator\"\n      proxy:\n        virtual_hosts:\n          - path: \"/k8s-basic\"\n        groups:\n          - endpoints:\n              - name: \"Default\"\n                target: \"https://api.gravitee.io/echo\"\n</code></pre> <p>The same API with support for plans is shown in the example below:</p> <pre><code>    apiVersion: gravitee.io/v1alpha1\n    kind: ApiDefinition\n    metadata:\n      name: apikey-example\n    spec:\n      name: \"K8s OAuth2 Example\"\n      version: \"1.0\"\n      description: \"Api managed by Gravitee Kubernetes Operator with OAuth2 plan\"\n      resources:\n        - name: \"am-demo\"\n          type: oauth2-am-resource\n          configuration:\n            version: V3_X\n            serverURL: \"https://am-nightly-gateway.cloud.gravitee.io\"\n            securityDomain: \"test-jh\"\n            clientId: \"localjh\"\n            clientSecret: \"localjh\"\n      plans:\n        - name: \"OAuth2\"\n          description: \"Oauth2 plan\"\n          security: OAUTH2\n          securityDefinition: '{\"oauthResource\":\"am-demo\"}'\n      proxy:\n        virtual_hosts:\n          - path: \"/k8s-oauth2\"\n        groups:\n          - name: default-group\n            endpoints:\n              - name: \"Default\"\n                target: \"https://api.gravitee.io/echo\"\n</code></pre> <p>Read more about <code>ApiDefinition</code> here.</p>","location":"apim/kubernetes/apim-kubernetes-operator-definitions/#examples_1","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Custom Resource Definitions","CRDs"]},{"title":"<code>ApiResource</code>","text":"<p>The <code>ApiResource</code> custom resource allows you to use the GKO to create reusable API resources by applying the <code>ApiResource</code> custom resource definition. This enables you to define resources such as cache or authentication providers once only and maintain them in a single place, and then reuse them in multiple APIs - any further updates to such a resource will be automatically propagated to all APIs containing a reference to that resource.</p> <p>Read more about <code>ApiResource</code> here.</p>","location":"apim/kubernetes/apim-kubernetes-operator-definitions/#apiresource","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Custom Resource Definitions","CRDs"]},{"title":"Examples","text":"<p>Here is an example of an <code>ApiResource</code> cache resource:</p> <pre><code>    apiVersion: gravitee.io/v1alpha1\n    kind: ApiResource\n    metadata:\n      name: reusable-resource-cache\n      namespace: default\n    spec:\n      name: \"cache-resource\"\n      type: \"cache\"\n      enabled: true\n      configuration:\n          timeToIdleSeconds: 0\n          timeToLiveSeconds: 0\n          maxEntriesLocalHeap: 1000\n</code></pre> <p>This reusable resource can then be later referenced in any <code>ApiDefinition</code> resource using a reference to its namespaced name in the <code>resources</code> field:</p> <pre><code>    apiVersion: gravitee.io/v1alpha1\n    kind: ApiDefinition\n    metadata:\n      name: resource-ref-example\n      namespace: default\n    spec:\n      name: \"Resource reference example\"\n      version: \"1.0\"\n      description: \"An API with a reference to a reusable resource\"\n      resources:\n        - ref:\n            name: reusable-resource-cache\n            namespace: default\n      proxy:\n        virtual_hosts:\n          - path: \"/resource-ref-sample\"\n        groups:\n          - endpoints:\n              - name: \"Default\"\n                target: \"https://api.gravitee.io/echo\"\n</code></pre>","location":"apim/kubernetes/apim-kubernetes-operator-definitions/#examples_2","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Custom Resource Definitions","CRDs"]},{"title":"CRD dependencies","text":"","location":"apim/kubernetes/apim-kubernetes-operator-definitions/#crd-dependencies","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Custom Resource Definitions","CRDs"]},{"title":"Resource deletion","text":"<p>Since an <code>ApiDefinition</code> can rely on a <code>ManagementContext</code>, resource deletion is restricted until a check is performed first whether there is an API associated with the respective <code>ManagementContext</code>. This is achieved through the use of Finalizers.</p>","location":"apim/kubernetes/apim-kubernetes-operator-definitions/#resource-deletion","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Custom Resource Definitions","CRDs"]},{"title":"CRD samples","text":"<p>Check out some sample CRDs in the GKO GitHub repository.</p>","location":"apim/kubernetes/apim-kubernetes-operator-definitions/#crd-samples","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Custom Resource Definitions","CRDs"]},{"title":"Deploying GKO on a Kubernetes cluster","text":"","location":"apim/kubernetes/apim-kubernetes-operator-installation-cluster/","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Deployment","Cluster","K8s"]},{"title":"Overview","text":"<p>This section provides steps on how to deploy the Gravitee Kubernetes Operator (GKO) on an existing APIM-ready Kubernetes cluster.</p>  <p>Cluster availability</p> <p>If you do not have an existing cluster you can deploy to, you can set up a new local cluster - see the local cluster installation section for details. Once you have the local cluster set up and running, return to this section to deploy the GKO.</p>   <p>Multiple clusters</p> <p>If your architecture requires the management of multiple Kubernetes clusters with a different set of APIs for each cluster, you should deploy the GKO separately on each cluster. Follow the deployment process described below for each cluster deployment.</p>","location":"apim/kubernetes/apim-kubernetes-operator-installation-cluster/#overview","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Deployment","Cluster","K8s"]},{"title":"Prerequisites","text":"<p>Before you start the deployment process, ensure that you have access to an APIM-ready Kubernetes cluster.</p> <p>By default the Kubernetes synchronizer is configured to look for API definitions in the API Gateway namespace. To watch all namespaces you must set the property <code>services.sync.kubernetes.namespaces</code> to <code>all</code> in the Gateway configuration. You can also provide a specific list of namespaces to watch.</p> <p>It is also recommended to check the current Kubernetes context to ensure that it is set to the correct cluster. To do this, run the following command:</p> <pre><code>kubectl config current-context\n</code></pre> <p>See the Kubernetes documentation for more information on displaying a list of contexts and setting your current context.</p>","location":"apim/kubernetes/apim-kubernetes-operator-installation-cluster/#prerequisites","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Deployment","Cluster","K8s"]},{"title":"Deploying the GKO on the cluster","text":"","location":"apim/kubernetes/apim-kubernetes-operator-installation-cluster/#deploying-the-gko-on-the-cluster","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Deployment","Cluster","K8s"]},{"title":"STEP 1: Run the deployment script","text":"<p>Run the following command in your command-line tool (the working directory does not matter) to deploy the GKO on the cluster of your current Kubernetes context:</p> <pre><code>kubectl apply -f https://github.com/gravitee-io/gravitee-kubernetes-operator/releases/latest/download/bundle.yml\n</code></pre> <p>The operation is quick and the successful command-line output should be similar to one in the example below:</p> <pre><code>namespace/gko-system created\ncustomresourcedefinition.apiextensions.k8s.io/apidefinitions.gravitee.io created\ncustomresourcedefinition.apiextensions.k8s.io/managementcontexts.gravitee.io created\nserviceaccount/gko-controller-manager created\nrole.rbac.authorization.k8s.io/gko-leader-election-role created\nclusterrole.rbac.authorization.k8s.io/gko-manager-role created\nclusterrole.rbac.authorization.k8s.io/gko-metrics-reader created\nclusterrole.rbac.authorization.k8s.io/gko-proxy-role created\nrolebinding.rbac.authorization.k8s.io/gko-leader-election-rolebinding created\nclusterrolebinding.rbac.authorization.k8s.io/gko-manager-rolebinding created\nclusterrolebinding.rbac.authorization.k8s.io/gko-proxy-rolebinding created\nconfigmap/gko-manager-config created\nservice/gko-controller-manager-metrics-service created\ndeployment.apps/gko-controller-manager created\n</code></pre> <p>The GKO has now been deployed on your cluster.</p>","location":"apim/kubernetes/apim-kubernetes-operator-installation-cluster/#step-1-run-the-deployment-script","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Deployment","Cluster","K8s"]},{"title":"STEP 2: Check if the Gravitee CRDs are available on your cluster","text":"<p>Run the following command:</p> <pre><code>kubectl get crd\n</code></pre> <p>The command-line output should include <code>apidefinitions.gravitee.io</code> and <code>managementcontexts.gravitee.io</code>, as shown in the example below:</p> <pre><code>NAME                              CREATED AT\naddons.k3s.cattle.io              2022-09-28T10:25:02Z\nhelmcharts.helm.cattle.io         2022-09-28T10:25:02Z\nhelmchartconfigs.helm.cattle.io   2022-09-28T10:25:02Z\napidefinitions.gravitee.io        2022-09-28T10:34:38Z\nmanagementcontexts.gravitee.io    2022-09-28T10:34:38Z\n</code></pre>","location":"apim/kubernetes/apim-kubernetes-operator-installation-cluster/#step-2-check-if-the-gravitee-crds-are-available-on-your-cluster","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Deployment","Cluster","K8s"]},{"title":"Setting up a local cluster for deployment","text":"","location":"apim/kubernetes/apim-kubernetes-operator-installation-local/","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Deployment","Local cluster","K8s"]},{"title":"Overview","text":"<p>If you do not have an existing APIM-ready Kubernetes cluster you can deploy the GKO on, you can create and set up a local cluster on your machine. This process is described below and involves the following stages:</p> <ol> <li>Set up your environment (prerequisite step).</li> <li>Create a local APIM-ready Kubernetes cluster.</li> <li>Monitor the APIM pods startup until they are ready.</li> <li>Check if the Console is up and running.</li> </ol> <p>After the local cluster setup, the next steps are to:</p> <ol> <li>Deploy the GKO on the cluster.</li> <li>Try out the GKO functionality.</li> </ol>  <p>Warning</p> <p>It is strongly recommended to only use local GKO cluster deployments for testing purposes - never in production.</p>","location":"apim/kubernetes/apim-kubernetes-operator-installation-local/#overview","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Deployment","Local cluster","K8s"]},{"title":"Prerequisites","text":"<p>Before you start, you need to have the following software set up and running on your machine:</p> <ul> <li>Docker.</li> <li>kubectl.</li> <li>Helm.</li> <li>Node.js.</li> <li>curl in case you do not have it already - to check, type <code>curl -V</code> in your command-line tool.</li> <li>A standard command-line tool of your choice.</li> </ul> <p>The GKO GitHub repository is public and available here. Cloning it is not a requirement for this installation process, so this is just for your reference.</p>","location":"apim/kubernetes/apim-kubernetes-operator-installation-local/#prerequisites","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Deployment","Local cluster","K8s"]},{"title":"STEP 1: Create a local cluster","text":"<p>To create a local APIM-ready Kubernetes cluster, run the following command:</p> <pre><code>curl -s https://raw.githubusercontent.com/gravitee-io/gravitee-kubernetes-operator/master/scripts/k3d.mjs | npx zx\n</code></pre> <p>This operation may take a few minutes to complete.</p>  <p>Note</p> <p>This script has only been tested on Mac machines.</p>  <p>Make note of the endpoints listed at the end of the command-line output:</p> <pre><code>    (...)\n\n    Available endpoints are:\n\n        Gateway       http://localhost:9000/gateway\n        Management    http://localhost:9000/management\n        Console       http://localhost:9000/console/#!/login\n\n    To update APIM components (e.g. APIM Gateway) to use a new docker image run:\n\n    &gt; docker tag &lt;image&gt; k3d-graviteeio.docker.localhost:12345/graviteeio/apim-gateway:3.19\n    &gt; docker push k3d-graviteeio.docker.localhost:12345/graviteeio/apim-gateway:3.19\n    &gt; kubectl rollout restart deployment apim-apim3-gateway\n</code></pre>","location":"apim/kubernetes/apim-kubernetes-operator-installation-local/#step-1-create-a-local-cluster","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Deployment","Local cluster","K8s"]},{"title":"STEP 2: Monitor the APIM pods startup until they are ready","text":"<p>The pods will take some time to start and must become ready before you can deploy the GKO (described in the next step).</p> <p>To monitor from the command line, run the following command:</p> <pre><code>kubectl wait --for=condition=ready pod -l app.kubernetes.io/name=apim3 --timeout 360s\n</code></pre> <p>After some time, the command-line output should look similar to the example below:</p> <pre><code>    pod/apim-apim3-api-7b8b85d79-b7hkh condition met\n    pod/apim-apim3-ui-5997c5d5c7-r9xdj condition met\n    pod/apim-apim3-gateway-66cbd5c9d9-tv5jz condition met\n</code></pre> <p>You can increase the timeout if your machine is slower. If you encounter an error, you will not be able to proceed to the next steps - please contact Gravitee for assistance with this.</p>","location":"apim/kubernetes/apim-kubernetes-operator-installation-local/#step-2-monitor-the-apim-pods-startup-until-they-are-ready","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Deployment","Local cluster","K8s"]},{"title":"STEP 3: Check if the API Console is up and running","text":"<p>As noted in step 1 above, you can use your Console endpoint created with the cluster to check if the Console is up and running.</p> <p>To do so, open the Console endpoint URL in your browser - for example:</p> <p>http://localhost:9000/console/#!/login</p> <p>Log in the Console - the default local login credentials are <code>admin</code>/<code>admin</code>.</p> <p>The Console dashboard should show one application running in the \"Number of Applications\" section of the Console dashboard:</p> <p></p>","location":"apim/kubernetes/apim-kubernetes-operator-installation-local/#step-3-check-if-the-api-console-is-up-and-running","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Deployment","Local cluster","K8s"]},{"title":"GKO installation and deployment","text":"<p>The current GKO deployment process is mostly identical for both possible scenarios, as follows:</p> <ol> <li>In a typical deployment scenario, you can deploy the GKO on an existing, APIM-ready remote / cloud-based cluster.</li> <li>For testing purposes, you can also set up a local cluster and deploy the GKO on it.</li> </ol>","location":"apim/kubernetes/apim-kubernetes-operator-installation/","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Deployment","Installation","K8s"]},{"title":"Deploying GKO on an existing cluster","text":"<p>Deploying the Gravitee Kubernetes Operator (GKO) on an existing remote / cloud-based APIM-ready Kubernetes cluster involves the following stages:</p> <ol> <li>Deploy the GKO on your cluster.</li> <li>Create a Management Context custom resource.</li> <li>Create an API Definition custom resource - this creates a new API on the cluster.</li> <li>Test the new API by calling it through the APIM Gateway.</li> </ol> <p>Read all about it here.</p>","location":"apim/kubernetes/apim-kubernetes-operator-installation/#deploying-gko-on-an-existing-cluster","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Deployment","Installation","K8s"]},{"title":"Setting up a new local cluster for GKO deployment","text":"<p>If you do not have an existing APIM-ready Kubernetes cluster you can deploy the GKO on, you can create and set up a local cluster on your machine.</p> <p>This setup involves the following stages:</p> <ol> <li>Set up your environment (prerequisite step).</li> <li>Create a local APIM-ready Kubernetes cluster.</li> <li>Monitor the APIM pods startup until they are ready.</li> <li>Check if the console is up and running.</li> </ol> <p>After the local cluster setup, the next steps are to:</p> <ol> <li>Deploy the GKO on the cluster.</li> <li>Try out the GKO functionality.</li> </ol>  <p>Warning</p> <p>It is strongly recommended to only use local GKO cluster deployments for testing purposes - never in production.</p>  <p>Learn all about local cluster installation and setup here.</p>","location":"apim/kubernetes/apim-kubernetes-operator-installation/#setting-up-a-new-local-cluster-for-gko-deployment","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","Deployment","Installation","K8s"]},{"title":"Gravitee Kubernetes Operator (GKO)","text":"","location":"apim/kubernetes/apim-kubernetes-operator-overview/","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s"]},{"title":"Overview","text":"<p>APIM 3.19.0 has introduced the BETA release of the Gravitee Kubernetes Operator (GKO) - a new technical component designed to be deployed on an existing APIM-ready Kubernetes Cluster. It can also be deployed on a local cluster for testing purposes.</p> <p>You can use the GKO to define, deploy, and publish APIs to your API Portal and API Gateway and to manage Custom Resource Definitions (CRDs) as part of the process.</p> <p>The GKO also enables you to create reusable API resources by applying the <code>ApiResource</code> custom resource definition. This enables you to define resources such as cache or authentication providers once only and maintain them in a single place, and then reuse them in multiple APIs - any further updates to such a resource will be automatically propagated to all APIs containing a reference to that resource.</p> <p>In future releases, the GKO will support additional functionality to enable the following:</p> <ul> <li>Using the GKO as an Ingress Controller for deploying Ingresses to an API Gateway.</li> <li>Deploying Gravitee products (API Management, Access Management, Alert Engine).</li> <li>Improving automation processes through covering CICD aspects when using Kubernetes with APIM.</li> <li>Managing most API Management resources without directly relying on the Console or on the Management API.</li> </ul>","location":"apim/kubernetes/apim-kubernetes-operator-overview/#overview","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s"]},{"title":"Rationale","text":"<p>When it comes to Gravitee deployment, there are two main components that can be deployed, as follows:</p> <ol> <li>The APIs and applications around those APIs.</li> <li>The actual API Gateway and the Management Console itself.</li> </ol> <p>An increasing number of Gravitee users have already been implementing an Infrastructure-as-code (IAC) practice using Gravitee.</p> <p>To support IAC-based use cases, Gravitee should enable users to handle Gravitee platform deployment \u201cas code\u201d by performing all the deployment types of actions below without ever having to use an UI:</p> <ul> <li>Push/deploy APIs to the API Gateway.</li> <li>Test the APIs.</li> <li>Promote the APIs across different environments - Test, UAT, Dev, Prod, and so on.</li> </ul> <p>Up until now, Gravitee customers have been deploying APIs using the following two main approaches:</p> <ol> <li>Using the Gravitee Console and UI. Gravitee comes with an easy-to-use, self-serve UI that is often used for development. This is backed by a backend service that is a part of the Gravitee web application.</li> <li>Using REST APIs. Every action in the Gravitee UI de facto represents a REST API with a JSON payload. This is all documented using an API spec. As a result, everything users can do in the UI can be done via REST API calls backed by JSON files. A lot of users would use tools and systems like GitLab, Jenkins, Bitbucket, or GitHub Actions, for example, to manage everything as JSON files. An API definition in Gravitee is also a JSON file that explains what the endpoints are, what the protections are, and so on.</li> </ol> <p>While the REST API method is compatible with an IAC approach, there has been feedback from many Gravitee users who are going \"Kubernetes-native\" that they would prefer to be able to deploy APIs and the Gravitee APIM Gateway and Console via Custom Resource Definitions (CRDs).</p> <p>The Gravitee Kubernetes Operator has made all this possible in APIM version 3.19.0.</p>","location":"apim/kubernetes/apim-kubernetes-operator-overview/#rationale","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s"]},{"title":"How it works","text":"<p>If you deploy APIs in a Kubernetes cluster, you can describe your API as an API extension of Kubernetes using CRDs. This approach removes the need to deploy by relying on the Console/UI or the REST API - when you deploy natively to your K8s cluster, there is an operator there that can deploy the API to your API Gateway without relying on a UI or REST API. This is powered by the Kubernetes API and the Gravitee Kubernetes Operator.</p>","location":"apim/kubernetes/apim-kubernetes-operator-overview/#how-it-works","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s"]},{"title":"Learn more","text":"<p>You can find more detailed information about the Gravitee Kubernetes Operator in the following sections:</p> <ul> <li>Architecture</li> <li>Quick Start</li> <li>Installation and deployment</li> <li>User Guide</li> <li>API reference</li> </ul>","location":"apim/kubernetes/apim-kubernetes-operator-overview/#learn-more","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s"]},{"title":"GKO Quick Start Guide","text":"","location":"apim/kubernetes/apim-kubernetes-operator-quick-start/","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","Quick Start Guide"]},{"title":"Overview","text":"<p>The main purpose of the Gravitee Kubernetes Operator (GKO) is to define, deploy, and publish APIs on your API Portal, Gateway, and Console with Custom Resource Definitions (CRDs).</p> <p>To enable that, you should deploy the GKO on a Kubernetes cluster.</p> <p>You can deploy the GKO on an existing, APIM-ready cluster. That cluster could be remote (cloud-based), or local (only recommended for testing purposes).</p> <p>As described in the next section, there are additional steps to perform in case you do not have a suitable existing cluster and you need to set up a new local cluster prior to deployment.</p> <p>After a successful GKO deployment, you can try out the GKO functionality by creating CRDs and testing your API by calling it from the API Gateway. This process is documented here.</p> <p>The GKO only works with APIM version 3.19.0 (and above).</p>","location":"apim/kubernetes/apim-kubernetes-operator-quick-start/#overview","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","Quick Start Guide"]},{"title":"Deploying the GKO on your cluster","text":"<p>For full details, see the GKO deployment guide section.</p>","location":"apim/kubernetes/apim-kubernetes-operator-quick-start/#deploying-the-gko-on-your-cluster","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","Quick Start Guide"]},{"title":"STEP 1: Prepare your cluster","text":"<p>As a prerequisite, you should have an APIM-ready cluster up and running before you deploy the GKO. You should have user access to the cluster you want to deploy to, and it should be the one defined as your current/active Kubernetes context.</p> <p>If you need to set up a local cluster first, follow the steps in the local cluster installation section, and then proceed to the GKO deployment steps.</p>","location":"apim/kubernetes/apim-kubernetes-operator-quick-start/#step-1-prepare-your-cluster","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","Quick Start Guide"]},{"title":"STEP 2: Deploy the GKO on your cluster","text":"<p>The GKO deployment process is simple and is the same for both remote and local Kubernetes clusters.</p> <p>To deploy the GKO on the cluster of your current Kubernetes context, run the following command in your command-line tool (the working directory does not matter):</p> <pre><code>kubectl apply -f https://github.com/gravitee-io/gravitee-kubernetes-operator/releases/latest/download/bundle.yml\n</code></pre> <p>As an optional but recommended next step, you should check if the Gravitee CRDs are available on your cluster. To do so, run the following command:</p> <pre><code>kubectl get crd\n</code></pre>","location":"apim/kubernetes/apim-kubernetes-operator-quick-start/#step-2-deploy-the-gko-on-your-cluster","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","Quick Start Guide"]},{"title":"Trying out the deployed GKO","text":"<p>After GKO deployment, it is time to try out the GKO functionality by creating CRDs and testing your API via and API call from the API Gateway.</p> <p>Before you start, ensure that the <code>services.sync.kubernetes</code> property is enabled (set to <code>true</code>) in the <code>gravitee.yml</code> file. For more information, see How to try out the GKO after deployment.</p> <p>The process involves the following stages:</p> <ol> <li>Create a Management Context custom resource.</li> <li>Create an API Definition custom resource - this creates a new API on the cluster.</li> <li>Test the new API by calling it through the APIM Gateway.</li> </ol> <p>For full details, see How to try out the GKO after deployment.</p>","location":"apim/kubernetes/apim-kubernetes-operator-quick-start/#trying-out-the-deployed-gko","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","Quick Start Guide"]},{"title":"STEP 1: Create a Management Context custom resource","text":"<p>The <code>ManagementContext</code> custom resource represents the configuration for a Management API.</p> <p>Read more about the Management Context custom resource here and here.</p> <p>To create a Management Context custom resource, you need a YAML file with the correct Management Context configuration. You can use the following sample YAML file from Gravitee directly, or as a template to base your configuration on:</p> <p>https://github.com/gravitee-io/gravitee-kubernetes-operator/blob/master/config/samples/context/k3d/managementcontext_credentials.yaml</p> <p>To create the Management Context resource using the ready Gravitee sample file, run the following command:</p> <pre><code>kubectl apply -f https://raw.githubusercontent.com/gravitee-io/gravitee-kubernetes-operator/master/config/samples/context/k3d/managementcontext_credentials.yaml\n</code></pre> <p>For full details on creating a Management Context custom resource, see STEP 1: Create a Management Context custom resource in the User Guide section.</p>","location":"apim/kubernetes/apim-kubernetes-operator-quick-start/#step-1-create-a-management-context-custom-resource","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","Quick Start Guide"]},{"title":"STEP 2: Create an API Definition custom resource","text":"<p>The APIDefinition custom resource represents the configuration for a single proxied API and its versions. It is similar to a YAML representation of an API Definition in JSON format.</p> <p>Read more about the API Definition custom resource here and here.</p> <p>To create an API Definition custom resource, you need a YAML file with the desired API Definition configuration. You can use the following sample YAML file from Gravitee directly, or as a template to base your configuration on:</p> <p>https://github.com/gravitee-io/gravitee-kubernetes-operator/blob/master/config/samples/apim/api-with-context.yml</p> <p>To create the API Definition resource using the ready Gravitee sample file, run the following command:</p> <pre><code>kubectl apply -f https://raw.githubusercontent.com/gravitee-io/gravitee-kubernetes-operator/master/config/samples/apim/api-with-context.yml\n</code></pre> <p>For full details on creating an API Definition custom resource, see STEP 2: Create an API Definition custom resource in the User Guide section.</p>","location":"apim/kubernetes/apim-kubernetes-operator-quick-start/#step-2-create-an-api-definition-custom-resource","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","Quick Start Guide"]},{"title":"STEP 3: Test the new API by calling it through the APIM Gateway","text":"<p>For the Gateway to work with the GKO, ensure that the <code>services.sync.kubernetes</code> property is enabled (set to <code>true</code>) in the <code>gravitee.yml</code> file. For more information, see the prerequisites section in How to try out the GKO after deployment.</p> <p>To test the API, you can call it through the APIM Gateway by running the following command using your APIM Gateway URL:</p> <pre><code>curl -i http://localhost:9000/gateway/k8s-basic-with-ctx\n</code></pre> <p>The entrypoint used in the Gateway URL may differ depending on your deployment. The example above shows the typical Gateway URL generated when using a local cluster created through the local cluster installation process.</p> <p>For full details on trying out the GKO functionality after deployment, see STEP 3: Call the API through the APIM Gateway in the User Guide section.</p>","location":"apim/kubernetes/apim-kubernetes-operator-quick-start/#step-3-test-the-new-api-by-calling-it-through-the-apim-gateway","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","Quick Start Guide"]},{"title":"How to use the API Definition (<code>ApiDefinition</code>) custom resource","text":"","location":"apim/kubernetes/apim-kubernetes-operator-user-guide-api-definition/","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","ApiDefinition"]},{"title":"Overview","text":"<p>The <code>ApiDefinition</code> custom resource represents the configuration for a single proxied API and its versions. It is similar to a YAML representation of an API Definition in JSON format.</p> <p>The example below shows a simple <code>ApiDefinition</code> custom resource definition:</p> <pre><code>    apiVersion: gravitee.io/v1alpha1\n    kind: ApiDefinition\n    metadata:\n      name: basic-api-example\n    spec:\n      name: \"GKO Basic\"\n      version: \"1.1\"\n      description: \"Basic api managed by Gravitee Kubernetes Operator\"\n      proxy:\n        virtual_hosts:\n          - path: \"/k8s-basic\"\n        groups:\n          - endpoints:\n              - name: \"Default\"\n                target: \"https://api.gravitee.io/echo\"\n</code></pre>","location":"apim/kubernetes/apim-kubernetes-operator-user-guide-api-definition/#overview","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","ApiDefinition"]},{"title":"The <code>ApiDefinition</code> lifecycle","text":"<p>The <code>ApiDefiniton</code> resource has a <code>Processing Status</code> field that makes it possible to view the status of the resource in the cluster. The following <code>Processing Status</code> field values are possible:</p>        <p>Status</p> <p>Description</p>   <p>[None]</p> <p>The API definition has been created but not processed yet.</p>   <p>Completed</p> <p>The API definition has been created or updated successfully.</p>   <p>Reconciling</p> <p>The operator has encountered a recoverable error. A retry will be performed every 5 seconds until the cluster retry limit is reached.</p>   <p>Failed</p> <p>The operator has encountered an unrecoverable error. These are errors that require manual action to correct. No retry will be performed.</p>    <p>Events are added to the resource as part of each action performed by the operator. To view these events, ensure that the CRD creation steps described above are completed and then run the following command:</p> <pre><code>&gt;     k describe -n default apidefinitions.gravitee.io basic-api-example\n</code></pre>","location":"apim/kubernetes/apim-kubernetes-operator-user-guide-api-definition/#the-apidefinition-lifecycle","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","ApiDefinition"]},{"title":"Example","text":"<pre><code>    Name:         basic-api-example\n    Namespace:    default\n    [...]\n    Events:\n      Type    Reason          Age   From                      Message\n      ----    ------          ----  ----                      -------\n      Normal  AddedFinalizer  73s   apidefinition-controller  Added Finalizer for the API definition\n      Normal  Creating        73s   apidefinition-controller  Creating API definition\n      Normal  Created         72s   apidefinition-controller  Created API definition\n</code></pre>","location":"apim/kubernetes/apim-kubernetes-operator-user-guide-api-definition/#example","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","ApiDefinition"]},{"title":"How to use the Management Context (<code>ManagementContext</code>) custom resource","text":"","location":"apim/kubernetes/apim-kubernetes-operator-user-guide-management-context/","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","ManagementContext"]},{"title":"Overview","text":"<p>To enable synchronization of CRDs with a remote management API, you need to create a Management Context referring to an existing organization and environment.</p> <p>You can create multiple Management Contexts, each targeting a specific environment and defined in a specific organization of a management API instance.</p> <p>A Management Context can authenticate to your management API instance by using either basic authentication or a bearer token. Authentication credentials may either be added inline in the Management Context definition or referenced from a Kubernetes secret.</p>  <p>Note</p> <p>If both credentials and a bearer token are defined in your custom resource, the bearer token will take precedence.</p>","location":"apim/kubernetes/apim-kubernetes-operator-user-guide-management-context/#overview","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","ManagementContext"]},{"title":"Examples","text":"<p>The custom resource in the example below refers to a Management API instance exposed at <code>https://gravitee-api.acme.com</code>, and targets the <code>dev</code> environment of the <code>acme</code> organization, with the <code>admin</code> account, using basic authentication credentials defined in a Kubernetes secret.</p> <p>Creating a secret to store the credentials:</p> <pre><code>kubectl create secret generic management-context-credentials \\\n  --from-literal=username=admin \\\n  --from-literal=password=admin \\\n  --namespace graviteeio\n</code></pre> <p>Defining a Management Context referencing the secret:</p> <pre><code>apiVersion: gravitee.io/v1alpha1\nkind: ManagementContext\nmetadata:\n  name: apim-example-context\n  namespace: graviteeio\nspec:\n  baseUrl: https://gravitee-api.acme.com\n  environmentId: dev\n  organizationId: acme\n  auth:\n    secretRef:\n      name: management-context-credentials\n</code></pre>  <p>Note</p> <p>If no namespace has been specified for the secret reference, the management context resource namespace will be used to resolve the secret.</p>   <p>Note</p> <p>To target another environment on the same API instance, add another Management Context configured to do that.</p>  <p>Although Kubernetes secrets should be the preferred way to store credentials, you can also add credentials inline in the Management Context definition, as follows:</p> <pre><code>apiVersion: gravitee.io/v1alpha1\nkind: ManagementContext\nmetadata:\n  name: apim-example-context\n  namespace: graviteeio\nspec:\n  baseUrl: https://gravitee-api.acme.com\n  environmentId: dev\n  organizationId: acme\n  auth:\n    credentials:\n      username: admin\n      password: admin\n</code></pre> <p>The example below uses a <code>bearerToken</code> to authenticate the requests. Note that the token must have been generated beforehand for the admin account:</p> <pre><code>apiVersion: gravitee.io/v1alpha1\nkind: ManagementContext\nmetadata:\n  name: apim-example-context\nspec:\n  baseUrl: https://gravitee-api.acme.com\n  environmentId: staging\n  organizationId: acme\n  auth:\n    bearerToken: xxxx-yyyy-zzzz\n</code></pre> <p>Alternatively, here is how to use a Kubernetes secret to store the token:</p> <pre><code>kubectl create secret generic management-context-credentials \\\n  --from-literal=bearerToken=xxxx-yyyy-zzzz \\\n  --namespace graviteeio\n</code></pre> <pre><code>apiVersion: gravitee.io/v1alpha1\nkind: ManagementContext\nmetadata:\n  name: apim-example-context\nspec:\n  baseUrl: https://gravitee-api.acme.com\n  environmentId: staging\n  organizationId: acme\n  auth:\n    secretRef:\n      name: management-context-credentials\n</code></pre>","location":"apim/kubernetes/apim-kubernetes-operator-user-guide-management-context/#examples","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","ManagementContext"]},{"title":"How to try out the GKO after deployment","text":"","location":"apim/kubernetes/apim-kubernetes-operator-user-guide-play/","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s"]},{"title":"Overview","text":"<p>This section describes how to try out the GKO functionality after deployment by creating CRDs and testing your API via and API call from the API Gateway.</p> <p>The process involves the following stages:</p> <ol> <li>Create a Management Context custom resource.</li> <li>Create an API Definition custom resource - this creates a new API on the cluster.</li> <li>Test the new API by calling it through the APIM Gateway.</li> </ol>","location":"apim/kubernetes/apim-kubernetes-operator-user-guide-play/#overview","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s"]},{"title":"Prerequisites","text":"<p>Before you start:</p> <ol> <li>Ensure that the GKO has been successfully deployed on your Kubernetes cluster.</li> <li>Ensure that the <code>services.sync.kubernetes</code> property is enabled (set to <code>true</code>) in the <code>gravitee.yml</code> file. This setting is disabled by default. This step is required for the Gateway to be enabled to work with a Kubernetes Operator. The configuration depends on how the Gateway is deployed:</li> <li>If your Gateway is deployed via a helm chart, you can enable the kubernetes operator option through helm values.</li> <li>For other deployment strategies (for example, deployment via a VM), you can update the configuration directly in the <code>gravitee.yml</code> file or by using an environment variable: <code>GRAVITEE_SERVICES_SYNC_KUBERNETES=true</code>.</li> </ol> <p>The <code>gravitee.yml</code> file value is listed below:</p> <pre><code># [Alpha] Enable Kubernetes Synchronization\n# This sync service requires to install Gravitee Kubernetes Operator\n#    kubernetes:\n#      enabled: false\n</code></pre> <p>See the Configure APIM Gateway section for more information on using environment variables in Gateway configurations.</p>","location":"apim/kubernetes/apim-kubernetes-operator-user-guide-play/#prerequisites","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s"]},{"title":"Trying out the GKO functionality","text":"","location":"apim/kubernetes/apim-kubernetes-operator-user-guide-play/#trying-out-the-gko-functionality","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s"]},{"title":"STEP 1: Create a Management Context custom resource","text":"<p>The first step is to create a Management Context (<code>ManagementContext</code>) custom resource for your APIM instance.</p>  <p>Note</p> <p>Read more about the Management Context custom resource here and here.</p>  <p>To create a Management Context custom resource, you need a YAML file with the correct Management Context configuration. You can use the following sample YAML file from Gravitee directly, or as a template to base your configuration on:</p> <p>https://github.com/gravitee-io/gravitee-kubernetes-operator/blob/master/config/samples/context/k3d/managementcontext_credentials.yaml</p> <p>The content of this sample file is shown below:</p> <pre><code>    # Copyright (C) 2015 The Gravitee team (http://gravitee.io)\n    #\n    # Licensed under the Apache License, Version 2.0 (the \"License\");\n    # you may not use this file except in compliance with the License.\n    # You may obtain a copy of the License at\n    #\n    #         http://www.apache.org/licenses/LICENSE-2.0\n    #\n    # Unless required by applicable law or agreed to in writing, software\n    # distributed under the License is distributed on an \"AS IS\" BASIS,\n    # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    # See the License for the specific language governing permissions and\n    # limitations under the License.\n\n    # Use this context if you are running APIM and GKO in k3d\n    apiVersion: gravitee.io/v1alpha1\n    kind: ManagementContext\n    metadata:\n      name: dev-mgmt-ctx\n      namespace: default\n    spec:\n      baseUrl: http://apim-apim3-api.apim-dev.svc:83\n      environmentId: DEFAULT\n      organizationId: DEFAULT\n      auth:\n        credentials:\n          username: admin\n          password: admin\n</code></pre> <p>In your copy, modify the <code>spec:</code> section by providing the actual URL of your APIM instance and the user credentials that match with the relevant user configuration.</p> <p>To create the Management Context resource using the Gravitee sample file directly, just run the following command:</p> <pre><code>kubectl apply -f https://raw.githubusercontent.com/gravitee-io/gravitee-kubernetes-operator/master/config/samples/context/k3d/managementcontext_credentials.yaml\n</code></pre> <p>Alternatively, to create the Management Context resource using a modified configuration, run the following command (using the relevant filename):</p> <pre><code>kubectl apply -f your_management_context_credentials_config.yaml\n</code></pre> <p>If the operation is successful, you should see the following line in the command-line output:</p> <pre><code>managementcontext.gravitee.io/dev-mgmt-ctx created\n</code></pre> <p>The Management Context resource has now been created.</p>","location":"apim/kubernetes/apim-kubernetes-operator-user-guide-play/#step-1-create-a-management-context-custom-resource","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s"]},{"title":"STEP 2: Create an API Definition custom resource","text":"<p>The next step is to create an API Definition (<code>ApiDefinition</code>) custom resource.</p> <p>Read more about the API Definition custom resource here and here.</p> <p>To create an API Definition (<code>ApiDefinition</code>) custom resource, you need a YAML file with the desired API Definition configuration. You can use the following sample YAML file from Gravitee directly, or as a template to base your configuration on:</p> <p>https://github.com/gravitee-io/gravitee-kubernetes-operator/blob/master/config/samples/apim/api-with-context.yml</p> <p>The content of this sample file is shown below:</p> <pre><code>    #\n    # Copyright (C) 2015 The Gravitee team (http://gravitee.io)\n    #\n    # Licensed under the Apache License, Version 2.0 (the \"License\");\n    # you may not use this file except in compliance with the License.\n    # You may obtain a copy of the License at\n    #\n    #         http://www.apache.org/licenses/LICENSE-2.0\n    #\n    # Unless required by applicable law or agreed to in writing, software\n    # distributed under the License is distributed on an \"AS IS\" BASIS,\n    # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    # See the License for the specific language governing permissions and\n    # limitations under the License.\n    #\n    apiVersion: gravitee.io/v1alpha1\n    kind: ApiDefinition\n    metadata:\n      name: basic-api-example\n      namespace: default\n    spec:\n      name: \"K8s Basic Example With Management Context\"\n      contextRef:\n        name: \"dev-mgmt-ctx\"\n        namespace: \"default\"\n      version: \"1.1\"\n      description: \"Basic api managed by Gravitee Kubernetes Operator\"\n      proxy:\n        virtual_hosts:\n          - path: \"/k8s-basic-with-ctx\"\n        groups:\n          - endpoints:\n              - name: \"Default\"\n                target: \"https://api.gravitee.io/echo\"\n</code></pre> <p>To create the API Definition resource using the Gravitee sample file directly, just run the following command:</p> <pre><code>kubectl apply -f https://raw.githubusercontent.com/gravitee-io/gravitee-kubernetes-operator/master/config/samples/apim/api-with-context.yml\n</code></pre> <p>Alternatively, to create the API Definition resource using a modified configuration, run the following command (using the relevant filename):</p> <pre><code>kubectl apply -f your_api_definition_config.yml\n</code></pre> <p>If the operation is successful, you should see the following line in the command-line output:</p> <pre><code>    apidefinition.gravitee.io/basic-api-example created\n</code></pre> <p>The API Definition resource has now been created and a new API has been added in your Console. You can check it out in your Console URL:</p> <p>http://&lt;YOUR_CONSOLE_URL&gt;/console/#!/environments/default/</p> <p>If you are using a local cluster created through the local cluster installation process, the Console URL would likely be as follows:</p> <p>http://localhost:9000/console/#!/environments/default/</p> <p>The new API will be listed in the \"Number of APIs\" section of the Console dashboard:</p> <p></p>","location":"apim/kubernetes/apim-kubernetes-operator-user-guide-play/#step-2-create-an-api-definition-custom-resource","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s"]},{"title":"STEP 3: Call the API through the APIM Gateway","text":"<p>To test the API, you can call it through the APIM Gateway by running the following command using your APIM Gateway URL:</p> <pre><code>curl -i http://&lt;YOUR_GATEWAY_URL&gt;/gateway/k8s-basic-with-ctx\n</code></pre> <p>The entrypoint used in the Gateway URL may differ depending on your deployment. If you are using a local cluster created through the local cluster installation process, the Gateway URL would likely be as shown in the following command:</p> <pre><code>curl -i http://localhost:9000/gateway/k8s-basic-with-ctx\n</code></pre>","location":"apim/kubernetes/apim-kubernetes-operator-user-guide-play/#step-3-call-the-api-through-the-apim-gateway","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s"]},{"title":"Creating a reusable API resource","text":"<p>You can use the GKO to create reusable API resources by applying the ApiResource CRD. This enables you to define resources such as cache or authentication providers once only and maintain them in a single place, and then reuse them in multiple APIs - any further resource changes will be automatically propagated to all APIs containing a reference to the updated resource(s).</p> <p>The example below shows a redis cache resource that can be applied using the <code>ApiResource</code> CRD:</p> <pre><code>    apiVersion: gravitee.io/v1alpha1\n    kind: ApiResource\n    metadata:\n      name: reusable-resource-cache-redis\n      namespace: default\n    spec:\n      name: \"redis-cache\"\n      type: \"cache-redis\"\n      enabled: true\n      configuration:\n          releaseCache: false\n          maxTotal: 8\n          timeToLiveSeconds: 0\n          timeout: 2000\n          useSsl: true\n          standalone:\n              enabled: true\n              host: \"redis-cache.default.svc.cluster.local\"\n              port: 6379\n          sentinel:\n              enabled: false\n              masterId: \"sentinel-master\"\n          password: \"change_me!\"\n</code></pre>","location":"apim/kubernetes/apim-kubernetes-operator-user-guide-reusable-resources/","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","Reusable CRD"]},{"title":"Referencing API resources in your API definitions","text":"<p>Once an API resource has been created, it can be used as a reference in one or more API definitions. The example below shows how to use the <code>reusable-resource-cache-redis</code> resource in an API definition, using a reference to the resource name and namespace:</p> <pre><code>    apiVersion: gravitee.io/v1alpha1\n    kind: ApiDefinition\n    metadata:\n      name: reusable-resource-example\n      namespace: default\n    spec:\n      name: \"Reusable Resource Example\"\n      version: \"1.0\"\n      description: \"A simple API reusing a redis cache resource\"\n      proxy:\n        virtual_hosts:\n          - path: \"/cached-with-redis\"\n        groups:\n          - endpoints:\n              - name: \"Default\"\n                target: \"https://api.gravitee.io/echo\"\n      resources:\n        - ref:\n            name: reusable-resource-cache-redis\n            namespace: default\n      flows:\n      - name: \"\"\n        path-operator:\n          path: \"/\"\n          operator: \"STARTS_WITH\"\n        condition: \"\"\n        consumers: []\n        methods: []\n        pre:\n        - name: \"Cache\"\n          description: \"Cache with Redis\"\n          enabled: true\n          policy: \"cache\"\n          configuration:\n            timeToLiveSeconds: 600\n            cacheName: \"redis-cache\"\n            methods:\n            - \"GET\"\n            - \"OPTIONS\"\n            - \"HEAD\"\n            scope: \"API\"\n            key: \"cache-key\"\n        post: []\n        enabled: true\n</code></pre> <p>You can also define resources inline in your API definitions. The following API reuses the redis cache resource defined above, and defines inline an in-memory authentication provider:</p> <pre><code>    apiVersion: gravitee.io/v1alpha1\n    kind: ApiDefinition\n    metadata:\n      name: reusable-resource-example\n      namespace: default\n    spec:\n      name: \"Reusable Resource Example\"\n      version: \"1.0\"\n      description: \"A simple API reusing a redis cache resource with an inlined authentication provider\"\n      proxy:\n        virtual_hosts:\n          - path: \"/cached-with-redis\"\n        groups:\n          - endpoints:\n              - name: \"Default\"\n                target: \"https://api.gravitee.io/echo\"\n      resources:\n        - ref:\n            name: reusable-resource-cache-redis\n            namespace: default\n        - name: \"inline-auth\"\n          type: \"auth-provider-inline-resource\"\n          enabled: true\n          configuration:\n              users:\n                - username: \"user\"\n                  password: \"password\"\n      # ...\n</code></pre> <p>If a resource defined inline contains a reference to a reusable resource (using the <code>ref</code> property), the reusable resource will take precedence over the inline configuration.</p>","location":"apim/kubernetes/apim-kubernetes-operator-user-guide-reusable-resources/#referencing-api-resources-in-your-api-definitions","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","Reusable CRD"]},{"title":"How to synchronize your API CRDs with an existing Management API","text":"<p>The following examples for creating a Management Context and creating an API referencing that context are based on the assumption that a Management API has already been deployed in a namespace called <code>apim-example</code>. The connection to that Management API uses the default in-memory credentials.</p>","location":"apim/kubernetes/apim-kubernetes-operator-user-guide-sync-crds/","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","Sync"]},{"title":"Example - creating a Management Context for an existing Management API","text":"<pre><code>    cat &lt;&lt;EOF | kubectl apply -f -\n    apiVersion: gravitee.io/v1alpha1\n    kind: ManagementContext\n    metadata:\n      name: apim-example-context\n      namespace: apim-example\n    spec:\n      baseUrl: http://acme-apim3-api.apim-example.svc:83\n      environmentId: DEFAULT\n      organizationId: DEFAULT\n      auth:\n        credentials:\n          username: admin\n          password: admin\n    EOF\n</code></pre>","location":"apim/kubernetes/apim-kubernetes-operator-user-guide-sync-crds/#example-creating-a-management-context-for-an-existing-management-api","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","Sync"]},{"title":"Example - creating an API referencing an existing Management Context","text":"<pre><code>    cat &lt;&lt;EOF | kubectl apply -f -\n    apiVersion: gravitee.io/v1alpha1\n    kind: ApiDefinition\n    metadata:\n      name: basic-api-example\n      namespace: apim-example\n    spec:\n      name: gko-example\n      contextRef:\n        name: apim-example-context\n        namespace: apim-example\n      version: \"1.0.0\"\n      description: \"Basic api managed by Gravitee Kubernetes Operator\"\n      proxy:\n        virtual_hosts:\n          - path: \"/k8s-basic\"\n        groups:\n          - endpoints:\n              - name: \"Default\"\n                target: \"https://api.gravitee.io/echo\"\n    EOF\n</code></pre>","location":"apim/kubernetes/apim-kubernetes-operator-user-guide-sync-crds/#example-creating-an-api-referencing-an-existing-management-context","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","Sync"]},{"title":"Using an APIM export endpoint to create an API Definition from an existing API","text":"<p>The Management API feature provides an export endpoint that enables you to export an API as an API Definition resource.</p> <p>This allows you to easily create an API Definition from a given environment by calling the endpoint and piping the result to a <code>kubectl</code> command. For example:</p> <pre><code>curl -s -H \"Authorization: Bearer $TOKEN\" \"https://apim-example-api.team-gko.gravitee.xyz/management/organizations/DEFAULT/environments/DEFAULT/apis/$API_ID/crd\" | kubectl apply -f -\n</code></pre>","location":"apim/kubernetes/apim-kubernetes-operator-user-guide-sync-crds/#using-an-apim-export-endpoint-to-create-an-api-definition-from-an-existing-api","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","Sync"]},{"title":"Starting and stopping your API","text":"<p>By default the API will start automatically. If you want to stop it later (or just create an API definition in \"stop mode\"), set the <code>state</code> property value to <code>STOPPED</code>, as shown in the example below:</p> <pre><code>    cat &lt;&lt;EOF | kubectl apply -f -\n    apiVersion: gravitee.io/v1alpha1\n    kind: ApiDefinition\n    metadata:\n      name: basic-api-example\n      namespace: apim-example\n    spec:\n      name: gko-example\n      contextRef:\n        name: apim-example-context\n        namespace: apim-example\n      version: \"1.0.0\"\n      description: \"Basic api managed by Gravitee Kubernetes Operator\"\n      state: \"STOPPED\"\n      proxy:\n        virtual_hosts:\n          - path: \"/k8s-basic\"\n        groups:\n          - endpoints:\n              - name: \"Default\"\n                target: \"https://api.gravitee.io/echo\"\n    EOF\n</code></pre> <p>To start the API again, change the <code>state</code> property value back to <code>STARTED</code>.</p>","location":"apim/kubernetes/apim-kubernetes-operator-user-guide-sync-crds/#starting-and-stopping-your-api","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","Sync"]},{"title":"Updating your API","text":"<p>To update the API, follow the example below - it shows a simple update of the API name, path, and endpoint target.</p> <p>Before you proceed, ensure that the steps above have been completed.</p> <pre><code>    cat &lt;&lt;EOF | kubectl apply -f -\n    apiVersion: gravitee.io/v1alpha1\n    kind: ApiDefinition\n    metadata:\n      name: basic-api-example\n      namespace: apim-example\n    spec:\n      name: gko-example-updated\n      contextRef:\n        name: apim-example-context\n        namespace: apim-example\n      version: \"1.0.0\"\n      description: \"Basic api managed by Gravitee Kubernetes Operator\"\n      proxy:\n        virtual_hosts:\n          - path: \"/k8s-basic-updated\"\n        groups:\n          - endpoints:\n              - name: \"Default\"\n                target: \"https://api.gravitee.io/whattimeisit\"\n    EOF\n</code></pre>","location":"apim/kubernetes/apim-kubernetes-operator-user-guide-sync-crds/#updating-your-api","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","Sync"]},{"title":"Deleting your API","text":"<p>Before you proceed, ensure that the steps above have been completed.</p> <p>The example below shows a simple deletion of the API definition:</p> <pre><code>kubectl -n apim-example delete apidefinitions.gravitee.io basic-api-example\n</code></pre>","location":"apim/kubernetes/apim-kubernetes-operator-user-guide-sync-crds/#deleting-your-api","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s","Sync"]},{"title":"GKO User Guide","text":"<p>In this section you can learn how to work with CRDs and how to synchronize your API CRDs with an existing management API, including how to start, stop, update, and delete your APIs - all this with examples.</p> <p>The Gravitee Kubernetes Operator comes with three Custom Resource Definitions (CRDs) - <code>ManagementContext</code>, <code>ApiDefinition</code>, and <code>ApiResource</code>. They are described in detail further in this section.</p> <p>The GKO only works with APIM version 3.19.0 (and above).</p>","location":"apim/kubernetes/apim-kubernetes-operator-user-guide/","tags":["Gravitee Kubernetes Operator","GKO","Introduced in version 3.19.0","BETA release","K8s"]},{"title":"APIM architecture overview","text":"<p>This page provides an overview of the global architecture that Gravitee.io APIM is based on.</p> <p>Before you install and use the product, take a few moments to familiarize yourself with it.</p>","location":"apim/overview/architecture/","tags":["APIM","Architecture"]},{"title":"Global APIM architecture","text":"<p>Gravitee.io APIM - Global Architecture</p> <p></p>","location":"apim/overview/architecture/#global-apim-architecture","tags":["APIM","Architecture"]},{"title":"APIM components overview","text":"<p>Gravitee.io APIM is separated into four main components:</p> <ol> <li>APIM Gateway</li> <li>APIM API</li> <li>APIM Console</li> <li>APIM Portal</li> </ol>","location":"apim/overview/components/","tags":["APIM","Components"]},{"title":"APIM Gateway","text":"<p>APIM Gateway is the core component of the APIM platform. You can think of it like a smart proxy.</p> <p>Unlike a traditional HTTP proxy, APIM Gateway has the capability to apply policies (i.e., rules) to both HTTP requests and responses according to your needs. With these policies, you can enhance request and response processing by adding transformations, security, and many other exciting features.</p> <p>Gravitee.io - Internal Gateway</p> <p></p>","location":"apim/overview/components/#apim-gateway","tags":["APIM","Components"]},{"title":"APIM API","text":"<p>This RESTful API exposes services to manage and configure the APIM Console and APIM Portal web UIs. All exposed services are restricted by authentication and authorization rules. For more information, see the API Reference section.</p>","location":"apim/overview/components/#apim-api","tags":["APIM","Components"]},{"title":"APIM Console","text":"<p>This web UI gives easy access to some key APIM API services. API Publishers can use it to publish APIs. Administrators can also configure global platform settings and specific portal settings.</p>","location":"apim/overview/components/#apim-console","tags":["APIM","Components"]},{"title":"APIM Portal","text":"<p>This web UI gives easy access to some key APIM API services. API Consumers can use it to search for, view, try out and subscribe to a published API. They can also use it to manage their applications.</p>","location":"apim/overview/components/#apim-portal","tags":["APIM","Components"]},{"title":"Introduction to Gravitee API Management (APIM)","text":"<p>Organizations need API management solutions to publish their APIs to external developers, internal developers, and other partners. API management can unlock the potential of the organization\u2019s data and services, as well as facilitate the transformation to OpenAPI and OpenData, extending the company\u2019s digital platform offerings, opening new communication channels, and finding new customers.</p> <p>Naturally, a growing customer base brings new challenges, such as:</p> <ul> <li> <p>How to reduce the time taken to enroll new partners.</p> </li> <li> <p>How to identify partners and manage their API consumption.</p> </li> <li> <p>How to measure consumption from a consumer and/or producer point of     view.</p> </li> <li> <p>How to share existing APIs and how to discover them.</p> </li> <li> <p>How to manage the API lifecycle, versioning, documentation, and so     on.</p> </li> </ul> <p>How can businesses address all these challenges seamlessly, for all APIs, using a centralized tool? Simple \u2013 by choosing Gravitee.io API Management.</p>","location":"apim/overview/introduction/","tags":["APIM","Introduction"]},{"title":"What Is Gravitee.io API Management?","text":"<p>Gravitee.io API Management (APIM) is a flexible, lightweight, and blazing-fast open source API management solution that gives your organization full control over who accesses your API \u2014 when and how. APIM is both simple to use and powerful, acting as a global solution for API management. Gravitee.io APIM is composed of four main components:</p> <ol> <li>APIM Gateway</li> <li>APIM API</li> <li>APIM Console</li> <li>APIM Portal</li> </ol> <p>We\u2019ll dive into these components in detail in their respective sections.</p>","location":"apim/overview/introduction/#what-is-graviteeio-api-management","tags":["APIM","Introduction"]},{"title":"Why Gravitee.io API Management?","text":"<p>Our goal in launching Gravitee.io APIM is to provide users with a highly flexible and scalable solution that integrates with their infrastructure seamlessly and fits their business needs perfectly. We\u2019ve designed and developed APIM to be fully extensible using its own internal plugin system, so you can define your own policy, develop your own reporting system, and more.</p> <p>Additionally, all APIM components (including APIM Gateway and APIM API) are incredibly lightweight. We took a consciously aggressive approach to CPU and memory management with our products to supply high availability through our lightning-fast component start-up times.</p> <p>Typically, it takes less than 5 seconds for the API Gateway to be accessible to consumers (subject to the number of APIs being deployed).</p>","location":"apim/overview/introduction/#why-graviteeio-api-management","tags":["APIM","Introduction"]},{"title":"Concepts","text":"","location":"apim/overview/introduction/#concepts","tags":["APIM","Introduction"]},{"title":"API","text":"<p>API is the root concept defined and used by APIM. Think of this as the starting point through which services are exposed to the gateway.</p>","location":"apim/overview/introduction/#api","tags":["APIM","Introduction"]},{"title":"Publisher","text":"<p>In our platform, we define a publisher (also called API publisher) as the role that declares and manages APIs.</p>","location":"apim/overview/introduction/#publisher","tags":["APIM","Introduction"]},{"title":"Consumer","text":"<p>In our platform, we define a consumer (also called API consumer) as the role that consumes APIs.</p>  <p>PRO-TIP:</p> <p>A consumer can only consume an API after subscribing to it.</p>","location":"apim/overview/introduction/#consumer","tags":["APIM","Introduction"]},{"title":"Application","text":"<p>An application is an intermediate level between a consumer and an API. The consumer uses an application to subscribe to the API before they are able to consume it.</p> <p>Ready to use Gravitee.io API Management? Let\u2019s get started!</p>","location":"apim/overview/introduction/#application","tags":["APIM","Introduction"]},{"title":"Plugins","text":"","location":"apim/overview/plugins/","tags":["APIM","Components"]},{"title":"Overview","text":"<p>Plugins are additional components that can be plugged into APIM Gateway or APIM API. They can customize the component\u2019s behavior to exactly fit your needs and technical constraints.</p> <p>For more information about plugins, including how to deploy them and details of their directory structure, see the Plugins Developer Guide.</p>","location":"apim/overview/plugins/#overview","tags":["APIM","Components"]},{"title":"Types of Plugins","text":"<p>The table below lists the different types of plugins you can use with APIM, with the component(s) they can be plugged into and some examples. For more details of what each plugin type does, see the sections below.</p>         Type Component Examples     <p>Identity Providers</p> <p>APIM API</p> <p>LDAP, Oauth2, InMemory</p>   <p>Fetchers</p> <p>APIM API</p> <p>HTTP, GIT</p>   <p>Policies</p> <p>APIM API APIM Gateway</p> <p>API Key, Rate-limiting, Cache</p>   <p>Reporters</p> <p>APIM Gateway</p> <p>Elasticsearch, Accesslog</p>   <p>Repositories</p> <p>APIM API APIM Gateway</p> <p>MongoDB, Redis, Elasticsearch</p>   <p>Resources</p> <p>APIM API APIM Gateway</p> <p>Oauth2, Cache, LDAP</p>   <p>Services</p> <p>APIM API APIM Gateway</p> <p>Sync, local-registry, health-check, monitor</p>   <p>Notifiers</p> <p>Alert Engine</p> <p>Email</p>   <p>Alerts</p> <p>APIM API APIM Gateway</p> <p>Vertx</p>","location":"apim/overview/plugins/#types-of-plugins","tags":["APIM","Components"]},{"title":"Identity Providers","text":"<p>An identity provider brokers trust with external user providers, to authenticate and obtain information about your end users.</p> <p>Out-of-the-box identity providers are:</p> <ul> <li> <p>MongoDB</p> </li> <li> <p>In-memory</p> </li> <li> <p>LDAP / Active Directory</p> </li> <li> <p>OpenID Connect IdP (Azure AD, Google)</p> </li> </ul>","location":"apim/overview/plugins/#identity-providers","tags":["APIM","Components"]},{"title":"Policies","text":"<p>A policy modifies the behavior of the request or response handled by APIM Gateway. It can be chained by a request policy chain or a response policy chain using a logical order. Policies can be considered like a proxy controller, guaranteeing that a given business rule is fulfilled during request/response processing.</p> <p>Examples of a policy are:</p> <ul> <li> <p>Authorization using an API key (see the api-key policy documentation)</p> </li> <li> <p>Applying header or query parameter transformations</p> </li> <li> <p>Applying rate limiting or quotas to avoid API flooding</p> </li> </ul> <p>Want to know how to create, use, and deploy a custom policy? Check out the Policies Developer Guide.</p>","location":"apim/overview/plugins/#policies","tags":["APIM","Components"]},{"title":"Reporters","text":"<p>A reporter is used by an APIM Gateway instance to report many types of event:</p> <ul> <li> <p>Request/response metrics\u2009\u2014\u2009for example, response-time,     content-length, api-key</p> </li> <li> <p>Monitoring metrics\u2009\u2014\u2009for example, CPU, Heap usage</p> </li> <li> <p>Health-check metrics\u2009\u2014\u2009for example, status, response code</p> </li> </ul> <p>Out-of-the-box reporters are :</p> <ul> <li> <p>Elasticsearch Reporter</p> </li> <li> <p>File Reporter</p> </li> </ul> <p>As with all plugins, you can create, use and deploy custom reporters as described in the Plugins Developer Guide.</p>","location":"apim/overview/plugins/#reporters","tags":["APIM","Components"]},{"title":"Repositories","text":"<p>A repository is a pluggable storage component for API configuration, policy configuration, analytics and so on. You can find more information in the Repositories section of the Installation Guide.</p>","location":"apim/overview/plugins/#repositories","tags":["APIM","Components"]},{"title":"Resources","text":"<p>A resource can be added to an API for its whole lifecycle. APIM comes with three default resources:</p> <ul> <li> <p>Cache</p> </li> <li> <p>OAuth2 - Gravitee Access Management</p> </li> <li> <p>OAuth2 - Generic Authorization Server</p> </li> </ul> <p>You can find more information in the Resources section of the API Publisher Guide.</p>","location":"apim/overview/plugins/#resources","tags":["APIM","Components"]},{"title":"Notifiers","text":"<p>A notifier is used to send notifications. Currently, the only notifier available is the email notifier, but others including slack and portal are planned soon.</p>","location":"apim/overview/plugins/#notifiers","tags":["APIM","Components"]},{"title":"Alerts","text":"<p>An alert is used to send triggers or events to the Alert Engine which can be processed to send a notification using the configured plugin notifier. Configuring the notifier is the responsibility of the trigger.</p>","location":"apim/overview/plugins/#alerts","tags":["APIM","Components"]},{"title":"Overview","text":"<p>This page explains how to migrate your existing API to Design Studio. It also summarizes the differences between the APIM Console Design function and Design Studio.</p>","location":"apim/policy-reference/policies-migrate/"},{"title":"Migrate an API","text":"<ol> <li> <p>Log in to APIM Console.</p> </li> <li> <p>Click APIs.</p> </li> <li> <p>Select your API and click Design.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/policies/graviteeio-policy-studio-before-migration.png %}[]</p> </li> <li> <p>Click the migrate button.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/policies/graviteeio-policy-studio-migration-button.png %}[]</p> <p>You are redirected to Design Studio.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/policies/graviteeio-policy-studio-migrated.png %}[]</p> </li> </ol>","location":"apim/policy-reference/policies-migrate/#migrate-an-api"},{"title":"Differences between Design function and new Design Studio","text":"<p>With the Design function, HTTP methods were linked directly to policies. With Design Studio, HTTP methods are linked to a flow. This means that you could have a path with policies linked to different HTTP Methods. The migration transforms each \"Path\"-\"HTTP methods\"-\"Policy\" into one flow.</p> <p>By default, the selection of a flow is based on the operator defined in the flow itself.</p> <p>You can use the operator either to select a flow with a path which matches exactly, or when the start of the path matches. You can then use the Best match option to select the flow from the path that is closest.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/policies/graviteeio-policy-studio-best-match.png %}[]</p>","location":"apim/policy-reference/policies-migrate/#differences-between-design-function-and-new-design-studio"},{"title":"Overview","text":"<p>APIM is delivered with some default common policies, for standard APIM usage. You can also customize APIM by adding your own policies. The default APIM policies are described in this section.</p> <p>You can configure these policies in two ways:</p> <ul> <li>Using the API Design function:</li> </ul> <p>image::{% link images/apim/3.x/api-publisher-guide/policies/graviteeio-old-studio-overview.png %}[]</p> <ul> <li>Using Design Studio (available from APIM 3.5.x):</li> </ul> <p>image::{% link images/apim/3.x/api-publisher-guide/policies/graviteeio-policy-studio-overview.png %}[]</p> <p>You can migrate from the former Design function to Design Studio by following link:{{ /apim/3.x/apim_policies_migrate.html | relative_url }}[this procedure].</p>","location":"apim/policy-reference/policies-overview/"},{"title":"Ant notation","text":"<p>APIM frequently uses Ant notation for path matching:</p> <ul> <li> <p><code>?</code> matches one character</p> </li> <li> <p><code>\\*</code> matches zero or more characters</p> </li> <li> <p><code>**</code> matches zero or more directories in a path</p> </li> </ul>","location":"apim/policy-reference/policies-overview/#ant-notation"},{"title":"See also","text":"<p>For details of how policies are defined and used in APIM, see also:</p> <ul> <li> <p>link:{{ /apim/3.x/apim_publisherguide_plans_subscriptions.html     | relative_url }}[Plans and subscriptions^] in the API Publisher     Guide to learn how to configure policies for API plans in APIM     Console</p> </li> <li> <p>link:{{ /apim/3.x/apim_publisherguide_expression_language.html     | relative_url }}[Expression Language^] in the API Publisher     Guide to learn more about using the Gravitee Expression Language     with policies</p> </li> <li> <p>link:{{ /apim/3.x/apim_devguide_policies.html | relative_url     }}[Policies^] in the Developer Guide to learn how to create custom     policies</p> </li> <li> <p>link:{{ /apim/3.x/apim_devguide_plugins.html | relative_url     }}[Plugins^] in the Developer Guide to learn how to deploy plugins     (of which policies are one type)</p> </li> <li> <p>link:{{ /apim/3.x/apim_adminguide_platform_policies.html |     relative_url }}[Platform policies^] in the Admin Guide to learn     how to use policies at the organization level</p> </li> </ul> <p>Before you use this reference, we recommend you read link:{{ /apim/3.x/apim_publisherguide_plans_subscriptions.html | relative_url }}[Plans and subscriptions^] in the API Publisher Guide to understand how policies work in APIM.</p>","location":"apim/policy-reference/policies-overview/#see-also"},{"title":"Javascript policy","text":"<p>The JavaScript policy is not included by default. To use this policy, you must download and install the plugin.</p>","location":"apim/policy-reference/policy-javascript/"},{"title":"Phases","text":"<p>onRequest</p> <p>onResponse</p> <p>onRequestContent</p> <p>onResponseContent</p>   <p>X</p> <p>X</p> <p>X</p> <p>X</p>","location":"apim/policy-reference/policy-javascript/#phases"},{"title":"Description","text":"<p>You can use this policy to run Javascript^ scripts at every stage of gateway processing.</p>","location":"apim/policy-reference/policy-javascript/#description"},{"title":"Phase - onRequest","text":"<p>As an example of what you can do in the onRequest phase, this script stops the processing if the request contains a certain header.</p> <pre><code>if (request.headers.containsKey('X-Gravitee-Break')) {\n    result.state = State.FAILURE;\n    result.code = 500\n    result.error = 'Stopped processing due to X-Gravitee-Break header'\n} else {\n    request.headers.set('X-Javascript-Policy', 'ok');\n}\n</code></pre> <p>In the onRequest phase you have access to the request object and the context object.</p>          <p>Object</p> <p>Property</p> <p>Type</p> <p>Description</p>   <p>request</p> <p>id</p> <p>string</p> <p>-</p>   <p>request</p> <p>transactionId</p> <p>string</p> <p>-</p>   <p>request</p> <p>uri</p> <p>string</p> <p>-</p>   <p>request</p> <p>path</p> <p>string</p> <p>-</p>   <p>request</p> <p>pathInfo</p> <p>string</p> <p>-</p>   <p>request</p> <p>contextPath</p> <p>string</p> <p>-</p>   <p>request</p> <p>parameters</p> <p>multivalue map</p> <p>-</p>   <p>request</p> <p>pathParameters</p> <p>multivalue map</p> <p>-</p>   <p>request</p> <p>headers</p> <p>iterable map &lt;string, string&gt;</p> <p>-</p>   <p>request</p> <p>method</p> <p>enum</p> <p>-</p>   <p>request</p> <p>version</p> <p>enum</p> <p>-</p>   <p>request</p> <p>timestamp</p> <p>long</p> <p>-</p>   <p>request</p> <p>remoteAddress</p> <p>string</p> <p>-</p>   <p>request</p> <p>localAddress</p> <p>string</p> <p>-</p>   <p>request</p> <p>scheme</p> <p>string</p> <p>-</p>   <p>request</p> <p>sslSession</p> <p>javax.net.ssl.SSLSession</p> <p>-</p>   <p>request</p> <p>metrics</p> <p>object</p> <p>-</p>    <p>The context object doesn\u2019t have known properties as such, it contains the attributes of the execution environment. And you can add some yourself too. For example, this could be the first line of your onRequest script:</p> <pre><code>context.setAttribute('custom-policy-start',Date.now());\n</code></pre> <p>That probably doesn\u2019t look all that exciting, but wait until the onResponse script and you\u2019ll see! The context object gives you access to the following methods:</p>         <p>Object</p> <p>Method</p> <p>Description</p>   <p>context</p> <p>Object getAttribute(String)</p> <p>-</p>   <p>context</p> <p>void setAttribute(String, Object)</p> <p>-</p>   <p>context</p> <p>void removeAttribute(String)</p> <p>-</p>   <p>context</p> <p>Map&lt;String, Object&gt; getAttributes()</p> <p>-</p>","location":"apim/policy-reference/policy-javascript/#phase-onrequest"},{"title":"Phase - onRequestContent","text":"<p>In the onRequestContent phase you have access to the content object, also known as the request body^. You can modify this object.</p> <p>As an example, assuming the following request body:</p> <pre><code>[\n    {\n        \"age\": 32,\n        \"firstname\": \"John\",\n        \"lastname\": \"Doe\"\n    }\n]\n</code></pre> <p>Then you can do the following:</p> <pre><code>var content = JSON.parse(request.content);\ncontent[0].firstname = 'Hacked ' + content[0].firstname;\ncontent[0].country = 'US';\n\nJSON.stringify(content);\n</code></pre> <p>And the request body being passed to the API would be:</p> <pre><code>[\n    {\n        \"age\": 32,\n        \"firstname\": \"Hacked John\",\n        \"lastname\": \"Doe\",\n        \"country\": \"US\"\n    }\n]\n</code></pre> <p>When working with scripts on onRequestContent phase, the last instruction of the script must be the new body content that would be returned by the policy.</p>","location":"apim/policy-reference/policy-javascript/#phase-onrequestcontent"},{"title":"Phase - onResponse","text":"<p>In the onResponse phase you have access to the request, the response and the context object.</p>          <p>Object</p> <p>Property</p> <p>Type</p> <p>Description</p>   <p>response</p> <p>status</p> <p>int</p> <p>-</p>   <p>response</p> <p>reason</p> <p>String</p> <p>-</p>   <p>response</p> <p>headers</p> <p>iterable map &lt;string, string&gt;</p> <p>-</p>    <p>As an example of what you can do in the onResponse phase, this script modifies the headers. And it uses the custom context attribute you set in the onRequest phase too:</p> <pre><code>response.headers.remove('Server');\nresponse.headers.set('Server', 'Powered by Gravitee');\nresponse.headers.set('X-Time-Elapsed', String(Date.now() - context.getAttribute('custom-policy-start')));\n</code></pre>","location":"apim/policy-reference/policy-javascript/#phase-onresponse"},{"title":"Phase - onResponseContent","text":"<p>In the onResponseContent phase you have access to the content object, also known response message. You can modify this object.</p> <p>As an example, assume that you sent the request body modified in the onRequestContent phase to an echo API. You can do the following:</p> <pre><code>var content = JSON.parse(response.content);\ncontent[0].firstname = content[0].firstname.substring(7);\ndelete content[0].country;\nJSON.stringify(content);\n</code></pre> <p>And the reponse message would be:</p> <pre><code>[\n    {\n        \"age\": 32,\n        \"firstname\": \"John\",\n        \"lastname\": \"Doe\"\n    }\n]\n</code></pre> <p>When working with scripts on onResponseContent phase, the last instruction of the script must be the new body content that would be returned by the policy.</p>","location":"apim/policy-reference/policy-javascript/#phase-onresponsecontent"},{"title":"Reference - Metrics","text":"<p>It is highly advisable to use the link:{% link pages/apim/3.x/policy-reference/policy-metrics-reporter.adoc %}[Metrics Reporter] in order to manage the metrics. However, the request object does contain a metrics object.</p>          <p>Object</p> <p>Property</p> <p>Type</p> <p>Description</p>   <p>metrics</p> <p>api</p> <p>String</p> <p>ID of the API</p>   <p>metrics</p> <p>apiResponseTimeMs</p> <p>long</p> <p>Response time spend to call the backend upstream</p>   <p>metrics</p> <p>application</p> <p>String</p> <p>ID of the consuming application</p>   <p>metrics</p> <p>endpoint</p> <p>String</p> <p>-</p>   <p>metrics</p> <p>errorKey</p> <p>String</p> <p>Key of the error if the policy chain is failing</p>   <p>metrics</p> <p>host</p> <p>String</p> <p>Host header value</p>   <p>metrics</p> <p>httpMethod</p> <p>enum</p> <p>-</p>   <p>metrics</p> <p>localAddress</p> <p>String</p> <p>-</p>   <p>metrics</p> <p>log</p> <p>object</p> <p>-</p>   <p>metrics</p> <p>mappedPath</p> <p>String</p> <p>-</p>   <p>metrics</p> <p>message</p> <p>String</p> <p>-</p>   <p>metrics</p> <p>path</p> <p>String</p> <p>-</p>   <p>metrics</p> <p>plan</p> <p>String</p> <p>ID of the plan</p>   <p>metrics</p> <p>proxyLatencyMs</p> <p>long</p> <p>Latency of the gateway to apply policies</p>   <p>metrics</p> <p>proxyResponseTimeMs</p> <p>long</p> <p>Global response time to process and respond to the consumer</p>   <p>metrics</p> <p>remoteAddress</p> <p>String</p> <p>-</p>   <p>metrics</p> <p>requestContentLength</p> <p>long</p> <p>-</p>   <p>metrics</p> <p>requestId</p> <p>String</p> <p>-</p>   <p>metrics</p> <p>responseContentLength</p> <p>long</p> <p>-</p>   <p>metrics</p> <p>securityToken</p> <p>String</p> <p>-</p>   <p>metrics</p> <p>securityType</p> <p>enum</p> <p>-</p>   <p>metrics</p> <p>status</p> <p>int</p> <p>-</p>   <p>metrics</p> <p>subscription</p> <p>String</p> <p>ID of the subscription</p>   <p>metrics</p> <p>tenant</p> <p>String</p> <p>gateway tenant value</p>   <p>metrics</p> <p>transactionId</p> <p>String</p> <p>-</p>   <p>metrics</p> <p>uri</p> <p>String</p> <p>-</p>   <p>metrics</p> <p>user</p> <p>String</p> <p>End-user doing the call (in case of OAuth2 / JWT / Basic Auth)</p>   <p>metrics</p> <p>userAgent</p> <p>String</p> <p>Value of the user-agent header</p>   <p>metrics</p> <p>zone</p> <p>String</p> <p>Gateway zone</p>    <p>The metrics object changes in the different processing phases and some properties may not make sense in certain phases!</p>","location":"apim/policy-reference/policy-javascript/#reference-metrics"},{"title":"How to access APIM Console","text":"<p>You access APIM Console using the <code>http://MANAGEMENT_UI_SERVER_DOMAIN</code> URL created during installation.</p> <p>During the APIM installation process a default administrator account is created. You can use this account to perform all the management tasks provided by APIM, such as creating APIs, registering users and configuring security.</p> <p>By default, the login details for the APIM Console administrator account are <code>admin / admin</code>.</p> <p>To log in:</p> <ol> <li> <p>Open APIM Console.</p> </li> <li> <p>Enter the administrator credentials and click SIGN IN.</p> <p>image:{% link images/apim/3.x/quickstart/console-login.png %}[]</p> </li> </ol> <p>You are now ready to link:{{ /apim/3.x/apim_quickstart_publish_ui.html | relative_url }}[publish your first API^].</p>","location":"apim/quickstart/quickstart-console-login/"},{"title":"Home dashboard","text":"<p>After login you are directed to your home dashboard, where you can access information and statistics relating to your APIs:</p> <p>image:{% link images/apim/3.x/quickstart/home-dashboard.png %}[]</p> <p>The dashboard view may vary according to your APIM version.</p> <p>You can:</p> <ul> <li> <p>change the time period or click REFRESH to update the display</p> </li> <li> <p>view the API health check in the API STATUS tab (see below for     more details)</p> </li> <li> <p>view the other dashboards and logs in the ANALYTICS tab</p> </li> <li> <p>drill down to the details of a specific API event by clicking it in     the list at the bottom of the page</p> <p>image:{% link images/apim/3.x/quickstart/home-dashboard-events.png %}[]</p> </li> </ul>","location":"apim/quickstart/quickstart-console-login/#home-dashboard"},{"title":"API status","text":"<p>You can view the status of all your APIs or only APIs with health checking enabled, by toggling on and off the View all APIs option.</p> <p>For APIs with health checking enabled, clicking the detail of the API redirects you to the Health check page. For more details, see link:{{ /apim/3.x/apim_publisherguide_backend_services.html | relative_url }}[Load balancing, failover and health check^].</p> <p>The APIs can be in three different states:</p> <ul> <li> <p>If the uptime is over 95%, the API is shown as in an OK state     (green)</p> </li> <li> <p>If the uptime is between 80 and 95%, the API is shown as in a     warning state (orange)</p> </li> <li> <p>If the uptime is under 80%, the API is shown as in an error state     (red)</p> </li> </ul>","location":"apim/quickstart/quickstart-console-login/#api-status"},{"title":"Customize the dashboard","text":"<p>You can customize the default dashboard view by resizing or removing widgets, or by adding custom metrics, as described in link:{{ /apim/3.x/apim_how_to_add_custom_metrics_in_dashboards.html | relative_url }}[How to add custom metrics in dashboards^].</p> <p>To perform more advanced configuration, see link:{{ /apim/3.x/apim_installguide_management_ui_configuration.html#home-dashboard | relative_url }}[Home dashboard^] in the Configuration Guide.</p>","location":"apim/quickstart/quickstart-console-login/#customize-the-dashboard"},{"title":"Introduction","text":"<p>Now that you\u2019ve successfully installed Gravitee.io APIM, this quick start guide will get you up and running in no time. You can find more detailed information about how to publish and consume APIs in APIM in the following sections:</p> <ul> <li>API Publisher Guide</li> <li>API Consumer Guide</li> </ul>","location":"apim/quickstart/quickstart-overview/"},{"title":"Overview","text":"<p>You can access APIM Portal as a public user without logging in. You only need to log in to APIM Portal if you want to work with private APIs. For more information, see the link:{{ /apim/3.x/apim_consumerguide_portal.html | relative_url }}[API Consumer Guide].</p>","location":"apim/quickstart/quickstart-portal-login/"},{"title":"How to access APIM Portal","text":"<p>There are two ways to access APIM Portal:</p> <ul> <li> <p>If you are logged into APIM Console already, with the DEVELOPERS     PORTAL button:</p> <p>image:{% link images/apim/3.10/apim-console-devportal.png %}[] * Directly in your browser, with the <code>http://PORTAL_UI_SERVER_DOMAIN</code> URL created during installation.</p> </li> </ul> <p>During the APIM installation process a default administrator account is created. By default, the login details for the APIM Portal administrator account are <code>admin / admin</code>. Ordinary users of APIM Portal need to obtain their user credentials from an administrator.</p> <p>To log in:</p> <ol> <li> <p>Open APIM Portal and click Sign in.</p> <p>image:{% link images/apim/3.x/quickstart/portal-signin.png %}[]</p> </li> <li> <p>Enter your user credentials and click SIGN IN.</p> <p>image:{% link images/apim/3.x/quickstart/portal-login.png %}[]</p> </li> </ol> <p>You are now ready to link:{{ /apim/3.x/apim_quickstart_consume_ui.html | relative_url }}[subscribe to some APIs^].</p>","location":"apim/quickstart/quickstart-portal-login/#how-to-access-apim-portal"},{"title":"Using APIM API","text":"<p>= Consuming an API with APIM API :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_quickstart_consume_api.html :page-folder: apim/quickstart :page-layout: apim3x</p> <p>== Overview</p> <p>This guide walks you through creating your first application and subscribing to your first API with APIM API. For a brief overview of how to set up your first API, see the Publish your first API section of the Quick Start Guide.</p> <p>NOTE: APIM includes several ways to access and secure an API, as described in (link:{{ '/apim/3.x/apim_publisherguide_plans_subscriptions.html' | relative_url }}[API Publisher Plans and subscriptions]). In this example, we will access an API using an link:{{ '/apim/3.x/apim_policies_apikey.html' | relative_url }}[API Key]. Only trusted applications can access the API data by requesting an API Key.</p> <p>== Create your application and subscribe to an API</p> <p>Create application request:: [source]</p>  <p>curl -H \"Authorization: Basic YWRtaW46YWRtaW4=\" \\      -H \"Content-Type:application/json;charset=UTF-8\" \\      -X POST \\      -d '{\"name\":\"My first Application\",\"type\":\"Web\",\"description\":\"Web client for Gravitee.io Echo API\"}' \\      http://MANAGEMENT_API_SERVER_DOMAIN/portal/environments/DEFAULT/applications</p>  <p>Subscribe to API request:: [source]</p>  <p>curl -H \"Authorization: Basic $lmA_AUTH\" \\      -H \"Content-Type:application/json;charset=UTF-8\" \\      -X POST \\      -d '{\"application\":\"[APPLICATION_ID]\",\"plan\":\"[PLAN_ID]\"' \\      http://MANAGEMENT_API_SERVER_DOMAIN/portal/environments/DEFAULT/subscriptions</p>  <p>For more information, see the complete link:{{ '/apim/3.x/apim_installguide_rest_apis_documentation.html' | relative_url }}[Rest API documentation].</p>","location":"apim/quickstart/api-consumer/api-consumer-api/"},{"title":"Test your API","text":"<p>= Test your API :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_quickstart_consume_test.html :page-folder: apim/quickstart :page-layout: apim3x</p> <p>Now that you have created your application, you can go ahead and obtain your API key.</p> <p>. Click Applications in the top menu. . Click My subscriptions in the sub-menu. + image::{% link images/apim/3.x/quickstart/consume/graviteeio-create-first-app-9.png %}[]</p> <p>. Select your application in the list on the left. . Select the API in the list on the right. . Copy the <code>curl</code> command at the bottom of the page. + [IMPORTANT] ==== By default, the host in the command is <code>https://api.company.com</code>. You need to change this value in the Sharding Tags section of the Management UI settings.</p>","location":"apim/quickstart/api-consumer/api-consumer-test/"},{"title":"image::{% link images/apim/3.x/quickstart/consume/graviteeio-settings-sharding-tags.png %}[]","text":"<p>+ You can use your API Key by setting the HTTP Header <code>X-Gravitee-Api-Key</code> or using the request query parameter <code>api-key</code>. + [source]</p>  <p>curl http://GATEWAY_SERVER_DOMAIN/myfirstapi \\      -H \"X-Gravitee-Api-Key:\"  <p>+ The Gravitee.io Echo API data is returned successfully.</p> <p>You can now test API requests, as described in the https://github.com/gravitee-io/gravitee-sample-apis/blob/master/gravitee-echo-api/README.md[Gravitee.io Echo API documentation].</p>","location":"apim/quickstart/api-consumer/api-consumer-test/#image-link-imagesapim3xquickstartconsumegraviteeio-settings-sharding-tagspng"},{"title":"Overview","text":"<p>This guide walks you through creating your first application and subscribing to your first API with APIM Portal. For a brief overview of how to set up your first API, see the Publish your first API section of the Quick Start Guide.</p> <p>APIM includes several ways to access and secure an API, as described in (link:{{ /apim/3.x/apim_publisherguide_plans_subscriptions.html | relative_url }}[API Publisher Plans and subscriptions]). In this example, we will access an API using an link:{{ /apim/3.x/apim_policies_apikey.html | relative_url }}[API Key]. Only trusted applications can access the API data by requesting an API Key. Let\u2019s see how to create an application and generate an API Key.</p>","location":"apim/quickstart/api-consumer/api-consumer-ui/"},{"title":"Create your application and subscribe to an API","text":"<ol> <li> <p>link:{{ /apim/3.x/apim_quickstart_portal_login.html |     relative_url }}[Log in to APIM Portal^].</p> </li> <li> <p>Click Applications in the top menu.</p> </li> <li> <p>Click CREATE AN APP in the sub-menu.</p> <p>image::{% link images/apim/3.x/quickstart/consume/graviteeio-create-first-app-1.png %}[]</p> </li> <li> <p>Give your application a name and a description. Click NEXT.</p> <p>image::{% link images/apim/3.x/quickstart/consume/graviteeio-create-first-app-2.png %}[]</p> </li> <li> <p>Specify the type of application. Click NEXT.</p> <p>Because you are subscribing to an API Key plan, you do not need to specify a Client ID.</p> <p>image::{% link images/apim/3.x/quickstart/consume/graviteeio-create-first-app-3.png %}[]</p> </li> <li> <p>Search for your API and select it.</p> <p>image::{% link images/apim/3.x/quickstart/consume/graviteeio-create-first-app-4.png %}[]</p> <p>The API plan is displayed.</p> <p>image::{% link images/apim/3.x/quickstart/consume/graviteeio-create-first-app-5.png %}[]</p> </li> <li> <p>Click SUBSCRIBE.</p> <p>image::{% link images/apim/3.x/quickstart/consume/graviteeio-create-first-app-6.png %}[]</p> </li> <li> <p>Click NEXT.</p> </li> <li> <p>You can check your application information in this summary. When you     are ready, click CREATE THE APP.</p> <p>image::{% link images/apim/3.x/quickstart/consume/graviteeio-create-first-app-7.png %}[]</p> <p>Congratulations! Your new application and subscription to the Echo API have been created.</p> <p>image::{% link images/apim/3.x/quickstart/consume/graviteeio-create-first-app-8.png %}[]</p> </li> </ol>","location":"apim/quickstart/api-consumer/api-consumer-ui/#create-your-application-and-subscribe-to-an-api"},{"title":"Publish your first API with APIM API","text":"<p>= Publish your first API with APIM API :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_quickstart_publish_api.html :page-folder: apim/quickstart/api-publisher :page-layout: apim3x</p> <p>== Overview</p> <p>This section walks you through creating and publishing your first API with APIM API. You can find more information in the link:{{ '/apim/3.x/apim_publisherguide_manage_apis.html' | relative_url }}[API Publisher Guide].</p> <p>NOTE: In this example we will use the https://api.gravitee.io/echo[Gravitee.io Echo API] to set up our first proxy API. The Gravitee.io Echo API returns JSON-formatted data via the following URL: https://api.gravitee.io/echo</p> <p>IMPORTANT: If option Enable API review is enabled in APIM Console, the API <code>workflow_state</code> attribute must be set to <code>REVIEW_OK</code> before you can deploy or start the API. See APIs &gt; Manage the API's review state in the link:{{ '/apim/3.x/apim_installguide_rest_apis_documentation.html' | relative_url }}[API Reference^].</p> <p>== Create your API with APIM API</p> <p>Create API request:: [source]</p>  <p>curl -H \"Authorization: Basic YWRtaW46YWRtaW4=\" \\      -H \"Content-Type:application/json;charset=UTF-8\" \\      -X POST \\      -d '{\"name\":\"My first API\",\"version\":\"1\",\"description\":\"Gravitee.io Echo API Proxy\",\"contextPath\":\"/myfirstapi\",\"endpoint\":\"https://api.gravitee.io/echo\"}' \\      http://MANAGEMENT_API_SERVER_DOMAIN/management/organizations/DEFAULT/environments/DEFAULT/apis</p>  <p>Create Plan request::</p>","location":"apim/quickstart/api-publisher/api-publisher-api/"},{"title":"[source]","text":"<p>curl -H \"Authorization: Basic YWRtaW46YWRtaW4=\" \\      -H \"Content-Type:application/json;charset=UTF-8\" \\      -X POST \\      -d '{\"name\":\"My Plan\",\"description\":\"Unlimited access plan\",\"validation\":\"auto\",\"characteristics\":[],\"paths\":{\"/\":[]},\"security\":\"api_key\"}' \\      http://MANAGEMENT_API_SERVER_DOMAIN/management/organizations/DEFAULT/environments/DEFAULT/apis/{api-id}/plans</p>  <p>Publish Plan request::</p>","location":"apim/quickstart/api-publisher/api-publisher-api/#source"},{"title":"[source]","text":"<p>curl -H \"Authorization: Basic YWRtaW46YWRtaW4=\" \\      -H \"Content-Type:application/json;charset=UTF-8\" \\      -X POST \\      http://MANAGEMENT_API_SERVER_DOMAIN/management/organizations/DEFAULT/environments/DEFAULT/apis/{api-id}/plans/{plan-id}/_publish</p>  <p>Deploy API request:: [source]</p>  <p>curl -H \"Authorization: Basic YWRtaW46YWRtaW4=\" \\      -X POST \\      http://MANAGEMENT_API_SERVER_DOMAIN/management/organizations/DEFAULT/environments/DEFAULT/apis/{api-id}/deploy</p>  <p>Start API request:: [source]</p>  <p>curl -H \"Authorization: Basic YWRtaW46YWRtaW4=\" \\      -X POST \\      http://MANAGEMENT_API_SERVER_DOMAIN/management/organizations/DEFAULT/environments/DEFAULT/apis/{api-id}?action=START</p>  <p>Publish API on APIM Portal request::</p> <p>From the JSON response of the Create API Request, add the field <code>lifecycle_state</code> with value =<code>\"published\"</code> and send the result in a PUT request. [source]</p>  <p>curl -H \"Authorization: Basic YWRtaW46YWRtaW4=\" \\      -H \"Content-Type:application/json;charset=UTF-8\" \\      -X PUT \\      -d '' '     http://MANAGEMENT_API_SERVER_DOMAIN/management/organizations/DEFAULT/environments/DEFAULT/apis/{api-id}  <p>For more information, see the complete link:{{ '/apim/3.x/apim_installguide_rest_apis_documentation.html' | relative_url }}[APIM API documentation].</p>","location":"apim/quickstart/api-publisher/api-publisher-api/#source_1"},{"title":"Publish your first API with APIM Console","text":"<p>= Publish your first API with APIM Console :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_quickstart_publish_ui.html :page-folder: apim/quickstart/api-publisher :page-layout: apim3x</p> <p>== Overview</p> <p>This section walks you through creating and publishing your first API with APIM Console. To learn more about creating and publishing APIs, see the link:{{ '/apim/3.x/apim_publisherguide_manage_apis.html' | relative_url }}[API Publisher Guide].</p> <p>== Create your API with APIM Console</p> <p>. Log in to APIM Console. . Click Start creating an API. + image::{% link images/apim/3.x/quickstart/publish/graviteeio-create-api-1.png %}[]</p> <p>. Click CREATE. + image::{% link images/apim/3.x/quickstart/publish/graviteeio-create-api-2.png %}[]</p> <p>. Give your API a name, a version, a description and a context path. Click NEXT. + image::{% link images/apim/3.x/quickstart/publish/graviteeio-create-first-api-1.png %}[]</p> <p>. Set Backend to the URL of the API, in this example <code>https://api.gravitee.io/echo</code>. Click NEXT. + image::{% link images/apim/3.x/quickstart/publish/graviteeio-create-first-api-2.png %}[] + NOTE: Before consumers can subscribe to your API, you must publish one or more plans, as described in the following step. A plan gives access to the API operations.</p> <p>. Create a plan by giving it a name, a description and a security type. Switch on the Auto validate subscription option. Click NEXT. + image::{% link images/apim/3.x/quickstart/publish/graviteeio-create-first-api-3.png %}[] + NOTE: Ensure you set the link:{{ '/apim/3.x/apim_policies_apikey.html' | relative_url }}[API Key] security type. For more information about plan configuration, see the link:{{ '/apim/3.x/apim_publisherguide_plans_subscriptions.html' | relative_url }}[API Publisher Plans and subscriptions Guide].</p> <p>. In the Doc step, you can add some Markdown and OpenAPI files. You can skip this step for now. Click SKIP. + image::{% link images/apim/3.x/quickstart/publish/graviteeio-create-first-api-4.png %}[]</p> <p>. Check your API information before deploying it. When you are ready, click CREATE AND START THE API. + image::{% link images/apim/3.x/quickstart/publish/graviteeio-create-first-api-5.png %}[]</p> <p>Congratulations! You have created your brand new API, published a plan and, if an APIM Gateway instance is running, deployed your API.</p> <p>image::{% link images/apim/3.x/quickstart/publish/graviteeio-create-first-api-6.png %}[]</p> <p>You need to complete one more step before your API is ready to be used by your consumers: click PUBLISH THE API to display the API in APIM Portal.</p> <p>image::{% link images/apim/3.x/quickstart/publish/graviteeio-create-first-api-7.png %}[]</p> <p>== Import your API with APIM Console</p> <p>Alternatively you can import an existing API specification.</p> <p>We are going to use an existing API specification. For this example, we\u2019ll use the link:{{'https://petstore.swagger.io/v2/swagger.json'}}[Swagger PetStore API example, window=\\\"_blank\\\"]. Download a copy, and click \u2018Import\u2019 and then \u2018Choose File\u2019 on the next screen:</p> <p>image::{% link images/apim/3.x/quickstart/publish/graviteeio-import-api-1.png %}[] image::{% link images/apim/3.x/quickstart/publish/graviteeio-import-api-2.png %}[]</p> <p>. Once the file has been selected, you will have some additional options available to you. In this quick example, we will focus on 2 options only. Check that they are selected : * Create policies on path \u2014 this option will create each endpoint and associated methods based on the imported swagger file * Apply Mock policies \u2014 this option will create a mock policy for each endpoint based on examples provided in the imported swagger file + Then click import : + image::{% link images/apim/3.x/quickstart/publish/graviteeio-import-api-3.png %}[]</p> <p>. A screen with options to configure your API will now appear. Don\u2019t worry about the gold bar \u2018API out of sync, deploy your API\u2019, we have a number of things to do first. + To be able to test out our API, we will need to create a plan. A plan always needs to be created, and gives us the ability to control how an API is accessed. For this example, we\u2019re going to create a keyless plan \u2014 this will allow anybody to access the API. Select \u2018Plans\u2019, the Plans window will appear: + image::{% link images/apim/3.x/quickstart/publish/graviteeio-import-api-4.png %}[] image::{% link images/apim/3.x/quickstart/publish/graviteeio-import-api-5.png %}[]</p> <p>. To add a new plan, press (+). Then provide a Name and Description for the plan, scroll down and click \u2018Next\u2019: + image::{% link images/apim/3.x/quickstart/publish/graviteeio-import-api-6.png %}[]</p> <p>. On the next screen, select \u2018Keyless (public)\u2019 from the \u2018Authentication type\u2019 drop-down menu: + image::{% link images/apim/3.x/quickstart/publish/graviteeio-import-api-7.png %}[]</p> <p>. Keep clicking through on \u2018Next\u2019 until you\u2019ve completed the plan creation process. We will now need to publish the plan so that it can be used. Click the picture of the Cloud with the upward pointing arrow: + image::{% link images/apim/3.x/quickstart/publish/graviteeio-import-api-8.png %}[]</p> <p>. The last step that remains is to start the API. Go to \u2018Details\u2019 under \u2018General\u2019, scrolling down to the \u2018Danger Zone\u2019. Select \u2018START THE API\u2019. This will sync the deployment of the API and associated plan, as well as starting the API itself. + image::{% link images/apim/3.x/quickstart/publish/graviteeio-import-api-9.png %}[]</p>","location":"apim/quickstart/api-publisher/api-publisher-ui/"},{"title":"Overview","text":"<p>Two concepts apply to the setup of Gravitee.io API Management (APIM) installation. Organization and environment.</p>","location":"apim/user-guide/admin/admin-guide-organizations-and-environments/"},{"title":"Organization","text":"<p>A logical part of your company in the way that makes most sense in your setup, for example a region or business unit. In the context of an APIM installation it is the level at which shared configurations for environments are managed, such as:</p> <ul> <li> <p>Users</p> </li> <li> <p>Roles</p> </li> <li> <p>Identity providers</p> </li> <li> <p>Notification templates</p> </li> </ul> <p>It also allows operations across managed environments (like API import/export).</p> <p>You can update a gateway\u2019s organization settings in APIM Console by clicking Organization settings in the left-hand navigation.</p>","location":"apim/user-guide/admin/admin-guide-organizations-and-environments/#organization"},{"title":"Environment","text":"<p>An environment in an IT infrastructure, such as development or production. There can be multiple environments linked to one organization. In the context of an APIM installation, it is the workspace in which users can manage their APIs, applications and subscriptions An environment handles its own categories, groups, documentation pages and quality rules.</p> <p>Examples of environments:</p> <ul> <li> <p>technical environments such as DEV / TEST / PRODUCTION</p> </li> <li> <p>functional environments such as PRIVATE APIS / PUBLIC APIS /     PARTNERSHIP</p> </li> </ul> <p>An environment belongs to one organization.</p> <p>You can update a gateway\u2019s environment settings in APIM Console by clicking Settings in the left-hand navigation</p> <p>By default, the OSS version of APIM comes with a default organization and a default environment. For a multi-environment setup, you need an integration with link:{% link pages/cockpit/overview/introduction.adoc %}[Cockpit].</p>","location":"apim/user-guide/admin/admin-guide-organizations-and-environments/#environment"},{"title":"Overview","text":"<p>Platform flows are executed before and after any API flows of the organization. They can be defined in the organization settings and are automatically deployed on every change.</p> <p>image:{% link images/apim/3.x/adminguide/platform-flows.png %}[]</p>","location":"apim/user-guide/admin/admin-guide-platform-policies/"},{"title":"Execution flow","text":"<p>Platform flows are encapsulating API flows as follows:</p> <ul> <li> <p>Platform flow request policies are executed before API flow     request policies</p> </li> <li> <p>Platform flow response policies are executed after API flow     response policies</p> </li> </ul>","location":"apim/user-guide/admin/admin-guide-platform-policies/#execution-flow"},{"title":"Typical use cases","text":"<p>You can use platform flows to enforce policies at the organization level such as:</p> <ul> <li> <p>reporting - e.g. Metrics Reporter</p> </li> <li> <p>security - e.g. IPFiltering</p> </li> </ul>","location":"apim/user-guide/admin/admin-guide-platform-policies/#typical-use-cases"},{"title":"Known limitations","text":"<p>Platform flows do currently not support conditional policies.</p>","location":"apim/user-guide/admin/admin-guide-platform-policies/#known-limitations"},{"title":"Overview","text":"<p>APIM allows you to create custom user roles to fit your needs. Some default roles are provided for you.</p> <p>In APIM, a role:</p> <ul> <li> <p>is associated with a group of permissions</p> </li> <li> <p>has a scope</p> </li> <li> <p>defines what you can do with the APIM UI components and APIM API</p> </li> </ul> <p>Before defining some key concepts, we recommend you first take a look at the new link:{{ /apim/3.x/apim_adminguide_organizations_and_environments.html | relative_url }}[Gravitee.io Platform design^].</p> <p>Any changes to a role may take a short time to be applied to a user.</p>","location":"apim/user-guide/admin/admin-guide-roles-and-permissions/"},{"title":"Scopes","text":"<p>Roles are defined in terms of scopes. As described in the link:{{ /apim/3.x/apim_adminguide_organizations_and_environments.html | relative_url }}[Organizations and environments] page, an environment corresponds roughly to what you can find in APIM Portal. More precisely, an environment\u2019s scope is all of the actions that can be performed in the specific context, whether in APIM Portal or APIM Console.</p> <p>For example:</p> <ul> <li> <p>APIs can be managed by API publishers in APIM Console.</p> </li> <li> <p>Applications can be managed in both APIM Console and APIM Portal.</p> </li> <li> <p>API ratings can be managed by API consumers in APIM Portal.</p> </li> </ul> <p>As the name suggests, the scope of an organization is all aspects of an organization: users, roles, and so on. Organization-level actions are only available in APIM Console.</p> <p>A user can have more than one organization role and more than one environment role.</p> <p>The scopes of API and application work slightly differently.</p> <p>As an API publisher or consumer, you have access to APIs and/or applications. APIM allows you to have a different role for each API and application. You can be the owner for one, an ordinary user for another and the person in charge of writing the documentation for another. This means that the API and application roles are only meaningful in terms of their association with an API or application.</p>","location":"apim/user-guide/admin/admin-guide-roles-and-permissions/#scopes"},{"title":"Role","text":"<p>A role is a functional group of permissions. There is no limit to the number of roles you can create. They all need to be administered, however.</p> <p>Some roles are special. The are tagged as <code>System</code> or <code>Default</code>.</p>","location":"apim/user-guide/admin/admin-guide-roles-and-permissions/#role"},{"title":"System role","text":"<p>The Organization Admin role is a read-only role (i.e. you cannot change its permissions) used by APIM.</p> <p>This role gives the user all permissions. If any accidental loss of access happened to another role, a user with this role will still be able to perform the action or restore required privileges.</p> <p>Historically, the roles listed bellow were also created as read-only system roles and are still tagged as such, but they have been made editable for the sake of administration flexibility.</p> <ol> <li> <p>The Environment Admin role</p> </li> <li> <p>The API Primary Owner role</p> </li> <li> <p>The Application Primary Owner role</p> </li> </ol> <p>In order to edit this roles, you need to activate this mode in <code>gravitee.yml</code></p> <pre><code>console:\n  systemRoleEdition:\n    enabled: true\n</code></pre> <p>Updating permissions for system roles should be done carefully to avoid any unexpected behavior.</p>","location":"apim/user-guide/admin/admin-guide-roles-and-permissions/#system-role"},{"title":"Default role","text":"<p>The Default role is the role used by APIM when a role is not specified. For example, new registered users are assigned the default <code>ENVIRONMENT</code> and <code>ORGANIZATION</code>. The Default role gives the user limited permissions.</p> <p>You can change the default on each scope.</p>","location":"apim/user-guide/admin/admin-guide-roles-and-permissions/#default-role"},{"title":"Permission","text":"<p>A permission is a list of actions allowed on a resource. The actions are <code>Create</code>, <code>Read</code>, <code>Update</code> and <code>Delete</code>.</p> <p>The list of permissions by scope is as follows:</p>  <code>ENVIRONMENT</code> scope permissions       <p>Name</p> <p>Description</p>   <p>INSTANCE</p> <p>Access to API Gateway instance information. Only <code>READ</code> permission is used.</p>   <p>GROUP</p> <p>Manages user groups.</p>   <p>TAG</p> <p>Manages sharding tags. Deprecated, will be removed on 3.10.0</p>   <p>TENANT</p> <p>Manages tenants. Deprecated, will be removed on 3.10.0</p>   <p>API</p> <p>Manages APIs in general. This means that the <code>CREATE</code> action is used to establish if the user is allowed to create an API or not, and the <code>READ</code> permission to allow the user to request the policies list and resources list.</p>   <p>APPLICATION</p> <p>Manages applications in general. <code>CREATE</code> allows the user to create an application, <code>READ</code> allows the user to list applications.</p>   <p>PLATFORM</p> <p>Gets APIM monitoring metrics. Only <code>READ</code> permission is used.</p>   <p>AUDIT</p> <p>Gets APIM audit. Only <code>READ</code> permission is used.</p>   <p>NOTIFICATION</p> <p>Manages global notifications.</p>   <p>MESSAGE</p> <p>Manages messaging.</p>   <p>DICTIONARY</p> <p>Manages environment dictionaries.</p>   <p>ALERT</p> <p>Manages environment alerting.</p>   <p>ENTRYPOINT</p> <p>Manages environment entrypoint configuration. Deprecated, will be removed on 3.10.0</p>   <p>SETTINGS</p> <p>Manages environment settings.</p>   <p>DASHBOARD</p> <p>Manages environment dashboards.</p>   <p>QUALITY_RULE</p> <p>Manages environment quality rules.</p>   <p>METADATA</p> <p>Manages APIM metadata.</p>   <p>DOCUMENTATION</p> <p>ManageS APIM Portal documentation.</p>   <p>CATEGORY</p> <p>Manages categories.</p>   <p>TOP_APIS</p> <p>Manages top apis.</p>   <p>API_HEADERS</p> <p>Manages environment API headers.</p>   <p>IDENTITY_PROVIDER</p> <p>Manages Identity Providers for authentication.</p>   <p>CLIENT_REGISTRATION_PROVIDER</p> <p>Manages environment client registration configuration.</p>   <p>THEME</p> <p>Manages APIM Portal themes.</p>    <p><code>ENVIRONMENT</code> scope permissions</p>  <code>ORGANIZATION</code> scope permissions       <p>Name</p> <p>Description</p>   <p>USER</p> <p>Manages users.</p>   <p>ENVIRONMENT</p> <p>Manages environments.</p>   <p>ROLE</p> <p>Manages roles.</p>   <p>TAG</p> <p>Manages sharding tags.</p>   <p>TENANT</p> <p>Manages tenants.</p>   <p>ENTRYPOINT</p> <p>Manages environment entrypoint configuration.</p>    <p><code>ORGANIZATION</code> scope permissions</p>  <code>API</code> scope permissions       <p>Name</p> <p>Description</p>   <p>DEFINITION</p> <p>Manages the API definition.</p>   <p>PLAN</p> <p>Manages API plans.</p>   <p>SUBSCRIPTION</p> <p>Manages API subscriptions.</p>   <p>MEMBER</p> <p>Manages API members.</p>   <p>METADATA</p> <p>Manages API metadata.</p>   <p>ANALYTICS</p> <p>Manages API analytics. Only <code>READ</code> permission is used.</p>   <p>EVENT</p> <p>Manages API events. Only <code>READ</code> permission is used.</p>   <p>HEALTH</p> <p>Manages API health checks.</p>   <p>LOG</p> <p>Manages API logs. Only <code>READ</code> permission is used.</p>   <p>DOCUMENTATION</p> <p>Manages API documentation.</p>   <p>GATEWAY_DEFINITION</p> <p>A specific permission used to update the context-path (<code>UPDATE</code>) and to give access to sensitive data (<code>READ</code>) such as endpoints and paths.</p>   <p>RATING</p> <p>Manages API rating.</p>   <p>RATING_ANSWERS</p> <p>Manages API rating answers.</p>   <p>AUDIT</p> <p>Manages API audits. Only <code>READ</code> permission is used.</p>   <p>DISCOVERY</p> <p>Manages service discovery.</p>   <p>NOTIFICATION</p> <p>Manages API notifications.</p>   <p>MESSAGE</p> <p>Manages messaging.</p>   <p>ALERT</p> <p>Manages API alerting.</p>   <p>RESPONSE_TEMPLATES</p> <p>Manages API response templates.</p>   <p>REVIEWS</p> <p>Manages API reviews.</p>   <p>QUALITY_RULE</p> <p>Manages API quality rules.</p>    <p><code>API</code> scope permissions</p>  <code>APPLICATION</code> scope permissions       <p>Name</p> <p>Description</p>   <p>DEFINITION</p> <p>Manages the application definition.</p>   <p>MEMBER</p> <p>Manages application members.</p>   <p>ANALYTICS</p> <p>Manages application analytics. Only <code>READ</code> permission is used.</p>   <p>LOG</p> <p>Manages application logs. Only <code>READ</code> permission is used.</p>   <p>SUBSCRIPTION</p> <p>Manages application subscriptions.</p>   <p>NOTIFICATION</p> <p>Manages application notifications.</p>   <p>ALERT</p> <p>Manages application alerting.</p>    <p><code>APPLICATION</code> scope permissions</p>","location":"apim/user-guide/admin/admin-guide-roles-and-permissions/#permission"},{"title":"Create a custom role","text":"<p>In this example, we will create a writer role which allows a user to create API documentation.</p>","location":"apim/user-guide/admin/admin-guide-roles-and-permissions/#create-a-custom-role"},{"title":"Create the <code>WRITER</code> role","text":"<ol> <li> <p>link:{{ /apim/3.x/apim_quickstart_console_login.html |     relative_url }}[Log in to APIM Console].</p> </li> <li> <p>In the Organization Settings &gt; Roles page, click ADD A NEW     ROLE.</p> <p>image::{% link images/apim/3.x/adminguide/newrole-create.png %}[Gravitee.io - Create a New Role]</p> </li> </ol>","location":"apim/user-guide/admin/admin-guide-roles-and-permissions/#create-the-writer-role"},{"title":"Configure the <code>WRITER</code> role","text":"<p>Assign the following permissions to the writer role:</p> <ul> <li> <p><code>READ</code> permissions on <code>DEFINITION</code> and <code>GATEWAY_DEFINITION</code>\u2009\u2014\u2009this     allows the user to see the API in the API list</p> </li> <li> <p><code>CRUD</code> permissions on <code>DOCUMENTATION</code></p> </li> </ul> <p>image::{% link images/apim/3.x/adminguide/newrole-configure.png %}[Gravitee.io - Configure a New Role]</p>","location":"apim/user-guide/admin/admin-guide-roles-and-permissions/#configure-the-writer-role"},{"title":"Result","text":"<p>Users with this role can now only see the documentation menu.</p> <p>image::{% link images/apim/3.x/adminguide/newrole-menu.png %}[Gravitee.io - Menu, 200]</p> <p>Granting <code>GROUP</code> permissions to the <code>MANAGEMENT</code> role also requires the <code>READ</code> operation for the <code>ROLE</code> permission in order to see which roles are provided by a group.</p>","location":"apim/user-guide/admin/admin-guide-roles-and-permissions/#result"},{"title":"Overview","text":"<p>Users are listed in the APIM Console Organization settings &gt; Users page.</p> <p>You can:</p> <ul> <li> <p>Create a new user account</p> </li> <li> <p>Remove a user account (only if the user is not a primary owner of an     API or an application)</p> </li> </ul> <p>image::{% link images/apim/3.x/adminguide/usersgroups-users.png %}[Gravitee.io - List users]</p> <p>When you select a user, you can:</p> <ul> <li> <p>Access detailed information about the user\u2019s account and permissions</p> </li> <li> <p>Manage the user\u2019s groups</p> </li> <li> <p>Reset the user\u2019s password (only for users created with the     registration form)</p> </li> <li> <p>Manage the user\u2019s registration requests</p> </li> <li> <p>Generate a token for the user</p> </li> </ul> <p>See also: link:{{ /apim/3.x/apim_installguide_authentication.html | relative_url }}[Configure authentication^].</p>","location":"apim/user-guide/admin/admin-guide-users-and-groups/"},{"title":"Create a user","text":"<p>Administrators can register new users in APIM Console, and users can self-register with a registration form.</p> <p>Registration emails include a link to your system where users can complete their registration. For the links to work, the Management URL and Portal URL settings shown in the images below must be correct.</p> <p>image::{% link images/apim/3.x/adminguide/usersgroups-management-url-parameter.png %}[] image::{% link images/apim/3.x/adminguide/usersgroups-portal-url-parameter.png %}[]</p>","location":"apim/user-guide/admin/admin-guide-users-and-groups/#create-a-user"},{"title":"Create a user account in APIM Console","text":"<ol> <li> <p>In APIM Console, click Organization settings &gt; Users.</p> </li> <li> <p>Click Add user at the top right of the page.</p> </li> <li> <p>Choose from the options available below.</p> </li> </ol>","location":"apim/user-guide/admin/admin-guide-users-and-groups/#create-a-user-account-in-apim-console"},{"title":"Create a regular user","text":"<p>An email will be sent to the user asking them to complete the registration.</p> <p>image::{% link images/apim/3.14/admin-create-regular-user.png %}[Gravitee.io - Pre-Register User]</p>","location":"apim/user-guide/admin/admin-guide-users-and-groups/#create-a-regular-user"},{"title":"Create a service account","text":"<p>New in version 3.14</p> <p>You can add an email to your service account to be able to subscribe to notifications.</p> <p>image::{% link images/apim/3.14/admin-create-service-account.png %}[Gravitee.io - Pre-Register Service Account]</p> <p>You won\u2019t be able to connect to APIM Console with this user.</p>","location":"apim/user-guide/admin/admin-guide-users-and-groups/#create-a-service-account"},{"title":"Create a user with the registration form","text":"<p>Users can self-register using the registration form, as described in link:{{ /apim/3.x/apim_consumerguide_create_account.html | relative_url }}[Create a user account] in the API Consumer Guide.</p>","location":"apim/user-guide/admin/admin-guide-users-and-groups/#create-a-user-with-the-registration-form"},{"title":"Manage registration requests","text":"<p>By default, if the Allow User Registration option is enabled, then all registration requests generated by users filling in the registration form will be automatically validated. This option exists both in the Console and Portal settings.</p> <p>image::{% link images/apim/3.x/adminguide/usersgroups-console-auto-validation-parameters.png %}[Gravitee.io - Automatic registration validation option for console] image::{% link images/apim/3.x/adminguide/usersgroups-portal-auto-validation-parameters.png %}[Gravitee.io - Automatic registration validation option for portal]</p>","location":"apim/user-guide/admin/admin-guide-users-and-groups/#manage-registration-requests"},{"title":"Accept or reject a registration request","text":"<p>If the Enable automatic validation of registration requests option is disabled, then you can reject or accept user registration requests in APIM Console:</p> <ol> <li> <p>In Organization Settings, click Users.</p> </li> <li> <p>Click a user with PENDING status.</p> <p>image::{% link images/apim/3.x/adminguide/usersgroups-manual-validation-1.png %}[Gravitee.io - Users status pour registration validation] . Click ACCEPT or REJECT.</p> <p>image::{% link images/apim/3.x/adminguide/usersgroups-manual-validation-2.png %}[Gravitee.io - Manual registration validation]</p> </li> </ol> <p>If a self-registered user has completed registration but the registration has not been accepted by an administrator, the user will not be able to sign in.</p>","location":"apim/user-guide/admin/admin-guide-users-and-groups/#accept-or-reject-a-registration-request"},{"title":"Customize the self-registration form","text":"<p>If you want new users to self-register but need additional information during the registration process, you can add custom fields to the registration form.</p> <p>To configure new custom fields:</p> <ol> <li> <p>Click Settings &gt; User Fields.</p> </li> <li> <p>Click the plus icon image:{% link images/icons/plus-icon.png     %}[role=\"icon\"].</p> </li> <li> <p>Enter the following information:</p> <ul> <li> <p>Select the field key from the pre-defined list in the     drop-down\u2009\u2014\u2009this is the field identifier, used to translate the     label in APIM Portal.</p> </li> <li> <p>The default label\u2009\u2014\u2009this label is used to display the value in     APIM Portal if a translation is not available.</p> </li> <li> <p>A checkbox to make the field mandatory during the registration     process.</p> </li> <li> <p>A list of values you want to restrict for this field.</p> <p>image::{% link images/apim/3.x/adminguide/custom-user-fields-create.png %}[Gravitee.io - Create User Field]</p> </li> </ul> </li> <li> <p>Click CREATE USER FIELD.</p> </li> </ol> <p>Once the user fields are defined, they will be displayed in the APIM Console and Portal registration forms.</p> <p>image::{% link images/apim/3.x/adminguide/custom-user-fields-registration.png %}[Gravitee.io - Registration With User Field]</p>","location":"apim/user-guide/admin/admin-guide-users-and-groups/#customize-the-self-registration-form"},{"title":"View and update a user","text":"<p>You can view detailed information about a user account, including any information added through custom fields, permissions and group management capabilities by selecting the user in the Organization settings &gt; Users list.</p> <p>image::{% link images/apim/3.x/adminguide/custom-user-fields-user-details.png %}[Gravitee.io - User With Custom Fields]</p> <p>Users can view and update this information on their account page.</p> <p>image::{% link images/apim/3.x/adminguide/custom-user-fields-account.png %}[Gravitee.io - User Account]</p> <p>Translations of the label for custom fields are based on the field key. To add translations for your own fields, you need to declare them in the translation files (en.json, fr.json\u2026) under the element <code>register.field</code>. If no translation is available, the default label will be used.</p>","location":"apim/user-guide/admin/admin-guide-users-and-groups/#view-and-update-a-user"},{"title":"Manage user tokens","text":"<p>New in version 3.14</p> <p>You can create one or more tokens for your users. You can see if a user has active tokens in the list display:</p> <p>image::{% link images/apim/3.14/admin-user-tokens.png %}[]</p> <p>To create a new user token:</p> <ol> <li> <p>Click Organization settings &gt; users.</p> </li> <li> <p>Select the user.</p> </li> <li> <p>Click Generate a personal token.</p> <p>image::{% link images/apim/3.14/admin-token-management.png %}[]</p> </li> <li> <p>Enter the details of the token:</p> <p>image::{% link images/apim/3.14/admin-token-management-form.png %}[]</p> <p>APIM displays the token.</p> <p>The token is only displayed once. Keep it somewhere safe.</p> <p>image::{% link images/apim/3.14/admin-token-management-example.png %}[]</p> </li> </ol>","location":"apim/user-guide/admin/admin-guide-users-and-groups/#manage-user-tokens"},{"title":"Create a group","text":"<p>You can create user groups to which you can add members of the same team/partner and set their role for the <code>API</code> scope and/or <code>APPLICATION</code> scope (see link:{{ /apim/3.x/apim_adminguide_roles_and_permissions.html | relative_url }}[Roles and permissions^] for details). Once a group is created, you can associate it with an API and/or an application. Users with roles for this scope become members of the API/application.</p> <p>In this example, we will create a <code>FOO Team</code> group to which you can add all members of your FOO team.</p>","location":"apim/user-guide/admin/admin-guide-users-and-groups/#create-a-group"},{"title":"Create the <code>FOO Team</code> group","text":"<p>image::{% link images/apim/3.x/adminguide/usersgroups-newgroup.png %}[Gravitee.io - New Group]</p> <p>You can see that in addition to the group name, you have two other sections:</p> <p>Roles &amp; Members</p> <ul> <li> <p>Max members\u2009\u2014\u2009defines the maximum number of members in this group     (default is no limit).</p> </li> <li> <p>Allows invitation via user search</p> </li> <li> <p>Allows email invitation</p> </li> <li> <p>Allows the group admin to change the API role</p> </li> <li> <p>Allows the group admin to change the application role</p> </li> </ul> <p>Associations</p> <ul> <li> <p>Associate to every new API\u2009\u2014\u2009every time an API is created, this     group will be added to it.</p> </li> <li> <p>Associate to every new application\u2009\u2014\u2009every time an application is     created, this group will be added to it.</p> </li> </ul> <p>These checkboxes are particularly useful for groups which traverse different teams (a helpdesk group, for example).</p>","location":"apim/user-guide/admin/admin-guide-users-and-groups/#create-the-foo-team-group"},{"title":"Configure users","text":"<ol> <li> <p>On the group detail page, click the plus icon image:{% link     images/icons/plus-icon.png %}[role=\"icon\"], then click Add     member to add users.</p> <p>image::{% link images/apim/3.x/adminguide/usersgroups-addgroupmembers-1.png %}[Gravitee.io - Add Group members]</p> </li> <li> <p>Select users and choose their roles (group default roles are     automatically selected).</p> <p>image::{% link images/apim/3.x/adminguide/usersgroups-addgroupmembers-2.png %}[Gravitee.io - Group members]</p> </li> </ol>","location":"apim/user-guide/admin/admin-guide-users-and-groups/#configure-users"},{"title":"Add the group to an API or application","text":"<ol> <li> <p>Go to the API/application you want to modify and click Groups.     In this example we will add to the group to an API.</p> </li> <li> <p>Click the down arrow and select the group you want to add.</p> <p>image::{% link images/apim/3.x/adminguide/usersgroups-apigroups.png %}[Gravitee.io - Api Group]</p> <p>If you return to Settings &gt; Groups and select the group name, you can now see the API listed in the Dependents section.</p> <p>image::{% link images/apim/3.x/adminguide/usersgroups-groups-dependents.png %}[Gravitee.io - Api Group]</p> <p>This means members of the <code>FOO Team</code> are members of the API with the role you set in ???.</p> </li> </ol>","location":"apim/user-guide/admin/admin-guide-users-and-groups/#add-the-group-to-an-api-or-application"},{"title":"Configure primary owner groups","text":"<p>New in version 3.7</p> <p>From APIM 3.7, you can configure three different ways of managing primary owners for APIs in APIM Console:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-api-primaryowner-mode-1.png %}[]</p> <p>USER -   Only users can be primary owner of an API</p> <ul> <li>Creating primary owner groups is not allowed</li> </ul> <p>GROUP -   Only primary owner groups can be primary owner of an API</p> <ul> <li> <p>Creating primary owner groups is allowed</p> </li> <li> <p>To create or import an API, you must belong to at least one primary     owner group</p> </li> <li> <p>You can only transfer API ownership to a primary owner group which     you belong to</p> </li> </ul> <p>HYBRID (default) -   Creating primary owner groups is allowed</p> <ul> <li> <p>Either a primary owner group or a user can be primary owner of an     API</p> </li> <li> <p>You can transfer API ownership to either a primary owner group or a     user</p> </li> </ul> <p>For a group to be defined as primary owner, it must contain one member with the PRIMARY OWNER role in the link:{{ /apim/3.x/apim_adminguide_roles_and_permissions.html#scopes | relative_url }}[API scope^]. You can only add one member with the PRIMARY OWNER role to a group.</p>","location":"apim/user-guide/admin/admin-guide-users-and-groups/#configure-primary-owner-groups"},{"title":"Update the API primary owner mode","text":"<ol> <li> <p>link:{{ /apim/3.x/apim_quickstart_console_login.html |     relative_url }}[Log in to APIM Console^].</p> </li> <li> <p>Click Settings &gt; Settings.</p> </li> <li> <p>Set API Primary Owner mode to HYBRID or GROUP.</p> <p>Any groups which include a PRIMARY OWNER member will now be available to add to your APIs. For more details, see link:{{ /apim/3.x/apim_publisherguide_create_apis.html | relative_url }}[Create APIs^].</p> </li> </ol>","location":"apim/user-guide/admin/admin-guide-users-and-groups/#update-the-api-primary-owner-mode"},{"title":"Overview","text":"<p>This section outlines the different ways you can get in touch with the Gravitee support team about issues with APIM.</p>","location":"apim/user-guide/admin/admin-guide-users-support-tickets/"},{"title":"Send a message to support","text":"","location":"apim/user-guide/admin/admin-guide-users-support-tickets/#send-a-message-to-support"},{"title":"Using APIM Console","text":"<ol> <li> <p>In the APIM Console user menu, click Support.</p> <p>image::{% link images/apim/3.x/adminguide/support-mgmt-menu.png %}[Gravitee.io - Support user menu]</p> </li> <li> <p>Fill in the ticket details and create the ticket.</p> <p>image::{% link images/apim/3.x/adminguide/support-mgmt-create.png %}[Gravitee.io - Support create]</p> </li> </ol>","location":"apim/user-guide/admin/admin-guide-users-support-tickets/#using-apim-console"},{"title":"Using APIM Portal","text":"","location":"apim/user-guide/admin/admin-guide-users-support-tickets/#using-apim-portal"},{"title":"From the user menu","text":"<ol> <li> <p>In the APIM Portal user menu, click Contact.</p> <p>image::{% link images/apim/3.x/adminguide/support-portal-user-menu.png %}[Gravitee.io - Support user menu]</p> </li> <li> <p>Fill in the ticket details and create the ticket.</p> <p>image::{% link images/apim/3.x/adminguide/support-portal-user-create.png %}[Gravitee.io - Support create]</p> </li> </ol>","location":"apim/user-guide/admin/admin-guide-users-support-tickets/#from-the-user-menu"},{"title":"From the API menu","text":"<p>You can send a message to the support team directly from the current API.</p> <ol> <li> <p>Click the Contact tab.</p> </li> <li> <p>Fill in the ticket details and create the ticket.</p> <p>image::{% link images/apim/3.x/adminguide/support-portal-api-create.png %}[Gravitee.io - Support create]</p> </li> </ol>","location":"apim/user-guide/admin/admin-guide-users-support-tickets/#from-the-api-menu"},{"title":"Check your messages","text":"","location":"apim/user-guide/admin/admin-guide-users-support-tickets/#check-your-messages"},{"title":"Using APIM Console","text":"<p>In the ticket creation screen, you can list your tickets by clicking See ticket history.</p> <p>image::{% link images/apim/3.x/adminguide/support-mgmt-list.png %}[Gravitee.io - Support list]</p> <p>You can view the details of a ticket by clicking the eye icon.</p> <p>image::{% link images/apim/3.x/adminguide/support-mgmt-detail.png %}[Gravitee.io - Support detail]</p>","location":"apim/user-guide/admin/admin-guide-users-support-tickets/#using-apim-console_1"},{"title":"Using APIM Portal","text":"","location":"apim/user-guide/admin/admin-guide-users-support-tickets/#using-apim-portal_1"},{"title":"From the user menu","text":"<ol> <li> <p>In the APIM Portal user menu, click Tickets.</p> </li> <li> <p>Click the ticket in the list to view the ticket and any messages.</p> <p>image::{% link images/apim/3.x/adminguide/support-portal-user-list.png %}[Gravitee.io - Support list]</p> </li> </ol>","location":"apim/user-guide/admin/admin-guide-users-support-tickets/#from-the-user-menu_1"},{"title":"From the API menu","text":"<p>You can view your messages directly from the current API.</p> <ol> <li> <p>Click the Tickets tab.</p> </li> <li> <p>Click the ticket in the list to view the ticket and any messages.</p> <p>image::{% link images/apim/3.x/adminguide/support-portal-api-list.png %}[Gravitee.io - Support list]</p> </li> </ol>","location":"apim/user-guide/admin/admin-guide-users-support-tickets/#from-the-api-menu_1"},{"title":"Overview","text":"<p>New user accounts can be registered in either APIM Console or APIM Portal.</p>","location":"apim/user-guide/consumer/developer-create-account/"},{"title":"Prerequisites","text":"<p>To work correctly, new user accounts require the following configuration:</p> <ul> <li> <p>email link:{{     /apim/3.x/apim_installguide_rest_apis_configuration.html#smtp-configuration     | relative_url }}[SMTP configuration^]</p> </li> <li> <p>the Allow User Registration option enabled in Settings:</p> <p>image::{% link images/apim/3.x/api-consumer-guide/create-account/graviteeio-developer-create-account-activate-settings.png %}[]</p> </li> <li> <p>the password validation regex configured in <code>gravitee.yml</code> (the     default regex is based on OWASP     recommendations^)</p> <pre><code>  # Password complexity validation policy\n  # Applications should enforce password complexity rules to discourage easy to guess passwords.\n  # Passwords should require a minimum level of complexity that makes sense for the application and its user population.\n  password:\n    policy:\n      # Regex pattern for password validation (default to OWASP recommendations).\n      # 8 to 32 characters, no more than 2 consecutive equal characters, min 1 special characters (@ &amp; # ...), min 1 upper case character.\n      pattern: ^(?:(?=.*\\d)(?=.*[A-Z])(?=.*[a-z])|(?=.*\\d)(?=.*[^A-Za-z0-9])(?=.*[a-z])|(?=.*[^A-Za-z0-9])(?=.*[A-Z])(?=.*[a-z])|(?=.*\\d)(?=.*[A-Z])(?=.*[^A-Za-z0-9]))(?!.*(.)\\1{2,})[A-Za-z0-9!~&lt;&gt;,;:_\\-=?*+#.\"'&amp;\u00a7`\u00a3\u20ac%\u00b0()\\\\\\|\\[\\]\\-\\$\\^\\@\\/]{8,32}$\n              # Example : ^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[@#$%^&amp;+=])(?=\\S+$).{8,}$\n              # ^                # start-of-string\n              #(?=.*[0-9])       # a digit must occur at least once\n              #(?=.*[a-z])       # a lower case letter must occur at least once\n              #(?=.*[A-Z])       # an upper case letter must occur at least once\n              #(?=.*[@#$%^&amp;+=])  # a special character must occur at least once\n              #(?=\\S+$)          # no whitespace allowed in the entire string\n              #.{8,}             # anything, at least eight places though\n              #$                 # end-of-string\n</code></pre> </li> </ul>","location":"apim/user-guide/consumer/developer-create-account/#prerequisites"},{"title":"Register as a new user","text":"<ol> <li> <p>Click Sign In in the top menu. The login form is displayed:</p> <p>image::{% link images/apim/3.x/api-consumer-guide/create-account/graviteeio-developer-create-account-login-form.png %}[]</p> </li> <li> <p>Click the Sign Up link at the bottom of the form. You are     redirected to a registration form.</p> </li> <li> <p>Fill in the form and click SIGN UP.</p> <p>image::{% link images/apim/3.x/api-consumer-guide/create-account/graviteeio-developer-create-account-signin-form.png %}[]</p> <p>APIM sends you a validation email.</p> <p>image:{% link images/apim/3.x/api-consumer-guide/create-account/graviteeio-developer-create-account-email-registration-1.png %}[Confirmation, 300] image:{% link images/apim/3.x/api-consumer-guide/create-account/graviteeio-developer-create-account-email-registration-2.png %}[Email, 300]</p> <p>By default, the link is available for 24h (86400s), but this can be changed in <code>gravitee.yml</code>.</p> <pre><code>user:\n  creation:\n    token:\n      expire-after: 86400\n</code></pre> </li> <li> <p>Click the link in the email.</p> </li> <li> <p>Confirm registration by defining your password and clicking the     CONFIRM button.</p> <p>image::{% link images/apim/3.x/api-consumer-guide/create-account/graviteeio-developer-create-account-confirm-registration.png %}[]</p> <p>You can click on the <code>eye</code> icon to display the password</p> <p>APIM displays a message confirming your registration is complete.</p> <p>image::{% link images/apim/3.x/api-consumer-guide/create-account/graviteeio-developer-create-account-confirm-registration-validated.png %}[Registration successful, 300]</p> </li> </ol>","location":"apim/user-guide/consumer/developer-create-account/#register-as-a-new-user"},{"title":"Expired link","text":"<p>If the link expires, you will see this message:</p> <p>image::{% link images/apim/3.x/api-consumer-guide/create-account/graviteeio-developer-create-account-link-expire.png %}[Expiration message, 300]</p> <p>Click Back to registration to return to the registration page and send a new registration request.</p>","location":"apim/user-guide/consumer/developer-create-account/#expired-link"},{"title":"Password validation","text":"<p>If the password does not respect some security rules (see link:{{ /apim/3.x/apim_consumerguide_create_account.html#prerequisites | relative_url }}[Prerequisites]), you will see this message:</p> <p>image::{% link images/apim/3.x/api-consumer-guide/create-account/graviteeio-developer-create-account-unsecure-password.png %}[]</p>","location":"apim/user-guide/consumer/developer-create-account/#password-validation"},{"title":"What is an application?","text":"<p>Consumers who want to use APIs need to register an application that will allow API publishers to control and regulate access to their APIs. Typical applications are web applications, native applications or bash/job applications which access data.</p> <p>You can manage applications in both APIM Console and APIM Portal.</p>","location":"apim/user-guide/consumer/developer-manage/"},{"title":"Prerequisites","text":"<p>To create applications, you need to enable the correct options in the Settings &gt; Client registration page.</p> <p>To create a simple application, enable the Simple option in the Allowed application types section:</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-manage/graviteeio-create-application-settings-1.png %}[]</p> <p>To create browser, web, native or backend-to-backend applications:</p> <ul> <li> <p>define at least one client registration provider</p> </li> <li> <p>enable the following options:</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-manage/graviteeio-create-application-settings-2.png %}[]</p> </li> </ul>","location":"apim/user-guide/consumer/developer-manage/#prerequisites"},{"title":"Create an application","text":"<p>Only users with the required permissions can create an application. For more details, see the link:{{ /apim/3.x/apim_adminguide_roles_and_permissions.html | relative_url }}[Roles and permissions] section of the Administration Guide.</p> <ol> <li> <p>Log in to APIM Portal.</p> </li> <li> <p>Click Dashboard in the top menu.</p> </li> <li> <p>Click the CREATE AN APPLICATION button.</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-manage/graviteeio-create-app-1.png %}[]</p> </li> <li> <p>Enter the application name and description, and upload an image, if     required. Click NEXT.</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-manage/graviteeio-create-app-2.png %}[]</p> </li> <li> <p>(Optional) If you want to subscribe to an API\u2019s OAuth 2.0/JWT plan     and you have an OAuth 2.0 client, make a note of your client_id     and complete the security part.</p> </li> <li> <p>Select the type of application and complete the details. Click     NEXT.</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-manage/graviteeio-create-app-3.png %}[]</p> </li> <li> <p>(Optional) Search for an API and request a subscription (see link:{{     /apim/3.x/apim_quickstart_consume_ui.html | relative_url     }}[Consume an API with APIM Portal]) in the Quick Start Guide.     Click NEXT.</p> </li> <li> <p>Check your application information in the summary, then click     CREATE THE APP.</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-manage/graviteeio-create-app-4.png %}[]</p> <p>If the selected plan requires the acceptance of general conditions, these will be displayed on the right.</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-manage/app-subscribe-general-conditions.png %}[]</p> <p>Congratulations! Your new application has been created.</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-manage/graviteeio-create-app-5.png %}[]</p> </li> </ol>","location":"apim/user-guide/consumer/developer-manage/#create-an-application"},{"title":"Manage members","text":"<p>When a new application is created, only the application\u2019s creator (PRIMARY OWNER) can see and manage the application. Most of the time an application is shared through a developer application and will retrieve information such as API keys and API analytics.</p> <p>By default, APIM includes three membership roles:</p>        Role Description     <p>Primary owner</p> <p>When an application is created, the primary owner is the creator of the applcation. Primary owner can do all possible actions for an API.</p>   <p>Owner</p> <p>Owner is a lightest version of the primary owner role. Owner can do all possible actions except delete the application.</p>   <p>User</p> <p>A user is a person who can access the application in read only mode and use the application to subscribe to an API.</p>    <p>Only users with the required permissions can manage application members. For more details, see the link:{{ /apim/3.x/apim_adminguide_roles_and_permissions.html | relative_url }}[Roles and permissions] section of the Administration Guide.</p> <p>To manage members:</p> <ol> <li> <p>Log in to APIM Portal.</p> </li> <li> <p>Click Applications in the top menu.</p> </li> <li> <p>In the Applications screen, select your application and go to     the Members page.</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-manage/manage-members.png %}[]</p> </li> </ol>","location":"apim/user-guide/consumer/developer-manage/#manage-members"},{"title":"Add and remove users","text":"<p>You can add new users by searching for them:</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-manage/manage-members-add.png %}[]</p> <p>You can remove users by clicking the trash icon:</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-manage/manage-members-remove.png %}[]</p>","location":"apim/user-guide/consumer/developer-manage/#add-and-remove-users"},{"title":"Transfer ownership","text":"<p>You can transfer ownership to another user, when the current primary owner leaves the project, for example.</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-manage/manage-members-transfer-ownership.png %}[]</p>","location":"apim/user-guide/consumer/developer-manage/#transfer-ownership"},{"title":"Manage subscriptions","text":"<p>Subscriptions represent the plans the application has subscribed to. In the Subscriptions page, application members can see if their access to the APIs is still valid, has not been revoked or is in the API publisher approval process.</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-manage/app-subscriptions.png %}[]</p>","location":"apim/user-guide/consumer/developer-manage/#manage-subscriptions"},{"title":"Analytics","text":"<p>For each API you have subscribed to, APIM provides some analytics to show API usage in your application.</p> <p>The table below lists the analytics available.</p>        <p>Analytics</p> <p>Description</p>   <p>Top API</p> <p>Top APIs sorted by the number of API calls</p>   <p>Status</p> <p>HTTP status distribution summary</p>   <p>Top paths</p> <p>Hits by path</p>   <p>Top mapped paths</p> <p>Hits by mapped path</p>   <p>Response status</p> <p>Hits by status</p>   <p>Response times</p> <p>Average response time</p>   <p>Hits by API</p> <p>Hits by API</p>","location":"apim/user-guide/consumer/developer-manage/#analytics"},{"title":"Restore an archived application","text":"<p>When a user deletes an application, it is in <code>ARCHIVED</code> status.</p> <p>It means that:</p> <ul> <li> <p>The link to the primary owner of the application is deleted.</p> </li> <li> <p>The subscriptions are closed. In case of subscription to an API-Key     plan, the keys are revoked.</p> </li> <li> <p>Notification settings are deleted.</p> </li> </ul> <p>As an <code>ADMIN</code>, you can restore application in the APIM Console.</p> <p>The <code>ADMIN</code> user will become the primary owner of the application.</p> <p>Every application\u2019s subscriptions will be restored in <code>PENDING</code> status. The API publisher will have to reactivate manually the needed subscriptions.</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-manage/app-restore.png %}[]</p>","location":"apim/user-guide/consumer/developer-manage/#restore-an-archived-application"},{"title":"Overview","text":"<p>This section explains how to consume APIs using APIM Portal.</p>","location":"apim/user-guide/consumer/developer-portal/"},{"title":"Access","text":"<p>You can access APIM Portal without a connection (as an anonymous user), but to do anything with an API, you need to connect with a user account and subscribe to some plans.</p> <p>The default view in APIM Portal shows all the APIs the authenticated user can access (or only public APIs for anonymous users).</p> <p>The rules for accessing APIs is as follows:</p> <ul> <li> <p>Public API: all users</p> </li> <li> <p>Private API: a user must be a member of the API (user, owner,     primary_owner)</p> </li> </ul>","location":"apim/user-guide/consumer/developer-portal/#access"},{"title":"Overview","text":"<p>APIM Portal exposes published APIs to developers so they can browse the APIs, request access, generate subscriptions to secure access and identify consumers for monitoring and analytics.</p> <p>To access the APIs and start interacting with them, consumers must first subscribe to an link:{{ /apim/3.x/apim_publisherguide_plans_subscriptions.html | relative_url }}[API plan] with their registered application.</p> <p>Consumers must have a link:{{ /apim/3.x/apim_consumerguide_create_account.html | relative_url }}[user account] to register an application and subscribe to an API.</p>","location":"apim/user-guide/consumer/developer-subscribe/"},{"title":"Plan security type","text":"<p>Depending on the plan security type (API-Key, OAuth 2.0, JWT), you need to set proper HTTP headers to call the API (for more details, see Create a plan).</p> <p>API Key</p> <pre><code>curl -X GET \"https://api.company.com/amazing-api\" -H \"X-Gravitee-Api-Key: xxxx-xxxx-xxxx-xxxx\"\n</code></pre> <p>OAuth 2.0/JWT</p> <p>You need to get an access token from the authorization server before you can consume the API.</p> <pre><code>curl -X GET \"https://api.company.com/amazing-api\" -H \"Authorization: Bearer xxxx-xxxx-xxxx-xxxx\"\n</code></pre>","location":"apim/user-guide/consumer/developer-subscribe/#plan-security-type"},{"title":"Create an application","text":"<p>Consumers wanting to subscribe to APIs need to register an application first, so that API publishers can control and regulate access to their APIs. Applications can be web applications, native application, bash/job applications and other applications needing to access sensitive data.</p> <p>For more information, see Create your application with APIM Portal.</p>","location":"apim/user-guide/consumer/developer-subscribe/#create-an-application"},{"title":"Subscribe to an API","text":"<ol> <li> <p>Log in to APIM Portal.</p> </li> <li> <p>Click Catalog in the top menu.</p> </li> <li> <p>Browse the API categories or search for an API using keywords.</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-subscribe/subscribe-search-an-api.png %}[]</p> </li> <li> <p>Select the API you want to subscribe to.</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-subscribe/subscribe-select-an-api.png %}[]</p> </li> <li> <p>Click SUBSCRIBE in the sub-menu and choose the API plan.</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-subscribe/subscribe-to-an-api.png %}[]</p> </li> <li> <p>Select your application.</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-subscribe/subscribe-select-an-application.png %}[]</p> <p>Remember, if you choose an OAuth 2.0 plan, the application must have a <code>client_id</code> set.</p> </li> <li> <p>Click NEXT. You can check your information before validating the     request.</p> </li> <li> <p>When you are ready, click VALIDATE THE REQUEST.</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-subscribe/subscribe-confirmation-before-validation.png %}[]</p> <p>If there are general conditions for the selected plan, you need to accept them before validating the subscription.</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-subscribe/subscribe-general-conditions-acceptance.png %}[]</p> <p>If validation is automatic, the following message is displayed:</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-subscribe/subscribe-validation.png %}[]</p> <p>If the API publisher chose to manually validate application subscriptions, you must await approval to use the API.</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-subscribe/subscribe-wait-for-validation.png %}[]</p> </li> </ol>","location":"apim/user-guide/consumer/developer-subscribe/#subscribe-to-an-api"},{"title":"Sharing key across API subscriptions","text":"<p>Since 3.17, an option can be activated to enable API consumers to subscribe to multiple APIs with the same API key.</p> <p>Refer to link:{{ /apim/3.x/apim_publisherguide_plan_security.html#use_a_shared_api_key }}[this section] to learn how to enable this feature.</p> <p>This option is only offered during the second subscription to an API (via an API Key plan). If activated the second subscription will share the same key generated during subscription to the 1st API.</p> <ol> <li> <p>Go to the API Catalog and select an API (that can be subscribed     through an API key plan).</p> </li> <li> <p>Click SUBSCRIBE.</p> </li> <li> <p>Select a plan (with Personal Key as attribute).</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-subscribe/subscribe-shared-key-choose-plan.png %}[]</p> </li> <li> <p>Select an Application (already subscribed once to an API through an     API Key plan).</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-subscribe/subscribe-shared-key-select-app.png %}[]</p> </li> <li> <p>You are now prompted to select the API key mode you want to use.</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-subscribe/subscribe-shared-key-confirm-key-mode.png %}[]</p> </li> <li> <p>Select Shared API Key and click NEXT.</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-subscribe/subscribe-shared-key-validate-subscription-request.png %}[]</p> </li> <li> <p>Click VALIDATE THE REQUEST.</p> </li> </ol> <p>Once the API key mode is chosen for an application, it cannot be changed. All subsequent subscriptions to APIs will be reusing the same key shared across all subscriptions.</p>","location":"apim/user-guide/consumer/developer-subscribe/#sharing-key-across-api-subscriptions"},{"title":"Manage subscriptions","text":"<p>To view your subscriptions and their current status:</p> <ol> <li> <p>Go to the Applications page.</p> </li> <li> <p>Choose an application. In the Subscriptions section you will see     all your subscriptions with their status (for example, Accepted     or Pending).</p> </li> <li> <p>Click on a specific subscription to see the details.</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-subscribe/subscribe-manage-subscriptions.png %}[]</p> <p>For API-Key plans, you can retrieve the API-Key value and also renew or revoke subscriptions.</p> </li> </ol>","location":"apim/user-guide/consumer/developer-subscribe/#manage-subscriptions"},{"title":"Manage subscriptions with Shared key","text":"<p>When an application uses a Shared API key, all subscripitions sharing the API Key are identifiable by a SHARED tag:</p> <p>image::{% link images/apim/3.x/api-consumer-guide/developer-subscribe/subscribe-shared-key-subscription-list.png %}[]</p>","location":"apim/user-guide/consumer/developer-subscribe/#manage-subscriptions-with-shared-key"},{"title":"Analytics","text":"<p>For each API you are subscribed to, APIM provides some analytics to show API usage in your application. For a list of the analytics available, see Analytics.</p>","location":"apim/user-guide/consumer/developer-subscribe/#analytics"},{"title":"Overview","text":"","location":"apim/user-guide/getting-started/apim-console-login/"},{"title":"Overview","text":"","location":"apim/user-guide/getting-started/apim-portal-login/"},{"title":"How To Add API Properties","text":"<p>With Gravitee APIM, you can add and encrypt properties that are local to the API by taking advantage of key-value pairings. Get the most out of this feature and comply with your organization\u2019s security requirements by adding these properties to policies afterwards. Note values are unencrypted by default.</p>","location":"apim/user-guide/publisher/api-property-encryption/"},{"title":"Step 1","text":"<p>First, select an API, then click on the Design tab. Once this tab is open, select the Properties tab in the upper right corner.</p>","location":"apim/user-guide/publisher/api-property-encryption/#step-1"},{"title":"Step 2","text":"<p>Now, add a property by creating your key and value.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/api-property-encryption/api-properties-encryption1.png %}[Create an API property.]</p> <p>Values are not encrypted by default. If the value is not encrypted, you can edit the value contents at any time.</p>","location":"apim/user-guide/publisher/api-property-encryption/#step-2"},{"title":"Step 3","text":"<p>Choose whether or not to encrypt the API property.</p> <ul> <li> <p>To encrypt the property, turn the slide button on before clicking     the + button. PRO-TIP: The value will remain unencrypted and     editable until you save your changes.</p> </li> <li> <p>If you do not want the property to be encrypted, do not turn on this     slide button. image:{% link     images/apim/3.x/api-publisher-guide/api-property-encryption/encrypted-vs-unencrypted.png     %}[Encrypted vs. unencrypted toggle button.]</p> </li> </ul>","location":"apim/user-guide/publisher/api-property-encryption/#step-3"},{"title":"Step 4","text":"<p>Click the + sign to add your property, then click Save in the lower left corner of the page so the system retains your changes. If you do not click save, no changes will be retained.</p> <p>Now, you can redeploy your API.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/api-property-encryption/api-properties-encryption3.png %}[Save your encrypted API property.]</p> <p>The value remains unencrypted and editable until you click Save. Once you click save, you can no longer edit, modify, or view the value.</p> <p>Encrypted values can still be used by API Policies (under the Design tab) and APIM Gateway will automatically decrypt these values. Pay special attention to how you use encrypted data in policies.</p>","location":"apim/user-guide/publisher/api-property-encryption/#step-4"},{"title":"Step 5 (Optional)","text":"<p>Now, you can apply your property to a policy. To experiment with this feature, you can add your property to the body of a Mock Policy.</p> <p>Use this syntax for your property: <code>{#properties['property_name']}</code></p> <p>Remember, encrypted values can still be used by API Policies (under the Design tab) and APIM Gateway will automatically decrypt these values. Be especially careful when using encrypted data in policies.</p>","location":"apim/user-guide/publisher/api-property-encryption/#step-5-optional"},{"title":"Step 6","text":"<p>Lastly, you\u2019ll need to reset the secret key. The method of encryption used for API properties is based on the default secret key in the 'gravitee.yml` config file which you must override to ensure proper security.</p> <p>Do not use this default secret key. Instead, set your own custom 32-byte length secret in the gravitee.yml config file.</p> <pre><code># Encrypt API properties using this secret:\napi:\n  properties:\n    encryption:\n         secret: vvLJ4Q8Khvv9tm2tIPdkGEdmgKUruAL6\n to provide the best security available.\n</code></pre> <p>PRO-TIP: The secret must be 32 bytes in length.</p>","location":"apim/user-guide/publisher/api-property-encryption/#step-6"},{"title":"API rating","text":"<p>API rating is a good way to promote your APIs. Only members of the API with correct permissions are allowed to rate it.</p> <p>Permission RATING:</p> <ul> <li> <p>CREATE: users can give a rating from 0 to 5</p> </li> <li> <p>READ: users can see the ratings of the API</p> </li> <li> <p>UPDATE: users can add a comment to their rating</p> </li> <li> <p>DELETE: users can delete any comment</p> </li> </ul> <p>A member can also answer a rating.</p> <p>Permission RATING_ANSWER:</p> <ul> <li> <p>CREATE: users can answer a rating</p> </li> <li> <p>READ: users can see the rating answers of the API</p> </li> <li> <p>DELETE: users can delete any answer</p> </li> </ul> <p>By default, API rating is disabled. To enable it, configure <code>gravitee.yml</code> as follows:</p> <pre><code>...\n# Allows to rate an API (default value: false)\nrating :\n  enabled: true\n</code></pre>","location":"apim/user-guide/publisher/api-rating/"},{"title":"Overview","text":"<p>You can use the APIM audit trail for monitoring the behaviour of your API and platform over time. For example, you can use it in conjunction with the analytics feature to identify a point at which your API behavior changed, view the configuration which caused the change and roll back to an earlier configuration if required.</p> <p>See also: link:{{ /apim/3.x/apim_publisherguide_logging_analytics.html | relative_url }}[Logging and analytics]</p> <p>APIM Console provides audit trails at two levels of granularity:</p> <ul> <li> <p>A platform-wide audit trail, which you can view with the Audit     menu option:</p> <p>image:{% link images/apim/3.x/api-publisher-guide/audit/global-audit.png %}[]</p> </li> <li> <p>An API-specific audit trail, which you can view with the API     Audit menu option in APIM Console:</p> <p>image:{% link images/apim/3.x/api-publisher-guide/audit/api-audit.png %}[]</p> </li> </ul> <p>The sections below focus on the API audit trail.</p>","location":"apim/user-guide/publisher/audit-trail/"},{"title":"API audit trail","text":"<p>You can use the API audit trail to:</p> <ul> <li> <p>view a list of API events, filtered by event type and date, with a     toggle to show and hide the JSON associated with the event</p> </li> <li> <p>view a history of API deployments, including details of the     configuration each deployment, a diff feature for comparing     deployments and a rollback feature for rolling back the API to an     earlier stage</p> </li> <li> <p>view a visual map of API events</p> </li> </ul>","location":"apim/user-guide/publisher/audit-trail/#api-audit-trail"},{"title":"API history","text":"<p>You can use the history feature of the audit trail to view the different stages of the API lifecycle and their associated configuration.</p> <p>Each stage corresponds to a new deployment of the API, with a number and a label (if specified at deployment time) identifying the deployment:</p> <p>image:{% link images/apim/3.x/api-publisher-guide/audit/history-overview.png %}[]</p>","location":"apim/user-guide/publisher/audit-trail/#api-history"},{"title":"View the details of an API deployment","text":"<ol> <li> <p>In the API Audit page, click History.</p> </li> <li> <p>Select the API deployment to see more details.</p> </li> <li> <p>Select a flow and click through the tabs to see its configuration     details. In the DESIGN tab, you can select a policy to view     details of the policy configuration.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/audit/audit-history-details.png %}[]</p> </li> <li> <p>To view the deployment configuration in JSON format, toggle Mode     to Definition.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/audit/audit-definition-mode.png %}[]</p> </li> <li> <p>To copy the deployment configuration in JSON format, click COPY TO     CLIPBOARD. You can do this in either definition or design mode.</p> </li> <li> <p>To view a diff of the deployment configuration, click DIFF and     select another deployment stage to view the difference between the     two deployments. If this is not the latest deployment, you can also     click DIFF WITH PUBLISHED API to view the difference with the     latest deployment. The numbers in green and red at the top indicate     the number of additions to and subtractions from the definition.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/audit/audit-history-diff.png %}[]</p> </li> </ol>","location":"apim/user-guide/publisher/audit-trail/#view-the-details-of-an-api-deployment"},{"title":"Roll back your API to an earlier deployment","text":"<p>You can roll back to an earlier deployment of your API. This does not remove the later deployments, it adds a new deployment in the history with a configuration which corresponds to the deployment selected for rollback.</p> <ol> <li> <p>Open the API history as described above.</p> </li> <li> <p>Click the API deployment to roll back to.</p> </li> <li> <p>Click ROLLBACK and confirm in the prompt.</p> </li> <li> <p>To complete the rollback, select the new rollback deployment and     click DEPLOY.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/audit/audit-history-rollback.png %}[]</p> <p>To view a diff of the deployment before deploying, you can use the diff feature as described above.</p> </li> <li> <p>(Optional) Add a deployment label to identify to the new deployment.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/audit/audit-history-rollback-deployment-label.png %}[]</p> </li> <li> <p>Click OK.</p> <p>APIM adds a new deployment to the history.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/audit/audit-history-rollback-deployment.png %}[]</p> </li> </ol>","location":"apim/user-guide/publisher/audit-trail/#roll-back-your-api-to-an-earlier-deployment"},{"title":"Load balancing, failover, and health check","text":"<p>= Load balancing, failover and health check :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_publisherguide_backend_services.html :page-folder: apim/user-guide/publisher :page-layout: apim3x</p> <p>== Overview</p> <p>APIM includes a number of backend services for managing your APIs. This page explains how to configure the following services for your APIs:</p> <ul> <li>Load balancing</li> <li>Failover</li> <li>Health check</li> </ul> <p>=== How to access the API backend service configuration</p> <p>To update the configuration for these services:</p> <p>. link:{{ '/apim/3.x/apim_quickstart_console_login.html' | relative_url }}[Log in to APIM Console^]. . Click APIs and select an API. . Click Proxy. + The backend service configuration options are in the BACKEND SERVICES section. + image:{% link images/apim/3.x/api-publisher-guide/backend-services/api-backend-services.png %}[]</p> <p>WARNING: You must redeploy your API with the deploy the API link after each new configuration.</p> <p>== Configure load balancing</p> <p>APIM Gateway includes a built-in load balancer, which you can enable and configure for your API endpoints according to your requirements.</p> <p>[[endpoint-groups]] === Endpoint groups</p> <p>You configure load balancing by creating a logical grouping of endpoints and specifying a load balancing algorithm for them. For example, you can define a group of endpoints representing instances of the same API deployed on different servers.</p> <p>APIM always uses the first group defined for load balancing. Any additional groups you define are for use in policies:</p> <ul> <li>redirection rules including named groups in the link:{{ '/apim/3.x/apim_policies_dynamic_routing.html#regular_expressions' | relative_url }}[Dynamic routing^] policy</li> <li>traffic shadowing using endpoints in these groups link:{{ '/apim/3.x/apim_policies_traffic_shadowing.html' | relative_url }}[Traffic shadowing^] policy</li> </ul> <p>=== Load balancing types</p> <p>You can configure four types of load balancing:</p> <ul> <li>Round robin</li> <li>Random</li> <li>Weighted round robin</li> <li>Weighted random</li> </ul> <p>For the two weighted types, you need to assign a weight to your endpoints to determine the frequency with which APIM Gateway selects one endpoint for load balancing compared to another.</p> <p>For example, if you have the following two endpoints:</p> <ul> <li>Endpoint 1 with a weight of 9</li> <li>Endpoint 2 with a weight of 1</li> </ul> <p>Endpoint 1 is selected 9 times out of 10, whereas Endpoint 2 is selected only 1 time out of 10.</p> <p>=== Create a group</p> <p>. Click Endpoints. . Click ADD A NEW GROUP. . In the GENERAL tab, enter a Name for the group and the type of load balancing algorithm to use. . In the CONFIGURATION tab, configure any additional HTTP details for the group, such as proxy and SSL details. . In the SERVICE DISCOVERY tab, enable Enabled service discovery if you want external endpoints to be dynamically added or removed to or from the group, then specify the type of service discovery. For more details of service discovery in APIM, see link:{{ '/apim/3.x/apim_service_discovery_overview.html' | relative_url }}[Service discovery^]). . Click SAVE.</p> <p>Your group is added to the list. You can now perform any of the following actions on the group by clicking the corresponding icon in the group header:</p> <ul> <li>Add endpoints to your group by clicking the plus icon image:{% link images/icons/lb-plus-icon.png %}[role=\"icon\"]</li> <li>Update the group configuration by clicking the settings icon image:{% link images/icons/settings-icon.png %}[role=\"icon\"]</li> <li>Delete the group by clicking the delete icon image:{% link images/icons/delete-icon.png %}[role=\"icon\"]</li> <li>Change the display order of the endpoints from ascending to descending and vice versa, by clicking the arrow icon image:{% link images/icons/up-arrow-icon.png %}[role=\"icon\"] next to the Name, Type or Weight header</li> </ul> <p>=== Add endpoints to your group</p> <p>. Click the plus icon image:{% link images/icons/lb-plus-icon.png %}[role=\"icon\"] to add new endpoints to your group. . In the GENERAL tab, specify the endpoint details as follows:</p> <ul> <li>The Type and Name of the endpoint</li> <li>The endpoint URL in the Target field</li> <li>A number in the Weight field (only if the endpoint is in a group configured with Weighted Round-Robin or Weighted Random load balancing), representing the weight the endpoint has in terms of selecting it for Weighted load balancing</li> <li>If a global health check configuration exists, it is automatically applied to this endpoint. If you want to change the health check behavior for your endpoint, click the settings icon image:{% link images/icons/settings-icon.png %}[role=\"icon\"]in the Health-check section, then:  Uncheck Enable health-check to disable health checking for your endpoint  Uncheck Inherit configuration and specify a different health check configuration, as described in &lt;&gt; from step 4 <li>Check the Secondary endpoint option to define this endpoint outside the main load balancing pool, to be used for load balancing only if all the primary endpoints are marked as down by the health check</li>  <p>. In the CONFIGURATION tab, uncheck the option to inherit the HTTP configuration specified for the group if you want to specify a different HTTP configuration for this endpoint, then enter the details of the HTTP configuration. . Click SAVE. + Your new endpoint is added to the list. Endpoints with inherited configuration are denoted by a right-angled arrow and endpoints with health checking configured are denoted by a heart: + image:{% link images/apim/3.x/api-publisher-guide/backend-services/api-backend-inherited-config.png %}[]</p> <p>You can now perform any of the following actions on the endpoint:</p> <ul> <li>Update the endpoint configuration by clicking the settings icon image:{% link images/icons/settings-icon.png %}[role=\"icon\"] next to the endpoint</li> <li>Delete one or more of the endpoints in the group by selecting the relevant checkboxes and clicking the delete icon image:{% link images/icons/delete-icon.png %}[role=\"icon\"] in the header row</li> </ul> <p>== Configure failover</p> <p>Once you have configured your endpoints, as described in &lt;&gt;, you can configure failover for the endpoints and load balancing algorithm configured. <p>. Click Failover. . Select Enabled to enable failover. + image:{% link images/apim/3.x/api-publisher-guide/backend-services/api-backend-failover.png %}[]</p> <p>. Enter a Max attempts number, for the number of times APIM Gateway attempts to find a suitable endpoint, according to the load balancing algorithm, before returning an error. . Enter a Timeout, for the number of milliseconds between each attempt. . Click SAVE.</p> <p>== Configure health check</p> <p>This section explains how to create a global health check configuration. When you create a global health check configuration, APIM applies the configuration to all existing endpoints and all new endpoints you create by default.</p> <p>To create an endpoint-specific health check configuration or disable health checking for an endpoint, choose the endpoint first and click the health check settings, as described in &lt;&gt;. <p>From APIM version 3.6, you can view the health of your APIs in Dashboard, by clicking the APIS STATUS tab:</p> <p>image:{% link images/apim/3.x/api-publisher-guide/backend-services/api-status-dashboard.png %}[]</p> <p>To configure health checking:</p> <p>. Click Health-check. . Click the Configure Health-check link at the top of the page. . Select Enable health-check. + image:{% link images/apim/3.x/api-publisher-guide/backend-services/api-backend-health-check.png %}[]</p> <p>ifeval::[{{ site.products.apim._3x.version }} &lt; 3.6.0] . Enter the interval between each health check as an Interval number and a Time Unit. Note that this interval is applied for each gateway in your APIM environment. endif::[] ifeval::[{{ site.products.apim._3x.version }} &gt;= 3.6.0] . Enter the schedule as a <code>cron</code> expression. endif::[]</p> <p>. Enter the HTTP Method which triggers the health check. . Add the path which triggers the health check. Select From root path to apply the path specified at root URL level. For example, if your endpoint URL is <code>www.test.com/api</code>, this option removes <code>/api</code> before appending the path. . Specify headers which trigger the health check, if any. You can use link:{{ '/apim/3.x/apim_publisherguide_expression_language.html' | relative_url }}[Gravitee Expression Language^] to configure a header. Available variables are link:{{ '/apim/3.x/apim_publisherguide_expression_language.html#dictionaries' | relative_url }}[dictionaries^] and link:{{ '/apim/3.x/apim_publisherguide_expression_language.html#properties' | relative_url }}[api's properties^] access. . In Assertions, specify any conditions to test for in the API response in order to trigger the health check. Assertions are written in link:{{ '/apim/3.x/apim_publisherguide_expression_language.html' | relative_url }}[Gravitee Expression Language^]. An assertion can be a simple 200 response (<code>#response.status == 200</code>) but you can also test for specific content. . Click SAVE. + You can see a visual summary of the health check configuration you specified on the right. + After you deploy your API, click Back to Health-check to view the health check. You can filter the display by date and time period.</p>","location":"apim/user-guide/publisher/backend-services/"},{"title":"Overview","text":"<p>CORS is a mechanism that allows resources on a web page to be requested from another domain.</p> <p>For background information on CORS, take a look at the CORS specification.</p>","location":"apim/user-guide/publisher/configuring-cors/"},{"title":"Configuration","text":"<p>You can configure CORS for an API in APIM Console with the Proxy &gt; CORS menu option. The sections below detail the values you can specify.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/cors/graviteeio-configuring-cors-configuration-1.png %}[]</p>","location":"apim/user-guide/publisher/configuring-cors/#configuration"},{"title":"Access-Control-Allow-Origin","text":"<p>One or multiple origins that can access the resource. If you want to allow all origins, you can enter <code>*</code>. Note that this is not safe for production environments.</p>","location":"apim/user-guide/publisher/configuring-cors/#access-control-allow-origin"},{"title":"Access-Control-Allow-Methods","text":"<p>The method or methods allowed to access the resource. This is used in response to a preflight request.</p>","location":"apim/user-guide/publisher/configuring-cors/#access-control-allow-methods"},{"title":"Access-Control-Allow-Headers","text":"<p>The headers allowed in your requests. Typically, your request header will include <code>Access-Control-Request-Headers</code>, which relies on CORS configuration to allow its values.</p> <p>A simple use case is as follows:</p> <p>A user makes a call with a header <code>Access-Control-Request-Headers: my-header</code>.</p> <ul> <li> <p>If CORS <code>Access-Control-Allow-Headers</code> is not configured with the     header <code>my-header</code>, the request will receive a 400 HTTP status     response.</p> </li> <li> <p>If CORS <code>Access-Control-Allow-Headers</code> includes the header     <code>my-header</code>, the request will receive a 200 HTTP status response.</p> </li> </ul> <p>Wildcard (<code>*</code>) is not allowed.</p>","location":"apim/user-guide/publisher/configuring-cors/#access-control-allow-headers"},{"title":"Access-Control-Allow-Credentials","text":"<p>Indicates whether or not the response to the request can be exposed when the credentials flag is <code>true</code>.</p>","location":"apim/user-guide/publisher/configuring-cors/#access-control-allow-credentials"},{"title":"Access-Control-Allow-Max-Age","text":"<p>indicates how long the results of a preflight request can be cached (<code>-1</code> if disabled).</p>","location":"apim/user-guide/publisher/configuring-cors/#access-control-allow-max-age"},{"title":"Access-Control-Expose-Headers","text":"<p>Provides a server whitelist headers that browsers are allowed to access.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/cors/graviteeio-configuring-cors-configuration-2.png %}[]</p>","location":"apim/user-guide/publisher/configuring-cors/#access-control-expose-headers"},{"title":"Troubleshooting CORS","text":"<p>All requests rejected because of CORS issues will generate some logs that you can view in the <code>Analytics</code> section of your API logs.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/cors/graviteeio-troubleshooting-cors.png %}[]</p>","location":"apim/user-guide/publisher/configuring-cors/#troubleshooting-cors"},{"title":"Overview","text":"<p>The following sections describe the different ways you can create an API using APIM Console.</p> <p>For a quick introduction to creating an API in APIM, see the link:{{ /apim/3.x/apim_quickstart_publish_ui.html | relative_url }}[Quick Start Guide^].</p> <p>From APIM 3.5.x, the recommended way to create an API is using the DESIGN STUDIO method described in the next section. For APIs created using this method, clicking the Design menu option automatically opens Design Studio. Old API definitions or APIs created using the PATH BASED option must be migrated before you can update them in Design Studio. For more information, see the link:{{ /apim/3.x/apim_publisherguide_design_studio_overview.html | relative_url }}[Design Studio Guide^].</p>","location":"apim/user-guide/publisher/create-api/"},{"title":"Get started","text":"<p>Using APIM Console, you can create new API definitions from scratch, or import existing definitions.</p> <p>You can also create APIs using APIM API. For more details, see the link:{{ /apim/3.x/apim_quickstart_publish_api.html | relative_url }}[Quick Start Guide^].</p> <p>To start creating an API:</p> <ol> <li> <p>In APIM Console, click APIs.</p> </li> <li> <p>Click the plus icon image:{% link images/icons/plus-icon.png     %}[role=\"icon\"] at the bottom right of the page.</p> <p>image::{% link images/apim/3.10/apim-console-create-api.png %}[Create API]</p> <p>APIM presents you with two options for creating APIs. The recommended option is DESIGN STUDIO.</p> <p>image::{% link images/apim/3.x/quickstart/publish/graviteeio-create-api-2.png %}[]</p> </li> <li> <p>Under DESIGN STUDIO, click:</p> <ul> <li> <p>CREATE to create an API from scratch.</p> <p>Learn how to ???</p> </li> <li> <p>IMPORT to import an external API definition.</p> <p>Learn how to ???</p> </li> </ul> </li> </ol>","location":"apim/user-guide/publisher/create-api/#get-started"},{"title":"Create an API from scratch","text":"<p>These steps describe how to create all of the basic API configuration your developers need to call your API. If a short TTFAC (time to first API call) is your goal, configure only the mandatory parts and a basic plan now\u2009\u2014\u2009you can always update these later on.</p> <p>You need to create a plan before you can accept user subscriptions to your API. You can do that now or when you get to the link:{{ /apim/3.x/apim_publisherguide_plans_subscriptions.html | relative_url }}[Plans and subscriptions^] section, but the plan options available to you now are more limited.</p> <ol> <li> <p>Enter the general details of the API:</p> <ul> <li> <p>A Name, Version, and Description.</p> </li> <li> <p>The Context-path where the API will be exposed on APIM     Gateway, starting from /.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/create-api-general-withgroups.png %}[]</p> </li> </ul> </li> <li> <p>(Optional) Associate a group with the API, if any are defined (see     link:{{ /apim/3.x/apim_adminguide_users_and_groups.html |     relative_url }}[Users and Groups] for more details):</p> <ul> <li> <p>Select a group which can access the API in Groups.</p> </li> <li> <p>If the link:{{     /apim/3.x/apim_adminguide_users_and_groups.html#primary_owner_mode     | relative_url }}[Primary owner mode^] is HYBRID, click     the Advanced mode link to associate a primary owner group.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-api-primaryowner-mode-3.png %}[]</p> </li> </ul> </li> <li> <p>Click NEXT.</p> </li> <li> <p>Enter the details of the gateway:</p> <ul> <li> <p>A backend URL for receiving API calls.</p> </li> <li> <p>(Optional) Click the Advanced mode link to specify details     of tenants and sharding tags.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/create-api-gateway.png %}[]</p> </li> </ul> </li> <li> <p>Click NEXT.</p> </li> <li> <p>(Optional) If you want to create a plan for the API, enter the     following details and click NEXT, otherwise click SKIP:</p> <ul> <li> <p>The Name, Security type, and Description.</p> </li> <li> <p>If subscription auto-validation is required, toggle on the     Auto validate subscription option.</p> </li> <li> <p>The Characteristics.</p> </li> <li> <p>Rate limit and Quota details. In this example, we are     specifying a rate limit of 1 request every 5 seconds.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/create-api-plan1.png %}[] * Resource filtering details, using link:{{ /apim/3.x/apim_policies_overview.html#ant-notation | relative_url }}[Ant^] notation and an HTTP method.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/create-api-plan-path.png %}[]</p> </li> </ul> </li> <li> <p>(Optional) Import a documentation specification file, otherwise     click SKIP.</p> </li> <li> <p>Review the details of the API, then click one of the following     options, depending on whether you want to create and deploy the API     or simply create it:</p> <ul> <li> <p>CREATE THE API WITHOUT DEPLOYING IT</p> </li> <li> <p>CREATE AND START THE API</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/create-api-confirm.png %}[]</p> </li> </ul> </li> </ol>","location":"apim/user-guide/publisher/create-api/#create-an-api-from-scratch"},{"title":"Import an API definition","text":"<p>You can import external API definitions using one of the following methods.</p>","location":"apim/user-guide/publisher/create-api/#import-an-api-definition"},{"title":"Import an existing API definition","text":"<p>You can import and export your APIs to a Gravitee API definition format (see the example below).</p> <p>To import an API from an API definition:</p> <ul> <li>If the definition is a file, select IMPORT FILE and browse your     file system to select it.</li> </ul> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-import-definition-file.png %}[Import from definition file, 300]</p> <ul> <li>If the definition is a link, select IMPORT FROM LINK, then     choose API Definition and enter the definition URL.</li> </ul> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-import-definition-link.png %}[Import from definition link, 300]</p> <p>Learn more about API definition import process link:{% link pages/apim/3.x/user-guide/publisher/import-apis.adoc %}[here].</p>","location":"apim/user-guide/publisher/create-api/#import-an-existing-api-definition"},{"title":"Import an OpenAPI specification","text":"<p>One of the most powerful features of APIM is its ability to import an OpenAPI specification to create an API. When you import an existing specification you do not have to complete all the fields required when you create a new API.</p> <p>To import an API from OpenAPI:</p> <ul> <li>If the OpenAPI specification is a file, select IMPORT FILE and     browse your file system to select it.</li> </ul> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-import-openapi-file.png %}[Import from definition file, 300]</p> <ul> <li>If the OpenAPI specification is a link, select IMPORT FROM LINK,     choose Swagger / OpenAPI and enter the definition URL.</li> </ul> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-import-openapi-link.png %}[Import from definition link, 300]</p>","location":"apim/user-guide/publisher/create-api/#import-an-openapi-specification"},{"title":"How the context-path is determined","text":"<p>Specification version</p> <p>Definition</p> <p>Example</p> <p>Context-path</p>   <p>Swagger (V2)</p> <p><code>basePath</code> field, if it exists.</p> <pre><code>{\n  \"swagger\": \"2.0\",\n  \"info\": {\n    \"description\": \"...\",\n    \"version\": \"1.0.5\",\n    \"title\": \"Swagger Petstore\"\n  },\n  \"host\": \"petstore.swagger.io\",\n  \"basePath\": \"/v2\",\n  ...\n}</code></pre> <p>/v2</p>   <p>If not, lowercase trimmed <code>info.title</code>.</p> <pre><code>{\n  \"swagger\": \"2.0\",\n  \"info\": {\n    \"description\": \"...\",\n    \"version\": \"1.0.5\",\n    \"title\": \"Swagger Petstore\"\n  },\n  \"host\": \"petstore.swagger.io\",\n\n  ...\n}</code></pre> <p>/swaggerpetstore</p>    <p>OpenAPI (V3)</p> <p>Path of the first <code>servers.url</code>, if it exists, without \"/\". </p> <pre><code>openapi: \"3.0.0\"\ninfo:\n  version: 1.0.0\n  title: Swagger Petstore\n  license:\n    name: MIT\nservers:\n  - url: http://petstore.swagger.io/v1\npaths:\n...</code></pre> <p>/v1</p>   <p>If not, lowercase trimmed <code>info.title</code>.</p> <pre><code>openapi: \"3.0.0\"\ninfo:\n  version: 1.0.0\n  title: Swagger Petstore\n  license:\n    name: MIT\nservers:\n  - url: http://petstore.swagger.io/\npaths:\n  ...</code></pre> <p>/swaggerpetstore</p>","location":"apim/user-guide/publisher/create-api/#how-the-context-path-is-determined"},{"title":"Vendor extensions","text":"<p>You can use a vendor extension to add more information to OpenAPI specifications about your API. To do this, you need to add the <code>x-graviteeio-definition</code> field at the root of the specification. The value of this field is an <code>object</code> that follows this JSON Schema^</p> <ul> <li> <p><code>categories</code> must contain either a key or an id. Only existing     categories are imported.</p> </li> <li> <p>Import will fail if <code>virtualHosts</code> are already in use by other     APIs.</p> </li> <li> <p>If set, <code>virtualHosts</code> will override <code>contextPath</code>.</p> </li> <li> <p><code>groups</code> must contain group names. Only existing groups are     imported.</p> </li> <li> <p><code>metadata.format</code> is case-sensitive. Possible values are:</p> <ul> <li> <p>STRING</p> </li> <li> <p>NUMERIC</p> </li> <li> <p>BOOLEAN</p> </li> <li> <p>DATE</p> </li> <li> <p>MAIL</p> </li> <li> <p>URL</p> </li> </ul> </li> <li> <p><code>picture</code> only accepts Data-URI format (see example below).</p> </li> </ul> <p>Here is an example: ```yaml openapi: \"3.0.0\" info: version: 1.2.3 title: Gravitee.io Echo API license: name: MIT servers: - url: https://demo.gravitee.io/gateway/echo x-graviteeio-definition: categories: - supplier - product virtualHosts: - host: api.gravitee.io path: /echo overrideEntrypoint: true groups: - myGroupName labels: - echo - api metadata: - name: relatedLink value: http://external.link format: URL picture: data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 properties: - key: customHttpHeader value: X-MYCOMPANY-ID tags: - DMZ - partner - internal visibility: PRIVATE paths: \u2026 ```</p>","location":"apim/user-guide/publisher/create-api/#vendor-extensions"},{"title":"Policies on path","text":"<p>When importing an OpenAPI definition, you can select the option Create policies on path in the import form. This specifies that all routes declared in the OpenAPI specification are to be automatically created in APIM. You can navigate to the policy management view to check.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-import-openapi-policies-path.png %}[Policies view - all routes imported]</p> <p>You can also choose to activate policies that will be configured using the OpenAPI specification.</p> <p>JSON Validation For each operation, if an <code>application/json</code> request body exists, then a JSON schema is computed from this body to configure a JSON Validation policy. REQUEST only More information is available link:{{ /apim/3.x/apim_policies_json_validation.html | relative_url }}[here].</p> <p>REST to SOAP transformer For each operation, if the definition contains some specific vendor extensions, a REST to SOAP policy can be configured. These extensions are:</p> <ul> <li> <p><code>x-graviteeio-soap-envelope</code>: contains the SOAP envelope</p> </li> <li> <p><code>x-graviteeio-soap-action</code>: contains the SOAP action</p> <p>REQUEST only More information is available link:{{ /apim/3.x/apim_policies_rest2soap.html | relative_url }}[here].</p> </li> </ul> <p>Mock For each operation, a mock policy is configured, based on the <code>example</code> field if it exists, or by generating a random value for the type of the attribute to mock. REQUEST only More information is available link:{{ /apim/3.x/apim_policies_mock.html | relative_url }}[here].</p> <p>Validation Request For each operation, <code>NOT__ __NULL</code> rules are created with query parameters and headers. REQUEST only More information is available link:{{ /apim/3.x/apim_policies_request_validation.html | relative_url }}[here]-</p> <p>XML Validation For each operation, if a <code>application/xml</code> request body exists, then a XSD schema is computed from this body to configure an XML Validation policy. REQUEST only More information is available link:{{ /apim/3.x/apim_policies_xml_validation.html | relative_url }}[here].</p>","location":"apim/user-guide/publisher/create-api/#policies-on-path"},{"title":"Import a WSDL","text":"<p>APIM can import a WSDL to create an API. This means you do not have to declare all the routing and policies to interact with your service.</p> <p>To import an API from a WSDL:</p> <ul> <li> <p>If the WSDL is a file, select IMPORT FILE and browse your file     system to select it.</p> </li> <li> <p>If the WSDL is a link, select IMPORT FROM LINK, choose WSDL     and enter the definition URL.</p> </li> </ul> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-import-wsdl-rest-to-soap-options.png %}[Import from WSDL link]</p> <p>If you select the option Apply REST to SOAP Transformer policy in addition to the option Create policies on path in the import form, a REST-To-SOAP policy will be generated for each path. These policies provide a SOAP envelope for each method with sample data that you can change using expression language. An XML-to-JSON policy will also be generated to convert the entire SOAP response to JSON format.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-import-wsdl-rest-to-soap-policy.png %}[WSDL REST to SOAP policy]</p>","location":"apim/user-guide/publisher/create-api/#import-a-wsdl"},{"title":"Manage your API","text":"<p>The API is created private, so it is only accessible in APIM Portal to users after you:</p> <ul> <li> <p>Publish it</p> </li> <li> <p>Make it public or add new members or groups to it</p> </li> </ul> <p>The process for adding new members or groups to the API is explained in link:{{ /apim/3.x/apim_publisherguide_manage_members.html | relative_url }}[API users and ownership^].</p> <p>You can publish the API or make it public, as well as remove it from APIM Portal or delete it, in the Danger Zone:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/danger-zone.png %}[]</p>","location":"apim/user-guide/publisher/create-api/#manage-your-api"},{"title":"Organize your APIs into categories","text":"<p>You can create categories to group APIs. The purpose of categories is to group APIs so consumers can easily find the APIs they need in APIM Portal.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-manage-apis-categories-1.png %}[]</p> <p>You can describe a category with the following characteristics:</p> <ul> <li> <p>Name</p> </li> <li> <p>Description</p> </li> <li> <p>Picture</p> </li> <li> <p>Markdown page as documentation</p> </li> </ul> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-manage-apis-categories-2.png %}[]</p> <p>Once you have finished describing the category, you select the APIs you want to include in it.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-manage-apis-categories-3.png %}[]</p> <p>You can also choose to highlight a particular API. This API will be shown at the top of the category page.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-manage-apis-categories-4.png %}[] image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-manage-apis-categories-4.png %}[] The next time you enter labels for an API, APIM Console makes suggestions based on your registered labels.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-manage-apis-labels-2.png %}[]</p> <p>You can search for APIs by label.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-manage-apis-labels-3.png %}[]</p>","location":"apim/user-guide/publisher/create-api/#organize-your-apis-into-categories"},{"title":"Overview","text":"<p>The APIM Expression Language (EL for short) is one of the key features that can be used by API publishers to configure various aspects and services of an API.</p> <p>The EL is a powerful language used for querying and manipulating an object graph. It is based on the SpEL^ (Spring Expression Language). This means that you can do everything described in the link.</p> <p>In addition, APIM extends the standard SpEL capabilities by providing extra objects and properties inside the expression language context.</p>","location":"apim/user-guide/publisher/expression-language/"},{"title":"Usage","text":"<p>The basic expression language syntax is as follows:</p> <p><code>{#request.id}</code></p> <p>See the sections below for example expression notations.</p>","location":"apim/user-guide/publisher/expression-language/#usage"},{"title":"API","text":"","location":"apim/user-guide/publisher/expression-language/#api"},{"title":"Properties","text":"<p>As an API publisher, you can define properties for your API. These properties are automatically injected into the expression language context to be used later.</p>","location":"apim/user-guide/publisher/expression-language/#properties"},{"title":"Example","text":"<ul> <li>Get the value of the property <code>my-property</code> defined in API     properties: <code>{#properties['my-property']}</code></li> </ul>","location":"apim/user-guide/publisher/expression-language/#example"},{"title":"Dictionaries","text":"<p>Dictionaries work in a similar way to properties, but you need to specify the dictionary name as well as the property name.</p>","location":"apim/user-guide/publisher/expression-language/#dictionaries"},{"title":"Example","text":"<ul> <li>Get the value of the property <code>my-property</code> defined in dictionary     <code>my-dictionary</code>: <code>{#dictionaries['my-dictionary']['my-property']}</code></li> </ul>","location":"apim/user-guide/publisher/expression-language/#example_1"},{"title":"Endpoints","text":"<p>When you define endpoints for your API, you need to give them a name which must be a unique identifier across all endpoints of the API. This identifier can be used to get an endpoint reference (i.e. uri).</p> <p>For example: when you create an API, a default endpoint is created, corresponding to the value you set for the backend property. This endpoint can be retrieved with EL by using the following syntax:</p> <p><code>{#endpoints['default']}</code></p>","location":"apim/user-guide/publisher/expression-language/#endpoints"},{"title":"Request","text":"<p>The properties you can access for API requests are listed below.</p>          <p>Property</p> <p>Description</p> <p>Type</p> <p>Example</p>   <p>id</p> <p>Identifier</p> <p>string</p> <p>12345678-90ab-cdef-1234-567890ab</p>   <p>transactionId</p> <p>Transaction identifier</p> <p>string</p> <p>cd123456-7890-abcd-ef12-34567890</p>   <p>uri</p> <p>URI</p> <p>string</p> <p>/v2/store/MyStore?order=100</p>   <p>path</p> <p>Path</p> <p>string</p> <p>/v2/store/MyStore</p>   <p>paths</p> <p>Path parts</p> <p>array of string</p> <p>[,v2,store,MyStore]</p>   <p>pathInfo</p> <p>Path info</p> <p>string</p> <p>/store/MyStore</p>   <p>pathInfos</p> <p>Path info parts</p> <p>array of string</p> <p>[,store,MyStore]</p>   <p>contextPath</p> <p>Context path</p> <p>string</p> <p>/v2/</p>   <p>params</p> <p>Query parameters</p> <p>key / value</p> <p>order \u2192 100</p>   <p>pathParams</p> <p>Path parameters</p> <p>key / value</p> <p>storeId \u2192 MyStore (see Warning for details)</p>   <p>headers</p> <p>Headers</p> <p>key / value</p> <p>X-Custom \u2192 myvalue</p>   <p>method</p> <p>HTTP method</p> <p>string</p> <p>GET</p>   <p>scheme</p> <p>HTTP scheme</p> <p>string</p> <p>http</p>   <p>version</p> <p>HTTP version</p> <p>string</p> <p>HTTP_1_1</p>   <p>timestamp</p> <p>Timestamp</p> <p>long</p> <p>1602781000267</p>   <p>remoteAddress</p> <p>Remote address</p> <p>string</p> <p>0:0:0:0:0:0:0:1</p>   <p>localAddress</p> <p>Local address</p> <p>string</p> <p>0:0:0:0:0:0:0:1</p>   <p>content</p> <p>Body content</p> <p>string</p> <p>-</p>   <p>ssl</p> <p>SSLSession information</p> <p>???</p> <p>-</p>    <p><code>{#request.content}</code> is only available for policies bound to an <code>on-request-content</code> phase.</p>","location":"apim/user-guide/publisher/expression-language/#request"},{"title":"SSL Object","text":"<p>The properties you can access in SSL Session object are listed below.</p>          <p>Property</p> <p>Description</p> <p>Type</p> <p>Example</p>   <p>clientHost</p> <p>Host name of the client</p> <p>string</p> <p>client.domain.com</p>   <p>clientPort</p> <p>Port number of the client</p> <p>long</p> <p>443</p>   <p>client</p> <p>Client information</p> <p>???</p> <p>-</p>   <p>server</p> <p>Server information</p> <p>???</p> <p>-</p>","location":"apim/user-guide/publisher/expression-language/#ssl-object"},{"title":"Principal Object","text":"<p>The properties you can access in Principal object are listed below.</p>          <p>Property</p> <p>Description</p> <p>Type</p> <p>Example</p>   <p>Common DN attributes</p>   <p>businessCategory</p> <p>Business category</p> <p>string</p> <p>-</p>   <p>c</p> <p>Country code</p> <p>string</p> <p>FR</p>   <p>cn</p> <p>Common name</p> <p>string</p> <p>-</p>   <p>countryOfCitizenship</p> <p>RFC 3039 CountryOfCitizenship</p> <p>string</p> <p>-</p>   <p>countryOfResidence</p> <p>RFC 3039 CountryOfResidence</p> <p>string</p> <p>-</p>   <p>dateOfBirth</p> <p>RFC 3039 RFC 3039 DateOfBirth</p> <p>string</p> <p>19830719000000Z</p>   <p>dc</p> <p>Domain component</p> <p>string</p> <p>-</p>   <p>description</p> <p>Description</p> <p>string</p> <p>-</p>   <p>dmdName</p> <p>RFC 2256 directory management domain</p> <p>string</p> <p>-</p>   <p>dnQualifier</p> <p>Domain name qualifier</p> <p>string</p> <p>-</p>   <p>e</p> <p>Email address in Verisign certificates</p> <p>string</p> <p>-</p>   <p>emailAddress</p> <p>Email address (RSA PKCS#9 extension)</p> <p>string</p> <p>-</p>   <p>gender</p> <p>RFC 3039 Gender</p> <p>string</p> <p>\"M\", \"F\", \"m\" or \"f\"</p>   <p>generation</p> <p>Naming attributes of type X520name</p> <p>string</p> <p>-</p>   <p>givenname</p> <p>Naming attributes of type X520name</p> <p>string</p> <p>-</p>   <p>initials</p> <p>Naming attributes of type X520name</p> <p>string</p> <p>-</p>   <p>l</p> <p>Locality name</p> <p>string</p> <p>-</p>   <p>name</p> <p>Name</p> <p>string</p> <p>-</p>   <p>nameAtBirth</p> <p>ISIS-MTT NameAtBirth</p> <p>string</p> <p>-</p>   <p>o</p> <p>Organization</p> <p>string</p> <p>-</p>   <p>organizationIdentifier</p> <p>Organization identifier</p> <p>string</p> <p>-</p>   <p>ou</p> <p>Organization unit name</p> <p>string</p> <p>-</p>   <p>placeOfBirth</p> <p>RFC 3039 PlaceOfBirth</p> <p>string</p> <p>-</p>   <p>postalAddress</p> <p>RFC 3039 PostalAddress</p> <p>string</p> <p>-</p>   <p>postalCode</p> <p>Postal code</p> <p>string</p> <p>-</p>   <p>pseudonym</p> <p>RFC 3039 Pseudonym</p> <p>string</p> <p>-</p>   <p>role</p> <p>Role</p> <p>string</p> <p>-</p>   <p>serialnumber</p> <p>Device serial number name</p> <p>string</p> <p>-</p>   <p>st</p> <p>State or province name</p> <p>string</p> <p>-</p>   <p>street</p> <p>Street</p> <p>string</p> <p>-</p>   <p>surname</p> <p>Naming attributes of type X520name</p> <p>string</p> <p>-</p>   <p>t</p> <p>Title</p> <p>string</p> <p>-</p>   <p>telephoneNumber</p> <p>Telephone number</p> <p>string</p> <p>-</p>   <p>uid</p> <p>LDAP User id</p> <p>string</p> <p>-</p>   <p>uniqueIdentifier</p> <p>Naming attributes of type X520name</p> <p>string</p> <p>-</p>   <p>unstructuredAddress</p> <p>Unstructured address (from PKCS#9)</p> <p>string</p> <p>-</p>   <p>Other attributes</p>   <p>attributes</p> <p>Retrieves all attribute values</p> <p>key / value</p> <p>\"ou\" \u2192 [\"Test team\", \"Dev team\"]</p>   <p>defined</p> <p>Returns true if the principal object is defined and contains values. False otherwise.</p> <p>boolean</p> <p>-</p>   <p>dn</p> <p>Full domain name</p> <p>string</p> <p>-</p>    <p>Even if some of these attributes can be arrays, EL will return the first item in the array. If you want to retrieve all values of an attribute, you can use the <code>attributes</code> field</p> <p>If the principal is not defined, all values are empty.</p>","location":"apim/user-guide/publisher/expression-language/#principal-object"},{"title":"Examples","text":"<ul> <li> <p>Get the value of the <code>Content-Type</code> header for an incoming HTTP     request: <code>{#request.headers['content-type'][0]}</code></p> </li> <li> <p>Get the second part of the request path: <code>{#request.paths[1]}</code></p> </li> <li> <p>Get the client HOST from the SSL session:     <code>{#request.ssl.clientHost}</code></p> </li> <li> <p>Get the client DN from the SSL session: <code>{#request.ssl.client.dn}</code></p> </li> <li> <p>Get the server organization from the SSL session:     <code>{#request.ssl.server.o}</code></p> </li> <li> <p>Get all the organization units of the server from the SSL session:</p> <ul> <li> <p><code>{#request.ssl.server.attributes['ou'][0]}</code></p> </li> <li> <p><code>{#request.ssl.server.attributes['OU'][1]}</code></p> </li> <li> <p><code>{#request.ssl.server.attributes['Ou'][2]}</code></p> </li> </ul> </li> <li> <p>Get a custom attribute of the client from the SSL session:     <code>{#request.ssl.client.attributes['1.2.3.4'][0]}</code></p> </li> <li> <p>Determine if the SSL attributes of the client are set:     <code>{#request.ssl.client.defined}</code></p> </li> </ul>","location":"apim/user-guide/publisher/expression-language/#examples"},{"title":"Request context","text":"","location":"apim/user-guide/publisher/expression-language/#request-context"},{"title":"Properties","text":"<p>Property</p> <p>Description</p> <p>Type</p> <p>Always present</p>   <p>attributes</p> <p>Request context attributes</p> <p>key-value</p> <p>X</p>","location":"apim/user-guide/publisher/expression-language/#properties_1"},{"title":"Attributes","text":"<p>When APIM Gateway handles an incoming HTTP request, some attributes are automatically created. These attributes are:</p>          <p>Property</p> <p>Description</p> <p>Type</p> <p>Nullable</p>   <p>context-path</p> <p>Context-path</p> <p>string</p> <p>-</p>   <p>resolved-path</p> <p>Resolved-path is the path defined in policies</p> <p>string</p> <p>-</p>   <p>application</p> <p>The authenticated application doing incoming HTTP request</p> <p>string</p> <p>X (for keyless plan)</p>   <p>api</p> <p>Called API</p> <p>string</p> <p>-</p>   <p>user-id</p> <p>The user identifier of incoming HTTP request:</p> <p>* The subscription id for api-key based plan</p> <p>* Remote IP for keyless based plan</p> <p>string</p> <p>-</p>   <p>plan</p> <p>Plan used to manage incoming HTTP request</p> <p>string</p> <p>-</p>   <p>api-key</p> <p>the api-key used (in case of an api-key based plan)</p> <p>string</p> <p>X (for no api-key plan)</p>    <p>Additionally, some policies (like the link:{{ /apim/3.x/apim_policies_oauth2.html#attributes | relative_url }}[OAuth2 policy]) register other attributes in the context. See the documentation for the policies you are using for more information.</p>","location":"apim/user-guide/publisher/expression-language/#attributes"},{"title":"Example","text":"<ul> <li>Get the value of the <code>user-id</code> attribute for an incoming HTTP     request:</li> </ul> <p><code>{#context.attributes['user-id']}</code></p> <ul> <li>Get the value of the <code>plan</code> attribute for an incoming HTTP request:</li> </ul> <p><code>{#context.attributes['plan']}</code></p> <ul> <li>Check that the path starts with a given value:</li> </ul> <p><code>{#request.path.startsWith('/my/api')}</code></p>","location":"apim/user-guide/publisher/expression-language/#example_2"},{"title":"Response","text":"","location":"apim/user-guide/publisher/expression-language/#response"},{"title":"Properties","text":"<p>Property</p> <p>Description</p> <p>Type</p> <p>Example</p>   <p>content</p> <p>Body content</p> <p>string</p> <p>-</p>   <p>headers</p> <p>Headers</p> <p>key / value</p> <p>X-Custom \u2192 myvalue</p>   <p>status</p> <p>Status of the HTTP response</p> <p>int</p> <p>200</p>","location":"apim/user-guide/publisher/expression-language/#properties_2"},{"title":"Example","text":"<ul> <li>Get the status of an HTTP response: <code>{#response.status}</code></li> </ul>","location":"apim/user-guide/publisher/expression-language/#example_3"},{"title":"Node","text":"<p>The properties you can access for node are listed below.</p>","location":"apim/user-guide/publisher/expression-language/#node"},{"title":"Properties","text":"<p>Property</p> <p>Description</p> <p>Type</p> <p>Example</p>   <p>id</p> <p>Node id</p> <p>string</p> <p>975de338-90ff-41ab-9de3-3890ff41ab62</p>   <p>version</p> <p>Node version</p> <p>string</p> <p>3.14.0</p>   <p>tenant</p> <p>Node tenant</p> <p>string</p> <p>Europe</p>","location":"apim/user-guide/publisher/expression-language/#properties_3"},{"title":"Example","text":"<ul> <li>Get the version of a node : <code>{#node.version}</code></li> </ul>","location":"apim/user-guide/publisher/expression-language/#example_4"},{"title":"Policies","text":"<p>You can use the EL to update some aspects of policy configuration. The policy specifies if it supports EL or not.</p>","location":"apim/user-guide/publisher/expression-language/#policies"},{"title":"Mixin","text":"<p>In previous examples, we showed various ways to manipulate objects available in the EL context. You can also mix property usage to provide an increasingly dynamic configuration.</p> <p>For example, we can retrieve the value of an HTTP header where the name is based on an API property named <code>my-property</code>:</p> <p><code>{#request.headers[#properties['my-property']]}</code></p>","location":"apim/user-guide/publisher/expression-language/#mixin"},{"title":"Import apis","text":"<p>{% assign version = site.products.apim._3x.version | split: \".\" %} {% capture current_version %}{{ version[0] }}.{{ version[1] }}{% endcapture %}</p>","location":"apim/user-guide/publisher/import-apis/"},{"title":"Overview","text":"<p>The following sections describe the process of importing an API from its JSON definition.</p>","location":"apim/user-guide/publisher/import-apis/#overview"},{"title":"API definition","text":"","location":"apim/user-guide/publisher/import-apis/#api-definition"},{"title":"What is an API definition ?","text":"<p>An API definition is a JSON representation of your API and its content, eg. plans, pages, metadata, etc.</p>","location":"apim/user-guide/publisher/import-apis/#what-is-an-api-definition"},{"title":"How to get an API definition ?","text":"<p>You can get the API definition by exporting it from the APIM console. Or, by using the export endpoint <code>**GET /apis/{api.id}/export**</code> (link:{{ /apim/3.x/management-api/ | relative_url | append: current_version | append: /index.html#operation/exportApiDefinition }}[API reference^]).</p>","location":"apim/user-guide/publisher/import-apis/#how-to-get-an-api-definition"},{"title":"What does it contain ?","text":"<p>In this definition each entity (API, plan or page) has :</p> <ul> <li>A crossId : Uniquely identifies an entity (an API, a plan or a     page) across environments : The same entity will keep the same     crossId from one environment to another</li> </ul> <p>You can find an API by its crossId, using the <code>getApis</code> endpoint with the <code>crossId</code> query param <code>**GET /apis?crossId=my-cross-id**</code> (link:{{ /apim/3.x/management-api/ | relative_url | append: current_version | append: /index.html#operation/getApis }}[API reference^]).</p> <ul> <li>A technical id : Uniquely identifies an entity in one     environment only: The same entity will have a different technical id     from one environment to another</li> </ul> <p>The API import process uses the crossId to match entities in the API defintion with existing ones. The technical id is not used during the import process unless the crossId isn\u2019t defined. For example in case of an old exported API definition.</p>","location":"apim/user-guide/publisher/import-apis/#what-does-it-contain"},{"title":"Import endpoints","text":"<p>Import endpoints allow you to import an API from a definition. The HTTP request body can contain :</p> <ul> <li> <p>the JSON API definition</p> </li> <li> <p>OR an HTTP link to the JSON API definition</p> </li> </ul> <p>They require the target organization and environment in the prefix : /organizations/{organization.id}/environments/{environment.id}/</p>","location":"apim/user-guide/publisher/import-apis/#import-endpoints"},{"title":"Creating a new API from an API definition","text":"<p><code>**POST /api/import**</code> (link:{{ /apim/3.x/management-api/ | relative_url | append: current_version | append: /index.html#operation/importApiDefinition }}[API reference^]).</p> <p>In the API definition, set the crossId that will identify your API (and related entities) across environments. You can assign any string to this crossId.</p> <p>Don\u2019t put any technical id in your API definition : the server will automatically generate a new id for the created API. Even if you provide one, it won\u2019t be used.</p> <p>Will raise an error if there is already an existing API on the target environment with the same crossId.</p>","location":"apim/user-guide/publisher/import-apis/#creating-a-new-api-from-an-api-definition"},{"title":"Updating an existing API from an API definition","text":"<p><code>**PUT /api/import**</code> (link:{{ /apim/3.x/management-api/ | relative_url | append: current_version | append: /index.html#operation/updateWithDefinition }}[API reference^])</p> <p>Using the technical id in the URL is not mandatory as it will use the crossId in your API definition to find the target API.</p> <p>This allows you to use the same URL to update your API across all environments.</p> <p>You can also use the URL containing API technical id if you want : <code>**PUT /api/{api.id}/import**</code> (link:{{ /apim/3.x/management-api/ | relative_url | append: current_version | append: /index.html#operation/updateWithDefinitionPUT }}[API reference^]) Raise an error if the crossId of your definition matches another API on target environment.</p>","location":"apim/user-guide/publisher/import-apis/#updating-an-existing-api-from-an-api-definition"},{"title":"API content behavior","text":"<p>This sections describes how API contents behave during import.</p>","location":"apim/user-guide/publisher/import-apis/#api-content-behavior"},{"title":"Plans","text":"<ul> <li> <p>Plans in API definition that already exist in the target API will be     updated (will not change the existing plan\u2019s status)</p> </li> <li> <p>Plans in API definition that do not exist in the target API will be     created</p> </li> <li> <p>Plans in target API without subscriptions that are not present in     the API definition will be deleted (an error would be raised if     plan got subscriptions)</p> </li> </ul>","location":"apim/user-guide/publisher/import-apis/#plans"},{"title":"Pages","text":"<ul> <li> <p>Pages in API definition that already exist in the target API will be     updated</p> </li> <li> <p>Pages in API definition that do not exist in the target API will be     created</p> </li> <li> <p>Pages in target API that are not present in the API definition     won\u2019t change</p> </li> </ul>","location":"apim/user-guide/publisher/import-apis/#pages"},{"title":"Groups, Members and roles","text":"<p>Depending on your installation setup, group, members and roles will not be imported the same way.</p> <ul> <li> <p>When using the import feature to update or create an API on the same     environment members, groups and roles can be edited, and group     memberships are preserved.</p> </li> <li> <p>When importing on another environment groups that are unknown to the     target environment will be created, but their memberships will not     be preserved.</p> </li> <li> <p>When importing on another environment that runs on the same APIM     instance (same database), direct members will be preserved on the     target environment.</p> </li> <li> <p>When importing on another environment that runs on a separate APIM     instance, direct members will not be preserved and group that are     unknown to the target environment will be created without preserving     their memberships.</p> </li> </ul>","location":"apim/user-guide/publisher/import-apis/#groups-members-and-roles"},{"title":"CI/CD use cases examples","text":"","location":"apim/user-guide/publisher/import-apis/#cicd-use-cases-examples"},{"title":"Create your API on development environment","text":"<p>Create your API in development environment, using the APIM console.</p>","location":"apim/user-guide/publisher/import-apis/#create-your-api-on-development-environment"},{"title":"Push your API to the production environment","text":"<ul> <li> <p>Get your API definition by exporting it from APIM console, or using     the export endpoint. For example :</p> <pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X GET \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/35a1b7d4-b644-43d1-a1b7-d4b64493d134/export\n</code></pre> </li> <li> <p>On each environment you want to create your API, call the POST     endpoint. For example</p> <pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X POST \\\n     -d '{\n            \"name\": \"my-api\",\n            \"crossId\": \"3e645da6-039c-4cc0-a45d-a6039c1cc0d3\",\n            \"version\": \"1\",\n            [....]\n        }' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/import\n</code></pre> </li> </ul>","location":"apim/user-guide/publisher/import-apis/#push-your-api-to-the-production-environment"},{"title":"Update your API on production environment","text":"<ul> <li> <p>Update your API definition. Manually, or by re-exporting the source     API from development environment.</p> </li> <li> <p>On each environment you want to update your API, call the PUT     endpoint. For example :</p> <pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PUT \\\n     -d '{\n            \"name\": \"my-updated-api\",\n            \"crossId\": \"3e645da6-039c-4cc0-a45d-a6039c1cc0d3\",\n            \"version\": \"1\",\n            [....]\n        }' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]//management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/import\n</code></pre> </li> </ul>","location":"apim/user-guide/publisher/import-apis/#update-your-api-on-production-environment"},{"title":"Logging and analytics","text":"<p>= Logging and analytics :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_publisherguide_logging_analytics.html :page-folder: apim/user-guide/publisher :page-layout: apim3x</p> <p>== Overview</p> <p>You can view metrics and logs for applications and APIs using the Analytics menu options in APIM Console.</p> <p>TIP: From APIM version 3.6.x, you can mask secure data in your logs by adding the Data logging masking policy to your API. For more details, see link:{{ '/apim/3.x/apim_policies_data_logging_masking.html' | relative_url }}[Data logging masking^].</p> <p>=== Metrics</p> <p>Metrics are presented in one or more dashboards. You can select the dashboard with the metrics you want to see from the Select a dashboard drop-down menu. You can then select a time period and view several different types of analytics -- such as requests received and responses sent, the most frequently called applications and response times, presented in different views and formats -- such as bar charts and maps.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/analytics/dashboards.png %}[]</p> <p>For more details on creating and configuring dashboards, see link:{{ '/apim/3.x/apim_installguide_dashboard_configuration.html' | relative_url }}[Configure dashboards^].</p> <p>=== Logs</p> <p>You can list the API requests for a single API or for an application by viewing the logs, as follows:</p> <ul> <li>Select the API and click Analytics &gt; Logs.</li> <li>Select the application and click Logs.</li> </ul> <p>This lists all the API requests in date and time order. You can filter by date or search term and click on an individual entry to view more details.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/analytics/logs.png %}[]</p> <p>Log entries include details such as:</p> <ul> <li>the API endpoint for the request</li> <li>the URL of the gateway through which the request was sent</li> </ul> <p>By default, the request header and payload are not logged in APIM, to save space, as shown in the basic logging detail page below. You specify how much detail to log in the logging configuration.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/analytics/logs-simple-view.png %}[Basic logging detail]</p> <p>== Configure API logging</p> <p>NOTE: If you configured a maximum logging duration in the global settings, the maximum duration will be applied to the API logging configuration specified here. For more details, see link:{{ '/apim/3.x/apim_how_to_configuration.html#update-the-default-apim-settings' | relative_url }}[Update the default APIM settings^].</p> <p>WARNING: Logging configuration changes can have a significant impact on performance. Proceed with caution.</p> <p>. link:{{ '/apim/3.x/apim_quickstart_console_login.html' | relative_url }}[Log in to APIM Console^]. . Click APIs and select the API from the list. . Click Analytics &gt; Logs. . Click the Configure the logging link at the top. + image:{% link images/apim/3.x/api-publisher-guide/analytics/logs-configure.png %}[]</p> <p>+ If you configured a maximum logging duration in the global settings, APIM displays a message to remind you: image:{% link images/apim/3.x/api-publisher-guide/analytics/logs-configure-max-duration.png %}[]</p> <p>ifeval::[{{ site.products.apim._3x.version }} &lt; 3.6.0]</p> <p>. In the Mode drop-down, select the type of logging required: * Client only -- to log HTTP request header and payload details between the client and the gateway * Proxy only -- to log HTTP request header and payload details between the gateway and the backend * Client and proxy -- to log HTTP request header and payload details for both . Select Logging enabled to go ahead and enable logging, or Conditional logging to specify conditions for logging. . To specify logging conditions, click SHOW EDITOR and select all the conditions which apply. You can restrict logging by: * application or plan * request header or query parameter * HTTP method * request IP address * duration * end date + You can create rules by combining conditions. Each new condition is added to the Condition field. See the example below for more details.</p> <p>== Example</p> <p>The following example shows how to configure logging to only log <code>GET</code> HTTP methods which include an <code>X-debug</code> request header with a value of <code>true</code>. We need to specify it as a combined condition in two parts.</p> <p>. Click SHOW EDITOR and in the condition editor, select Condition type as HTTP Method. Click ADD. + image:{% link images/apim/3.x/api-publisher-guide/analytics/logs-configure-example-step1.png %}[]</p> <p>. Select GET as the HTTP method. + image:{% link images/apim/3.x/api-publisher-guide/analytics/logs-configure-example-step2.png %}[]</p> <p>. Click SAVE. The new condition is added. Note that you need to take a copy the syntax of the condition, as it will be overwritten when you specify the next one. + image:{% link images/apim/3.x/api-publisher-guide/analytics/logs-configure-example-step3.png %}[]</p> <p>. Now click SHOW EDITOR again to specify the second part of the condition. . Select Request query-parameter as the Condition type. Click ADD. + image:{% link images/apim/3.x/api-publisher-guide/analytics/logs-configure-example-step4.png %}[]</p> <p>. Enter X-debug as the Query parameter name and true as the value. + image:{% link images/apim/3.x/api-publisher-guide/analytics/logs-configure-example-step5.png %}[]</p> <p>. Click SAVE. We can see that the second condition has been added. To add back in the first condition, go to the end of the condition line and type &amp;&amp;, then paste it at the end. + image:{% link images/apim/3.x/api-publisher-guide/analytics/logs-configure-example-step6.png %}[] endif::[] ifeval::[{{ site.products.apim._3x.version }} &gt;= 3.6.0] . Toggle on the Enabled option. . Select the level of logging required for the mode, content and scope. + image:{% link images/apim/3.x/api-publisher-guide/analytics/logs-configure-3-6.png %}[]</p> <p>. Specify all logging conditions which apply in link:{{ '/apim/3.x/apim_publisherguide_expression_language.html' | relative_url }}[Gravitee Expression Language^]. You can restrict logging by: * application or plan * request header or query parameter * HTTP method * request IP address * duration * end date + You can combine conditions, as in the example below: + image:{% link images/apim/3.x/api-publisher-guide/analytics/logs-configure-example-step6.png %}[] endif::[]</p> <p>. Click SAVE to save the new logging configuration. Don't forget to redeploy your API. + We can now return to the logging screen and see the logging detail when we click on a log entry, as in the image below: + image:{% link images/apim/3.x/api-publisher-guide/analytics/logs-detailed-view2.png %}[]</p>","location":"apim/user-guide/publisher/logging-analytics/"},{"title":"Overview","text":"<p>This section describes how to manage and configure your APIs, including:</p> <ul> <li> <p>Creating an API</p> </li> <li> <p>Creating and configuring a plan so users can subscribe to your API</p> </li> <li> <p>Adding members and transferring ownership</p> </li> <li> <p>Configuring logging and analytics</p> </li> <li> <p>Configuring CORS</p> </li> <li> <p>Specifying your top APIs and enabling API rating</p> </li> <li> <p>Designing your API flows and policies with Design Studio</p> </li> <li> <p>Providing APIM Portal documentation</p> </li> <li> <p>Using Resources and Service Discoveries</p> </li> <li> <p>Using Gravitee Expression Language with your APIs</p> </li> </ul>","location":"apim/user-guide/publisher/manage-api/"},{"title":"Overview","text":"<p>When you first create your API, by default it is defined as a private API and cannot be accessed through APIM Portal or subscribed to.</p> <p>If you want to grant specific users or groups access to a private API, the way to do this is by managing its members.</p> <p>Only users with the required permissions can manage an application\u2019s members. For more details, see link:{{ /apim/3.x/apim_adminguide_roles_and_permissions.html | relative_url }}[Roles and permissions].</p>","location":"apim/user-guide/publisher/manage-members/"},{"title":"Roles","text":"<p>By default, APIM includes three membership roles:</p>        Role Description     <p>Primary Owner</p> <p>When an API is created, the Primary Owner is the creator of the API. A Primary Owner can perform all possible actions on an API.</p>   <p>Owner</p> <p>Owner is similar to the Primary Owner role. An Owner can perform all the same actions on an API apart from change the context-path of the API or delete it.</p>   <p>User</p> <p>A User is a person who can access the API and subscribe to it through a plan.</p>","location":"apim/user-guide/publisher/manage-members/#roles"},{"title":"Primary Owner groups","text":"<p>New in version 3.7</p> <p>From APIM 3.7, APIM Console provides a configurable mode to define how you manage the primary owners of your API. For more details, see link:{{ /apim/3.x/apim_adminguide_users_and_groups.html#primary_owner_mode | relative_url }}[Configure primary owners as groups^].</p>","location":"apim/user-guide/publisher/manage-members/#primary-owner-groups"},{"title":"Add and remove users","text":"<p>You can manage users for APIs and applications.</p> <ol> <li> <p>link:{{ /apim/3.x/apim_quickstart_portal_login.html |     relative_url }}[Log in to APIM Console^].</p> </li> <li> <p>If you want to manage users for an:</p> <ul> <li> <p>application, click Applications in the menu, then select     your application and click Members.</p> </li> <li> <p>API, click APIs in the menu, then select your API and click     Portal &gt; Members.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/members/manage-members.png %}[Gravitee.io - manage members]</p> </li> </ul> </li> </ol> <p>To add new users:</p> <ol> <li> <p>Click the plus icon image:{% link images/icons/plus-icon.png     %}[role=\"icon\"] at the bottom right of the page.</p> </li> <li> <p>Search for the user with the form, then select the user.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/members/manage-members-add.png %}[Gravitee.io - add member,300]</p> </li> </ol> <p>To remove users:</p> <p>Navigate to the Members page for the API or application as described above, then click the delete icon next to the user.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/members/manage-members-remove.png %}[Gravitee.io - remove member]</p>","location":"apim/user-guide/publisher/manage-members/#add-and-remove-users"},{"title":"Transfer ownership","text":"<p>You can transfer ownership of an API or application from one user to another. You do this when the current Primary Owner leaves a project, for example.</p> <p>From APIM 3.7, you can also transfer ownership to a group, depending on your configuration. For more details, see link:{{ /apim/3.x/apim_adminguide_users_and_groups.html#primary_owner_mode | relative_url }}[Configure primary owners as groups^].</p> <ol> <li> <p>In APIM Console, click APIs or Applications in the left     menu.</p> </li> <li> <p>If you want to transfer ownership for an:</p> <ul> <li> <p>application, click Applications in the menu, then select     your application and click Members.</p> </li> <li> <p>API, click APIs in the menu, then select your API and click     Portal &gt; Transfer ownership.</p> </li> </ul> </li> <li> <p>Choose the new Primary Owner or Primary Owner Group.</p> <p>You can only select a Primary Owner Group which you belong to. If your Primary owner mode is configured as GROUP, you can only select a Primary Owner Group and not a user.</p> </li> <li> <p>Choose the new role of the current Primary Owner, if the current     Primary Owner is a user.</p> </li> <li> <p>Click TRANSFER.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/members/manage-members-transfer-ownership.png %}[Gravitee.io - transfer ownership]</p> </li> </ol>","location":"apim/user-guide/publisher/manage-members/#transfer-ownership"},{"title":"Overview","text":"<p>You can use the APIM Console messaging feature to communicate with your users. You can send notifications at the level of the entire APIM platform or a specific API.</p> <p>There are three types of platform-wide and API notifications:</p> <ul> <li> <p>Portal notifications</p> </li> <li> <p>Email notifications</p> </li> <li> <p>POST HTTP message notifications</p> </li> </ul> <p>You define the audience for your notifications in terms of roles, as described in the section below. For a detailed explanation of roles in APIM, see link:{{ /apim/3.x/apim_adminguide_roles_and_permissions.html | relative_url }}[Roles and permissions^].</p>","location":"apim/user-guide/publisher/messaging/"},{"title":"Platform-wide notifications","text":"<p>You send APIM platform-wide notifications with the Messages menu option:</p> <p>image:{% link images/apim/3.x/api-publisher-guide/messaging/message-platform-level.png %}[]</p> <p>You can send platform-wide notifications to users defined with the following link:{{ /apim/3.x/apim_adminguide_roles_and_permissions.html#scope | relative_url }}[environment scope^] roles:</p> <ul> <li> <p>ADMIN</p> </li> <li> <p>API_PUBLISHER</p> </li> <li> <p>USER</p> </li> </ul>","location":"apim/user-guide/publisher/messaging/#platform-wide-notifications"},{"title":"API notifications","text":"<p>You can only send API notifications to consumers with a valid subscription to your API applications.</p> <p>You send API notifications with the API Messages menu option:</p> <p>image:{% link images/apim/3.x/api-publisher-guide/messaging/message-api-level.png %}[]</p> <p>You can send API notifications to users defined with the following link:{{ /apim/3.x/apim_adminguide_roles_and_permissions.html#scope | relative_url }}[application scope^] roles:</p> <ul> <li> <p>OWNER</p> </li> <li> <p>PRIMARY_OWNER</p> </li> <li> <p>USER</p> </li> </ul>","location":"apim/user-guide/publisher/messaging/#api-notifications"},{"title":"Send a notification","text":"","location":"apim/user-guide/publisher/messaging/#send-a-notification"},{"title":"Portal notification","text":"<p>When sending Portal notifications, you need to specify:</p> <ul> <li> <p>the user role to notify</p> </li> <li> <p>the title of the notification</p> </li> <li> <p>the text of the notification</p> </li> </ul> <p>When you click SEND, APIM sends the notification to all users belonging to the specified role (as long as they have a valid application subscription, in the case of API level subscriptions). They can access the notification in APIM Console, by clicking the bell in the top bar.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/messaging/message-notifications.png %}[]</p> <p>The notification is also visible in the notifications area of the system, if enabled for the browser:</p> <p>image:{% link images/apim/3.x/api-publisher-guide/messaging/message-notifications-system.png %}[]</p>","location":"apim/user-guide/publisher/messaging/#portal-notification"},{"title":"Email notification","text":"<p>When sending Email notifications, you specify the same information as for portal notifications.</p> <p>When you click SEND, APIM sends an email to all the users with the specified role who have an email address configured for their profile (as long as they have a valid application subscription, in the case of API level subscriptions).</p> <p>For more details on configuring user profiles, see link:{{ /apim/3.x/apim_adminguide_users_and_groups.html | relative_url }}[Users and groups^].</p>","location":"apim/user-guide/publisher/messaging/#email-notification"},{"title":"HTTP POST notification","text":"<p>When sending POST HTTP message notifications, you need to specify:</p> <ul> <li> <p>HTTP headers</p> </li> <li> <p>whether a system proxy is to be used</p> </li> <li> <p>the URL to use for the HTTP message</p> </li> <li> <p>the text of the message</p> </li> </ul> <p>image:{% link images/apim/3.x/api-publisher-guide/messaging/message-post-http.png %}[]</p> <p>When you click SEND, APIM sends the message to the URL, including any HTTP headers specified.</p>","location":"apim/user-guide/publisher/messaging/#http-post-notification"},{"title":"Example","text":"<p>In this example we will see how to send a notification to all platform administrators.</p> <ol> <li> <p>link:{{ /apim/3.x/apim_quickstart_console_login.html |     relative_url }}[Log in to APIM Console^].</p> </li> <li> <p>Click Messages.</p> </li> <li> <p>Select Portal Notifications.</p> </li> <li> <p>Choose the ENVIRONMENT role to notify as ADMIN.</p> </li> <li> <p>Give the message a Title and enter the detail of the message in     Text.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/messaging/message-portal-example.png %}[]</p> </li> <li> <p>Click SEND.</p> <p>All users with the ADMIN role are notified of new messages by a number on the bell in the top bar:</p> <p>image:{% link images/apim/3.x/api-publisher-guide/messaging/message-notifications.png %}[]</p> <p>Clicking on the bell shows the content of the message:</p> <p>image:{% link images/apim/3.x/api-publisher-guide/messaging/message-portal-example-notification.png %}[]</p> </li> </ol>","location":"apim/user-guide/publisher/messaging/#example"},{"title":"Partial update apis","text":"<p>{% assign version = site.products.apim._3x.version | split: \".\" %} {% capture current_version %}{{ version[0] }}.{{ version[1] }}{% endcapture %}</p>","location":"apim/user-guide/publisher/partial-update-apis/"},{"title":"Overview","text":"<p>This method lets you update only a part of an existing API definition and/or its sub-resources (e.g., plans, pages, metadata), either by adding updating or removing attributes. It provides more flexbility in case of small updates as you are not required to provide the full API definition like when using the <code>**PUT /api/import**</code> endpoint.</p> <p>The business rules that apply during a partial update are identical to those used for the <code>**PUT /api/import**</code> endpoint.</p>","location":"apim/user-guide/publisher/partial-update-apis/#overview"},{"title":"HTTP PATCH and format","text":"<p>To partially update your API use the HTTP <code>PATCH</code> verb on the <code>**/api/import**</code> enpdoint.</p> <p>The expected format of the request body is a JSON document containing the list of operations describing the changes you want to apply to the API definition.</p> <p>The format used to describe these changes is based on JSON Patch but uses JSON Path instead of JSON Pointer.</p>","location":"apim/user-guide/publisher/partial-update-apis/#http-patch-and-format"},{"title":"JSON Patch format","text":"<p>A JSON Patch document is an array of JSON objects, each object representing exactly one JSON Patch operation.</p> <p>Each patch operation takes the following fields:</p> <ul> <li> <p><code>operation</code>: defines the type of operation (e.g., ADD, REMOVE,     REPLACE, TEST)</p> </li> <li> <p><code>jsonPath</code>: defines where the operation applies in the document     through a JSON Path expression. Check ???     section for more details.</p> </li> <li> <p><code>value</code>: defines the value to apply (e.g., a raw JSON literal,     object, or array), optional for <code>REMOVE</code> operation.</p> </li> </ul>","location":"apim/user-guide/publisher/partial-update-apis/#json-patch-format"},{"title":"Example","text":"<p>The below example would update the API version and remove an API property:</p> <pre><code>[\n  {\n    \"jsonPath\": \"$.version\",\n    \"value\": \"3.2.0\",\n    \"operation\": \"REPLACE\"\n  },\n  {\n    \"jsonPath\": \"$.properties[?(@.key == 'properties_1')]\",\n    \"operation\": \"REMOVE\"\n  }\n]\n</code></pre>","location":"apim/user-guide/publisher/partial-update-apis/#example"},{"title":"JSON Patch operations","text":"<p>Operation</p> <p>Description</p>   <p>REPLACE (default)</p> <p>Updates the value at the targeted location with a new value.</p>   <p>ADD</p> <p>Adds a new property to an object or inserts a new item into an array.</p>   <p>REMOVE</p> <p>Removes a value at the defined location</p>   <p>TEST</p> <p>Tests that the value at the defined \"path\" is equal to the <code>value</code>. Because the PATCH operation is atomic, the PATCH should be discarded if any of its operations fail. The test operation can be used to validate that the preconditions and post-conditions have been met. In case the condition fails the API will return an <code>HTTP 204 No Content</code>.</p>","location":"apim/user-guide/publisher/partial-update-apis/#json-patch-operations"},{"title":"JSONPath syntax","text":"<p>A JSONPath expression must be provided in the <code>jsonPath</code> attribute of each JSON Patch operation.</p> <p>Note that:</p> <ul> <li> <p>JSONPath is a query language for JSON, similar to XPath for XML.</p> </li> <li> <p>JSONPath expressions always refer to a JSON structure.</p> </li> <li> <p>The root member object in JSONPath is always referred to as <code>$</code>     regardless if it is an object or array.</p> </li> <li> <p>JSONPath expressions, including property names and values, are     case-sensitive.</p> </li> </ul>","location":"apim/user-guide/publisher/partial-update-apis/#jsonpath-syntax"},{"title":"Operators","text":"<p>Operator</p> <p>Description</p>   <p><code>$</code></p> <p>The root element to query. This starts all path expressions.</p>   <p><code>@</code></p> <p>The current node being processed by a filter predicate.</p>   <p><code>*</code></p> <p>Wildcard. Available anywhere a name or numeric are required.</p>   <p><code>..</code></p> <p>Deep scan. Available anywhere a name is required.</p>   <p><code>.&lt;name&gt;</code></p> <p>Dot-notated child</p>   <p><code>['&lt;name&gt;' (, '&lt;name&gt;')]</code></p> <p>Bracket-notated child or children</p>   <p><code>[&lt;number&gt; (, &lt;number&gt;)]</code></p> <p>Array index or indexes</p>   <p><code>[start:end]</code></p> <p>Array slice operator</p>   <p><code>[?(&lt;expression&gt;)]</code></p> <p>Filter expression. Expression must evaluate to a boolean value.</p>","location":"apim/user-guide/publisher/partial-update-apis/#operators"},{"title":"Filters","text":"<p>Filters are logical expressions used to filter arrays:</p> <ul> <li> <p>A typical filter would be <code>[?(@.age &gt; 18)]</code> where <code>@</code> represents the     current item being processed.</p> </li> <li> <p>More complex filters can be created with logical operators <code>&amp;&amp;</code> and     <code>||</code>.</p> </li> <li> <p>String literals must be enclosed by single or double quotes     (<code>[?(@.color == 'blue')]</code> or <code>[?(@.color == \"blue\")]</code>).</p> </li> </ul>         <p>Operator</p> <p>Description</p>    <p>==</p> <p>left is equal to right (note that 1 is not equal to 1)</p>    <p>!=</p> <p>left is not equal to right</p>    <p>&lt;</p> <p>left is less than right</p>    <p>\u21d0</p> <p>left is less or equal to right</p>    <p>&gt;</p> <p>left is greater than right</p>    <p>&gt;=</p> <p>left is greater than or equal to right</p>    <p>=~</p> <p>left matches regular expression [?(@.name =~ /foo.*?/i)]</p>    <p>in</p> <p>left exists in right [?(@.size in [S, M])]</p>    <p>nin</p> <p>left does not exists in right</p>    <p>subsetof</p> <p>left is a subset of right [?(@.sizes subsetof [S, M, L])]</p>    <p>anyof</p> <p>left has an intersection with right [?(@.sizes anyof [M, L])]</p>    <p>noneof</p> <p>left has no intersection with right [?(@.sizes noneof [M, L])]</p>    <p>size</p> <p>size of left (array or string) should match right</p>    <p>empty</p> <p>left (array or string) should be empty</p>","location":"apim/user-guide/publisher/partial-update-apis/#filters"},{"title":"Dry run mode","text":"<p>A good way to test your request before actually applying the changes on your API definition is to execute a dry run of your request.</p> <p>When executing a dry run, no changes will be commited to database and the targeted API definition will not be affacted.</p> <p>Instead, a simulation of your changes will be executed and the resulting API definition will be provided in response.</p> <p>Set <code>dryRun</code> query parameter to <code>true</code> to enable dry run mode:</p> <p><code>PATCH /apis/{api.id}/definition?dryRun=true</code></p>","location":"apim/user-guide/publisher/partial-update-apis/#dry-run-mode"},{"title":"Partial update examples","text":"<p>Below a list of examples that you might find useful when managing your APIs through an automated CI/CD process:</p>","location":"apim/user-guide/publisher/partial-update-apis/#partial-update-examples"},{"title":"Update an API version","text":"<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n           {\n             \"jsonPath\": \"$.version\",\n             \"value\": \"3.2.0\",\n             \"operation\": \"REPLACE\"\n           }\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition\n</code></pre>","location":"apim/user-guide/publisher/partial-update-apis/#update-an-api-version"},{"title":"Update an API version in dry run mode","text":"<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n           {\n             \"jsonPath\": \"$.version\",\n             \"value\": \"3.2.0\",\n             \"operation\": \"REPLACE\"\n           }\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition?dryRun=true\n</code></pre>","location":"apim/user-guide/publisher/partial-update-apis/#update-an-api-version-in-dry-run-mode"},{"title":"Update the weight of a specific backend","text":"<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n           {\n             \"jsonPath\": \"$.proxy.groups[?(@.name == 'my-group')].endpoints[?(@.name == 'my-endpoint')].weight\",\n             \"value\": \"10\",\n             \"operation\": \"REPLACE\"\n           }\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition\n</code></pre>","location":"apim/user-guide/publisher/partial-update-apis/#update-the-weight-of-a-specific-backend"},{"title":"Switch backup endpoint","text":"<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n           {\n             \"jsonPath\": \"$.proxy.groups[?(@.name == 'my-group')].endpoints[?(@.name == 'my-endpoint')].backup\",\n             \"value\": true,\n             \"operation\": \"REPLACE\"\n           },\n          {\n             \"jsonPath\": \"$.proxy.groups[?(@.name == 'my-group')].endpoints[?(@.name == 'my-endpoint-backup')].backup\",\n             \"value\": false,\n             \"operation\": \"REPLACE\"\n          }\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition\n</code></pre>","location":"apim/user-guide/publisher/partial-update-apis/#switch-backup-endpoint"},{"title":"Update the target of an endpoint","text":"<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n           {\n             \"jsonPath\": \"$.proxy.groups[?(@.name == 'default-group')].endpoints[?(@.name == 'my-endpoint')].target\",\n             \"value\": \"https://api.gravitee.io/echo\",\n             \"operation\": \"REPLACE\"\n           }\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition\n</code></pre>","location":"apim/user-guide/publisher/partial-update-apis/#update-the-target-of-an-endpoint"},{"title":"Create a new policy flow","text":"<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n            {\n              \"jsonPath\": \"$.flows\",\n              \"value\": [\n                 {\n                   \"name\": \"ALL\",\n                   \"methods\": [\"GET\", \"POST\", \"PUT\"],\n                   \"path-operator\": {\n                     \"path\": \"/\"\n                   },\n                  \"pre\": [],\n                  \"post\": []\n                }\n              ],\n              \"operation\": \"REPLACE\"\n            }\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition\n</code></pre>","location":"apim/user-guide/publisher/partial-update-apis/#create-a-new-policy-flow"},{"title":"Add a policy to an existing flow","text":"<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n           {\n             \"jsonPath\": \"$.flows[?(@.path-operator.path == '/')].post\",\n             \"value\": {\n               \"policy\": \"mock\",\n               \"name\": \"A mock\",\n               \"configuration\": {\n                 \"status\": \"200\",\n                 \"content\": \"{ \\\"message\\\": \\\"This is a mock\\\" }\"\n               }\n             },\n             \"operation\": \"ADD\"\n           }\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition\n</code></pre>","location":"apim/user-guide/publisher/partial-update-apis/#add-a-policy-to-an-existing-flow"},{"title":"Update a policy configuration","text":"<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n           {\n             \"jsonPath\": \"$.flows[?(@.path-operator.path == '/')].post[?(@.name == 'A mock')].configuration\",\n             \"value\": {\n               \"status\": \"500\",\n               \"content\": \"{#request.attributes.api}\"\n             },\n             \"operation\": \"REPLACE\"\n           }\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition\n</code></pre>","location":"apim/user-guide/publisher/partial-update-apis/#update-a-policy-configuration"},{"title":"Add a resource","text":"<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n           {\n             \"jsonPath\": \"$.resources\",\n             \"value\": {\n               \"name\": \"cache_name\",\n               \"type\": \"cache\",\n               \"enabled\": false,\n               \"configuration\": {\n                 \"name\": \"my-cache\",\n                 \"timeToIdleSeconds\": 100,\n                 \"timeToLiveSeconds\": 200,\n                 \"maxEntriesLocalHeap\": 1000\n               }\n             },\n             \"operation\": \"ADD\"\n            }\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition\n</code></pre>","location":"apim/user-guide/publisher/partial-update-apis/#add-a-resource"},{"title":"Update a resource configuration","text":"<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n           {\n             \"jsonPath\": \"$.resources[?(@.name == 'cache_name')].enabled\",\n             \"value\": false\n           },\n           {\n             \"jsonPath\": \"$.resources[?(@.name == 'cache_name')].configuration.timeToIdleSeconds\",\n             \"value\": 1000\n           }\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition\n</code></pre>","location":"apim/user-guide/publisher/partial-update-apis/#update-a-resource-configuration"},{"title":"Set properties if don\u2019t already exist","text":"<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n           {\n             \"jsonPath\": \"$.properties\",\n             \"value\": \"null\",\n             \"operation\": \"TEST\"\n           },\n           {\n             \"jsonPath\": \"$.properties\",\n             \"value\": [\n                { key: \"properties_1\", value: \"my_property_value_1\" },\n                { key: \"properties_2\", value: \"my_property_value_2\" }\n             ],\n             \"operation\": \"REPLACE\"\n           }\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition\n</code></pre>","location":"apim/user-guide/publisher/partial-update-apis/#set-properties-if-dont-already-exist"},{"title":"Remove a property by key","text":"<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n           {\n             \"jsonPath\": \"$.properties[?(@.key == 'properties_1')]\",\n             \"operation\": \"REMOVE\"\n           }\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition\n</code></pre>","location":"apim/user-guide/publisher/partial-update-apis/#remove-a-property-by-key"},{"title":"Overview","text":"<p>The following sections describe how you can promote an API from one environment to another.</p> <p>For a quick introduction on how to create an API in APIM, see link:{{ /apim/3.x/apim_publisherguide_create_apis.html | relative_url }}[Create an API^].</p> <p>This feature is available starting in version APIM 3.10.0 and requires that your installation is linked to Cockpit. For more information about Cockpit, see link:{{ /cockpit/3.x/cockpit_overview_introduction.html | relative_url }}[Cockpit].</p> <p>APIs can only be promoted to environments belonging to the same organization.</p>","location":"apim/user-guide/publisher/promote-api/"},{"title":"Context","text":"<ul> <li> <p>Two installations</p> <ul> <li> <p>One linked to Demo and Production environments.</p> </li> <li> <p>Another one linked to Dev and QA environments.</p> </li> <li> <p>An API to promote.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/promote-apis/graviteeio-promote-api-cockpit-graph.png %}[Map of installations in Cockpit]</p> </li> </ul> </li> </ul>","location":"apim/user-guide/publisher/promote-api/#context"},{"title":"Request Promotion For An API","text":"<p>Here, we will see how to promote our API from environment <code>DEV</code> to environment <code>QA</code>.</p> <p>To request a promotion, you only need to have API-DEFINITION link:{{ /apim/3.x/apim_adminguide_roles_and_permissions.html | relative_url }}[permissions^].</p> <p>Promotion requests are logged in link:{{ /apim/3.x/apim_publisherguide_audit.html | relative_url }}[Audits trail^].</p> <p>The following actions must be done with an API Publisher on <code>DEV</code> environment.</p> <ol> <li> <p>Go to the API to promote and click the image:{% link     images/icons/promote-button.png %}[role=\"icon\"] button.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/promote-apis/graviteeio-promote-api-promote-1.png %}[Promote button]</p> </li> <li> <p>A window listing the available environments for the API promotion     will pop up</p> <p>image::{% link images/apim/3.x/api-publisher-guide/promote-apis/graviteeio-promote-api-promote-2.png %}[Target environments list]</p> <p>If a promotion request already exists for your API on an environment, you cannot do another request until the previous one is rejected or accepted.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/promote-apis/graviteeio-promote-api-promote-2-bis.png %}[Target environments list]</p> </li> <li> <p>Choose the environment you want to promote the API on, then click on     PROMOTE button</p> </li> </ol> <p>When promoting an API, members and groups information are lost.</p> <p>If a promotion has already been accepted for an API, you can request a new one on the same target environment. Once this promotion is accepted, the API on the target environment will be updated.</p>","location":"apim/user-guide/publisher/promote-api/#request-promotion-for-an-api"},{"title":"Accepting Or Rejecting A Promotion","text":"<p>To be able to accept or reject a promotion, you need to have ENVIRONMENT-API link:{{ /apim/3.x/apim_adminguide_roles_and_permissions.html | relative_url }}[permissions^].</p> <p>As a user of <code>QA</code> environment, promotion requests are visible in the Tasks section.</p> <ol> <li> <p>Go to the Tasks section.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/promote-apis/graviteeio-promote-api-promote-3.png %}[Promotion tasks]</p> </li> <li> <p>You can choose to accept or reject the promotion.</p> <ul> <li> <p>Rejecting the promotion will Remove the task.</p> </li> <li> <p>Accepting the promotion will:</p> <ul> <li> <p>Create or update the API (depending on if it has already     been promoted or not).</p> </li> <li> <p>Remove the task.</p> </li> </ul> </li> </ul> </li> </ol>","location":"apim/user-guide/publisher/promote-api/#accepting-or-rejecting-a-promotion"},{"title":"Overview","text":"<p>You can use response templates to override the default values sent in response to consumer calls to an API.</p> <p>Response template overrides are triggered by error keys, which are specific to policies. Each response template defines the new values to be returned for one or more status codes when the template is triggered.</p> <p>For the full list of policy error keys for which you can override the values, see the ??? table below.</p>","location":"apim/user-guide/publisher/response-templates/"},{"title":"Global response templates","text":"<p>As well as creating templates associated with a specific error key, you can create two types of global templates for an API:</p> <ul> <li> <p>Templates with a template key of <code>DEFAULT</code>, which are always     triggered, regardless of the error key</p> </li> <li> <p>Templates with one of a set of error keys which are not     policy-specific and are triggered in specific circumstances, such as     an invalid request or response (designated in     ??? as applying to all     policies)</p> </li> </ul>","location":"apim/user-guide/publisher/response-templates/#global-response-templates"},{"title":"Before you begin","text":"<p>Before you can define response templates for your API, you need to know:</p> <ul> <li> <p>which policies are defined in the API plans associated with your API     (see link:{{     /apim/3.x/apim_publisherguide_plans_subscriptions.html |     relative_url }}[Plans and subscriptions^])</p> </li> <li> <p>which error keys you can override for the policies associated with     your API plans (see ???)</p> </li> </ul>","location":"apim/user-guide/publisher/response-templates/#before-you-begin"},{"title":"Configure a response template","text":"<p>You can define:</p> <ul> <li> <p>multiple templates for one API (for multiple policies and/or     multiple error keys sent by the same policy)</p> </li> <li> <p>multiple template definitions for the same error key in a single     template (for different content types or status codes)</p> </li> </ul> <p>To configure a response template:</p> <ol> <li> <p>link:{{ /apim/3.x/apim_quickstart_console_login.html |     relative_url }}[Log in to APIM Console^].</p> </li> <li> <p>Click APIs and select the API.</p> </li> <li> <p>Click Proxy &gt; Response Templates.</p> </li> <li> <p>Click the plus icon image:{% link images/icons/plus-icon.png     %}[role=\"icon\"] to add a new template.</p> </li> <li> <p>Select the Template key. This can be either:</p> <ul> <li> <p>one of the error keys associated with the policy (see the     ??? table below for more     details)</p> </li> <li> <p><code>DEFAULT</code>, applying to all errors returned (as long as they     correspond to the content type specified in the next step)</p> </li> <li> <p>one of the global error keys (keys described as applying to all     policies in the ???     table)</p> <p>image:{% link images/apim/3.x/api-publisher-guide/response-templates/template-key.png %}[]</p> </li> </ul> </li> <li> <p>To send the template override values only for JSON or XML requests,     specify <code>JSON</code> or <code>XML</code> as the Content type. The default value     <code>\\*/*</code> applies to all content types.</p> </li> <li> <p>Specify the status code for which the new values are sent.</p> </li> <li> <p>Specify the override values to send to the API consumer, which can     be one or more of the following:</p> <ul> <li> <p>one or more HTTP headers to include in the response</p> </li> <li> <p>body of the response</p> </li> </ul> <p>image:{% link images/apim/3.x/api-publisher-guide/response-templates/template-vals.png %}[]</p> </li> <li> <p>Click ADD A NEW REPONSE TEMPLATE to add more templates for the     same error key, then repeat the previous three steps.</p> </li> <li> <p>Click SAVE.</p> </li> <li> <p>Click the deploy your API link with the changes.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/response-templates/template-deploy.png %}[]</p> </li> </ol> <p>The next time a call triggering the error associated with your template is sent to the API, the consumer will see the override values.</p>","location":"apim/user-guide/publisher/response-templates/#configure-a-response-template"},{"title":"Policy error keys you can override","text":"<p>Key</p> <p>Policy</p>   <p><code>API_KEY_MISSING</code></p> <p>link:{{ /apim/3.x/apim_policies_apikey.html</p>   <p>relative_url }}[API key]</p> <p><code>API_KEY_INVALID</code></p>   <p>link:{{ /apim/3.x/apim_policies_apikey.html</p> <p>relative_url }}[API key]</p>   <p><code>QUOTA_TOO_MANY_REQUESTS</code></p> <p>link:{{ /apim/3.x/apim_policies_rate_limiting.html</p>   <p>relative_url }}[Rate limiting]</p> <p><code>RATE_LIMIT_TOO_MANY_REQUESTS</code></p>   <p>link:{{ /apim/3.x/apim_policies_rate_limiting.html</p> <p>relative_url }}[Rate limiting]</p>   <p><code>REQUEST_CONTENT_LIMIT_TOO_LARGE</code></p> <p>link:{{ /apim/3.x/apim_policies_request_content_limit.html</p>   <p>relative_url }}[Request content limit]</p> <p><code>REQUEST_CONTENT_LIMIT_LENGTH_REQUIRED</code></p>   <p>link:{{ /apim/3.x/apim_policies_request_content_limit.html</p> <p>relative_url }}[Request content limit]</p>   <p><code>REQUEST_TIMEOUT</code></p> <p>link:{{ /apim/3.x/apim_policies_mock.html</p>   <p>relative_url }}[Mock], link:{{ /apim/3.x/apim_policies_callout_http.html</p> <p>relative_url }}[Callout HTTP], link:{{ /apim/3.x/apim_policies_request_validation.html</p>   <p>relative_url }}[Request validation]</p> <p><code>REQUEST_VALIDATION_INVALID</code></p>   <p>link:{{ /apim/3.x/apim_policies_request_validation.html</p> <p>relative_url }}[Request validation]</p>   <p><code>RESOURCE_FILTERING_METHOD_NOT_ALLOWED</code></p> <p>link:{{ /apim/3.x/apim_policies_resource_filtering.html</p>   <p>relative_url }}[Resource filtering]</p> <p><code>RBAC_INVALID_USER_ROLES</code></p>   <p>link:{{ /apim/3.x/apim_policies_role_based_access_control.html</p> <p>relative_url }}[Role-based access control]</p>   <p><code>RESOURCE_FILTERING_FORBIDDEN</code></p> <p>link:{{ /apim/3.x/apim_policies_resource_filtering.html</p>   <p>relative_url }}[Resource filtering]</p> <p><code>RBAC_FORBIDDEN</code></p>   <p>link:{{ /apim/3.x/apim_policies_role_based_access_control.html</p> <p>relative_url }}[Role-based access control]</p>   <p><code>RBAC_NO_USER_ROLE</code></p> <p>link:{{ /apim/3.x/apim_policies_role_based_access_control.html</p>   <p>relative_url }}[Role-based access control]</p> <p><code>OAUTH2_MISSING_SERVER</code></p>   <p>link:{{ /apim/3.x/apim_policies_oauth2.html</p> <p>relative_url }}[OAuth2]</p>   <p><code>OAUTH2_MISSING_HEADER</code></p> <p>link:{{ /apim/3.x/apim_policies_oauth2.html</p>   <p>relative_url }}[OAuth2]</p> <p><code>OAUTH2_MISSING_ACCESS_TOKEN</code></p>   <p>link:{{ /apim/3.x/apim_policies_oauth2.html</p> <p>relative_url }}[OAuth2]</p>   <p><code>OAUTH2_INVALID_ACCESS_TOKEN</code></p> <p>link:{{ /apim/3.x/apim_policies_oauth2.html</p>   <p>relative_url }}[OAuth2]</p> <p><code>OAUTH2_INSUFFICIENT_SCOPE</code></p>   <p>link:{{ /apim/3.x/apim_policies_oauth2.html</p> <p>relative_url }}[OAuth2]</p>   <p><code>OAUTH2_INVALID_SERVER_RESPONSE</code></p> <p>link:{{ /apim/3.x/apim_policies_oauth2.html</p>   <p>relative_url }}[OAuth2]</p> <p><code>OAUTH2_SERVER_UNAVAILABLE</code></p>   <p>link:{{ /apim/3.x/apim_policies_oauth2.html</p> <p>relative_url }}[OAuth2]</p>   <p><code>HTTP_SIGNATURE_INVALID_SIGNATURE</code></p> <p>link:{{ /apim/3.x/apim_policies_http_signature.html</p>   <p>relative_url }}[HTTP Signature]</p> <p><code>JWT_MISSING_TOKEN</code></p>   <p>link:{{ /apim/3.x/apim_policies_jwt.html</p> <p>relative_url }}[JWT]</p>   <p><code>JWT_INVALID_TOKEN</code></p> <p>link:{{ /apim/3.x/apim_policies_jwt.html</p>   <p>relative_url }}[JWT]</p> <p><code>JSON_INVALID_PAYLOAD</code></p>   <p>link:{{ /apim/3.x/apim_policies_json_validation.html</p> <p>relative_url }}[JSON validation]</p>   <p><code>JSON_INVALID_FORMAT</code></p> <p>link:{{ /apim/3.x/apim_policies_json_validation.html</p>   <p>relative_url }}[JSON validation]</p> <p><code>JSON_INVALID_RESPONSE_PAYLOAD</code></p>   <p>link:{{ /apim/3.x/apim_policies_json_validation.html</p> <p>relative_url }}[JSON validation]</p>   <p><code>JSON_INVALID_RESPONSE_FORMAT</code></p> <p>link:{{ /apim/3.x/apim_policies_json_validation.html</p>   <p>relative_url }}[JSON validation]</p> <p><code>GATEWAY_INVALID_REQUEST</code></p>   <p>All</p> <p><code>GATEWAY_INVALID_RESPONSE</code></p>   <p>All</p> <p><code>GATEWAY_OAUTH2_ACCESS_DENIED</code></p>   <p>All</p> <p><code>GATEWAY_OAUTH2_SERVER_ERROR</code></p>   <p>All</p> <p><code>GATEWAY_OAUTH2_INVALID_CLIENT</code></p>   <p>All</p> <p><code>GATEWAY_MISSING_SECURITY_PROVIDER</code></p>   <p>All</p> <p><code>GATEWAY_PLAN_UNRESOLVABLE</code></p>   <p>All</p> <p><code>GATEWAY_POLICY_INTERNAL_ERROR</code></p>","location":"apim/user-guide/publisher/response-templates/#policy-error-keys-you-can-override"},{"title":"Overview","text":"<p>APIM includes a feature for displaying your most important APIs on the APIM Portal homepage.</p>","location":"apim/user-guide/publisher/top-apis/"},{"title":"Configure your top APIs","text":"<p>You configure your top APIs in the APIM Management Settings:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/top-apis/graviteeio-top-apis-settings.png %}[]</p> <p>The configured APIs are displayed on the APIM Portal homepage:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/top-apis/graviteeio-top-apis-homepage.png %}[]</p> <p>They are also displayed on the Catalog &gt; Featured page:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/top-apis/graviteeio-top-apis-featured.png %}[]</p> <p>You can configure as many top APIs as you like.</p>","location":"apim/user-guide/publisher/top-apis/#configure-your-top-apis"},{"title":"Design your API flows","text":"","location":"apim/user-guide/publisher/design-studio/design-studio-create/","tags":["Design Studio","API flows","Introduced in version 3.5"]},{"title":"Overview","text":"<p>You can use Design Studio to create new API flows for your plans and define policies for each flow. Creating different flows for a plan allows you to apply different policies by path and/or HTTP method.</p>","location":"apim/user-guide/publisher/design-studio/design-studio-create/#overview","tags":["Design Studio","API flows","Introduced in version 3.5"]},{"title":"Get started with Design Studio","text":"<ol> <li> <p>link:{{ /apim/3.x/apim_quickstart_console_login.html |     relative_url }}[Log in to APIM Console^].</p> </li> <li> <p>Click APIs and select your API in the list.</p> </li> <li> <p>Click Design.</p> </li> <li> <p>If your API was created in an earlier version of APIM, migrate it to     Design Studio as described in link:{{     /apim/3.x/apim_publisherguide_design_studio_migrate.html |     relative_url }}[Migrate to Design Studio^].</p> </li> </ol>","location":"apim/user-guide/publisher/design-studio/design-studio-create/#get-started-with-design-studio","tags":["Design Studio","API flows","Introduced in version 3.5"]},{"title":"Create and configure an API flow","text":"<p>You can create flows at API level or at plan level.</p> <ol> <li> <p>In the DESIGN tab, click the API tab to design a new API     level flow or PLANS to create a new plan level flow.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/design-studio/design-studio.png %}[Design Studio]</p> </li> <li> <p>Click the plus icon to add a new flow.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/design-studio/add-plan-flow.png %}[]</p> </li> <li> <p>Double-click the flow to configure its details.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/design-studio/flow-configuration.png %}[]</p> <p>Configure the following:</p> <ul> <li> <p>Name</p> </li> <li> <p>Path details to filter on: the path syntax for the flow in     link:{{ /apim/3.x/apim_policies_overview.html#ant-notation |     relative_url }}[Ant format^] and whether the path starts with     or equals the value entered in Path.</p> </li> <li> <p>One or methods to filter on (specify all which apply)</p> </li> <li> <p>One or more conditions to filter on, in link:{{     /apim/3.x/apim_publisherguide_expression_language.html |     relative_url }}[Expression Language format^]\u2009\u2014\u2009for example, a     condition to filter on query parameters called <code>X-debug</code> would     be written like this: <code>#request.params['X-debug'] != null</code></p> </li> </ul> </li> <li> <p>Click SAVE.</p> </li> </ol> <p>You can update a flow by clicking it and changing any required values, then clicking the tick icon image:{% link images/icons/tick-icon.png %}[role=\"icon\"] to update the values.</p>","location":"apim/user-guide/publisher/design-studio/design-studio-create/#create-and-configure-an-api-flow","tags":["Design Studio","API flows","Introduced in version 3.5"]},{"title":"Additional configuration","text":"<p>You can configure the following additional resources and properties for your API flows.</p>","location":"apim/user-guide/publisher/design-studio/design-studio-create/#additional-configuration","tags":["Design Studio","API flows","Introduced in version 3.5"]},{"title":"Specify Best match for your flow paths","text":"<p>In the CONFIGURATION tab, select Best match if you want APIM to match your flows from the path that is closest to that defined in the flow definition.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/design-studio/configuration-tab.png %}[]</p> <p>Best match flow is chosen if the request matches the flow. A plain text part of the path will take precedence over a path parameter.</p> <p>It means, reading from left to right, each part of the path is compared, keeping the better matching. Strict equality between part of request path and flow path prevails over a path parameter.</p> <p>For example, with those flows configured:</p> <ul> <li> <p><code>/test/:id</code></p> </li> <li> <p><code>/test/subtest</code></p> </li> </ul> <p>If the request is <code>/test/55</code>, the resulting flow will be <code>/test/:id</code>. If the request is <code>/test/subtest</code>, the resulting flow will be <code>/test/subtest</code>.</p>","location":"apim/user-guide/publisher/design-studio/design-studio-create/#specify-best-match-for-your-flow-paths","tags":["Design Studio","API flows","Introduced in version 3.5"]},{"title":"Define properties for your API flows","text":"<p>In the PROPERTIES tab, specify properties as key-value pairs. You can specify them one by one, or toggle from Simple to Expert mode and paste property definitions into an editor in format <code>&lt;key&gt;=&lt;value&gt;</code>.</p> <p>You can also configure dynamic properties by clicking CONFIGURE DYNAMIC PROPERTIES. Dynamic properties are fetched with a URL on a regular schedule and subsequently updated according to the details you specify.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/design-studio/properties-tab.png %}[]</p> <p>When you add new policies to your API flows which include link:{{ /apim/3.x/apim_publisherguide_expression_language.html#api | relative_url }}[Expression Language^] fields as part of their configuration (such as the dynamic routing policy), you can retrieve and query property values with the <code>#properties</code> statement. For more details, see the ??? below.</p>","location":"apim/user-guide/publisher/design-studio/design-studio-create/#define-properties-for-your-api-flows","tags":["Design Studio","API flows","Introduced in version 3.5"]},{"title":"Dynamic properties","text":"<p>You can configure dynamic properties, which retrieve properties from a remote server with a URL and update them according to the details you specify.</p> <ol> <li> <p>Click CONFIGURE DYNAMIC PROPERTIES.</p> </li> <li> <p>Specify the details of the property:</p> <ul> <li> <p><code>cron</code> schedule</p> </li> <li> <p>URL</p> </li> <li> <p>request headers and body to include with the call</p> </li> <li> <p>JOLT transformation to perform on the response</p> </li> </ul> </li> <li> <p>Toggle on the Enabled option.</p> </li> <li> <p>Click the tick icon image:{% link images/icons/tick-icon.png     %}[role=\"icon\"] to save your changes.</p> </li> <li> <p>Click SAVE.</p> <p>After the first call, the resulting property is added to the list of global properties, where its value is continuously updated according to the <code>cron</code> schedule specified.</p> </li> </ol>","location":"apim/user-guide/publisher/design-studio/design-studio-create/#dynamic-properties","tags":["Design Studio","API flows","Introduced in version 3.5"]},{"title":"Create resources to use in your flows","text":"<p>In the RESOURCES tab, create new resources to use in your flows. You can add resources to policies which support them when configuring them for a flow.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/design-studio/resources-tab.png %}[]</p> <ul> <li> <p><code>Cache</code> resources can be added to a <code>Cache</code> policy</p> </li> <li> <p><code>Generic OAuth2 Authorization Server</code> resources can be added to an     <code>OAuth2</code> policy</p> </li> <li> <p><code>Gravitee.io AM Authorization Server</code> resources can be added to an     <code>OAuth2</code> policy</p> </li> </ul> <p>For example, specify a cache resource as follows:</p> <ol> <li> <p>Click CACHE.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/design-studio/cache-resource.png %}[]</p> </li> <li> <p>Enter the cache name.</p> </li> <li> <p>Specify the cache properties: time to idle, time to live and max     entries on heap.</p> </li> <li> <p>Click the tick icon image:{% link images/icons/tick-icon.png     %}[role=\"icon\"].</p> </li> <li> <p>Click SAVE.</p> </li> </ol>","location":"apim/user-guide/publisher/design-studio/design-studio-create/#create-resources-to-use-in-your-flows","tags":["Design Studio","API flows","Introduced in version 3.5"]},{"title":"Add policies to a flow","text":"<p>You can add as many policies as you want to a flow.</p> <p>You can find out more about a specific policy by selecting it to view the in-product reference documentation, or you can view the online Policy Reference link:{{ /apim/3.x/apim_policies_overview.html | relative_url }}[here^].</p> <ol> <li> <p>Click the DESIGN tab.</p> </li> <li> <p>Click on a plan to expand it.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/design-studio/add-policies-expand-plan.png %}[] . From the list on the right, drag the policy to the required phase of the flow.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/design-studio/add-policies-new-policy.png %}[] . Specify the details of the policy configuration. If this is a <code>Cache</code> or <code>OAuth2</code> type policy, you can add the corresponding resources created in ???. . Click SAVE.</p> </li> </ol> <p>If you hover over a policy in a flow you can perform various operations on it: drag the policy to another phase of the flow, disable, delete or duplicate the policy.</p>","location":"apim/user-guide/publisher/design-studio/design-studio-create/#add-policies-to-a-flow","tags":["Design Studio","API flows","Introduced in version 3.5"]},{"title":"Example","text":"<p>In this example, we want our API to query our shop databases to check their stock levels. We will dynamically reroute any API calls containing a shop ID to its associated URL.</p> <p>The first step is to define a list of properties for the shops, with each unique shop ID as the key and the URL of the shop as the value.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/design-studio/global-properties-list.png %}[]</p> <p>We then configure a dynamic routing policy for the API with a routing rule which builds a new URL dynamically through property matching. The URL is created with a <code>#properties</code> statement which matches properties returned by querying the request header containing the shop ID.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/design-studio/dynamic-routing-properties.png %}[]</p> <p>If the ID in the request header matches the key of one of the properties, it is replaced with the URL. The dynamic routing policy then reroutes the API call to the URL.</p> <p>The list of shop IDs and URLs could also be maintained using a dictionary, for example, in organizations where the administrator maintains this information independently of the API creation process or if the list needs to be available to multiple APIs. For more details, see link:{{ /apim/3.x/apim_installguide_configuration_dictionaries.html | relative_url }}[Configure dictionaries^] in the Configuration Guide.</p>","location":"apim/user-guide/publisher/design-studio/design-studio-create/#example","tags":["Design Studio","API flows","Introduced in version 3.5"]},{"title":"Deploy your API and view it in the audit history","text":"<p>When you have finished designing an API, you need to click the deploy your API link to deploy your API with your changes.</p> <p>Each new API deployment has a version associated, for which you can add a description as a label when deploying the API:</p> <p>image:{% link images/apim/3.x/api-publisher-guide/design-studio/deploy-label.png %}[]</p> <p>You can use this label to identify the API deployment in the audit trail and in views on the API dashboard:</p> <p>image:{% link images/apim/3.x/api-publisher-guide/audit/audit-history.png %}[]</p> <p>The audit history allows you to view the deployment in detail. For more information, see link:{{ /apim/3.x/apim_publisherguide_audit.html | relative_url }}[Audit trail^].</p>","location":"apim/user-guide/publisher/design-studio/design-studio-create/#deploy-your-api-and-view-it-in-the-audit-history","tags":["Design Studio","API flows","Introduced in version 3.5"]},{"title":"Debug ode","text":"<p>New in version 3.16</p>","location":"apim/user-guide/publisher/design-studio/design-studio-debug-mode/"},{"title":"Overview","text":"<p>From 3.16, we\u2019ve updated the try it mode to offer new capabilities and view what\u2019s happening on each policy executed, now called Debug mode.</p> <p>Debug mode is a tool for troubleshooting your API proxies running on APIM. It provides detailed information about the behavior of each policy in your flows as well as the overall execution order at runtime. With debug, you can:</p> <ul> <li> <p>Understand which policies are triggered by a specific request     (including Platform-level policies).</p> </li> <li> <p>Visualise which policies are executed or skipped (conditional     policy).</p> </li> <li> <p>Understand the order of execution of your policies.</p> </li> <li> <p>Trace transformations and changes made to headers, body and     execution context.</p> </li> <li> <p>Easily troubleshoot and find root cause of errors, misbehaviors or     performance issues.</p> </li> </ul>","location":"apim/user-guide/publisher/design-studio/design-studio-debug-mode/#overview"},{"title":"How to Get Started With Debug Mode","text":"<ol> <li> <p>link:{{     /apim/3.x/apim_publisherguide_design_studio_create.html |     relative_url }}[Design your API^].</p> </li> <li> <p>Select Debug tab.</p> </li> <li> <p>Configure your request.</p> </li> <li> <p>Select Send.</p> </li> </ol>","location":"apim/user-guide/publisher/design-studio/design-studio-debug-mode/#how-to-get-started-with-debug-mode"},{"title":"How To Test Your API Concept with Debug Mode","text":"<p>You can send a request to your API endpoint through the embedded HTTP client available under the Debug tab.</p> <p>You don\u2019t need to save or redeploy the API to test your changes when using the Debug Mode.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/design-studio/debug-mode/debug-mode-example-empty.png %}[Debug Mode empty example]</p> <p>The embedded HTTP client let you configure different attributes of your request:</p> <ul> <li> <p>HTTP method to select the HTTP verb (e.g., <code>GET</code>, <code>POST</code>, <code>PUT</code>,     etc.).</p> </li> <li> <p>Path to test a specific subpath and provide query parameters.</p> </li> </ul> <p>The context-path of the API your are debugging is already taken into account. Path refers to the subpath: myapi-context-path/path?queryparam=value</p> <ul> <li> <p>Headers to provide a custom list of HTTP request headers.</p> </li> <li> <p>Request body to configure a custom request body.</p> </li> </ul> <p>Since debug mode emulates an external call to your API, it will resolve the flow as the gateway would do, so if you want to debug a specific flow you must configure your request (path, headers) to replicate the conditions on which the flow is triggered.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/design-studio/debug-mode/debug-mode-example.png %}[Debug Mode example]</p> <p>The debug mode displays all policies in a vertical timeline so you can easily visualize the exact order of execution.</p>","location":"apim/user-guide/publisher/design-studio/design-studio-debug-mode/#how-to-test-your-api-concept-with-debug-mode"},{"title":"Different state for policies :","text":"<p>image:{% link images/apim/3.x/api-publisher-guide/design-studio/debug-mode/debug-mode-legend.png %}[Debug Mode legend]</p> <ul> <li> <p>executed - the policy has been executed properly</p> </li> <li> <p>skipped - the policy contains a condition that has not been     fulfilled. Refer to the input/output inspector for more details on     the evaluation of the condition.</p> </li> <li> <p>error - an error occurred during policy execution. Refer to the     input/output inspector for more details on the error.</p> </li> </ul> <p>By selecting a specific policy in the timeline, you have access to additional information regarding the input/output of the policy:</p> <ul> <li> <p>header</p> </li> <li> <p>context attributes</p> </li> <li> <p>body</p> </li> </ul> <p>The inspector relies on 3 colors to indicate the nature of the change:</p> <ul> <li> <p>green color indicates a addition</p> </li> <li> <p>orange color indicates a edition</p> </li> <li> <p>red color indicates a deletion</p> </li> </ul> <p>image:{% link images/apim/3.x/api-publisher-guide/design-studio/debug-mode/debug-mode-inspector.png %}[Debug Mode inspector]</p>","location":"apim/user-guide/publisher/design-studio/design-studio-debug-mode/#different-state-for-policies"},{"title":"Timeline","text":"","location":"apim/user-guide/publisher/design-studio/design-studio-debug-mode/#timeline"},{"title":"How to interpret ?","text":"<p>The order in which the policies appear in the timeline reflects the exact order in which they have been executed by the gateway at runtime.</p> <p>Note that this order may differ from the order in which policies where placed in the Policy Studio during the design phase.</p> <p>This is due to a performance optimization applied at runtime on the the policy chain. The gateway always executes policies interacting with the HTTP Header part of the request (onRequest, onResponse) before policies interacting with the body part of the request (onRequestContent, onResponseContent).</p> <p>Also, a policy may appear twice in the timeline if it interacts with both the head and the body part of the request.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/design-studio/debug-mode/debug-mode-policy-chain.png %}[Policies execution chain order]</p>","location":"apim/user-guide/publisher/design-studio/design-studio-debug-mode/#how-to-interpret"},{"title":"How to navigate ?","text":"<p>You can scroll through the list of policies via the timeline. You can also quickly access a specific policy by clicking on it in the quick access timeline.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/design-studio/debug-mode/debug-mode-timeline.png %}[Debug Mode timeline]</p> <p>By clicking Request Input or Request Output, you can view the global transformation on your request and difference between what has been received by the gateway and what has been sent to your backend.</p> <p>By clicking Response Input or Response Output, you can view the global transformation on your response and difference between what has been received from the backend and what has been sent back to your client app.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/design-studio/try-it/try-it-example.png %}[Try it example]</p>","location":"apim/user-guide/publisher/design-studio/design-studio-debug-mode/#how-to-navigate"},{"title":"Limitations","text":"<p>Some features are not testable with Debug Mode:</p> <ul> <li> <p>Rate Limit &amp; quota policies</p> </li> <li> <p>Spike arrest</p> </li> <li> <p>Cache - cache policy will not be testable through debug mode     with in memory cache since it is created and destroyed with the api</p> </li> <li> <p>IPFiltering - Since calls are emited by the gateway itself, you     will not be able to emulate a call from another IP with the debug     mode (IP used to issue requests is 127.0.0.1)</p> </li> <li> <p>Health-check</p> </li> <li> <p>Virtual hosts - the first host is always selected</p> </li> <li> <p>Encrypted properties - For security reasons, you won\u2019t be able     to clear encrypted properties in debug mode (it could have an impact     if you want to use them in a condition for example).</p> </li> </ul>","location":"apim/user-guide/publisher/design-studio/design-studio-debug-mode/#limitations"},{"title":"Migrate to Design Studio","text":"<p>New in version 3.5</p>","location":"apim/user-guide/publisher/design-studio/design-studio-migrate/"},{"title":"Overview","text":"<p>This page explains how to migrate your existing API to Design Studio.</p> <p>The migration process transforms each <code>Path</code>-<code>HTTP methods</code>-<code>Policy</code> into one flow.</p> <p>For more information on the differences between the APIM Console Design function and Design Studio, see link:{{ /apim/3.x/apim_publisherguide_design_studio_overview.html#differences | relative_url }}[Differences between Design function and Design Studio^].</p>","location":"apim/user-guide/publisher/design-studio/design-studio-migrate/#overview"},{"title":"Migrate an API","text":"<ol> <li> <p>Log in to APIM Console.</p> </li> <li> <p>Click APIs.</p> </li> <li> <p>Select your API and click Design.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/policies/graviteeio-policy-studio-before-migration.png %}[]</p> </li> <li> <p>Click the migrate button.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/policies/graviteeio-policy-studio-migration-button.png %}[]</p> <p>You are redirected to Design Studio.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/policies/graviteeio-policy-studio-migrated.png %}[]</p> </li> </ol>","location":"apim/user-guide/publisher/design-studio/design-studio-migrate/#migrate-an-api"},{"title":"Introduction","text":"<p>New in version 3.5</p>","location":"apim/user-guide/publisher/design-studio/design-studio-overview/"},{"title":"Overview","text":"<p>From APIM 3.5, you can use Design Studio to design your APIs with an intuitive drag and drop interface.</p> <p>You design your APIs by adding and configuring new flows at both API and plan level. You can then customize your flows with link:{{ /apim/3.x/apim_policies_overview.html | relative_url }}[Policies] and link:{{ /apim/3.x/apim_resources_overview.html | relative_url }}[Resources].</p> <p>You can also migrate existing API definitions to Design Studio.</p>","location":"apim/user-guide/publisher/design-studio/design-studio-overview/#overview"},{"title":"How to access Design Studio","text":"<p>APIM Console opens Design Studio automatically when you click the Design menu option for an API, as long as one of the following conditions is met:</p> <ul> <li> <p>Your API was created in APIM 3.5 or above using the DESIGN     STUDIO API creation method (see link:{{     /apim/3.x/apim_publisherguide_create_apis.html | relative_url     }}[Create APIs^] for more details)</p> </li> <li> <p>Your API design was previously migrated to Design Studio (see     link:{{     /apim/3.x/apim_publisherguide_design_studio_migrate.html |     relative_url }}[Migrate to Design Studio^] for more details)</p> </li> </ul> <p>Otherwise, the Design function is available as in earlier APIM versions.</p> <p>With the APIM Console Design function, HTTP methods were linked directly to policies. With Design Studio, HTTP methods are linked to a flow. This means that you can have a path with policies linked to different HTTP methods.</p> <p>By default, the selection of a flow is based on the operator defined in the flow itself.</p> <p>You can use the operator either to select a flow with a path which matches exactly, or when the start of the path matches. You can then use the Best match option to select the flow from the path that is closest.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/design-studio/graviteeio-design-studio-best-match.png %}[]</p>","location":"apim/user-guide/publisher/design-studio/design-studio-overview/#how-to-access-design-studio"},{"title":"Quick tour","text":"<p>Design Studio shows a visual representation of a plan\u2019s flows horizontally, with the request and response phases clearly demarcated, and the policies associated with each phase shown.</p> <p>Each plan can have more than one set of request and response flows, each with its own definition (for example, HTTP method).</p> <p>image:{% link images/apim/3.x/api-publisher-guide/design-studio/quick-tour.png %}[Design Studio]</p> <ul> <li> <p>The list on the left shows the plans associated with the API, which     you can expand to see the different flows defined</p> </li> <li> <p>The central pane shows the currently selected flows with their     associated policies</p> </li> <li> <p>The list on the right shows the list of policies, organized into     sections by type</p> </li> </ul>","location":"apim/user-guide/publisher/design-studio/design-studio-overview/#quick-tour"},{"title":"Try It mode","text":"<p>New in version 3.11</p>","location":"apim/user-guide/publisher/design-studio/design-studio-try-it/"},{"title":"Overview","text":"<p>You can use Design Studio Try-it Mode to test a non deployed API. This mode allows you to modify your API without saving or deploying it.</p>","location":"apim/user-guide/publisher/design-studio/design-studio-try-it/#overview"},{"title":"Get Started With Try It Mode","text":"<ol> <li> <p>link:{{     /apim/3.x/apim_publisherguide_design_studio_create.html |     relative_url }}[Design your API^].</p> </li> <li> <p>Click TRY IT.</p> </li> <li> <p>Send a request to your API with whatever parameters you\u2019d like to     try.</p> </li> </ol>","location":"apim/user-guide/publisher/design-studio/design-studio-try-it/#get-started-with-try-it-mode"},{"title":"How To Test Your API Concept With Try It Mode","text":"<p>You can test your API through the HTTP client available in the TRY IT tab.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/design-studio/try-it/try-it-view.png %}[HTTP Client]</p> <p>With this client, you can call your API, and test and experiment with the following:</p> <ol> <li> <p>HTTP Method.</p> </li> <li> <p>Path (and query params).</p> </li> <li> <p>Headers.</p> </li> <li> <p>Request body.</p> </li> </ol> <p>image:{% link images/apim/3.x/api-publisher-guide/design-studio/try-it/try-it-example.png %}[Try it example]</p>","location":"apim/user-guide/publisher/design-studio/design-studio-try-it/#how-to-test-your-api-concept-with-try-it-mode"},{"title":"Limitations","text":"<p>Some features are not testable with Try It Mode:</p> <ol> <li> <p>Rate Limit &amp; Quota.</p> </li> <li> <p>Health-Check.</p> </li> <li> <p>Virtual hosts (the first host is selected).</p> </li> </ol>","location":"apim/user-guide/publisher/design-studio/design-studio-try-it/#limitations"},{"title":"Overview","text":"<p>AsciiDoc pages can be translated or come from an external source, and their access can be restricted. See link:{{ /apim/3.x/apim_publisherguide_publish_documentation.html#manage_pages | relative_url }}[Publish documentation] for more information on creating AsciiDoc pages.</p> <p>The sections below describe specific configuration for AsciiDoc pages.</p>","location":"apim/user-guide/publisher/documentation/publish-documentation-asciidoc/"},{"title":"Edit an AsciiDoc page","text":"<p>You can use the PAGE editor to edit a AsciiDoc page\u2019s content and preview it:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-asciidoc-editor.png %}[]</p>","location":"apim/user-guide/publisher/documentation/publish-documentation-asciidoc/#edit-an-asciidoc-page"},{"title":"Attached resources","text":"<p>The ATTACHED RESOURCES tab is also available for link:{{ /apim/3.x/apim_publisherguide_publish_documentation_markdown.html | relative_url }}[Markdown] pages. In this tab, you can import files and attach them to the page. Imported files size must not exceed the size defined in the settings.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-markdown-attached-resources-1.png %}[]</p> <p>You can add files by clicking the ADD A NEW RESOURCE button, and remove them by clicking the trash icon.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-markdown-attached-resources-2.png %}[] image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-markdown-attached-resources-3.png %}[,300]</p> <p>In APIM Portal attached files are displayed at the bottom on the page as download links.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-markdown-attached-resources-4.png %}[]</p>","location":"apim/user-guide/publisher/documentation/publish-documentation-asciidoc/#attached-resources"},{"title":"Overview","text":"<p>You can create Markdown template pages in the same way as Markdown pages. See link:{{ /apim/3.x/apim_publisherguide_publish_documentation_markdown.html | relative_url }}[Markdown documentation] for more information.</p> <p>The sections below describe specific configuration for Markdown templates.</p>","location":"apim/user-guide/publisher/documentation/publish-documentation-markdown-template/"},{"title":"Create a template page","text":"<p>You can use the PAGE editor to edit a Markdown page\u2019s content and preview it.</p> <p>As for any Markdown page, you can use templates to create your templates.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-template-creation.png %}[]</p>","location":"apim/user-guide/publisher/documentation/publish-documentation-markdown-template/#create-a-template-page"},{"title":"Use a template page","text":"<p>When creating a Markdown page, you can select the template from a list, if any are available.</p> <p>You can now modify the content as needed.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-template-usage.png %}[]</p>","location":"apim/user-guide/publisher/documentation/publish-documentation-markdown-template/#use-a-template-page"},{"title":"Overview","text":"<p>Markdown pages can be translated or come from an external source, and their access can be restricted. See link:{{ /apim/3.x/apim_publisherguide_publish_documentation.html#manage_pages | relative_url }}[Publish documentation] for more information on creating Markdown pages.</p> <p>The sections below describe specific configuration for Markdown pages.</p>","location":"apim/user-guide/publisher/documentation/publish-documentation-markdown/"},{"title":"Edit a Markdown page","text":"<p>You can use the PAGE editor to edit a Markdown page\u2019s content and preview it:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-markdown-editor.png %}[]</p>","location":"apim/user-guide/publisher/documentation/publish-documentation-markdown/#edit-a-markdown-page"},{"title":"Add links to a documentation page","text":"<p>You can add a direct link to an existing OpenAPI or Markdown page. Only published pages can be linked. To link a page, click Insert page link in the toolbar, select a page and click ADD.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-markdown-add-page-link-1.png %}[]</p> <p>A new link is added in the editor. The text of the link can be customized but the path must not be changed.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-markdown-add-page-link-2.png %}[]</p>","location":"apim/user-guide/publisher/documentation/publish-documentation-markdown/#add-links-to-a-documentation-page"},{"title":"Attached resources","text":"<p>The ATTACHED RESOURCES tab is also available for link:{{ /apim/3.x/apim_publisherguide_publish_documentation_asciidoc.html | relative_url }}[AsciiDoc] pages. In this tab, you can import files and attach them to the page. Imported files size must not exceed the size defined in the settings.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-markdown-attached-resources-1.png %}[]</p> <p>You can add files by clicking the ADD A NEW RESOURCE button, and remove them by clicking the trash icon.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-markdown-attached-resources-2.png %}[] image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-markdown-attached-resources-3.png %}[,300]</p> <p>In APIM Portal attached files are displayed at the bottom on the page as download links.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-markdown-attached-resources-4.png %}[]</p>","location":"apim/user-guide/publisher/documentation/publish-documentation-markdown/#attached-resources"},{"title":"Overview","text":"<p>OpenAPI pages can be translated or come from an external source, and their access can be restricted. See link:{{ /apim/3.x/apim_publisherguide_publish_documentation.html#manage_pages | relative_url }}[Publish documentation] for more information.</p> <p>The sections below describe specific configuration for OpenAPI pages.</p>","location":"apim/user-guide/publisher/documentation/publish-documentation-openapi/"},{"title":"Edit an OpenAPI page","text":"<p>You can use the PAGE editor to edit an OpenAPI page\u2019s raw content and preview it.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-swagger-editor.png %}[]</p>","location":"apim/user-guide/publisher/documentation/publish-documentation-openapi/#edit-an-openapi-page"},{"title":"Add links to a documentation page","text":"<p>You can add a direct link to an existing OpenAPI or Markdown page. Only published pages can be linked. To link a page, click Insert page link in the toolbar, select a page and click ADD.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-markdown-add-page-link-1.png %}[]</p> <p>A new link is added in the editor. The text of the link can be customized but the path must not be changed.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-markdown-add-page-link-2.png %}[]</p>","location":"apim/user-guide/publisher/documentation/publish-documentation-openapi/#add-links-to-a-documentation-page"},{"title":"Viewer","text":"<p>You can choose the renderer for your OpenAPI file.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-swagger-configuration-viewer.png %}[,300]</p> <p>You can also edit this configuration globally in the settings to change your default renderer or disable a renderer.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-openapi-configuration-viewer.png %}[]</p>","location":"apim/user-guide/publisher/documentation/publish-documentation-openapi/#viewer"},{"title":"Swagger-UI configuration","text":"<p>If you choose Swagger-UI as the viewer, you can configure the following options:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-swagger-configuration.png %}[]</p>","location":"apim/user-guide/publisher/documentation/publish-documentation-openapi/#swagger-ui-configuration"},{"title":"Overview","text":"<p>You can use the system folders to customize the APIM Portal navigation. You can customize:</p> <ul> <li> <p>the APIM Portal menu in the header and footer</p> </li> <li> <p>the API side menu</p> </li> </ul>","location":"apim/user-guide/publisher/documentation/publish-documentation-system-folders/"},{"title":"Links","text":"<p>You customize the navigation by create link pages in the folders. There are 3 kinds of link:</p> <ul> <li> <p>External link</p> </li> <li> <p>Link to an existing documentation page</p> </li> <li> <p>Link to a category</p> </li> </ul>","location":"apim/user-guide/publisher/documentation/publish-documentation-system-folders/#links"},{"title":"Access system folders","text":"<p>To access system folders:</p> <ul> <li> <p>for the APIM Portal, click Settings &gt; Documentation</p> </li> <li> <p>for an APIM menu, click APIs and select the API, then click     Pages</p> </li> </ul> <p>System folders are listed with a padlock icon:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/system-folders.png %}[]</p>","location":"apim/user-guide/publisher/documentation/publish-documentation-system-folders/#access-system-folders"},{"title":"Manage links","text":"<p>To create a link, go to a system folder and click the plus icon image:{% link images/icons/plus-icon.png %}[role=\"icon\"].</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-link-create.png %}[]</p>","location":"apim/user-guide/publisher/documentation/publish-documentation-system-folders/#manage-links"},{"title":"External link","text":"<p>Enter a name and a URL (relative or absolute):</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-link-external.png %}[,300]</p>","location":"apim/user-guide/publisher/documentation/publish-documentation-system-folders/#external-link"},{"title":"Documentation link","text":"<p>Select an existing page in the documentation:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-link-documentation.png %}[,300]</p> <p>A documentation link is published only if the target documentation page is published.</p>","location":"apim/user-guide/publisher/documentation/publish-documentation-system-folders/#documentation-link"},{"title":"Category link","text":"<p>Select an existing category in the documentation:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-link-category.png %}[,300]</p> <p>Both documentation and category links inherit the name and translation of their target. You can override these values by toggling off the Inherit switches:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-link-override-name.png %}[]</p> <p>You can create links from documentation by clicking the following icon:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-link-fast-create.png %}[]</p>","location":"apim/user-guide/publisher/documentation/publish-documentation-system-folders/#category-link"},{"title":"System folders","text":"<p>APIM Portal documentation has 3 system folders: <code>Header</code>, <code>TopFooter</code> and <code>Footer</code>. API documentation has 1 system folder: <code>Aside</code>.</p> <p>Each system folder corresponds to an area of APIM Portal:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-link-portal-zones.png %}[] image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-link-api-zones.png %}[]</p> <p>The APIM Portal <code>TopFooter</code> is the only system folder in which you can create standard folders. These folders are used to group links together.</p> <p>For this system folder, only links to folders will be displayed.</p>","location":"apim/user-guide/publisher/documentation/publish-documentation-system-folders/#system-folders"},{"title":"Publish API documentation","text":"<p>= Publish documentation :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_publisherguide_publish_documentation.html :page-folder: apim/user-guide/publisher :page-layout: apim3x</p> <p>== Overview</p> <p>APIM includes a feature for publishing documentation in APIM Portal. You can publish documentation for the whole portal and for individual APIs.</p> <p>The APIM Portal documentation creates a direct line of communication with your developer community through a single channel. For example, you can use it to communicate your best practices or even to configure your own homepage.</p> <p>Documentation is the key to a successful API. It is the best way to promote your web services and give developers all the information they need to consume them successfully.</p> <p>=== System folders</p> <p>You can use system folders to customize the APIM Portal menu header, footer and navigation by adding custom links. For more information, see link:{{ '/apim/3.x/apim_publisherguide_publish_documentation_system_folders.html' | relative_url }}[Customize the APIM Portal navigation^].</p> <p>=== Documentation set To add some documentation, you can either create new pages or import them from a file or external source.</p> <p>APIM supports multiple types of documentation:</p> <ul> <li>Markdown (for more information, see link:{{ '/apim/3.x/apim_publisherguide_publish_documentation_markdown.html' | relative_url }}[Markdown documentation] and link:{{ '/apim/3.x/apim_publisherguide_publish_documentation_markdown_template.html' | relative_url }}[Markdown templates])</li> <li>AsciiDoc (for more information, see link:{{ '/apim/3.x/apim_publisherguide_publish_documentation_asciidoc.html' | relative_url }}[AsciiDoc documentation])</li> <li>OpenAPI (Swagger) (for more information, see link:{{ '/apim/3.x/apim_publisherguide_publish_documentation_openapi.html' | relative_url }}[OpenAPI documentation])</li> </ul> <p>You can create folders to organize your documentation.</p> <p>=== External documentation</p> <p>You can fetch your documentation from external sources.</p> <p>APIM includes 5 types of fetchers:</p> <ul> <li>GitHub: fetch your documentation from a GitHub repository</li> <li>GitLab: fetch your documentation from a GitLab repository</li> <li>Git: fetch your documentation from a Git repository</li> <li>WWW: fetch your documentation from the web</li> <li>Bitbucket: fetch your documentation from a Bitbucket repository</li> </ul> <p>The documentation is fetched and stored locally in APIM when you first create it, and at regular intervals if you configure auto-fetch.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-external-source-auto-fetch.png %}[]</p> <p>=== Manage documentation pages and folders</p> <p>To create new pages and folders in APIM Console:</p> <ul> <li>for an API, click APIs and select the API, then click Pages</li> <li>for the whole APIM Portal, click Settings &gt; Documentation</li> </ul> <p>== Create a new folder</p> <p>. Click the plus icon image:{% link images/icons/plus-icon.png %}[role=\"icon\"] and select the folder icon. + image:{% link images/apim/3.x/api-publisher-guide/documentation/create-folder.png %}[]</p> <p>. Specify your folder name and click SAVE. + APIM adds your folder to a list, where you can select it and:</p> <ul> <li>add different language versions of the folder name by clicking TRANSLATE FOLDER</li> <li>start creating documentation pages in your folder by clicking the plus icon image:{% link images/icons/plus-icon.png %}[role=\"icon\"] and following the steps below</li> </ul> <p>== Create a new page</p> <p>. Click the plus icon image:{% link images/icons/plus-icon.png %}[role=\"icon\"] and choose the documentation type. + image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-creation.png %}[]</p> <p>. (Optional) Set the page as your API Portal home page by selecting the Set as homepage option. . Choose whether to import the documentation or create it directly in the editor. If importing, specify the file details or the external documentation source. . If you are creating a Markdown page and want to use an existing template, select the template. . If the page is ready to publish, select Publish this page. The page will not be visible until this option is selected. You can also publish it later from the documentation list. . Click SAVE.</p> <p>NOTE: For Markdown pages, you can link:{{ '/apim/3.x/apim_publisherguide_publish_documentation_markdown_template.html' | relative_url }}[create and use templates].</p> <p>== Import multiple pages</p> <p>If you have an existing documentation set for your API in a GitHub or GitLab repository, you can configure the GitHub or GitLab fetcher to import the complete documentation structure on a one-off or regular basis. You can import the documentation into APIM in a different structure from the source repository structure.</p> <p>In order for the fetcher to locate the documentation in your repository structure and create the documentation structure you need in APIM, you first create a JSON file in the repository describing both the source and destination structure. You can then configure a fetcher in APIM to read the JSON file and import the documentation according to the structure defined in the file.</p> <p>=== Example JSON file</p> <p>The following example JSON file describes a documentation set which includes:</p> <ul> <li>a home page in Markdown format in a folder called <code>/newdoc</code>, to be placed at the root of the APIM documentation structure.</li> <li>a JSON file containing a Swagger specification at the root of the repository, to be placed in a folder called <code>/technical</code> in the APIM documentation structure.</li> </ul>","location":"apim/user-guide/publisher/documentation/publish-documentation/"},{"title":"[source,json]","text":"<p>{     \"version\": 1,     \"documentation\": {         \"pages\": [             {                 \"src\": \"/newdoc/readme.md\",                 \"dest\": \"/\",                 \"name\": \"Homepage\",                 \"homepage\": true             },             {                 \"src\": \"/test-import-swagger.json\",                 \"dest\": \"/technical\",                 \"name\": \"Swagger\"             }         ]     } }</p>  <p>=== Configure a fetcher</p> <p>. Click Import multiple files. . If you want to publish the pages on import, select Publish all imported pages. + image:{% link images/apim/3.x/api-publisher-guide/documentation/import-multiple-files.png %}[] . Click the GitHub or GitLab fetcher. . Specify the details of the external source, such as the URL of the external API, name of the repository and the branch. The fields vary slightly depending on the fetcher. + image:{% link images/apim/3.x/api-publisher-guide/documentation/import-multiple-file-dets.png %}[] . In Filepath, enter the path to your JSON documentation specification file. . Enter an access token, which you need to generate in your GitHub or GitLab user profile. . Select Auto Fetch and specify the <code>crontab</code> update frequency, if you want the pages to be updated dynamically. . Click IMPORT. + APIM adds the files to your documentation set. + image:{% link images/apim/3.x/api-publisher-guide/documentation/import-multiple-files-result.png %}[]</p> <p>=== Publish your page</p> <p>Once your page is created, you can view it before publishing it. APIM displays the following message:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-draft.png %}[]</p> <p>You can publish a page in one of the following ways:</p> <ul> <li> <p>Check the Publish this page option in the CONFIGURATION tab: + image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-publish-1.png %}[] + When you publish the page in this way, you can enable the option Allow access to anonymous user to display the page to users browsing APIM Portal without logging in. The option is checked by default.</p> </li> <li> <p>Click the cloud icon in the documentation list:</p> </li> </ul> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-publish-2.png %}[]</p> <p>== Configure a page</p> <p>You can select a page from the list and configure it using the tabs, as described in the sections below.</p> <p>=== Translate a page</p> <p>You can add translations for your pages. In the TRANSLATIONS tab:</p> <p>. Click ADD A TRANSLATION. . Enter your 2 character language code (FR for french, CZ for czech, IT for italian and so on). . Enter the translated title. . (Optional) You can edit the content to add translated content by toggling on the switch. . Click SAVE TRANSLATION at the bottom of the page.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-translations-1.png %}[]</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-translations-2.png %}[]</p> <p>=== Auto fetch from an external source</p> <p>To periodically fetch your documentation from external sources, you can enable the auto-fetch option and specify the fetch frequency. In the EXTERNAL SOURCE tab:</p> <p>. Select the external source type. . Enter the source details, such as URL, username and so on. . Specify the Update frequency as a <code>cron</code> expression. This is a string consisting of six fields that describe the schedule (representing seconds, minutes, hours, days, months and weekdays). + For example:</p> <ul> <li>Fetch every second: <code>* * */1 * * *</code></li> <li>At 00:00 on Saturday : <code>0 0 0 * * SAT</code></li> </ul> <p>NOTE: If the APIM administrator configured a maximum fetch frequency, the value configured by the APIM administrator will override the frequency you specify.</p> <p>=== Access control</p> <p>In the ACCESS CONTROL tab, you can mark a page as PRIVATE if you want to deny access to anonymous user.</p> <p>For private pages, you can configure access lists by required or to be excluded roles/groups.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-access-control.png %}[]</p> <p>== Templating</p> <p>This example shows how to create documentation templates based on the Apache https://freemarker.apache.org[FreeMarker template engine, window=\\\"_blank\\\"].</p> <p>=== Syntax</p> <p>You can access your API data in your API documentation with the following format: <code>${api.name} or ${api.metadata['foo-bar']}</code></p> <p>== Available API properties</p> <p>[width=\"100%\",cols=\"20%,10%,70%\",options=\"header\"] |====================== |Field name                 |Field type |Example |id                         |String     |70e72a24-59ac-4bad-a72a-2459acbbad39 |name                       |String     |My first API |description                |String     |My first API |version                    |String     |1 |metadata                   |Map        |{\"email-support\": \"support.contact@company.com\"} |createdAt                  |Date       |12 juil. 2018 14:44:00 |updatedAt                  |Date       |12 juil. 2018 14:46:00 |deployedAt                 |Date       |12 juil. 2018 14:49:00 |picture                    |String     |data:image/png;base64,iVBO... |state                      |String     |STARTED/STOPPED |visibility                 |String     |PUBLIC/PRIVATE |tags                       |Array      |[\"internal\", \"sales\"] |proxy.contextPath          |String     |/stores |primaryOwner.displayName   |String     |Firstname Lastname |primaryOwner.email         |String     |firstname.lastname@company.com |======================</p> <p>== Example</p> <p>The following example shows an API documentation template.</p>","location":"apim/user-guide/publisher/documentation/publish-documentation/#sourcejson"},{"title":"[source,markdown]","text":"<p>&lt;#if api.picture??&gt; </p>","location":"apim/user-guide/publisher/documentation/publish-documentation/#sourcemarkdown"},{"title":"Welcome to the API ${api.name}(${api.version})!","text":"<p>The API is &lt;span style=\"text-transform: lowercase;color: &lt;#if api.state=='STARTED'&gt;green&lt;#else&gt;red&lt;/#if&gt;\"&gt;${api.state}.</p> <p>This API has been created on ${api.createdAt?datetime} and updated on ${api.updatedAt?datetime}.</p> <p>&lt;#if api.deployedAt??&gt; This API has been deployed on ${api.deployedAt?datetime}. &lt;#else&gt; This API has not yet been deployed.</p>  <p>&lt;#if api.visibility=='PUBLIC'&gt; This API is publicly exposed. &lt;#else&gt; This API is not publicly exposed.</p>  <p>&lt;#if api.tags?has_content&gt; Sharding tags: ${api.tags?join(\", \")}</p>","location":"apim/user-guide/publisher/documentation/publish-documentation/#welcome-to-the-api-apinameapiversion"},{"title":"Description","text":"<p>${api.description}</p>","location":"apim/user-guide/publisher/documentation/publish-documentation/#description"},{"title":"How to access","text":"<p>The API can be accessed through https://api.company.com${api.proxy.contextPath}:</p> <p>curl https://api.company.com${api.proxy.contextPath}</p>","location":"apim/user-guide/publisher/documentation/publish-documentation/#how-to-access"},{"title":"Rating","text":"<p>You can rate and put a comment for this API here.</p>","location":"apim/user-guide/publisher/documentation/publish-documentation/#rating"},{"title":"Contact","text":"<p>The support contact is ${api.metadata['email-support']}.</p>","location":"apim/user-guide/publisher/documentation/publish-documentation/#contact"},{"title":"The API owner is &lt;#if api.primaryOwner.email??&gt;${api.primaryOwner.displayName}&lt;#else&gt;${api.primaryOwner.displayName}.","text":"<p>Let's see the result in APIM Portal:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/documentation/graviteeio-page-documentation-template.png %}[]</p>","location":"apim/user-guide/publisher/documentation/publish-documentation/#the-api-owner-is-if-apiprimaryowneremailapiprimaryownerdisplaynameelseapiprimaryownerdisplayname"},{"title":"Using Management APIs","text":"<p>{% assign version = site.products.apim._3x.version | split: \".\" %} {% capture current_version %}{{ version[0] }}.{{ version[1] }}{% endcapture %}</p>","location":"apim/user-guide/publisher/manage-apis/using-apis/"},{"title":"Overview","text":"<p>The following sections describes the process of creating and updating your API through our management API and provide examples of integration into a CI/CD workflow.</p>","location":"apim/user-guide/publisher/manage-apis/using-apis/#overview"},{"title":"API definition","text":"","location":"apim/user-guide/publisher/manage-apis/using-apis/#api-definition"},{"title":"What is an API definition?","text":"<p>An API definition is a JSON representation of your API and its content (e.g., plans, pages, metadata).</p>","location":"apim/user-guide/publisher/manage-apis/using-apis/#what-is-an-api-definition"},{"title":"How to get an API definition?","text":"<p>You can get the API definition by exporting it from the APIM console. Or, by using the export endpoint <code>**GET /apis/{api.id}/export**</code> (link:{{ /apim/3.x/management-api/ | relative_url | append: current_version | append: /index.html#operation/exportApiDefinition }}[API reference^]).</p>","location":"apim/user-guide/publisher/manage-apis/using-apis/#how-to-get-an-api-definition"},{"title":"What does it contain ?","text":"<p>In this definition each entity (e.i, API, plan or page) has:</p> <ul> <li>A crossId that identifies the entity (e.i, API, plan or page)     across environments: meaning that the same entity will keep its     <code>crossId</code> from one environment to another.</li> </ul> <p>You can find an API by its crossId, using the <code>getApis</code> endpoint by providing the <code>crossId</code> as a query paramater. <code>**GET /apis?crossId=my-cross-id**</code> (link:{{ /apim/3.x/management-api/ | relative_url | append: current_version | append: /index.html#operation/getApis }}[API reference^]).</p> <ul> <li>A technical id that uniquely identifies an entity in one     environment only: The same entity will have a different technical id     from one environment to another</li> </ul> <p>The API import process relies on the crossId to match entities with existing ones. The technical id is used during the import only if the crossId is not provided. For example in case of an old exported API definition.</p>","location":"apim/user-guide/publisher/manage-apis/using-apis/#what-does-it-contain"},{"title":"Import and update business rules","text":"<p>The sections below describe the business rules applied during import and update process.</p> <p>For clarity, the following terminology is used:</p> <ul> <li> <p>Imported API: the API definition you are trying to import.</p> </li> <li> <p>Target API: an API definition that may already exists in the     environment with the same <code>crossID</code> as the Imported API.</p> </li> </ul>","location":"apim/user-guide/publisher/manage-apis/using-apis/#import-and-update-business-rules"},{"title":"Plans","text":"<ul> <li> <p>Plans in Imported API that already exist in the Target API will be     updated (plan\u2019s status remains unchanged).</p> </li> <li> <p>Plans in Imported API that do not exist in the Target API will be     created.</p> </li> <li> <p>Plans without subscriptions in Target API that are not present in     the Imported API will be deleted.</p> </li> </ul>","location":"apim/user-guide/publisher/manage-apis/using-apis/#plans"},{"title":"Pages","text":"<ul> <li> <p>Pages in Imported API that already exist in the Target API will be     updated.</p> </li> <li> <p>Pages in Imported API that do not exist in the target API will be     created.</p> </li> <li> <p>Pages in Target API that are not present in the Imported API     remains unchanged.</p> </li> </ul>","location":"apim/user-guide/publisher/manage-apis/using-apis/#pages"},{"title":"Groups, Members and roles","text":"<p>Depending on your installation setup, group, members and roles will not be imported the same way.</p> <ul> <li> <p>When using the import feature to update or create an API on the same     environment, members, groups and roles can be edited, and group     memberships are preserved.</p> </li> <li> <p>When importing on another environment, groups unknown to the target     environment will be created, but their memberships will not be     preserved.</p> </li> <li> <p>When importing on another environment that runs on the same APIM     instance (same database), direct members will be preserved on the     target environment.</p> </li> <li> <p>When importing on another environment that runs on a separate APIM     instance, direct members will not be preserved and group that are     unknown to the target environment will be created without     preserving their memberships.</p> </li> </ul>","location":"apim/user-guide/publisher/manage-apis/using-apis/#groups-members-and-roles"},{"title":"Endpoints for managing your APIs","text":"<p>This section describes the different endpoints your can use to manage your APIs.</p> <p>They require the target organization and environment in the prefix: <code>/organizations/**{organization.id}**/environments/**{environment.id}**/</code></p>","location":"apim/user-guide/publisher/manage-apis/using-apis/#endpoints-for-managing-your-apis"},{"title":"Creating a new API from an API definition","text":"<p><code>**POST /api/import**</code> (link:{{ /apim/3.x/management-api/ | relative_url | append: current_version | append: /index.html#operation/importApiDefinition }}[API reference^]).</p> <p>The HTTP request body can contain :</p> <ul> <li> <p>the JSON API definition</p> </li> <li> <p>OR an HTTP link to the JSON API definition</p> </li> </ul> <p>An error is raised if an API with same crossId already exists on the target environment.</p>","location":"apim/user-guide/publisher/manage-apis/using-apis/#creating-a-new-api-from-an-api-definition"},{"title":"Exporting an existing API","text":"<p>Use the following endpoint to export an API definition:</p> <p><code>**GET /apis/{api.id}/export**</code> (link:{{ /apim/3.x/management-api/ | relative_url | append: current_version | append: /index.html#operation/exportApiDefinition }}[API reference^])</p>","location":"apim/user-guide/publisher/manage-apis/using-apis/#exporting-an-existing-api"},{"title":"Updating an existing API from an API definition","text":"<p><code>**PUT /api/import**</code> (link:{{ /apim/3.x/management-api/ | relative_url | append: current_version | append: /index.html#operation/updateWithDefinition }}[API reference^])</p> <p>This method relies on the crossId provided as part of the Imported API definition to eventually match your API to an existing API in the target environment.</p> <p>An error is raised if the crossId of the Imported API matches with an existing API on the target environment.</p> <p>Endpoint <code>**PUT /apis/{api.id}/import**</code> (link:{{ /apim/3.x/management-api/ | relative_url | append: current_version | append: /index.html#operation/updateWithDefinitionPUT }}[API reference^]) based on the technical id (passed as a path parameter) can still be used, but is no longer the recommended option.</p>","location":"apim/user-guide/publisher/manage-apis/using-apis/#updating-an-existing-api-from-an-api-definition"},{"title":"Partially update an API","text":"<p>This endpoint lets you update only a part of an existing API definition and its sub-resources.</p> <p><code>**PATCH /apis/{api.id}/definition**</code></p> <p>Refer to this link:{{ /apim/3.x/apim_publisherguide_partial_update_apis.html | relative_url}}[section^] for more details.</p>","location":"apim/user-guide/publisher/manage-apis/using-apis/#partially-update-an-api"},{"title":"CI/CD use cases examples","text":"","location":"apim/user-guide/publisher/manage-apis/using-apis/#cicd-use-cases-examples"},{"title":"Create your API on development environment","text":"<p>Create your API in development environment, using the APIM console.</p>","location":"apim/user-guide/publisher/manage-apis/using-apis/#create-your-api-on-development-environment"},{"title":"Push your API to the production environment","text":"<ul> <li> <p>Get your API definition by exporting it from APIM console, or using     the export endpoint. For example :</p> <pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X GET \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/35a1b7d4-b644-43d1-a1b7-d4b64493d134/export\n</code></pre> </li> <li> <p>On each environment you want to create your API, call the POST     endpoint. For example</p> <pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X POST \\\n     -d '{\n            \"name\": \"my-api\",\n            \"crossId\": \"3e645da6-039c-4cc0-a45d-a6039c1cc0d3\",\n            \"version\": \"1\",\n            [....]\n        }' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/import\n</code></pre> </li> </ul>","location":"apim/user-guide/publisher/manage-apis/using-apis/#push-your-api-to-the-production-environment"},{"title":"Update your API on production environment","text":"<ul> <li> <p>Update your API definition. Manually, or by re-exporting the source     API from development environment.</p> </li> <li> <p>On each environment you want to update your API, call the PUT     endpoint. For example :</p> <pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PUT \\\n     -d '{\n            \"name\": \"my-updated-api\",\n            \"crossId\": \"3e645da6-039c-4cc0-a45d-a6039c1cc0d3\",\n            \"version\": \"1\",\n            [....]\n        }' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]//management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/import\n</code></pre> </li> </ul>","location":"apim/user-guide/publisher/manage-apis/using-apis/#update-your-api-on-production-environment"},{"title":"Update your API version","text":"<ul> <li>On an API you want to update the version, call the PATCH endpoint.     For example :<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n           {\n             \"jsonPath\": \"$.version\",\n             \"value\": \"3.2.0\",\n             \"operation\": \"REPLACE\"\n           }\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition\n</code></pre> </li> </ul>","location":"apim/user-guide/publisher/manage-apis/using-apis/#update-your-api-version"},{"title":"Update the weight of specific backend","text":"<ul> <li>On an API you want to update the weight of specific backend, call     the PATCH endpoint. For example :<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n           {\n             \"jsonPath\": \"$.proxy.groups[?(@.name == 'my-group')].endpoints[?(@.name == 'my-endpoint')].weight\",\n             \"value\": \"10\",\n             \"operation\": \"REPLACE\"\n           }\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition\n</code></pre> </li> </ul>","location":"apim/user-guide/publisher/manage-apis/using-apis/#update-the-weight-of-specific-backend"},{"title":"Switch endpoint backup","text":"<ul> <li>On an API you want to switch endpoint backup, call the PATCH     endpoint. For example :<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n           {\n             \"jsonPath\": \"$.proxy.groups[?(@.name == 'my-group')].endpoints[?(@.name == 'my-endpoint')].backup\",\n             \"value\": true,\n             \"operation\": \"REPLACE\"\n           },\n          {\n             \"jsonPath\": \"$.proxy.groups[?(@.name == 'my-group')].endpoints[?(@.name == 'my-endpoint-backup')].backup\",\n             \"value\": false,\n             \"operation\": \"REPLACE\"\n          }\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition\n</code></pre> </li> </ul>","location":"apim/user-guide/publisher/manage-apis/using-apis/#switch-endpoint-backup"},{"title":"Update the target of an endpoint","text":"<ul> <li>On an API you want to update the target of an endpoint, call the     PATCH endpoint. For example :<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n           {\n             \"jsonPath\": \"$.proxy.groups[?(@.name == 'default-group')].endpoints[?(@.name == 'my-endpoint')].target\",\n             \"value\": \"https://api.gravitee.io/echo\",\n             \"operation\": \"REPLACE\"\n           }\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition\n</code></pre> </li> </ul>","location":"apim/user-guide/publisher/manage-apis/using-apis/#update-the-target-of-an-endpoint"},{"title":"Create policy flow","text":"<ul> <li>On an API you want to create a policy flow, call the PATCH endpoint.     For example :<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n           {\n             name: 'ALL',\n             methods: ['GET', 'POST', 'PUT'],\n             'path-operator': {\n               path: '/',\n             },\n             pre: [],\n             post: []\n           },\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition\n</code></pre> </li> </ul>","location":"apim/user-guide/publisher/manage-apis/using-apis/#create-policy-flow"},{"title":"Add policy to flow","text":"<ul> <li>On an API you want to add policy to flow, call the PATCH endpoint.     For example :<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n           {\n             \"jsonPath\": \"$.flows[?(@.path-operator.path == '/')].post\",\n             \"value\": {\n               policy: 'mock',\n               name: 'A mock',\n               configuration: {\n                 status: '200',\n                 content: '{ \"message\": \"This is a mock\" }',\n               },\n              },\n             \"operation\": \"ADD\"\n           }\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition\n</code></pre> </li> </ul>","location":"apim/user-guide/publisher/manage-apis/using-apis/#add-policy-to-flow"},{"title":"Update a policy configuration","text":"<ul> <li>On an API you want to update a policy configuration, call the PATCH     endpoint. For example :<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n           {\n             \"jsonPath\": \"$.flows[?(@.path-operator.path == '/')].pre[?(@.name == 'A mock')].configuration\",\n             \"value\": {\n               \"status\": \"500\",\n               \"content\": \"{#request.attributes.application}\",\n             },\n             \"operation\": \"REPLACE\"\n           }\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition\n</code></pre> </li> </ul>","location":"apim/user-guide/publisher/manage-apis/using-apis/#update-a-policy-configuration"},{"title":"Add a resource","text":"<ul> <li>On an API you want to add a resource, call the PATCH endpoint. For     example :<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n           {\n             \"jsonPath\": \"$.resources\",\n             \"value\": {\n               \"name\": \"cache_name\",\n               \"type\": \"cache\",\n               \"enabled\": false,\n               \"configuration\": {\n                 \"name\": \"my-cache\",\n                 \"timeToIdleSeconds\": 100,\n                 \"timeToLiveSeconds\": 200,\n                 \"maxEntriesLocalHeap\": 1000\n               }\n             },\n             \"operation\": \"ADD\"\n            }\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition\n</code></pre> </li> </ul>","location":"apim/user-guide/publisher/manage-apis/using-apis/#add-a-resource"},{"title":"Update a resource configuration","text":"<ul> <li>On an API you want to update a resource configuration, call the     PATCH endpoint. For example :<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n           {\n             \"jsonPath\": \"$.resources[?(@.name == 'cache_name')].enabled\",\n             \"value\": false\n           },\n           {\n             \"jsonPath\": \"$.resources[?(@.name == 'cache_name')].configuration.timeToIdleSeconds\",\n             \"value\": 1000\n           }\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition\n</code></pre> </li> </ul>","location":"apim/user-guide/publisher/manage-apis/using-apis/#update-a-resource-configuration"},{"title":"Set properties if not exist","text":"<ul> <li>On an API you want to set all properties if not exist, call the     PATCH endpoint. For example :<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n           {\n             \"jsonPath\": \"$.properties\",\n             \"value\": \"null\",\n             \"operation\": \"TEST\"\n           },\n           {\n             \"jsonPath\": \"$.properties\",\n             \"value\": [\n                { key: 'properties_1', value: 'my_property_value_1' },\n                { key: 'properties_2', value: 'my_property_value_2' },\n             ],\n             \"operation\": \"REPLACE\"\n           }\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition\n</code></pre> </li> </ul>","location":"apim/user-guide/publisher/manage-apis/using-apis/#set-properties-if-not-exist"},{"title":"Remove a property with key","text":"<ul> <li>On an API you want to remove a property, call the PATCH endpoint.     For example :<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n           {\n             \"jsonPath\": \"$.properties[?(@.key == 'properties_1')]\",\n             \"operation\": \"REMOVE\"\n           }\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition\n</code></pre> </li> </ul>","location":"apim/user-guide/publisher/manage-apis/using-apis/#remove-a-property-with-key"},{"title":"Check the update of version","text":"<ul> <li>On an API you want to check the update of version, call the PATCH     endpoint. For example :<pre><code>curl -H \"Authorization: Bearer MY-ACCESS-TOKEN\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X PATCH \\\n     -d '[\n           {\n             \"jsonPath\": \"$.version\",\n             \"value\": \"3.2.0\",\n             \"operation\": \"REPLACE\"\n           }\n         ]' \\\n     https://[GRAVITEEIO-APIM-MGT-API-HOST]/management/organizations/[ORGANIZATION_ID]/environments/[ENVIRONMENT_ID]/apis/[API_ID]/definition?dryRun=true\n</code></pre> </li> </ul>","location":"apim/user-guide/publisher/manage-apis/using-apis/#check-the-update-of-version"},{"title":"Overview","text":"<p>The following sections describe the different ways you can create an API using APIM Console.</p> <p>For a quick introduction to creating an API in APIM, see the link:{{ /apim/3.x/apim_quickstart_publish_ui.html | relative_url }}[Quick Start Guide^].</p> <p>From APIM 3.5.x, the recommended way to create an API is using the DESIGN STUDIO method described in the next section. For APIs created using this method, clicking the Design menu option automatically opens Design Studio. Old API definitions or APIs created using the PATH BASED option must be migrated before you can update them in Design Studio. For more information, see the link:{{ /apim/3.x/apim_publisherguide_design_studio_overview.html | relative_url }}[Design Studio Guide^].</p>","location":"apim/user-guide/publisher/manage-apis/using-console/"},{"title":"Get started","text":"<p>Using APIM Console, you can create new API definitions from scratch, or import existing definitions.</p> <p>You can also create APIs using APIM API. For more details, see the link:{{ /apim/3.x/apim_quickstart_publish_api.html | relative_url }}[Quick Start Guide^].</p> <p>To start creating an API:</p> <ol> <li> <p>In APIM Console, click APIs.</p> </li> <li> <p>Click the plus icon image:{% link images/icons/plus-icon.png     %}[role=\"icon\"] at the bottom right of the page.</p> <p>image::{% link images/apim/3.10/apim-console-create-api.png %}[Create API]</p> <p>APIM presents you with two options for creating APIs. The recommended option is DESIGN STUDIO.</p> <p>image::{% link images/apim/3.x/quickstart/publish/graviteeio-create-api-2.png %}[]</p> </li> <li> <p>Under DESIGN STUDIO, click:</p> <ul> <li> <p>CREATE to create an API from scratch.</p> <p>Learn how to ???</p> </li> <li> <p>IMPORT to import an external API definition.</p> <p>Learn how to ???</p> </li> </ul> </li> </ol>","location":"apim/user-guide/publisher/manage-apis/using-console/#get-started"},{"title":"Create an API from scratch","text":"<p>These steps describe how to create all of the basic API configuration your developers need to call your API. If a short TTFAC (time to first API call) is your goal, configure only the mandatory parts and a basic plan now\u2009\u2014\u2009you can always update these later on.</p> <p>You need to create a plan before you can accept user subscriptions to your API. You can do that now or when you get to the link:{{ /apim/3.x/apim_publisherguide_plans_subscriptions.html | relative_url }}[Plans and subscriptions^] section, but the plan options available to you now are more limited.</p> <ol> <li> <p>Enter the general details of the API:</p> <ul> <li> <p>A Name, Version, and Description.</p> </li> <li> <p>The Context-path where the API will be exposed on APIM     Gateway, starting from /.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/create-api-general-withgroups.png %}[]</p> </li> </ul> </li> <li> <p>(Optional) Associate a group with the API, if any are defined (see     link:{{ /apim/3.x/apim_adminguide_users_and_groups.html |     relative_url }}[Users and Groups] for more details):</p> <ul> <li> <p>Select a group which can access the API in Groups.</p> </li> <li> <p>If the link:{{     /apim/3.x/apim_adminguide_users_and_groups.html#primary_owner_mode     | relative_url }}[Primary owner mode^] is HYBRID, click     the Advanced mode link to associate a primary owner group.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-api-primaryowner-mode-3.png %}[]</p> </li> </ul> </li> <li> <p>Click NEXT.</p> </li> <li> <p>Enter the details of the gateway:</p> <ul> <li> <p>A backend URL for receiving API calls.</p> </li> <li> <p>(Optional) Click the Advanced mode link to specify details     of tenants and sharding tags.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/create-api-gateway.png %}[]</p> </li> </ul> </li> <li> <p>Click NEXT.</p> </li> <li> <p>(Optional) If you want to create a plan for the API, enter the     following details and click NEXT, otherwise click SKIP:</p> <ul> <li> <p>The Name, Security type, and Description.</p> </li> <li> <p>If subscription auto-validation is required, toggle on the     Auto validate subscription option.</p> </li> <li> <p>The Characteristics.</p> </li> <li> <p>Rate limit and Quota details. In this example, we are     specifying a rate limit of 1 request every 5 seconds.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/create-api-plan1.png %}[] * Resource filtering details, using link:{{ /apim/3.x/apim_policies_overview.html#ant-notation | relative_url }}[Ant^] notation and an HTTP method.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/create-api-plan-path.png %}[]</p> </li> </ul> </li> <li> <p>(Optional) Import a documentation specification file, otherwise     click SKIP.</p> </li> <li> <p>Review the details of the API, then click one of the following     options, depending on whether you want to create and deploy the API     or simply create it:</p> <ul> <li> <p>CREATE THE API WITHOUT DEPLOYING IT</p> </li> <li> <p>CREATE AND START THE API</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/create-api-confirm.png %}[]</p> </li> </ul> </li> </ol>","location":"apim/user-guide/publisher/manage-apis/using-console/#create-an-api-from-scratch"},{"title":"Import an API definition","text":"<p>You can import external API definitions using one of the following methods.</p>","location":"apim/user-guide/publisher/manage-apis/using-console/#import-an-api-definition"},{"title":"Import an existing API definition","text":"<p>You can import and export your APIs to a Gravitee API definition format (see the example below).</p> <p>To import an API from an API definition:</p> <ul> <li>If the definition is a file, select IMPORT FILE and browse your     file system to select it.</li> </ul> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-import-definition-file.png %}[Import from definition file, 300]</p> <ul> <li>If the definition is a link, select IMPORT FROM LINK, then     choose API Definition and enter the definition URL.</li> </ul> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-import-definition-link.png %}[Import from definition link, 300]</p> <p>Learn more about API definition import process link:{% link pages/apim/3.x/user-guide/publisher/import-apis.adoc %}[here].</p>","location":"apim/user-guide/publisher/manage-apis/using-console/#import-an-existing-api-definition"},{"title":"Import an OpenAPI specification","text":"<p>One of the most powerful features of APIM is its ability to import an OpenAPI specification to create an API. When you import an existing specification you do not have to complete all the fields required when you create a new API.</p> <p>To import an API from OpenAPI:</p> <ul> <li>If the OpenAPI specification is a file, select IMPORT FILE and     browse your file system to select it.</li> </ul> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-import-openapi-file.png %}[Import from definition file, 300]</p> <ul> <li>If the OpenAPI specification is a link, select IMPORT FROM LINK,     choose Swagger / OpenAPI and enter the definition URL.</li> </ul> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-import-openapi-link.png %}[Import from definition link, 300]</p>","location":"apim/user-guide/publisher/manage-apis/using-console/#import-an-openapi-specification"},{"title":"How the context-path is determined","text":"<p>Specification version</p> <p>Definition</p> <p>Example</p> <p>Context-path</p>   <p>Swagger (V2)</p> <p><code>basePath</code> field, if it exists.</p> <pre><code>{\n  \"swagger\": \"2.0\",\n  \"info\": {\n    \"description\": \"...\",\n    \"version\": \"1.0.5\",\n    \"title\": \"Swagger Petstore\"\n  },\n  \"host\": \"petstore.swagger.io\",\n  \"basePath\": \"/v2\",\n  ...\n}</code></pre> <p>/v2</p>   <p>If not, lowercase trimmed <code>info.title</code>.</p> <pre><code>{\n  \"swagger\": \"2.0\",\n  \"info\": {\n    \"description\": \"...\",\n    \"version\": \"1.0.5\",\n    \"title\": \"Swagger Petstore\"\n  },\n  \"host\": \"petstore.swagger.io\",\n\n  ...\n}</code></pre> <p>/swaggerpetstore</p>    <p>OpenAPI (V3)</p> <p>Path of the first <code>servers.url</code>, if it exists, without \"/\". </p> <pre><code>openapi: \"3.0.0\"\ninfo:\n  version: 1.0.0\n  title: Swagger Petstore\n  license:\n    name: MIT\nservers:\n  - url: http://petstore.swagger.io/v1\npaths:\n...</code></pre> <p>/v1</p>   <p>If not, lowercase trimmed <code>info.title</code>.</p> <pre><code>openapi: \"3.0.0\"\ninfo:\n  version: 1.0.0\n  title: Swagger Petstore\n  license:\n    name: MIT\nservers:\n  - url: http://petstore.swagger.io/\npaths:\n  ...</code></pre> <p>/swaggerpetstore</p>","location":"apim/user-guide/publisher/manage-apis/using-console/#how-the-context-path-is-determined"},{"title":"Vendor extensions","text":"<p>You can use a vendor extension to add more information to OpenAPI specifications about your API. To do this, you need to add the <code>x-graviteeio-definition</code> field at the root of the specification. The value of this field is an <code>object</code> that follows this JSON Schema^</p> <ul> <li> <p><code>categories</code> must contain either a key or an id. Only existing     categories are imported.</p> </li> <li> <p>Import will fail if <code>virtualHosts</code> are already in use by other     APIs.</p> </li> <li> <p>If set, <code>virtualHosts</code> will override <code>contextPath</code>.</p> </li> <li> <p><code>groups</code> must contain group names. Only existing groups are     imported.</p> </li> <li> <p><code>metadata.format</code> is case-sensitive. Possible values are:</p> <ul> <li> <p>STRING</p> </li> <li> <p>NUMERIC</p> </li> <li> <p>BOOLEAN</p> </li> <li> <p>DATE</p> </li> <li> <p>MAIL</p> </li> <li> <p>URL</p> </li> </ul> </li> <li> <p><code>picture</code> only accepts Data-URI format (see example below).</p> </li> </ul> <p>Here is an example: ```yaml openapi: \"3.0.0\" info: version: 1.2.3 title: Gravitee.io Echo API license: name: MIT servers: - url: https://demo.gravitee.io/gateway/echo x-graviteeio-definition: categories: - supplier - product virtualHosts: - host: api.gravitee.io path: /echo overrideEntrypoint: true groups: - myGroupName labels: - echo - api metadata: - name: relatedLink value: http://external.link format: URL picture: data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 properties: - key: customHttpHeader value: X-MYCOMPANY-ID tags: - DMZ - partner - internal visibility: PRIVATE paths: \u2026 ```</p>","location":"apim/user-guide/publisher/manage-apis/using-console/#vendor-extensions"},{"title":"Policies on path","text":"<p>When importing an OpenAPI definition, you can select the option Create policies on path in the import form. This specifies that all routes declared in the OpenAPI specification are to be automatically created in APIM. You can navigate to the policy management view to check.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-import-openapi-policies-path.png %}[Policies view - all routes imported]</p> <p>You can also choose to activate policies that will be configured using the OpenAPI specification.</p> <p>JSON Validation For each operation, if an <code>application/json</code> request body exists, then a JSON schema is computed from this body to configure a JSON Validation policy. REQUEST only More information is available link:{{ /apim/3.x/apim_policies_json_validation.html | relative_url }}[here].</p> <p>REST to SOAP transformer For each operation, if the definition contains some specific vendor extensions, a REST to SOAP policy can be configured. These extensions are:</p> <ul> <li> <p><code>x-graviteeio-soap-envelope</code>: contains the SOAP envelope</p> </li> <li> <p><code>x-graviteeio-soap-action</code>: contains the SOAP action</p> <p>REQUEST only More information is available link:{{ /apim/3.x/apim_policies_rest2soap.html | relative_url }}[here].</p> </li> </ul> <p>Mock For each operation, a mock policy is configured, based on the <code>example</code> field if it exists, or by generating a random value for the type of the attribute to mock. REQUEST only More information is available link:{{ /apim/3.x/apim_policies_mock.html | relative_url }}[here].</p> <p>Validation Request For each operation, <code>NOT__ __NULL</code> rules are created with query parameters and headers. REQUEST only More information is available link:{{ /apim/3.x/apim_policies_request_validation.html | relative_url }}[here]-</p> <p>XML Validation For each operation, if a <code>application/xml</code> request body exists, then a XSD schema is computed from this body to configure an XML Validation policy. REQUEST only More information is available link:{{ /apim/3.x/apim_policies_xml_validation.html | relative_url }}[here].</p>","location":"apim/user-guide/publisher/manage-apis/using-console/#policies-on-path"},{"title":"Import a WSDL","text":"<p>APIM can import a WSDL to create an API. This means you do not have to declare all the routing and policies to interact with your service.</p> <p>To import an API from a WSDL:</p> <ul> <li> <p>If the WSDL is a file, select IMPORT FILE and browse your file     system to select it.</p> </li> <li> <p>If the WSDL is a link, select IMPORT FROM LINK, choose WSDL     and enter the definition URL.</p> </li> </ul> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-import-wsdl-rest-to-soap-options.png %}[Import from WSDL link]</p> <p>If you select the option Apply REST to SOAP Transformer policy in addition to the option Create policies on path in the import form, a REST-To-SOAP policy will be generated for each path. These policies provide a SOAP envelope for each method with sample data that you can change using expression language. An XML-to-JSON policy will also be generated to convert the entire SOAP response to JSON format.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-import-wsdl-rest-to-soap-policy.png %}[WSDL REST to SOAP policy]</p>","location":"apim/user-guide/publisher/manage-apis/using-console/#import-a-wsdl"},{"title":"Manage your API","text":"<p>The API is created private, so it is only accessible in APIM Portal to users after you:</p> <ul> <li> <p>Publish it</p> </li> <li> <p>Make it public or add new members or groups to it</p> </li> </ul> <p>The process for adding new members or groups to the API is explained in link:{{ /apim/3.x/apim_publisherguide_manage_members.html | relative_url }}[API users and ownership^].</p> <p>You can publish the API or make it public, as well as remove it from APIM Portal or delete it, in the Danger Zone:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/danger-zone.png %}[]</p>","location":"apim/user-guide/publisher/manage-apis/using-console/#manage-your-api"},{"title":"Organize your APIs into categories","text":"<p>You can create categories to group APIs. The purpose of categories is to group APIs so consumers can easily find the APIs they need in APIM Portal.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-manage-apis-categories-1.png %}[]</p> <p>You can describe a category with the following characteristics:</p> <ul> <li> <p>Name</p> </li> <li> <p>Description</p> </li> <li> <p>Picture</p> </li> <li> <p>Markdown page as documentation</p> </li> </ul> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-manage-apis-categories-2.png %}[]</p> <p>Once you have finished describing the category, you select the APIs you want to include in it.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-manage-apis-categories-3.png %}[]</p> <p>You can also choose to highlight a particular API. This API will be shown at the top of the category page.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-manage-apis-categories-4.png %}[] image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-manage-apis-categories-4.png %}[] The next time you enter labels for an API, APIM Console makes suggestions based on your registered labels.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-manage-apis-labels-2.png %}[]</p> <p>You can search for APIs by label.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/manage-apis/graviteeio-manage-apis-labels-3.png %}[]</p>","location":"apim/user-guide/publisher/manage-apis/using-console/#organize-your-apis-into-categories"},{"title":"Create a plan","text":"<p>There are two ways to create a plan in APIM.</p>","location":"apim/user-guide/publisher/plans/create-plan/"},{"title":"Create a plan when you create your API","text":"<p>You can create a plan as part of creating an API.</p> <p>image::{% link images/apim/3.10/create-api-plan.png %}[]</p> <p>Learn more about creating plans using this method in link:{{ /apim/3.x/apim_publisherguide_create_apis.html | relative_url }}[Create APIs^].</p> <p>Plans you create as part of the API creation process are more limited in scope than plans created using the method below. You can use this method to get up and running quickly, then go back and update the plan later if needed.</p>","location":"apim/user-guide/publisher/plans/create-plan/#create-a-plan-when-you-create-your-api"},{"title":"Create or update a plan for an existing API","text":"<p>You can select an existing API and create or update plans for it.</p> <p>image::{% link images/apim/3.10/create-existing-plan.png %}[]</p> <p>To create or update a plan for an existing API:</p> <ol> <li> <p>Click APIs and select your API.</p> </li> <li> <p>Click Portal &gt; Plans.</p> </li> <li> <p>Click the edit icon image:{% link images/icons/edit-icon.png     %}[role=\"icon\"] on an existing plan, or click the plus icon     image:{% link images/icons/plus-icon.png %}[role=\"icon\"] at the     bottom of the Plans page.</p> </li> <li> <p>On the Define page, enter the plan definition:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/create-plan-define.png %}[] .. Enter a name and description. .. In Characteristics, enter labels you want to use to tag the plan. .. Select a page containing the general conditions of use.</p> <p>You must create the page first. Learn more about link:{{ /apim/3.x/apim_publisherguide_plan_general_conditions.html#create_a_general_conditions_page | relative_url }}[creating a general conditions of use page]</p> <ol> <li> <p>If you want subscriptions to be validated without manual     intervention, toggle on the Auto validate subscription     option.</p> </li> <li> <p>If you require consumers to provide a comment when subscribing     to the plan, toggle on the Consumer must provide a comment     when subscribing to the plan option. You can also provide a     custom message to display to consumers (for example, ask them to     provide specific information in their comment).</p> </li> <li> <p>In Deployment, enter details of sharding tags.</p> </li> <li> <p>In Access Control, select groups which are not allowed to     subscribe to the plan.</p> </li> </ol> </li> <li> <p>Click NEXT to link:{{     /apim/3.x/apim_publisherguide_plan_security.html#configure_security     | relative_url }}[configure plan security].</p> </li> </ol>","location":"apim/user-guide/publisher/plans/create-plan/#create-or-update-a-plan-for-an-existing-api"},{"title":"Overview","text":"<p>You can provide general conditions of use for a plan. These conditions must be accepted by the user to finalize the subscription process.</p> <p>To associate general conditions of use with a plan, you need to specify a markdown page where these conditions are specified.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/add-general-conditions.png %}[]</p> <p>Plans with general conditions are identified by a <code>With general conditions</code> label.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/general-conditions-plans.png %}[]</p> <p>Users can only subscribe to plans with general conditions through APIM Portal.</p>","location":"apim/user-guide/publisher/plans/plan-general-conditions/"},{"title":"Create a general conditions page","text":"<ol> <li> <p>In APIM Console, select your API and click Pages.</p> </li> <li> <p>Create a Markdown page with the required general conditions content.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/gcu-page.png %}[]</p> <p>link:{{ /apim/3.x/apim_publisherguide_publish_documentation.html#create_a_new_page | relative_url }}[Learn more about creating Markdown pages]</p> <p>The page is available when you create the plan:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/plan-gcu-page.png %}[]</p> </li> </ol>","location":"apim/user-guide/publisher/plans/plan-general-conditions/#create-a-general-conditions-page"},{"title":"Configure plan flows and policies","text":"<p>From APIM 3.5.x, the recommended method for adding policies to plans is with link:{{ /apim/3.x/apim_publisherguide_design_studio_create.html#flow-policies | relative_url }}[Design Studio^].</p>","location":"apim/user-guide/publisher/plans/plan-policies/"},{"title":"Configure flows and policies in Design Studio","text":"<ol> <li> <p>Find your plan in the Plans page of the API.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/staging-plan.png %}[] . Click the design icon image:{% link images/icons/design-icon.png %}[role=\"icon\"].</p> <p>APIM opens the plan in Design Studio, where you can configure flows and policies, as described in the link:{{ /apim/3.x/apim_publisherguide_design_studio_create.html | relative_url }}[Design Studio Guide].</p> </li> </ol>","location":"apim/user-guide/publisher/plans/plan-policies/#configure-flows-and-policies-in-design-studio"},{"title":"Configure policies on the Policies page of a plan","text":"<p>In some APIs created in earlier versions of APIM, you configure policies on the Policies page of a new or existing plan. You can configure a single policy, or a chain of policies. Policy chains can be of the same or different types.</p> <ol> <li> <p>To edit an existing plan:</p> <ol> <li> <p>In APIM Console, select your API.</p> </li> <li> <p>Click Portal &gt; Plans.</p> </li> <li> <p>Click the edit icon image:{% link images/icons/edit-icon.png     %}[role=\"icon\"]. On the Policies page:</p> </li> <li> <p>Choose a policy type from the list and click ADD.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/add-plan-policies.png %}[]</p> </li> <li> <p>Depending on the policy type, specify any other required details     of the policy.</p> </li> <li> <p>If you want to create a policy chain, repeat the same steps for     each policy in the chain.</p> </li> </ol> </li> <li> <p>Click SAVE to save your plan.</p> </li> </ol>","location":"apim/user-guide/publisher/plans/plan-policies/#configure-policies-on-the-policies-page-of-a-plan"},{"title":"Plan states","text":"<ul> <li> <p>Staging - It\u2019s the first state of a plan, it is a draft mode.     You can configure your plan but it won\u2019t be accessible to users.</p> </li> <li> <p>Published - Once your plan is ready, you can publish it (view     section below to learn how to publish a plan) to let API consumers     view and subscribe on the APIM Portal and consume API through it. A     published plan can still be edited.</p> </li> <li> <p>Deprecated - You can deprecate a plan so it won\u2019t be available     on the APIM portal and API Consumers won\u2019t be able to subscribe to     it. Existing subscriptions remains so it doesn\u2019t impact your     existing API consumers.</p> </li> <li> <p>Closed - Once a plan is closed, all associated subscriptions are     closed too. This can not be undone. API consumers subscribed to this     plan won\u2019t be able to use your API.</p> </li> </ul>","location":"apim/user-guide/publisher/plans/plan-publish/"},{"title":"Plan lifecycle","text":"<p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/plan-lifecycle.png %}[]</p> <p>A plan can not be moved back to a previous state.</p> <p>You need to close all published or deprecated plans before deleting an API.</p>","location":"apim/user-guide/publisher/plans/plan-publish/#plan-lifecycle"},{"title":"Publish a plan","text":"<ol> <li> <p>On the Plans page, go to the Staging tab.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/staging-plan.png %}[] . Click the publish icon image:{% link images/icons/publish-icon.png %}[role=\"icon\"]. . Click PUBLISH.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/plan-publish-confirm.png %}[]</p> <p>APIM publishes the plan. Published plans can be viewed in the Published tab:</p> </li> </ol> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/plan-published.png %}[]</p>","location":"apim/user-guide/publisher/plans/plan-publish/#publish-a-plan"},{"title":"Overview","text":"<p>You can configure some more advanced features to restrict plans.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/add-plan-restrictions.png %}[]</p>","location":"apim/user-guide/publisher/plans/plan-restrictions/"},{"title":"Configure restrictions","text":"<p>You configure restrictions on the Restrictions page of a new or existing plan.</p> <ol> <li> <p>To edit an existing plan:</p> <ol> <li> <p>In APIM Console, select your API.</p> </li> <li> <p>Click Portal &gt; Plans.</p> </li> <li> <p>Click the edit icon image::{% link images/icons/edit-icon.png     %}[role=\"icon\"]</p> </li> </ol> </li> <li> <p>On the Restrictions page, configure the restrictions for the     plan, as described in the sections below.</p> </li> <li> <p>Click SAVE to save your plan.</p> <p>For some APIs created in earlier versions of APIM, you can click NEXT to configure plan policies.</p> <p>APIM adds the plan to the list of Staging plans.</p> </li> </ol> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/staging-plan.png %}[]</p> <p>You can now: * link:{{ /apim/3.x/apim_publisherguide_plan_policies.html | relative_url }}[Configure flows and policies for your plan]. * link:{{ /apim/3.x/apim_publisherguide_plan_publish.html | relative_url }}[Publish your plan]</p>","location":"apim/user-guide/publisher/plans/plan-restrictions/#configure-restrictions"},{"title":"Limit request traffic","text":"<p>Plans provide tools for maintaining and optimizing traffic management and protecting the health of the API backend.</p>","location":"apim/user-guide/publisher/plans/plan-restrictions/#limit-request-traffic"},{"title":"Rate-limiting","text":"<p>You can rate limit how many HTTP requests an application can make in a specified period of seconds or minutes.</p> <p>In the following example, the plan enforces a limit of 1000 requests per minute:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/create-plan-rate-limit.png %}[]</p> <p>Rate-limiting helps you prevent sudden increases in the number of requests at any point in time.</p>","location":"apim/user-guide/publisher/plans/plan-restrictions/#rate-limiting"},{"title":"Quotas","text":"<p>A quota specifies the number of requests allowed to call an API backend during a specified time interval.</p> <p>In the following example, the plan enforces a limit of 100000 requests per day:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/create-plan-quota.png %}[]</p> <p>You can use quotas to enforce business or financial requirements to limit the number of calls partner or third-party apps can make in a period of time.</p>","location":"apim/user-guide/publisher/plans/plan-restrictions/#quotas"},{"title":"Resource filtering","text":"<p>You can use resource filtering to limit access to a subset of API resources.</p> <p>In the following example, the plan only allows GET requests:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/create-plan-path-authorization.png %}[]</p> <p>You can use resource filtering to make an API read-only for public members and give premium members access to more resources.</p>","location":"apim/user-guide/publisher/plans/plan-restrictions/#resource-filtering"},{"title":"Configure plan security","text":"<p>= Configure plan security :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_publisherguide_plan_security.html :page-folder: apim/user-guide/publisher :page-keywords: Gravitee.io, API Platform, API Management, API Gateway, documentation, manual, guide, reference, api, CGU, GCU :page-layout: apim3x</p> <p>== Overview</p> <p>You configure the level of security required for accessing your API in your plan. APIM supports the following four security types:</p> <ul> <li>Keyless (public)</li> <li>API Key</li> <li>OAuth 2.0</li> <li>JWT</li> </ul> <p>== Configure security</p> <p>You can find examples of configuring OAuth2 security and JTW security in the following sections:</p> <ul> <li>&lt;&gt; <li>&lt;&gt;  <p>You configure security on the Secure page of a new or existing plan.</p> <p>. To edit an existing plan:   .. In APIM Console, select your API.   .. Click Portal &gt; Plans.   .. Click the edit icon image:{% link images/icons/edit-icon.png %}[role=\"icon\"] . On the Secure page, configure the type of security you require for your plan, as described in the sections below. + image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/create-plan-secure.png %}[] . Click NEXT to link:{{ '/apim/3.x/apim_publisherguide_plan_restrictions.html' | relative_url }}[configure plan restrictions].</p> <p>=== Keyless plans</p> <p>Keyless plans allow public access to the API and bypass any security mechanisms on the whole request process.</p> <p>By default, keyless plans offer no security and are most useful for quickly and easily exposing your API to external users and getting their feedback. Due to the lack of consumer identifier token (API key), keyless consumers are set as <code>unknown application</code> in the API analytics section.</p> <p>==== Basic authentication</p> <p>You can configure basic authentication for keyless plans, by associating a basic authentication policy with either an LDAP or inline resource. For more details, see link:{{ '/apim/3.x/apim_policies_basic_authentication.html' | relative_url }}[Basic authentication policy^].</p> <p>=== API key plans</p> <p>You use API key plans to enforce verification of API keys during request processing, allowing only apps with approved API keys to access your APIs. This plan type ensures that API keys are valid, are not revoked or expired and are approved to consume the specific resources associated with your API.</p> <p>API key plans offer only a basic level of security, acting more as a unique identifier than a security token, since the API key can easily be found in the app code. For a higher level of security, see OAuth 2.0 and JWT plans.</p> <p>==== Use a custom API key</p> <p>You can specify a custom API key for an API key plan. This is particularly useful when you want to silently migrate to APIM and have a pre-defined API key.</p> <p>NOTE: The custom API key feature can be enabled in the global settings of APIM.</p> <p>The custom API key must have more than 8 characters, less than 64 characters and be URL compliant (^ # % @  / ; = ? | ~ , (space) are all invalid characters).</p> <p>When prompted, you can choose to provide your custom API key or let APIM generate one for you by leaving the field empty.</p> <p>You can provide a custom API key when:</p> <ul> <li>creating a subscription:</li> </ul> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/custom-api-key-1.png %}[]</p> <ul> <li>accepting a subscription:</li> </ul> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/custom-api-key-2.png %}[]</p> <ul> <li>renewing a subscription:</li> </ul> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/custom-api-key-3.png %}[]</p> <p>==== Use a shared API key</p> <p>The shared API key mode makes consumers reuse the same API key across all API subscriptions of an application.</p> <p>This mode can be enabled in environment settings:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/shared-api-key-1.png %}[]</p> <p>With this mode enabled, consumers will be asked on their second subscription to choose between reusing their key across all subscriptions or generate one different API key for each subscription (which is the default mode).</p> <p>.When subscribing in the console image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/shared-api-key-2.png %}[] .When subscribing in the portal image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/shared-api-key-2-portal.png %}[]</p> <p>This choice is permanent and consumers will not be able to switch back to one key per subscription for their application.</p> <p>NOTE: When disabling the shared API key mode in environment settings, applications that have already been configured to use a shared key will continue to work this way, but consumers will stop being asked to choose between one mode or the other on their second subscription.</p> <p>NOTE: For technical reasons, in shared mode, API keys can only be shared across API key plans that belong to distinct APIs. This means that if subscribing to two API key plans on the same API while creating an application, no prompt will be made to choose for a mode and the default mode will be used automatically.</p> <p>Because they may be used to call APIs that are owned by another group of publishers, shared API keys cannot be edited from the API publisher subscription view. This means that while they are still readable, renewal and revocation of shared API keys cannot be performed by the API publisher when a subscription has been made in shared mode.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/shared-api-key-3.png %}[]</p> <p>Instead, it is the responsability of the application owner to perform such operations, and for this reason, shared API keys can only be revoked from the application owner subscription view.</p> <p>.Manage your shared API in the console image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/shared-api-key-4.png %}[] .Manage your shared API in the portal image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/shared-api-key-4-portal.png %}[]</p> <p>=== OAuth 2.0 plans</p> <p>To configure an OAuth 2.0 plan for an API, you need to:</p> <ul> <li>create an OAuth 2.0 client resource that represents your OAuth 2.0 authorization server</li> <li>create a new plan for it or apply it to an existing plan</li> </ul> <p>==== Create and specify an OAuth 2.0 authorization server</p> <p>NOTE: The instructions below explain how to create an OAuth 2.0 resource in Design Studio. For APIs not migrated to Design Studio, you can create resources with the Design &gt; Resources menu option.</p> <p>. Open your API in APIM Console and click Design. . Click the RESOURCES tab and create a new Generic OAuth2 Authorization Server resource. + NOTE: If you use https://gravitee.io/[Gravitee.io Access Management], we provide a dedicated OAuth 2.0 AM resource. + image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/create-oauth2-resource.png %}[Gravitee.io - Create OAuth 2.0 resource, 873, 530, align=center, title-align=center]</p> <p>. Enter the Resource name. . Set the OAuth 2.0 Authorization server URL. . Set the https://tools.ietf.org/html/rfc7662[Token introspection endpoint^] URI with the correct HTTP method and https://tools.ietf.org/html/rfc6749#section-3.3[scope^] delimiter. . Enter the Scope separator. . If you want to retrieve consented claims about the end user, enter the http://openid.net/specs/openid-connect-core-1_0.html#UserInfo[UserInfo Endpoint^] URI. . Enter the Client Id and Client Secret used for token introspection. + NOTE: Why do I need this? As defined in https://tools.ietf.org/html/rfc7662#section-2.1[RFC 7662^], to prevent token scanning attacks, the introspection endpoint must also require some form of authorization to access this endpoint, such as client authentication.</p> <p>. Enter any other required information, then click the tick icon image:{% link images/icons/tick-icon.png %}[role=\"icon\"]. . Click SAVE to save the resource.</p> <p>==== Add OAuth 2.0 security to a plan</p> <p>NOTE: If you already have a suitable plan defined, you can add your OAuth2 resource to one of the flows defined for it in Design Studio, by following the steps in link:{{ '/apim/3.x/apim_publisherguide_design_studio_create.html#flow-policies' | relative_url }}[Add policies to a flow^].</p> <p>. In APIM Console, select your API and click Portal &gt; Plans. . On the Secure page, choose OAuth2 as the authorization type. . Specify the OAuth2 resource name you created and check any https://tools.ietf.org/html/rfc6749#section-3.3[scopes^] to access the API. + image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/create-oauth2-plan.png %}[]</p> <p>Your API is now OAuth 2.0 secured and consumers must call the API with an <code>Authorization Bearer :token:</code> HTTP header to access the API resources.</p> <p>IMPORTANT: Any applications wanting to subscribe to an OAuth 2.0 plan must have an existing client with a valid <code>client_id</code> registered in the OAuth 2.0 authorization server. The <code>client_id</code> will be used to establish a connection between the OAuth 2.0 client and the APIM consumer application.</p> <p>=== JSON Web Tokens (JWT) plans</p> <p>JWT plans ensure that JWT tokens issued by third parties are valid. Only apps with approved JWT tokens can access APIs associated with a JWT plan.</p> <p>https://tools.ietf.org/html/rfc7519[JSON Web Tokens] are an open method for representing claims securely between two parties. JWT are digitally-signed using HMAC shared keys or RSA public/private key pairs. JWT plans allow you to verify the signature of the JWT and check if the JWT is still valid according to its expiry date.</p> <p>NOTE: JWT define some https://tools.ietf.org/html/rfc7519#section-4.1[registered claim names] including subject, issuer, audience, expiration time and not-before time. In addition to these claims, the inbound JWT payload must include the <code>client_id</code> claim (see below) to establish a connection between the JWT and the APIM application subscription.</p> <p>The policy searches for a client ID in the payload as follows:</p> <ul> <li>First in the <code>azp</code> claim</li> <li>Next in the <code>aud</code> claim</li> <li>Finally in the <code>client_id</code> claim</li> </ul> <p>==== Add JWT security to a plan</p> <p>. In APIM Console, select your API and click Portal &gt; Plans. . On the Secure page, choose JWT as the authorization type. . Specify the public key used to verify the incoming JWT token. + NOTE: You can also set the public key in the <code>gravitee.yml</code> file. See link:{{ '/apim/3.x/apim_policies_jwt.html' | relative_url }}[JWT policy] for more information. APIM only supports the RSA Public Key format. + image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/create-jwt-plan.png %}[]</p> <p>Your API is now JWT secured and consumers must call the API with an <code>Authorization Bearer :JWT Token:</code> HTTP header to access the API resources.</p>","location":"apim/user-guide/publisher/plans/plan-security/"},{"title":"Overview","text":"<p>Consumers use plans to request subscriptions and access your APIs. They subscribe to plans in APIM Portal:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/plans-subscriptions.png %}[]</p> <p>The following sections describe how to manage subscription requests from consumers.</p>","location":"apim/user-guide/publisher/plans/plan-subscriptions/"},{"title":"Approve a subscription","text":"<p>When publishers create new plans, they can specify auto validation of subscriptions, so consumers are ready to access the API as soon as they subscribe to the plan. If you set manual approval on a plan, however, you must approve subscriptions by following these steps.</p> <p>You can enable mail or portal notifications so you can be notified when a subscription validation task requires your attention.</p> <ol> <li> <p>Go to your API in APIM Management and click Portal &gt;     Subscriptions.</p> </li> <li> <p>Select the Pending subscription.</p> </li> <li> <p>Click ACCEPT, then enter the start and end dates (no end date     means forever) of subscription approval.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/approve-subscription.png %}[]</p> </li> </ol>","location":"apim/user-guide/publisher/plans/plan-subscriptions/#approve-a-subscription"},{"title":"Revoke a subscription","text":"<p>You can revoke a subscription to remove access to APIs.</p> <ol> <li> <p>Go to your API in APIM Management and click Portal &gt;     Subscriptions.</p> </li> <li> <p>Select the subscription you want to revoke and click CLOSE.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/revoke-subscription.png %}[]</p> </li> </ol>","location":"apim/user-guide/publisher/plans/plan-subscriptions/#revoke-a-subscription"},{"title":"Overview","text":"<p>Once an API is registered and made public, you can manage subscriptions to it through APIM plans. Managing subscriptions and plans is a key feature of APIM that publishers can use to provide and regulate access to APIs.</p>","location":"apim/user-guide/publisher/plans/plans-and-subscriptions/"},{"title":"What is a plan?","text":"<p>A plan provides a service and access layer on top of your APIs for consumer link:{{ /apim/3.x/apim_overview_concepts.html#gravitee-concepts-application | relative_url }}[applications]. A plan specifies access limits, subscription validation modes and other configuration to tailor it to a specific application.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/plans-subscriptions/plan-diagram.png %}[Gravitee.io - Plan diagram, 873, 530, align=center, title-align=center]</p> <p>To get your consumers up and running with your APIs quickly, you can create a keyless plan with no security, bypassing the need for an application/subscription.</p> <p>link:{{ /apim/3.x/apim_publisherguide_plan_security.html#keyless_plans | relative_url }}[Learn more about keyless plans]</p> <p>The concept of API as a Product is at the core of the APIM approach to API management. We\u2019re not just in the business of providing tools for managing your APIs, we also understand that business and service are of paramount importance when consumers leverage your product lines.</p> <p>There are many possible types of API access scenarios, which can be difficult to encode into your APIs. Different types of access scenarios very often require external tools. In APIM, however, you can manage access with plans.</p> <p>These are just some of the access scenarios APIM manages with plans:</p> <ul> <li> <p>Read-only access and limited request traffic, so potential customers     can discover and try out your APIs.</p> </li> <li> <p>Premium access with public resources and access limits for your     partners.</p> </li> <li> <p>Unlimited access to your internal enterprise applications.</p> </li> </ul> <p>To consume your APIs, developers must create an link:{{ /apim/3.x/apim_overview_concepts.html#gravitee-concepts-application | relative_url }}[application] linked to one of the API plans (unless the plan is keyless, as described above). They can then subscribe to the API. APIM uses the subscription to decide whether to accept or deny an incoming request.</p> <p>Learn more about applications and subscriptions in the link:{{ /apim/3.x/apim_consumerguide_portal.html | relative_url }}[API Consumer Guide^].</p>","location":"apim/user-guide/publisher/plans/plans-and-subscriptions/#what-is-a-plan"},{"title":"How to create a plan","text":"<p>You can create plans in APIM Console as part of the API creation process. You can also create them later with the Portal &gt; Plans function. The workflow is as follows:</p> <ul> <li> <p>Step 1 - Create the basic plan definition.</p> <p>link:{{ /apim/3.x/apim_publisherguide_create_plan.html | relative_url }}[Learn more about creating plan definitions] * Step 2 - Specify details of the plan security.</p> <p>link:{{ /apim/3.x/apim_publisherguide_plan_security.html | relative_url }}[Learn more about configuring plan security] * Step 3 - (Optional) Specify details of plan restrictions.</p> <p>link:{{ /apim/3.x/apim_publisherguide_plan_restrictions.html | relative_url }}[Learn more about configuring plan restrictions] * Step 4 - (Optional) Configure flows and policies.</p> <p>link:{{ /apim/3.x/apim_publisherguide_plan_policies.html | relative_url }}[Learn more about configuring plan policies] * Step 5 - Publish the plan.</p> <p>link:{{ /apim/3.x/apim_publisherguide_plan_publish.html | relative_url }}[Learn more about publishing plans]</p> </li> </ul>","location":"apim/user-guide/publisher/plans/plans-and-subscriptions/#how-to-create-a-plan"},{"title":"Cache Redis","text":"<p>This plugin is not in distribution by default, but you can download plugin and follow link:{{ /apim/3.x/apim_installguide_docker_customize.html#install_an_additional_plugin | relative_url }}[instructions] to install it.</p>","location":"apim/user-guide/publisher/resources/resource-cache-redis/"},{"title":"Overview","text":"<p>APIM comes with some default common resources, for standard APIM usage. The default resources are described in this section.</p> <p>You can configure resources for your APIs during the API design phase. From APIM 3.5, the recommended way of doing this is with link:{{ /apim/3.x/apim_publisherguide_design_studio_overview.html | relative_url }}[Design Studio^].</p>","location":"apim/user-guide/publisher/resources/resources-overview/"},{"title":"HashiCorp Consul service discovery","text":"<p>= HashiCorp Consul Service Discovery :page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_service_discovery_consul.html :page-folder: apim/user-guide/publisher/service-discovery :page-layout: apim3x :page-title: HashiCorp Consul Service Discovery</p> <p>// include::https://raw.githubusercontent.com/gravitee-io/gravitee-service-discovery-consul/master/README.adoc[]</p> <p>== Introduction</p> <p>https://www.consul.io[HashiCorp Consul^] is a service mesh solution providing a full featured control plane with service discovery, configuration, and segmentation functionality.</p> <p>. Service Discovery: One of the main goals of service discovery is to provide a catalog of available services and to potentially associate it with a health check. Clients of HashiCorp Consul can register a service, such as\u00a0a backend api, and other clients can use HashiCorp Consul to discover providers of a given service. Using either DNS or HTTP, applications can easily find the services they depend upon.</p> <p>. Health Checking: HashiCorp Consul clients can provide any number of health checks, either associated with a given service (\"is the webserver returning 200 OK\"), or with the local node (\"is memory utilization below 90%\"). This information is used by the service discovery components to route traffic away from unhealthy hosts.</p> <p>Gravitee.io Service discovery for HashiCorp Consul allows you to bind the backend endpoints of your API to a service managed by HashiCorp Consul so that API requests are always routed to the proper, healthy backend service dynamically managed by HashiCorp Consul.</p> <p>== Prerequisites</p> <p>We will be using docker-compose to setup an integration between Gravitee.io APIM and HashiCorp Consul.</p> <p>Refer to this link:{{'/apim/3.x/apim_installation_guide_docker_compose.html' | relative_url }}[guide] to install Gravitee thanks to docker-compose.</p> <p>== Install HashiCorp Consul Server</p> <p>The first thing to do is install a Consul server. Consul agents that run in server mode become the centralized registry for service discovery information in your network. They answer queries from other Consul agents about where a particular service can be found. For example, if you ask them where the log service is running, they may return to you that it is running on three machines, with these IP addresses, on these ports. Meanwhile, services such as the log service register themselves with the Consul clients so that they can become discoverable.</p> <p>Read the https://www.consul.io/docs/install[official Consul documentation] to see how to install a Consul server. </p> <p>To get started, edit the docker-compose.yml used to install Gravitee and declare an addtional service for Consul server as follows:</p>","location":"apim/user-guide/publisher/service-discovery/service-discovery-consul/"},{"title":"[source,yaml]","text":"<p>consul-server:     image: hashicorp/consul:1.11.4     container_name: consul-server     restart: always     volumes:      - ./consul/server.json:/consul/config/server.json:ro     ports:      - \"8500:8500\"      - \"8600:8600/tcp\"      - \"8600:8600/udp\"     command: \"agent\"     networks:      - backend</p>  <p>In the example above, we declare a volume to mount the directory containing Consul configuration files as read-only (<code>:ro</code>) volume.</p> <p>Consul containers loads their configuration from <code>/consul/config/</code> folder, at startup. </p> <p>We use the following server.json to initialize the Consul server:</p>","location":"apim/user-guide/publisher/service-discovery/service-discovery-consul/#sourceyaml"},{"title":"[source,yaml]","text":"<p>{   \"node_name\": \"consul-server\",   \"server\": true,   \"bootstrap\" : true,   \"ui_config\": {       \"enabled\" : true   },   \"data_dir\": \"/consul/data\",   \"addresses\": {       \"http\" : \"0.0.0.0\"   } }</p>  <p>Notice that the <code>server</code> field is set to <code>true</code> to indicate that this Consul agent should run in server mode.</p> <p>We are also enabling Consul\u2019s web UI via <code>ui_config</code> attribute by setting sub key <code>enabled</code> to <code>true</code>.</p> <p>Once Consul server's container is running, Consul\u2019s web UI is accessible at port <code>8500</code>.</p> <p>The <code>addresses</code> field specifies the address that the agent will listen on for communication from other Consul members. </p> <p>By default, this is <code>0.0.0.0</code>, meaning Consul will bind to all addresses on the local machine and will advertise the private IPv4 address to the rest of the cluster.</p> <p>== Register a Service with HashiCorp Consul</p> <p>An easy way to register a service in Consul is to request <code>/v1/agent/service/register</code> endpoint of Consul's https://www.consul.io/api-docs/catalog[Catalog HTTP API^].</p> <p>Consul does not allow you to directly specify an extra path of your service when registering it. </p> <p>To overcome this limitation, Gravitee.io supports extra <code>Meta</code> attributes in addition to the standard <code>Address</code> attribute.</p> <p>Meta attributes must be provided as part of the definition of your service:</p> <ul> <li><code>gravitee_path</code> to specify on which path your service is reachable.</li> <li><code>gravitee_ssl</code> to specify whether your service should be called with <code>http://</code> or <code>https://</code> scheme.</li> </ul> <p>Below an cURL command example to register a service in Consul with extra attributes supported by Gravitee.io: </p>","location":"apim/user-guide/publisher/service-discovery/service-discovery-consul/#sourceyaml_1"},{"title":"[source,bash]","text":"","location":"apim/user-guide/publisher/service-discovery/service-discovery-consul/#sourcebash"},{"title":"curl -X PUT -d '{ \"ID\": \"whattimeisit_1\", \"Name\": \"whattimeisit\", \"Address\": \"api.gravitee.io\", \"Meta\": {\"gravitee_path\":\"/whattimeisit\", \"gravitee_ssl\":\"true\" }, \"Port\": 443}' http://localhost:8500/v1/agent/service/register","text":"<p>Check the Consul web UI and you should see the new service named <code>whattimeisit</code>:</p> <p>image::{% link images/apim/3.x/api-publisher-guide/service-discovery/service-discovery-consul-services.png %}[]</p> <p>You can also verify that your service is successfully registered in Consul by interacting with Consul Agent API.</p> <p>Use the following cURL command:</p>","location":"apim/user-guide/publisher/service-discovery/service-discovery-consul/#curl-x-put-d-id-whattimeisit_1-name-whattimeisit-address-apigraviteeio-meta-gravitee_pathwhattimeisit-gravitee_ssltrue-port-443-httplocalhost8500v1agentserviceregister"},{"title":"[source, bash]","text":"","location":"apim/user-guide/publisher/service-discovery/service-discovery-consul/#source-bash"},{"title":"curl \"http://localhost:8500/v1/agent/service/whattimeisit\"","text":"<p>You should get a response as follows: [source,json]</p>  <p>{    \"ID\":\"whattimeisit\",    \"Service\":\"whattimeisit\",    \"Tags\":[</p> <p>],    \"Meta\":{       \"gravitee_path\":\"/whattimeisit\",       \"gravitee_ssl\":\"true\"    },    \"Port\":443,    \"Address\":\"api.gravitee.io\",    \"Weights\":{       \"Passing\":1,       \"Warning\":1    },    \"EnableTagOverride\":false,    \"ContentHash\":\"d43a25497735099\",    \"Datacenter\":\"dc1\" }</p>  <p>In order to test that incoming requests on APIM gateway are dynamically routed to different service instances, let's register another instance for service <code>whattimeisit</code> that serves a different content with <code>gravitee_path</code> set to <code>/echo</code>: </p>","location":"apim/user-guide/publisher/service-discovery/service-discovery-consul/#curl-httplocalhost8500v1agentservicewhattimeisit"},{"title":"[source,bash]","text":"","location":"apim/user-guide/publisher/service-discovery/service-discovery-consul/#sourcebash_1"},{"title":"curl -X PUT -d '{ \"ID\": \"whattimeisit_2\", \"Name\": \"whattimeisit\", \"Address\": \"api.gravitee.io\", \"Meta\": {\"gravitee_path\":\"/echo\", \"gravitee_ssl\":\"true\" }, \"Port\": 443}' http://localhost:8500/v1/agent/service/register","text":"<p>== Enable Consul Service Discovery in Gravitee.io APIM</p> <p>Now that your service instances are registered in Consul, go to APIM console:</p> <ul> <li>Create or select an existing API.</li> <li>Under API's submenu, click Proxy.</li> <li>Under Backend Service, select Endpoints.</li> </ul> <p>image::{% link images/apim/3.x/api-publisher-guide/service-discovery/service-discovery-endpoints.png %}[]</p> <ul> <li>Click on the Edit Group icon.</li> <li>Select SERVICE DISCOVERY tab.</li> <li>Check Enabled service discovery checkbox.</li> <li>For Type dropdown list, select Consul.io Service Discovery. </li> </ul> <p>image::{% link images/apim/3.x/api-publisher-guide/service-discovery/service-discovery-consul-configuration.png %}[]</p> <ul> <li>Consul.io URL: Enter the URL on which your Consul is deployed (make sure it is reacheable from the Gravitee APIM gateway).</li> <li>Service: Enter the name of the service registered in Consul.</li> <li>DC:  The consul datacenter is an optional part of the Fully Qualified Domain Name (FQDN). if not provided, it defaults to the datacenter of the agent. Refer to this https://www.consul.io/docs/architecture[documentation^] for more details.</li> <li> <p>ACL: Provide the ACL token if you've secured the access to Consul. For more information on how to setup ACLs, check this https://learn.hashicorp.com/tutorials/consul/access-control-setup-production[ACL tutorial^]</p> </li> <li> <p>Truststore Type: Allows to select the type of truststore (Java KeyStore or PKCS#12) storing the certificates that will be presented Consul agent to Gravitee during the secure connection handshake (SSL/TLS). When selecting <code>None (Trust All)</code> you configure Gravitee.io to trust all certificates presented by Consul during connection handshake. You can either copy/paste the content of your Truststore directly under Truststore content field or provide the path to you external Truststore under Truststore path. At least one of the two must be provided.</p> </li> <li> <p>KeyStore Type allows to select the type of keystore (Java KeyStore or PKCS#12) storing certificates that will be presented by Gravitee.io to Consul agent during the secure connection handshake (SSL/TLS). You can either copy/paste the content of your keystore directly under KeyStore content field or provide the path to you external Keystore under KeyStore path. At least one of the two must be provided.</p> </li> <li>Click SAVE.</li> </ul> <p>Your API should now appear out of sync in the top banner. Be sure to click deploy your API.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/service-discovery/service-discovery-redeploy.png %}[]</p> <p>NOTE: Endpoints configured through the APIM console before service discovery was enabled are not removed. The Gravitee.io gateway will continue to consider those endpoints in addition to the ones discovered through Consul integration. The endpoints dynamically discovered through Consul are not displayed in APIM console. You can remove the endpoints define through the APIM console. However, we encourage you to keep at least one endpoint declared as secondary. Secondary endpoints are not included in the load-balancer pool and are only selected to handle requests if Consul is no longer responding.</p> <p>To declare an endpoint as secondary:</p> <ul> <li>Click on the Edit icon.</li> <li>Check Secondary endpoint checkbox.</li> <li>Select SAVE.</li> </ul> <p>image::{% link images/apim/3.x/api-publisher-guide/service-discovery/service-discovery-secondary-endpoint.png %}[]</p> <p>== Verify that your service is properly discovered by APIM gateway</p> <p>You can check API gateway's logs to verify that your service have been successfully discovered thanks to HashiCorp Consul: </p>","location":"apim/user-guide/publisher/service-discovery/service-discovery-consul/#curl-x-put-d-id-whattimeisit_2-name-whattimeisit-address-apigraviteeio-meta-gravitee_pathecho-gravitee_ssltrue-port-443-httplocalhost8500v1agentserviceregister"},{"title":"[source]","text":"<p>INFO  i.g.g.h.a.m.impl.ApiManagerImpl - API id[194c560a-fcd1-4e26-8c56-0afcd17e2630] name[Time] version[1.0.0] has been updated INFO  i.g.d.consul.ConsulServiceDiscovery - Register a new service from Consul.io: id[whattimeisit] name[whattimeisit] INFO  i.g.g.s.e.d.v.EndpointDiscoveryVerticle - Receiving a service discovery event id[consul:whattimeisit] type[REGISTER]</p>  <p>You can now try to call your API to make sure that incoming API requests are properly routed to the proper backend service.</p> <p>You can also deregister your service instance from Consul by refering to their ID and call your API again to observe how APIM dynamically routes the trafic based on Consul's Service Catalog.</p>","location":"apim/user-guide/publisher/service-discovery/service-discovery-consul/#source"},{"title":"[source,bash]","text":"","location":"apim/user-guide/publisher/service-discovery/service-discovery-consul/#sourcebash_2"},{"title":"curl -X PUT -v \"http://localhost:8500/v1/agent/service/deregister/whattimeisit\"","text":"<p>If you encounter any issues, enable logs in order to troubleshoot. Refer to the link:{{'/apim/3.x/apim_publisherguide_logging_analytics.html#logs' | relative_url}}[Logging and analytics] to learn how to configure logging on your API.</p> <p>You learned how to integrate Gravitee.io APIM gateway with HashiCorp Consul, which enables dynamic load balancer configuration changes that are pulled directly from Consul\u2019s service discovery registry.</p> <p>== Additional considerations</p> <p>=== Enable Health Check to monitor backend endpoints managed by HashiCorp Consul</p> <p>You can optionally enable health checks for your API. You will then be able to view the status of all endpoints under Per-endpoint availability section, including the ones managed by Consul.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/service-discovery/service-discovery-consul-healthcheck.png %}[]</p> <p>For more details on how to enable Health Check, refer tot this link:{{'/apim/3.x/apim_publisherguide_backend_services.html#configure_health_check' | relative_url}}[section].</p>","location":"apim/user-guide/publisher/service-discovery/service-discovery-consul/#curl-x-put-v-httplocalhost8500v1agentservicederegisterwhattimeisit"},{"title":"Eureka service discovery","text":"<p>:page-sidebar: apim_3_x_sidebar :page-permalink: apim/3.x/apim_service_discovery_eureka.html :page-folder: apim/user-guide/publisher/service-discovery :page-layout: apim3x :page-title: Eureka service discovery</p> <p>== Configuration</p> <p>The configuration is loaded from the common GraviteeIO Gateway configuration file (gravitee.yml) All configurations described by official Eureka discovery client documentation are available on the official github repository: https://github.com/Netflix/eureka/wiki. Gravitee Gateway uses Eureka Discovery client v1 and fetch configured Eureka Servers. It does not register the gateway application into Eureka registry. Please refer the official Eureka documentation for advanced uses and advanced concepts.</p> <p>For more information, see the complete link:{{ 'https://github.com/gravitee-io-community/gravitee-service-discovery-eureka/blob/master/README.adoc' }}[Eureka client configuration].</p> <p>== Enable Eureka Service Discovery in Gravitee APIM</p> <p>Once you have configured your Eureka service, go to the APIM console:</p> <p>. Create or select an existing API. . Under API's submenu, click Proxy. . Under Backend Service, select Endpoints.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/service-discovery/service-discovery-endpoints.png %}[]</p> <p>[start=4] . Click on the Edit Group icon. . Select the SERVICE DISCOVERY tab. . Click the Enabled service discovery checkbox to activate this option. . Select Eureka Service Discovery in the Type dropdown list. . For Application, enter your application name.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/service-discovery/service-discovery-eureka-configuration.png %}[]</p> <p>[start=9] . Click SAVE.</p> <p>Your API should now appear out of sync in the top banner - click deploy your API to rectify this</p> <p>image::{% link images/apim/3.x/api-publisher-guide/service-discovery/service-discovery-redeploy.png %}[]</p> <p>NOTE: Gravitee Gateway will not remove endpoints configured through the APIM console before service discovery was enabled - it will continue to consider such endpoints in addition to the ones dynamically discovered through Eureka integration (these are not shown in the APIM console). You can manually remove any endpoints defined through the APIM console. However, it is highly recommended that you keep at least one such endpoint declared as secondary - secondary endpoints are not included in the load-balancer pool and are only selected to handle requests if Eureka is no longer responding.</p> <p>To declare an endpoint as secondary:</p> <p>. Click on the Edit icon. . Click the Secondary endpoint checkbox to enable it. . Select SAVE.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/service-discovery/service-discovery-secondary-endpoint.png %}[]</p> <p>== Verify that your service is properly discovered by the APIM gateway</p> <p>To verify that your service has been successfully discovered through Eureka, check out the API gateway logs:</p>","location":"apim/user-guide/publisher/service-discovery/service-discovery-eureka/"},{"title":"[source]","text":"<p>INFO  i.g.g.h.a.m.impl.ApiManagerImpl - API id[194c560a-fcd1-4e26-8c56-0afcd17e2630] name[Time] version[1.0.0] has been updated INFO  i.g.g.s.e.d.v.EndpointDiscoveryVerticle - Receiving a service discovery event id[eureka:whattimeisit] type[REGISTER]</p>  <p>You can now try to call your API to make sure that incoming API requests are properly routed to the right backend service.</p>","location":"apim/user-guide/publisher/service-discovery/service-discovery-eureka/#source"},{"title":"[source,bash]","text":"","location":"apim/user-guide/publisher/service-discovery/service-discovery-eureka/#sourcebash"},{"title":"curl -X PUT -v \"http://localhost:8082/whattimeisit\"","text":"<p>If you encounter any issues, enable logs in order to troubleshoot. Refer to the link:{{'/apim/3.x/apim_publisherguide_logging_analytics.html#logs' | relative_url}}[Logging and analytics documentation] to learn how to configure logging on your API.</p> <p>== Additional considerations</p> <p>=== Enable Health Check to monitor backend endpoints managed by Eureka</p> <p>To view the status of all endpoints, including the ones managed by Eureka, enable the Health Check option for your API in the Per-endpoint availability section.</p> <p>image::{% link images/apim/3.x/api-publisher-guide/service-discovery/service-discovery-eureka-healthcheck.png %}[]</p> <p>See the link:{{'/apim/3.x/apim_publisherguide_backend_services.html#configure_health_check' | relative_url}}[Health Check documentation] for more information on how to enable the Health Check option for your API.</p>","location":"apim/user-guide/publisher/service-discovery/service-discovery-eureka/#curl-x-put-v-httplocalhost8082whattimeisit"},{"title":"Introduction","text":"<p>APIM is delivered with some default common service discoveries, for standard APIM usage. The default service discoveries are described in this section.</p>","location":"apim/user-guide/publisher/service-discovery/service-discovery-overview/"},{"title":"Overview","text":"<p>The Kafka connector implements the SME Connector API in order to provide native integration with Apache Kafka. This connector can be leveraged in the following ways depending on your use case:</p> <ul> <li>Ingest data by exposing an endpoint that transforms requests into     messages that are published into an Apache Kafka topic.</li> </ul> <p>image:{% link images/apim/3.x/api-publisher-guide/sme/kafka-controller.png %}[]</p> <ul> <li>Stream your Kafka events to consumers thanks to web-friendly     protocols such as HTTP or Websocket, and provide real-time     integration capability to your ecosystem.</li> </ul> <p>image:{% link images/apim/3.x/api-publisher-guide/sme/kafka-controller2.png %}[]</p>","location":"apim/user-guide/publisher/sme/introducing-kafka/"},{"title":"Getting started","text":"<p>This guide will take you through creating a Kafka endpoint, describe how to produce and consume messages and provide the details of all the configuration options available to you.</p>","location":"apim/user-guide/publisher/sme/introducing-kafka/#getting-started"},{"title":"Prerequisites","text":"<ul> <li> <p>You must have installed the Kafka     plugin^.     More information on installing a plugin can be found link:{% link     pages/apim/3.x/installation-guide/installation-guide-plugins.adoc     %}[here].</p> </li> <li> <p>A basic understanding of Kafka is required, this     link^ is a good resource     to get you started.</p> </li> </ul>","location":"apim/user-guide/publisher/sme/introducing-kafka/#prerequisites"},{"title":"Creating a Kafka endpoint","text":"<p>You have the two following options when creating a Kafka endpoint:</p> <ul> <li> <p>You can create it via a <code>curl</code> command in API Management, or</p> </li> <li> <p>You can import an API definition using the Gravitee console.</p> </li> </ul>","location":"apim/user-guide/publisher/sme/introducing-kafka/#creating-a-kafka-endpoint"},{"title":"Creating a Kafka endpoint using API Management","text":"<p>Use standard API Management functionality to create an API endpoint (see link:{% link pages/apim/3.x/user-guide/publisher/create-api.adoc %}[here] for more detail on creating APIs)</p> <pre><code>curl -H \"Authorization: Basic YWRtaW46YWRtaW4=\" \\\n     -H \"Content-Type:application/json;charset=UTF-8\" \\\n     -X POST \\\n     -d '\"proxy\": {\"virtual_hosts\": [{\"path\": \"/kafka\"}],\"strip_context_path\": false,\"preserve_host\":false,\"groups\": [{\"name\": \"default-group\",\"endpoints\": [{\"backup\": false,\"inherit\": true,\"name\": \"default\",\"weight\": 1,\"type\": \"kafka\",\"target\": \"[YOUR_KAFKA_HOST]\"}],\"load_balancing\": {\"type\": \"ROUND_ROBIN\"},\"http\": {\"connectTimeout\": 5000,\"idleTimeout\": 60000,\"keepAlive\": true,\"readTimeout\": 10000,\"pipelining\": false,\"maxConcurrentConnections\": 100,\"useCompression\": true,\"followRedirects\": false}}]},' \\\n     http://MANAGEMENT_API_SERVER_DOMAIN/management/organizations/DEFAULT/environments/DEFAULT/apis\n</code></pre> <p>Once created, you can access the Kafka connector configuration via the console, go to your API &gt; Proxy &gt; Endpoints.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/sme/kafka-console1.png %}[]</p> <p>On the Configuration tab, configure your settings, referring to the link:{% link pages/apim/3.x/user-guide/publisher/sme/kafka-connector-configuration.adoc %}[configuration section] for any required information.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/sme/kafka-console2.png %}[]</p> <p>Add Kafka to the default group</p> <p>image:{% link images/apim/3.x/api-publisher-guide/sme/kafka-console3.png %}[]</p> <p>For more details on the parameters defined in this call, refer to the link:{% link pages/apim/3.x/user-guide/publisher/sme/kafka-connector-configuration.adoc %}[configuring Kafka section].</p>","location":"apim/user-guide/publisher/sme/introducing-kafka/#creating-a-kafka-endpoint-using-api-management"},{"title":"Configuring Kafka Connector","text":"","location":"apim/user-guide/publisher/sme/kafka-connector-configuration/"},{"title":"Consumer","text":"<p>groupId</p> <p>A unique string that identifies the consumer group this consumer belongs to. This property is required if the consumer uses either the group management functionality by using subscribe(topic) or the Kafka-based offset management strategy.</p> <p>groupInstanceId</p> <p>A unique identifier of the consumer instance provided by the end user. Only non-empty strings are permitted. If set, the consumer is treated as a static member, which means that only one instance with this ID is allowed in the consumer group at any time. This can be used in combination with a larger session timeout to avoid group rebalances caused by transient unavailability (e.g. process restarts). If not set, the consumer will join the group as a dynamic member, which is the traditional behavior.</p> <p>sessionTimeoutMs</p> <p>The timeout used to detect client failures when using Kafka\u2019s group management facility. The client sends periodic heartbeats to indicate its liveness to the broker. If no heartbeats are received by the broker before the expiration of this session timeout, then the broker will remove this client from the group and initiate a rebalance. Note that the value must be in the allowable range as configured in the broker configuration by group.min.session.timeout.ms and group.max.session.timeout.ms.</p> <pre><code>      \"default\": 10000\n</code></pre> <p>heartbeatIntervalMs</p> <p>The expected time between heartbeats to the consumer coordinator when using Kafka\u2019s group management facilities. Heartbeats are used to ensure that the consumer\u2019s session stays active and to facilitate rebalancing when new consumers join or leave the group. The value must be set lower than session.timeout.ms, but typically should be set no higher than 1/3 of that value. It can be adjusted even lower to control the expected time for normal rebalances.</p> <pre><code>      \"default\": 3000\n</code></pre> <p>partitionAssignmentStrategy</p> <p>A list of class names or class types, ordered by preference, of supported partition assignment strategies that the client will use to distribute partition ownership amongst consumer instances when group management is used.In addition to the default class specified below, you can use the org.apache.kafka.clients.consumer.RoundRobinAssignorclass for round robin assignments of partitions to consumers. Implementing the org.apache.kafka.clients.consumer.ConsumerPartitionAssignor interface allows you to plug in a custom assignmentstrategy.</p> <pre><code>      \"default\": \"org.apache.kafka.clients.consumer.RangeAssignor\"\n</code></pre> <p>metadataMaxAgeMs</p> <p>The period of time in milliseconds after which we force a refresh of metadata even if we haven\u2019t seen any partition leadership changes to proactively discover any new brokers or partitions.</p> <pre><code>      \"default\": 300000,\n      \"minimum\": 0\n</code></pre> <p>enableAutoCommit</p> <p>If true the consumer\u2019s offset will be periodically committed in the background.</p> <pre><code>      \"default\": true\n</code></pre> <p>autoCommitIntervalMs</p> <p>The frequency in milliseconds that the consumer offsets are auto-committed to Kafka if enable.auto.commit is set to true.</p> <pre><code>      \"default\": 5000,\n      \"minimum\": 0\n</code></pre> <p>clientId</p> <p>An id string to pass to the server when making requests. The purpose of this is to be able to track the source of requests beyond just ip/port by allowing a logical application name to be included in server-side request logging.</p> <pre><code>      \"default\": \"\"\n</code></pre> <p>clientRack</p> <p>A rack identifier for this client. This can be any string value which indicates where this client is physically located. It corresponds with the broker config broker.rack</p> <pre><code>      \"default\": \"\"\n</code></pre> <p>maxPartitionFetchBytes</p> <p>The maximum amount of data per-partition the server will return. Records are fetched in batches by the consumer. If the first record batch in the first non-empty partition of the fetch is larger than this limit, the batch will still be returned to ensure that the consumer can make progress. The maximum record batch size accepted by the broker is defined via message.max.bytes (broker config) or max.message.bytes (topic config). See fetch.max.bytes for limiting the consumer request size.</p> <pre><code>      \"default\": 1048576,\n      \"minimum\": 0\n</code></pre> <p>sendBufferBytes</p> <p>The size of the TCP send buffer (SO_SNDBUF) to use when sending data. If the value is -1, the OS default will be used.</p> <pre><code>      \"default\": 131072,\n      \"minimum\": -1\n</code></pre> <p>receiveBufferBytes</p> <p>The size of the TCP receive buffer (SO_RCVBUF) to use when reading data. If the value is -1, the OS default will be used.</p> <pre><code>      \"default\": 65536,\n      \"minimum\": -1\n</code></pre> <p>fetchMinBytes</p> <p>The minimum amount of data the server should return for a fetch request. If insufficient data is available the request will wait for that much data to accumulate before answering the request. The default setting of 1 byte means that fetch requests are answered as soon as a single byte of data is available or the fetch request times out waiting for data to arrive. Setting this to something greater than 1 will cause the server to wait for larger amounts of data to accumulate which can improve server throughput a bit at the cost of some additional latency.</p> <pre><code>      \"default\": 1,\n      \"minimum\": 0\n</code></pre> <p>fetchMaxBytes</p> <p>The maximum amount of data the server should return for a fetch request. Records are fetched in batches by the consumer, and if the first record batch in the first non-empty partition of the fetch is larger than this value, the record batch will still be returned to ensure that the consumer can make progress. As such, this is not a absolute maximum. The maximum record batch size accepted by the broker is defined via message.max.bytes (broker config) or max.message.bytes (topic config). Note that the consumer performs multiple fetches in parallel.</p> <pre><code>      \"default\": 52428800,\n      \"minimum\": 0\n</code></pre> <p>fetchMaxWaitMs</p> <p>The maximum amount of time the server will block before answering the fetch request if there isn\u2019t sufficient data to immediately satisfy the requirement given by fetch.min.bytes.</p> <pre><code>      \"default\": 500,\n      \"minimum\": 0\n</code></pre> <p>reconnectBackoffMs</p> <p>The base amount of time to wait before attempting to reconnect to a given host. This avoids repeatedly connecting to a host in a tight loop. This backoff applies to all connection attempts by the client to a broker.</p> <pre><code>      \"default\": 50,\n      \"minimum\": 0\n</code></pre> <p>reconnectBackoffMaxMs</p> <p>The maximum amount of time in milliseconds to wait when reconnecting to a broker that has repeatedly failed to connect. If provided, the backoff per host will increase exponentially for each consecutive connection failure, up to this maximum. After calculating the backoff increase, 20% random jitter is added to avoid connection storms.</p> <pre><code>      \"default\": 1000,\n      \"minimum\": 0\n</code></pre> <p>retryBackoffMs</p> <p>The amount of time to wait before attempting to retry a failed request to a given topic partition. This avoids repeatedly sending requests in a tight loop under some failure scenarios.</p> <pre><code>      \"default\": 100,\n      \"minimum\": 0\n</code></pre> <p>autoOffsetReset</p> <p>What to do when there is no initial offset in Kafka or if the current offset does not exist any more on the server (e.g. because that data has been deleted): earliest: automatically reset the offset to the earliest offsetlatest: automatically reset the offset to the latest offsetnone: throw exception to the consumer if no previous offset is found for the consumer\u2019s groupanything else: throw exception to the consumer.</p> <pre><code>      \"default\": \"latest\n      \"enum\": [\n        \"latest\n        \"earliest\n        \"none\"\n      ]\n</code></pre> <p>checkCRCS</p> <p>Automatically check the CRC32 of the records consumed. This ensures no on-the-wire or on-disk corruption to the messages occurred. This check adds some overhead, so it may be disabled in cases seeking extreme performance.</p> <pre><code>      \"default\": true\n</code></pre> <p>metricsSampleWindowMs</p> <p>The window of time a metrics sample is computed over.</p> <pre><code>      \"default\": 30000,\n      \"minimum\": 0\n</code></pre> <p>metricsNumSamples</p> <p>The number of samples maintained to compute metrics.</p> <pre><code>      \"default\": 2,\n      \"minimum\": 1\n</code></pre> <p>metricsRecordingLevel</p> <p>The highest recording level for metrics.</p> <pre><code>      \"default\": \"INFO\n      \"enum\": [\n        \"INFO\n        \"DEBUG\"\n      ]\n</code></pre> <p>metricReporters</p> <p>A list of classes to use as metrics reporters. Implementing the org.apache.kafka.common.metrics.MetricsReporter interface allows plugging in classes that will be notified of new metric creation. The JmxReporter is always included to register JMX statistics.</p> <p>keyDeserializer</p> <p>Deserializer class for key that implements the org.apache.kafka.common.serialization.Deserializer interface.</p> <pre><code>      \"default\": \"org.apache.kafka.common.serialization.StringDeserializer\"\n</code></pre> <p>valueDeserializer</p> <p>Deserializer class for value that implements the org.apache.kafka.common.serialization.Deserializer interface.</p> <pre><code>      \"default\": \"org.apache.kafka.common.serialization.StringDeserializer\"\n</code></pre> <p>requestTimeoutMs</p> <p>The configuration controls the maximum amount of time the client will wait for the response of a request. If the response is not received before the timeout elapses the client will resend the request if necessary or fail the request if retries are exhausted.</p> <pre><code>      \"default\": 30000,\n      \"minimum\": 0\n</code></pre> <p>defaultApiTimeoutMs</p> <p>Specifies the timeout (in milliseconds) for client APIs. This configuration is used as the default timeout for all client operations that do not specify a timeout parameter.</p> <pre><code>      \"default\": 60000,\n      \"minimum\": 0\n</code></pre> <p>connectionsMaxIdleMs</p> <p>Close idle connections after the number of milliseconds specified by this config.</p> <pre><code>      \"default\": 540000\n</code></pre> <p>interceptorClasses</p> <p>A list of classes to use as interceptors. Implementing the org.apache.kafka.clients.consumer.ConsumerInterceptor interface allows you to intercept (and possibly mutate) records received by the consumer. By default, there are no interceptors.</p> <p>maxPollRecords</p> <p>The maximum number of records returned in a single call to poll().</p> <pre><code>      \"default\": 500,\n      \"minimum\": 1\n</code></pre> <p>maxPollIntervalMs</p> <p>The maximum delay between invocations of poll() when using consumer group management. This places an upper bound on the amount of time that the consumer can be idle before fetching more records. If poll() is not called before expiration of this timeout, then the consumer is considered failed and the group will rebalance in order to reassign the partitions to another member. For consumers using a non-null group.instance.id which reach this timeout, partitions will not be immediately reassigned. Instead, the consumer will stop sending heartbeats and partitions will be reassigned after expiration of session.timeout.ms. This mirrors the behavior of a static consumer which has shutdown.</p> <pre><code>      \"default\": 300000,\n      \"minimum\": 1\n</code></pre> <p>excludeInternalTopics</p> <p>Whether internal topics matching a subscribed pattern should be excluded from the subscription. It is always possible to explicitly subscribe to an internal topic.</p> <pre><code>      \"default\": true\n</code></pre> <p>isolationLevel</p> <p>Controls how to read messages written transactionally. If set to read_committed, consumer.poll() will only return transactional messages which have been committed. If set to read_uncommitted' (the default), consumer.poll() will return all messages, even transactional messages which have been aborted. Non-transactional messages will be returned unconditionally in either mode. Messages will always be returned in offset order. Hence, in read_committed mode, consumer.poll() will only return messages up to the last stable offset (LSO), which is the one less than the offset of the first open transaction. In particular any messages appearing after messages belonging to ongoing transactions will be withheld until the relevant transaction has been completed. As a result, read_committed consumers will not be able to read up to the high watermark when there are in flight transactions. Further, when in read_committed the seekToEnd method will return the LSO</p> <pre><code>      \"default\": \"READ_UNCOMMITTED\n      \"enum\": [\n        \"READ_COMMITTED\n        \"READ_UNCOMMITTED\"\n      ]\n</code></pre> <p>allowAutoCreateTopics</p> <p>Allow automatic topic creation on the broker when subscribing to or assigning a topic. A topic being subscribed to will be automatically created only if the broker allows for it using <code>auto.create.topics.enable</code> broker configuration. This configuration must be set to <code>false</code> when using brokers older than 0.11.0</p> <pre><code>      \"default\": true\n</code></pre> <p>securityProviders</p> <p>A list of configurable creator classes each returning a provider implementing security algorithms. These classes should implement the org.apache.kafka.common.security.auth.SecurityProviderCreator interface.</p> <p>securityProtocol</p> <p>Protocol used to communicate with brokers.</p> <pre><code>      \"default\": \"PLAINTEXT\n      \"enum\": [\n        \"PLAINTEXT\n        \"SSL\n        \"SASL_PLAINTEXT\n        \"SASL_SSL\"\n      ]\n    }\n  \"x-schema-form\": {\n    \"open\": false\n  }\n</code></pre>","location":"apim/user-guide/publisher/sme/kafka-connector-configuration/#consumer"},{"title":"Producer","text":"<p>bufferMemory</p> <p>The total bytes of memory the producer can use to buffer records waiting to be sent to the server. If records are sent faster than they can be delivered to the server the producer will block for max.block.ms after which it will throw an exception.This setting should correspond roughly to the total memory the producer will use, but is not a hard bound since not all memory the producer uses is used for buffering. Some additional memory will be used for compression (if compression is enabled) as well as for maintaining in-flight requests.</p> <pre><code>      \"default\": 33554432,\n      \"minimum\": 0\n</code></pre> <p>retries</p> <p>Setting a value greater than zero will cause the client to resend any record whose send fails with a potentially transient error. Note that this retry is no different than if the client resent the record upon receiving the error. Allowing retries without setting max.in.flight.requests.per.connection to 1 will potentially change the ordering of records because if two batches are sent to a single partition, and the first fails and is retried but the second succeeds, then the records in the second batch may appear first. Note additionally that produce requests will be failed before the number of retries has been exhausted if the timeout configured by delivery.timeout.ms expires first before successful acknowledgement. Users should generally prefer to leave this config unset and instead use delivery.timeout.ms to control retry behavior.</p> <pre><code>      \"default\": 2147483647,\n      \"minimum\": 0,\n      \"maximum\": 2147483647\n</code></pre> <p>acks</p> <p>The number of acknowledgments the producer requires the leader to have received before considering a request complete. This controls the durability of records that are sent. The following settings are allowed: acks=0 If set to zero then the producer will not wait for any acknowledgment from the server at all. The record will be immediately added to the socket buffer and considered sent. No guarantee can be made that the server has received the record in this case, and the retries configuration will not take effect (as the client won\u2019t generally know of any failures). The offset given back for each record will always be set to -1. acks=1 This will mean the leader will write the record to its local log but will respond without awaiting full acknowledgement from all followers. In this case should the leader fail immediately after acknowledging the record but before the followers have replicated it then the record will be lost. acks=all This means the leader will wait for the full set of in-sync replicas to acknowledge the record. This guarantees that the record will not be lost as long as at least one in-sync replica remains alive. This is the strongest available guarantee. This is equivalent to the acks=-1 setting.</p> <pre><code>      \"default\": \"1\n      \"enum\": [\n        \"all\n        \"-1\n        \"0\n        \"1\"\n      ]\n</code></pre> <p>compressionType</p> <p>The compression type for all data generated by the producer. The default is none (i.e. no compression). Valid values are none, gzip, snappy, lz4, or zstd. Compression is of full batches of data, so the efficacy of batching will also impact the compression ratio (more batching means better compression).</p> <pre><code>      \"default\": \"none\n      \"enum\": [\n        \"none\n        \"gzip\n        \"snappy\n        \"lz4\n        \"zstd\"\n      ]\n</code></pre> <p>batchSize</p> <p>The producer will attempt to batch records together into fewer requests whenever multiple records are being sent to the same partition. This helps performance on both the client and the server. This configuration controls the default batch size in bytes. No attempt will be made to batch records larger than this size. Requests sent to brokers will contain multiple batches, one for each partition with data available to be sent. A small batch size will make batching less common and may reduce throughput (a batch size of zero will disable batching entirely). A very large batch size may use memory a bit more wastefully as we will always allocate a buffer of the specified batch size in anticipation of additional records.</p> <pre><code>      \"default\": 16384,\n      \"minimum\": 0\n</code></pre> <p>lingerMs</p> <p>The producer groups together any records that arrive in between request transmissions into a single batched request. Normally this occurs only under load when records arrive faster than they can be sent out. However in some circumstances the client may want to reduce the number of requests even under moderate load. This setting accomplishes this by adding a small amount of artificial delay\u2014that is, rather than immediately sending out a record the producer will wait for up to the given delay to allow other records to be sent so that the sends can be batched together. This can be thought of as analogous to Nagle\u2019s algorithm in TCP. This setting gives the upper bound on the delay for batching: once we get batch.size worth of records for a partition it will be sent immediately regardless of this setting, however if we have fewer than this many bytes accumulated for this partition we will linger for the specified time waiting for more records to show up. This setting defaults to 0 (i.e. no delay). Setting linger.ms=5, for example, would have the effect of reducing the number of requests sent but would add up to 5ms of latency to records sent in the absence of load.</p> <pre><code>      \"default\": 0,\n      \"minimum\": 0\n</code></pre> <p>deliveryTimeoutMs</p> <p>An upper bound on the time to report success or failure after a call to send() returns. This limits the total time that a record will be delayed prior to sending, the time to await acknowledgement from the broker (if expected), and the time allowed for retriable send failures. The producer may report failure to send a record earlier than this config if either an unrecoverable error is encountered, the retries have been exhausted, or the record is added to a batch which reached an earlier delivery expiration deadline. The value of this config should be greater than or equal to the sum of request.timeout.ms and linger.ms.</p> <pre><code>      \"default\": 120000,\n      \"minimum\": 0\n</code></pre> <p>clientId</p> <p>An id string to pass to the server when making requests. The purpose of this is to be able to track the source of requests beyond just ip/port by allowing a logical application name to be included in server-side request logging.</p> <pre><code>      \"default\": \"\"\n</code></pre> <p>sendBufferBytes</p> <p>The size of the TCP send buffer (SO_SNDBUF) to use when sending data. If the value is -1, the OS default will be used.</p> <pre><code>      \"default\": 131072,\n      \"minimum\": -1\n</code></pre> <p>receiveBufferBytes</p> <p>The size of the TCP receive buffer (SO_RCVBUF) to use when reading data. If the value is -1, the OS default will be used.</p> <pre><code>      \"default\": 32768,\n      \"minimum\": -1\n</code></pre> <p>maxRequestSize</p> <p>The maximum size of a request in bytes. This setting will limit the number of record batches the producer will send in a single request to avoid sending huge requests. This is also effectively a cap on the maximum uncompressed record batch size. Note that the server has its own cap on the record batch size (after compression if compression is enabled) which may be different from this.</p> <pre><code>      \"default\": 1048576,\n      \"minimum\": -1\n</code></pre> <p>reconnectBackoffMs</p> <p>The base amount of time to wait before attempting to reconnect to a given host. This avoids repeatedly connecting to a host in a tight loop. This backoff applies to all connection attempts by the client to a broker.</p> <pre><code>      \"default\": 50,\n      \"minimum\": 0\n</code></pre> <p>reconnectBackoffMaxMs</p> <p>The maximum amount of time in milliseconds to wait when reconnecting to a broker that has repeatedly failed to connect. If provided, the backoff per host will increase exponentially for each consecutive connection failure, up to this maximum. After calculating the backoff increase, 20% random jitter is added to avoid connection storms.</p> <pre><code>      \"default\": 1000,\n      \"minimum\": 0\n</code></pre> <p>retryBackoffMs</p> <p>The amount of time to wait before attempting to retry a failed request to a given topic partition. This avoids repeatedly sending requests in a tight loop under some failure scenarios.</p> <pre><code>      \"default\": 100,\n      \"minimum\": 0\n</code></pre> <p>maxBlockMs</p> <p>The configuration controls how long KafkaProducer.send() and KafkaProducer.partitionsFor() will block.These methods can be blocked either because the buffer is full or metadata unavailable.Blocking in the user-supplied serializers or partitioner will not be counted against this timeout.</p> <pre><code>      \"default\": 60000,\n      \"minimum\": 0\n</code></pre> <p>requestTimeoutMs</p> <p>The configuration controls the maximum amount of time the client will wait for the response of a request. If the response is not received before the timeout elapses the client will resend the request if necessary or fail the request if retries are exhausted. This should be larger than replica.lag.time.max.ms (a broker configuration) to reduce the possibility of message duplication due to unnecessary producer retries.</p> <pre><code>      \"default\": 30000,\n      \"minimum\": 0\n</code></pre> <p>metadataMaxAgeMs</p> <p>The period of time in milliseconds after which we force a refresh of metadata even if we haven\u2019t seen any partition leadership changes to proactively discover any new brokers or partitions.</p> <pre><code>      \"default\": 30000,\n      \"minimum\": 0\n</code></pre> <p>metadataMaxIdleMs</p> <p>Controls how long the producer will cache metadata for a topic that\u2019s idle. If the elapsed time since a topic was last produced to exceeds the metadata idle duration, then the topic\u2019s metadata is forgotten and the next access to it will force a metadata fetch request.</p> <pre><code>      \"default\": 300000,\n      \"minimum\": 5000\n</code></pre> <p>metricsSampleWindowMs</p> <p>The window of time a metrics sample is computed over.</p> <pre><code>      \"default\": 30000,\n      \"minimum\": 0\n</code></pre> <p>metricsNumSamples</p> <p>The number of samples maintained to compute metrics.</p> <pre><code>      \"default\": 2,\n      \"minimum\": 1\n</code></pre> <p>metricsRecordingLevel</p> <p>The highest recording level for metrics.</p> <pre><code>      \"default\": \"INFO\n      \"enum\": [\n        \"INFO\n        \"DEBUG\"\n      ]\n</code></pre> <p>metricReporters</p> <p>A list of classes to use as metrics reporters. Implementing the org.apache.kafka.common.metrics.MetricsReporter interface allows plugging in classes that will be notified of new metric creation. The JmxReporter is always included to register JMX statistics.</p> <p>maxInFlightRequestsPerConnection</p> <p>The maximum number of unacknowledged requests the client will send on a single connection before blocking. Note that if this setting is set to be greater than 1 and there are failed sends, there is a risk of message re-ordering due to retries (i.e., if retries are enabled).</p> <pre><code>      \"default\": 5,\n      \"minimum\": 1\n</code></pre> <p>keySerializer</p> <p>Serializer class for key that implements the org.apache.kafka.common.serialization.Serializer interface.</p> <pre><code>      \"default\": \"org.apache.kafka.common.serialization.StringSerializer\"\n</code></pre> <p>valueSerializer</p> <p>Serializer class for value that implements the org.apache.kafka.common.serialization.Serializer interface.</p> <pre><code>      \"default\": \"org.apache.kafka.common.serialization.StringSerializer\"\n</code></pre> <p>connectionsMaxIdleMs</p> <p>Close idle connections after the number of milliseconds specified by this config.</p> <pre><code>      \"default\": 540000\n</code></pre> <p>partitionerClass</p> <p>Partitioner class that implements the org.apache.kafka.clients.producer.Partitioner interface.</p> <pre><code>      \"default\": \"org.apache.kafka.clients.producer.internals.DefaultPartitioner\"\n</code></pre> <p>interceptorClasses</p> <p>A list of classes to use as interceptors. Implementing the org.apache.kafka.clients.consumer.ConsumerInterceptor interface allows you to intercept (and possibly mutate) records received by the consumer. By default, there are no interceptors.</p> <p>securityProtocol</p> <p>Protocol used to communicate with brokers.</p> <pre><code>      \"default\": \"PLAINTEXT\n      \"enum\": [\n        \"PLAINTEXT\n        \"SSL\n        \"SASL_PLAINTEXT\n        \"SASL_SSL\"\n      ]\n</code></pre> <p>securityProviders</p> <p>A list of configurable creator classes each returning a provider implementing security algorithms. These classes should implement the org.apache.kafka.common.security.auth.SecurityProviderCreator interface.</p> <p>enableIdempotence</p> <p>When set to true, the producer will ensure that exactly one copy of each message is written in the stream. If false, producer retries due to broker failures, etc., may write duplicates of the retried message in the stream. Note that enabling idempotence requires max.in.flight.requests.per.connection to be less than or equal to 5, retries to be greater than 0 and acks must be all. If these values are not explicitly set by the user, suitable values will be chosen. If incompatible values are set, a ConfigException will be thrown.</p> <pre><code>      \"default\": false\n</code></pre> <p>transactionTimeoutMs</p> <p>The maximum amount of time in ms that the transaction coordinator will wait for a transaction status update from the producer before proactively aborting the ongoing transaction.If this value is larger than the transaction.max.timeout.ms setting in the broker, the request will fail with a InvalidTransactionTimeout error.</p> <pre><code>      \"default\": 60000\n</code></pre> <p>transactionalId</p> <p>The TransactionalId to use for transactional delivery. This enables reliability semantics which span multiple producer sessions since it allows the client to guarantee that transactions using the same TransactionalId have been completed prior to starting any new transactions. If no TransactionalId is provided, then the producer is limited to idempotent delivery. If a TransactionalId is configured, enable.idempotence is implied. By default the TransactionId is not configured, which means transactions cannot be used. Note that, by default, transactions require a cluster of at least three brokers which is the recommended setting for production; for development you can change this, by adjusting broker setting transaction.state.log.replication.factor.</p> <pre><code>      \"default\": \"\"\n</code></pre>","location":"apim/user-guide/publisher/sme/kafka-connector-configuration/#producer"},{"title":"Why Service Management Ecosystem?","text":"<p>API Gateways are evolving; the adoption of micro-services to gain agility and increased pace of innovation has created the need for new technologies and protocols such as service mesh and gRPC.</p> <p>The corresponding explosion of data requires the adoption of Event-Driven Architectures (EDA) and real-time processing capabilities (such as Apache Kafka) to keep up with the growing need for fast decision making, while also meeting the expectations of real-time user experience from service consumers.</p> <p>Also, the proliferation of IoT devices and the emergence of the latest generation of mobile network (5g) creates new opportunities for disruptive business models.</p> <p>In this context, API Gateways are due to evolve in order to embrace these modern architectures and technologies that go beyond traditional HTTP APIs. Gravitee.io Service Management Ecosystem (SME) is designed to enable you to embrace ever increasing complexities and apply consistent and effortless governance on top of both traditional and event-driven APIs.</p> <p>Service Management Ecosystem (SME) enables you to go beyond REST API and embrace modern protocols and backend services to future-proof your API Strategy.</p>","location":"apim/user-guide/publisher/sme/sme-overview/"},{"title":"What is SME?","text":"<p>The SME is composed of a Connector API which provides a framework to allow for any backend protocol to be proxied through the Gravitee API Gateway. The Gravitee.io gateway can now be used as a protocol mediation layer between consumers of service and backend services.</p> <p>image:{% link images/apim/3.x/api-publisher-guide/sme/what-is-sme.png %}[]</p> <p>In addition, the SME will also provide a set of connectors implementing the Connector API in the form of plugins. A plugin consists of a single unit of code/package that can be deployed onto the platform (e.g Kafka, HTTP, MQTT, JDBC) giving you the flexibility to only deploy the connector(s) needed for your use case(s).</p>","location":"apim/user-guide/publisher/sme/sme-overview/#what-is-sme"},{"title":"Overview","text":"<p>This section describes the basic usage of the Kafka connector - producing and consuming messages.</p>","location":"apim/user-guide/publisher/sme/using-kafka-connector/"},{"title":"Producing messages","text":"<p>Using the HTTP <code>POST</code> command to the example endpoint <code>https://api.company.com/kafka/messages</code>, you can send a message with the following structure:</p> <pre><code>https://api.company.com/kafka/messages\n{\n  \"messages\": [\n    {\n      \"key\": \"key\",\n      \"value\": {\n        \"val1\": \"hello\"\n      }\n    }\n  ]\n}\n</code></pre>","location":"apim/user-guide/publisher/sme/using-kafka-connector/#producing-messages"},{"title":"Consuming messages","text":"<p>Using the HTTP <code>GET</code> command to the example endpoint <code>https://api.company.com/kafka/messages</code>, you can receive any available messages.</p>","location":"apim/user-guide/publisher/sme/using-kafka-connector/#consuming-messages"},{"title":"Event-native API Management example use cases","text":"<p>This document assumes you are familiar with synchronous APIs, asynchronous APIs, and the OpenAPI specification.</p> <p>This page describes some example use cases for event-native API management.</p>","location":"apim/v4-beta/v4-beta-event-native-apim-example-use-cases/","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"Prerequisites","text":"","location":"apim/v4-beta/v4-beta-event-native-apim-example-use-cases/#prerequisites","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"Kafka","text":"<p>These examples all depend on Kafka. To set up a Kafka Docker container with the AKHQ UI, follow these steps.</p> <ol> <li> <p>Download     https://raw.githubusercontent.com/tchiotludo/akhq/master/docker-compose.yml.</p> </li> <li> <p>Run it locally.</p> </li> </ol> <pre><code>docker-compose pull\ndocker-compose up\n</code></pre> <p>You can now access the AKHQ UI at http://localhost:8080.</p>","location":"apim/v4-beta/v4-beta-event-native-apim-example-use-cases/#kafka","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"Enabling event-native API management","text":"<p>To run these examples, you must enable the new V4 BETA policy execution engine first by setting the <code>gravitee_api_jupiterMode_enabled</code> environment variable to <code>true</code> on the Management API and the API Gateway.</p> <p>See Environment variables on the Management API and Environment variables on the API Gateway for more detail about setting environment variables.</p>","location":"apim/v4-beta/v4-beta-event-native-apim-example-use-cases/#enabling-event-native-api-management","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"V4 BETA 3.20.x Postman Collection","text":"<p>These examples use the Gravitee V4 BETA 3.20.x Postman Collection, available from the Gravitee Public Workspace in Postman.</p> <p>This collection uses the following four variables:</p>         Variable Description Example     <p><code>management_host</code></p> <p>The host for the Management API</p> <p><code>http://localhost:8083</code></p>   <p><code>management_username</code></p> <p>The username for a management user</p> <p><code>admin</code></p>   <p><code>management_password</code></p> <p>The password for <code>management_username</code></p>    <p><code>gateway_host</code></p> <p>The gateway host</p> <p><code>http://loalhost:8082</code></p>","location":"apim/v4-beta/v4-beta-event-native-apim-example-use-cases/#v4-beta-320x-postman-collection","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"Data ingestion","text":"<p>Some data ingestion examples are illustrated in the following diagram.</p> <p></p> <p>For data ingestion, run the requests in the 01 - Data Ingestion folder of the Postman Collection.</p> <p>You can also use <code>curl</code> to <code>POST</code> data to the endpoint, as shown in the example below.</p> <pre><code>curl -X POST -d \"my_payload\" http://localhost:8082/data/ingestion\n</code></pre>","location":"apim/v4-beta/v4-beta-event-native-apim-example-use-cases/#data-ingestion","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"Event consumption","text":"","location":"apim/v4-beta/v4-beta-event-native-apim-example-use-cases/#event-consumption","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"Streaming: server-sent events (SSE)","text":"<p>For streaming with server-sent events (SSE), run the requests in the 02 - Event Consumption - SSE folder of the Postman Collection.</p> <p>You can test it with <code>curl</code>.</p> <pre><code>curl -N -H \"Accept:text/event-stream\" http://localhost:8082/demo/sse\n</code></pre>","location":"apim/v4-beta/v4-beta-event-native-apim-example-use-cases/#streaming-server-sent-events-sse","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"Streaming: WebSocket","text":"<p>For streaming with WebSocket, run the requests in the 03 - Event Consumption - Websocket folder of the Postman Collection.</p> <p>You can test it through a WebSocket connection in Postman, or you can use the <code>websocat</code> command-line tool as shown in the example below.</p> <pre><code>websocat ws://localhost:8082/demo/ws\n</code></pre>","location":"apim/v4-beta/v4-beta-event-native-apim-example-use-cases/#streaming-websocket","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"Webhooks","text":"<p>For webhooks, run the requests in the 04 - Event Consumption - Webhook folder of the Postman Collection.</p> <p>This request group uses a webhook callback that is called by the API Gateway. The unique callback URL is generated via https://webhook.site.</p> <p>To use these requests, go to https://webhook.site to get your unique callback URL, and update the Postman Collection to use it. For example:</p> <pre><code>{\n  \"configuration\": {\n    \"type\": \"webhook\",\n    \"callbackUrl\": \"https://webhook.site/891490b9-1e37-4b5e-8f91-4d40b9187710\"\n  }\n}\n</code></pre>","location":"apim/v4-beta/v4-beta-event-native-apim-example-use-cases/#webhooks","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"Webhooks with subscription filter","text":"<p>For webhooks with subscription filters, run the requests in the 05 - Event Consumption - Webhook - Message Filtering folder of the Postman Collection.</p> <p>Use the following policy configuration.</p> <pre><code>{\n  \"name\": \"Message filtering\",\n  \"description\": \"Apply filter to messages\",\n  \"enabled\": true,\n  \"policy\": \"message-filtering\",\n  \"configuration\": {\n    \"filter\": \"{#jsonPath(#message.content, '$.feature') == #subscription.metadata.feature}\"\n  }\n}\n</code></pre>","location":"apim/v4-beta/v4-beta-event-native-apim-example-use-cases/#webhooks-with-subscription-filter","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"Event-native API Management (V4 BETA)","text":"","location":"apim/v4-beta/v4-beta-event-native-apim-introduction/","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"Event-driven asynchronous APIs","text":"<p>Most developers are familiar with synchronous APIs, where the client sends a request to a server, and the server sends a response back. Every time the client needs new data, it has to send a request. You can think of synchronous APIs as a client pull model. RESTful APIs are a type of synchronous API.</p> <p>In contrast, asynchronous APIs are event-driven - the initial request opens a connection and data (responses) is received back as and when it becomes available, where certain events would trigger the responses. Asynchronous APIs also allow you to stream data - a common use case in banking and finance systems and applications, as well as many other domains. Asynchronous APIs can use callbacks (such as synchronous API webhooks) if the requested data is not available at the time of the request. You can think of asynchronous APIs as a \u2018server push\u2019 model. AsyncAPIs are a type of asynchronous API.</p>","location":"apim/v4-beta/v4-beta-event-native-apim-introduction/#event-driven-asynchronous-apis","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"Gravitee\u2019s event-native API management","text":"<p>With the rise of cloud computing, many vendors started to build their solutions for the cloud. Rather than taking on-premises software and converting it to work as SaaS, it was built from the ground to be cloud-based. These solutions are said to be cloud-native.</p> <p>Event-native API management is similar. Rather than taking a synchronous API management solution and converting it to handle event-driven APIs, an event-native API management solution is built from the ground up to handle event-driven APIs.</p> <p>Gravitee\u2019s API management solution can run in event-native mode, and it can support all asynchronous use cases, such as streaming or event-driven APIs. Of course, Gravitee\u2019s API management solution also supports synchronous use cases.</p> <p>Gravitee can act as a bridge between synchronous and asynchronous APIs.</p> <p>For example, Gravitee can subscribe to a Kafka topic and then allow filtered HTTP GET subscriptions from clients as shown in the following diagram.</p> <p></p>","location":"apim/v4-beta/v4-beta-event-native-apim-introduction/#gravitees-event-native-api-management","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"BETA Features","text":"<p>The following features are available in the BETA release.</p>","location":"apim/v4-beta/v4-beta-event-native-apim-introduction/#beta-features","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"HTTP POST and HTTP GET entrypoints","text":"<p>The HTTP POST and HTTP GET entrypoints are Community Edition (OSS) plugins that enable external clients to publish and receive data via standard HTTP POST / HTTP GET requests, and ease the ingestion of data into event-oriented backends like Kafka.</p> <p>They are available as separate plugins you can download from the entrypoints plugin download page.</p> <p>With the HTTP POST workflow, a client application running on HTTP can post content to the Gravitee Gateway. The Gateway can then take that content and push it over to Kafka as a message that Kafka can ingest. The Gravitee Gateway acts as a protocol mediation layer in this context. This enables API owners to quickly set up a sync-to-async integration.</p> <p>The diagram below shows the workflow for this use case:</p> <p></p> <p>The HTTP POST entrypoint enables you to push messages to any supported event broker via a \"sync call\" (post) - it can be used in combination with specific Asynchronous API endpoints in different ways, depending on what publish and subscribe mode actions are possible between the two when using a connector.</p>","location":"apim/v4-beta/v4-beta-event-native-apim-introduction/#http-post-and-http-get-entrypoints","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"WebSocket and SSE entrypoints","text":"<p>The Server-Sent Events (SSE) and WebSocket entrypoints are available as separate plugins you can download from the entrypoints plugin download page. Please note that you need an Enterprise Edition (EE) license to use the SSE Advanced entrypoint capabilities.</p> <p>This feature enables you to front your event-driven backend - currently only using Kafka or the MQTT5 connectors - with Websocket or Server-Sent Events (SSE) so that API consumers can access events from the Kafka backend via one of these more consumer-friendly protocols.</p> <p>For example, if an API consumer cannot connect to a native Kafka instance due to technical limitations (for example, if they cannot implement a Kafka client themselves), Kafka topics can be made available to that consumer via a more consumer-friendly protocol such as SSE or Websocket.</p> <p>The diagram below shows the workflow for this use case:</p> <p></p> <p>This feature enables you to potentially cover use cases in the fields of Event-Driven Architecture (EDA) and Internet of Things (IoT) without the Gateway and API Management components becoming a bottleneck.</p> <p>In comparison to the HTTP POST entrypoint use case using Kafka (where the HTTP POST method is just about sending information from the client app to Kafka), with Websocket it is possible for the client app to send and receive information from Kafka as well. SSE can consume information from Kafka.</p>","location":"apim/v4-beta/v4-beta-event-native-apim-introduction/#websocket-and-sse-entrypoints","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"Webhook entrypoint","text":"<p>This is a feature that enables you to front your backend with a Webhook. It has CE/OSS and EE versions - Webhook, and Webhook Advanced, respectively. Both variants are available as part of a separate plugin you can download from the entrypoints plugin download page. Please note that you need an Enterprise Edition (EE) license to use the Webhook Advanced entrypoint capabilities.</p> <p>With Webhook support, an API consumer subscribes to the Webhook API, which basically indicates to the Gateway to listen for specific Kafka messages and then call the consumer to let them know that an expected event has occurred. This communication is performed via Webhook, however it is always up to the Gateway to push the events or messages to the consumer.</p> <p>The diagram below shows the workflow for this use case:</p> <p></p>","location":"apim/v4-beta/v4-beta-event-native-apim-introduction/#webhook-entrypoint","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"Security","text":"<p>Gravitee can still provide the same security as in previous versions. You can secure access using an API key, JWT, or OAuth.</p>","location":"apim/v4-beta/v4-beta-event-native-apim-introduction/#security","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"Event-native API Management (V4 BETA) User Guide","text":"<p>This document assumes you are familiar with synchronous APIs, asynchronous APIs, and the OpenAPI specification.</p> <p>Before running any of the examples on this page, work through some of the example use cases so you know that the event-native engine is running.</p>","location":"apim/v4-beta/v4-beta-event-native-apim-user-guide/","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"Asynchronous APIs","text":"<p>In this release, you can create asynchronous APIs and connect to event brokers and asynchronous data sources. You can configure asynchronous API connections using the RESTful interface to the management API.</p> <p>The OpenAPI specification for the management API is available at <code>swagger.json</code> (reference documentation). Examples of how to use the management API to configure asynchronous APIs can be found in the Gravitee Postman Collections, which are described in example use cases.</p> <p>The management API is in beta and it may change.</p>","location":"apim/v4-beta/v4-beta-event-native-apim-user-guide/#asynchronous-apis","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"Entrypoints and endpoints","text":"<p>An entrypoint is how an end user connects to the Gravitee Gateway. An endpoint is how the Gravitee Gateway connects to the source of data.</p> <p>The following types of entrypoints are available:</p> <ul> <li>SSE (Server-Sent Events)</li> <li>SSE advanced (Enterprise Edition only)</li> <li>WebSocket</li> <li>HTTP GET</li> <li>HTTP POST</li> <li>Webhook</li> <li>Webhook advanced (Enterprise Edition only)</li> </ul> <p>For more information about these entrypoints, see HTTP POST and HTTP GET entrypoints and WebSocket and SSE entrypoints.</p> <p>The following types of endpoints are available:</p> <ul> <li>Kafka</li> <li>Kafka advanced (Enterprise Edition only)</li> <li>MQTT</li> <li>MQTT advanced (Enterprise Edition only)</li> </ul>","location":"apim/v4-beta/v4-beta-event-native-apim-user-guide/#entrypoints-and-endpoints","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"How to create a V4 BETA asynchronous API","text":"<p>The Gravitee V4 BETA Postman Collection contains several examples of how to create and test an asynchronous API using the event-native V4 BETA API definition and the new V4 BETA policy execution engine.</p> <p>For example, to create an HTTP POST entrypoint that connects to a Kafka endpoint, send a POST request to <code>{{management_host}}/management/organizations/DEFAULT/environments/DEFAULT/v4/apis/</code>, where <code>{{management_host}}</code> is the host for the management API, with the following message body:</p> <pre><code>    {\n        \"name\": \"Data Ingestion to Kafka\",\n        \"apiVersion\": \"1.0\",\n        \"definitionVersion\": \"4.0.0\",\n        \"type\": \"async\",\n        \"description\": \"Data Ingestion to Kafka\",\n        \"listeners\": [\n            {\n                \"type\": \"http\",\n                \"paths\": [\n                    {\n                        \"path\": \"/data/ingestion/kafka\"\n                    }\n                ],\n                \"entrypoints\": [\n                    {\n                        \"type\": \"http-post\",\n                        \"configuration\": {\n                            \"requestHeadersToMessage\": false\n                        }\n                    }\n                ]\n            }\n        ],\n        \"endpointGroups\": [\n            {\n                \"name\": \"default\",\n                \"type\": \"kafka\",\n                \"endpoints\": [\n                    {\n                        \"name\": \"default\",\n                        \"type\": \"kafka\",\n                        \"weight\": 1,\n                        \"inheritConfiguration\": false,\n                        \"configuration\": {\n                            \"bootstrapServers\": \"kafka:9092\",\n                            \"topics\" : [\"demo\"],\n                            \"consumer\" : {\n                                \"enabled\": false\n                            },\n                            \"producer\": {\n                                \"enabled\": true\n                            }\n                        }\n                    }\n                ]\n            }\n        ],\n        \"flows\": [\n            {\n                \"name\": \"\",\n                \"selectors\": [],\n                \"request\": [],\n                \"response\": [],\n                \"subscribe\": [],\n                \"publish\": [],\n                \"enabled\": true\n            }\n        ]\n    }\n</code></pre>","location":"apim/v4-beta/v4-beta-event-native-apim-user-guide/#how-to-create-a-v4-beta-asynchronous-api","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"Quality of Service","text":"<p>When working with asynchronous APIs, quality of service is important. Quality of service defines the guaranteed level of message delivery. For example, a quality of service of \"none\" means that a given message might be delivered zero, one, or several times. A quality of service of \"at-most-once\" means that a given message will be delivered zero or one times, with no duplication.</p> <p>A higher quality of service could lead to lower system performance depending on the endpoint chosen.</p> <p>The quality-of-service levels are described in the following table.</p>  Table Quality of service levels       <p>Level</p> <p>Description</p>   <p>None</p> <p>A given message might be delivered zero, one, or many times. This level allows high throughput and good performance but without guaranteed delivery. After failure or disconnection, the client will only receive messages sent after reconnection.</p>   <p>Auto (0 or N)</p> <p>A given message might be delivered zero, one, or many times. This level allows a trade-off between performance and delivery guarantee. Delivery is highly dependent on the capabilities supported by the endpoint connector. In case of failure or disconnection, after reconnection the client will resume, if possible, from a previously saved state, although duplication of messages could potentially exist.</p>   <p>At-Most-Once (0 or 1)</p> <p>A given message might be delivered zero times or once without any duplication. Depending on the capabilities of the entrypoint connector, performance could be degraded.</p>   <p>At-Least-Once (1 or N)</p> <p>A given message is delivered once or many times. This level gives a good balance between guaranteed delivery and performance when compared to At-Most-Once, especially when the entrypoint connector is not able to resume message streams after failure.</p>","location":"apim/v4-beta/v4-beta-event-native-apim-user-guide/#quality-of-service","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"Setting quality of service","text":"<p>You can set quality of service levels with the <code>qos</code> object in the <code>entrypoints</code> object, as shown in the following example. See the <code>swagger.json</code> definition of the Management API for a list of possible <code>qos</code> values you can specify.</p> <pre><code>  \"entrypoints\": [\n    {\n      \"type\": \"sse\",\n      \"qos\": \"none\",\n      \"configuration\": {\n        \"heartbeatIntervalInMs\": 5000,\n        \"metadataAsComment\": false,\n        \"headersAsComment\": false\n      }\n    }\n  ]\n</code></pre>","location":"apim/v4-beta/v4-beta-event-native-apim-user-guide/#setting-quality-of-service","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"Compatibility","text":"<p>Not all levels of quality of service work with every entrypoint / endpoint combination. The following table shows how they can be used.</p>  Table Quality of service compatibility matrix          <p>Entrypoint</p> <p>MQTT5 endpoint</p> <p>MQTT5 advanced endpoint</p> <p>Kafka endpoint</p> <p>Kafka advanced endpoint</p>   <p>SSE</p> <p>At-Least-Once, At-Most-Once</p> <p>At-Least-Once, At-Most-Once</p> <p>None, Auto</p> <p>None, Auto, At-Least-Once, At-Most-Once</p>   <p>SSE advanced</p> <p>At-Least-Once, At-Most-Once</p> <p>At-Least-Once, At-Most-Once</p> <p>None, Auto</p> <p>None, Auto, At-Least-Once, At-Most-Once</p>   <p>HTTP POST</p> <p>None, Auto</p> <p>None, Auto</p> <p>None, Auto</p> <p>None, Auto</p>   <p>HTTP GET</p> <p>Auto</p> <p>Auto</p> <p>Auto</p> <p>Auto, At-Least-Once, At-Most-Once</p>   <p>Websocket</p> <p>None, Auto</p> <p>None, Auto</p> <p>None, Auto</p> <p>None, Auto</p>   <p>Webhook</p> <p>At-Least-Once, At-Most-Once</p> <p>At-Least-Once, At-Most-Once</p> <p>None, Auto</p> <p>None, Auto, At-Least-Once, At-Most-Once</p>   <p>Webhook advanced</p> <p>At-Least-Once, At-Most-Once</p> <p>At-Least-Once, At-Most-Once</p> <p>None, Auto</p> <p>None, Auto, At-Least-Once, At-Most-Once</p>","location":"apim/v4-beta/v4-beta-event-native-apim-user-guide/#compatibility","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"Policies","text":"<p>Policies are steps in the gateway execution chain. A policy guarantees that a given business rule will be fulfilled during processing.</p> <p>Policies can be set on request, response, subscribe, or publish phases. The following example shows how to set a policy on a subscribe phase.</p> <pre><code>  \"subscribe\": [\n    {\n      \"name\": \"Message filtering\",\n      \"description\": \"Apply filter to messages\",\n      \"enabled\": true,\n      \"policy\": \"message-filtering\",\n      \"configuration\": {\n        \"filter\": \"{#message.headers.foo == #subscription.metadata['bar']}\"\n      }\n    }\n  ]\n</code></pre> <p>For an example, see 04 - Event Consumption - Webhook &gt; Webhook Messaging Filtering &gt; Create API in the Gravitee V4 BETA Postman Collection.</p>","location":"apim/v4-beta/v4-beta-event-native-apim-user-guide/#policies","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"Use cases","text":"<p>The Gravitee V4 BETA Postman Collection contains several examples of how end users can work with your asynchronous APIs. Some examples are described on Event consumption.</p>","location":"apim/v4-beta/v4-beta-event-native-apim-user-guide/#use-cases","tags":["Event-native API management","V4 BETA API Definition","New in version 3.20.0","BETA release"]},{"title":"V3 and V4 (BETA) policy execution engines compared","text":"<p>In this section you can learn about all the differences between the new V4 BETA policy execution engine and the existing V3 execution engine, as well as get guidance on managing changes in system behavior and the potential design and operational impact when switching to the new policy execution engine mode. The information is grouped by functional area in the sub-sections below.</p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"Policy execution phases/scopes and execution order","text":"","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#policy-execution-phasesscopes-and-execution-order","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"V3 policy execution engine mode","text":"<p>In V3 mode, different execution scopes are required in order to indicate at which level a policy will work, as follows:</p> <ul> <li><code>REQUEST</code>: The policy only works on request headers. It never accesses the request body.</li> <li><code>REQUEST_CONTENT</code>: The policy works at request content level and can access the request body.</li> <li><code>RESPONSE</code>: The policy only works on response headers. It never accesses the response body.</li> <li><code>RESPONSE_CONTENT</code>: The policy works at response content level and can access the response body.</li> </ul> <p>As a result, all policies working on the body content are postponed to be executed after the policies working on headers. This leads to an execution order than is often different than the one originally designed, as shown in the following diagram:</p> <p></p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#v3-policy-execution-engine-mode","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"New V4 BETA policy execution engine mode","text":"<p>In V4 BETA mode, the <code>REQUEST_CONTENT</code> and <code>RESPONSE_CONTENT</code> scopes (which we now call phases) are no longer considered - all policies are executed in the exact order of design, regardless of whether they work on the content or not. This is shown in the following diagram:</p> <p></p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#new-v4-beta-policy-execution-engine-mode","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"Potential impact","text":"<p>If you have designed your APIs with V3 policy execution engine mode ordering in mind, when you switch to using the new V4 BETA mode there may be policy execution behavior changes because the policy execution will be reordered to match the original design policy order.</p> <p>To smooth the transition process to the new mode, you can use the debug mode to test the new behavior and adapt your APIs, so they can be safely redeployed in the new mode. For example, you can extract some information from the payload to assign it to a header.</p> <p>In case of any issues or unexpected behavior, you can switch back to V3 execution mode at any time.</p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#potential-impact","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"Logging","text":"","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#logging","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"V3 policy execution engine mode","text":"<p>In V3 mode, the following issues exist with logging:</p> <ul> <li>A 502 status code would normally indicate that the server has responded with a 502 status code, however this is not possible if the connection has failed.</li> <li>Consumer response headers are not displayed clearly.</li> </ul> <p>For example:</p> <p></p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#v3-policy-execution-engine-mode_1","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"New V4 BETA policy execution engine mode","text":"<p>In V4 BETA mode:</p> <ul> <li>When a connectivity error occurs during a connection attempt to the backend endpoint, the Gateway response displays an HTTP status code 0 and no headers. This makes it clear that no response has been received from the backend endpoint due to the connectivity error.</li> <li>Consumer response headers are displayed more clearly.</li> </ul> <p>For example:</p> <p></p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#new-v4-beta-policy-execution-engine-mode_1","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"Condition evaluation","text":"","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#condition-evaluation","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"V3 policy execution engine mode","text":"<p>In V3 mode, when the Gateway provides a valid EL expression that fails to be evaluated because it is trying to access missing data, the Gateway returns a 500 error with an obscure message.</p> <p>For example:</p> <p></p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#v3-policy-execution-engine-mode_2","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"New V4 BETA policy execution engine mode","text":"<p>In V4 BETA mode, when a valid EL expression is evaluated as <code>true</code>, the policy (or flow) is executed. Otherwise, it is skipped.</p> <p>A policy is skipped when: * The Expression Language (EL) expression is evaluated as <code>false</code>. * The EL expression evaluation fails because the expected data tested is missing.</p> <p>This is shown in the example below:</p> <p></p> <p>Mastering EL expressions can be difficult, so the new mode ensures that if an EL expression fails because it is trying to access missing data, the condition is evaluated as <code>false</code>. This makes the use of EL expressions much simpler and easier.</p> <p>For example, <code>{#request.headers['X-Test'][0] == 'something'}</code> will just skip the execution even if the request header <code>X-Test</code> is not specified.</p> <p>The execution still fails and throws an error if the provided EL expression cannot be parsed (for example, if it is syntactically invalid).</p> <p>The example below shows the new behavior:</p> <p></p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#new-v4-beta-policy-execution-engine-mode_2","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"Potential impact","text":"<p>In V4 BETA mode, conditions evaluated as errors skip the policy or flow execution instead of returning a 500 error.</p> <p>As a result, the number of <code>500</code> errors should decrease after activating the new V4 BETA policy execution engine mode.</p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#potential-impact_1","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"Connection: close","text":"","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#connection-close","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"V3 policy execution engine mode","text":"<p>In V3 mode, when a bad request is sent to the Gateway, the Gateway indicates a <code>Connection: close</code> response header and effectively closes the connection. The next same call from a client application will then end with the same 400 bad request code and that connection will be closed too. This could happen over and over again as long as the client application sends requests to the Gateway with the same invalid data. The same behavior is in place for 404 \"not found\" errors.</p> <p>Creating a connection is costly for the Gateway and such issues can dramatically impact performance - especially if the consumer intensively makes a lot of bad requests.</p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#v3-policy-execution-engine-mode_3","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"New V4 BETA policy execution engine mode","text":"<p>The new execution engine considers that a bad request does not require to close the connection as it is a client-side error. The engine will only close the connection in case of a server-side error.</p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#new-v4-beta-policy-execution-engine-mode_3","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"Potential impact","text":"<p>You can expect decreased CPU consumption in the new mode, especially when a lot of requests end with 4xx errors.</p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#potential-impact_2","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"Flow condition","text":"","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#flow-condition","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"V3 policy execution engine mode","text":"<p>In V3 mode, a condition can be defined once for the whole flow but it is evaluated before executing each phase of the flow (<code>REQUEST</code> and <code>RESPONSE</code> phases). This could lead to a partial flow execution - for instance, when trying to define a condition based on a request header and this same header is removed during the <code>REQUEST</code> phase (for example, the user does not want it to be transmitted to the backend). In such cases, the condition is re-evaluated and the <code>RESPONSE</code> phase is skipped completely. The same scenario could happen with a platform flow for the same reasons.</p> <p>The example below shows this behavior:</p> <p></p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#v3-policy-execution-engine-mode_4","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"New V4 BETA policy execution engine mode","text":"<p>In V4 mode, the flow condition will be applied once for the whole flow - if the condition is evaluated as <code>true</code>, then both the <code>REQUEST</code> and the <code>RESPONSE</code> phases will be executed.</p> <p>The example below shows the new behavior:</p> <p></p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#new-v4-beta-policy-execution-engine-mode_4","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"Potential impact","text":"<p>If you expect the <code>RESPONSE</code> phase to be skipped in the scenario described above, you must refactor your flows since both the <code>REQUEST</code> and <code>RESPONSE</code> phases will be executed as long as the condition is evaluated as <code>true</code>.</p> <p>To mimic the V3 behavior while executing in the new V4 BETA policy execution engine mode, you can create a new flow and add a condition directly on the policies.</p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#potential-impact_3","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"Flow interruption","text":"","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#flow-interruption","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"V3 policy execution engine mode","text":"<p>In V3 mode, when a policy fails, the execution flow is interrupted and the response is returned to the client application. As a result, the platform flow response is also skipped. This leads to unexpected behavior, especially when POST actions are expected (for example, for a custom metrics reporter).</p> <p>The example below shows this behavior:</p> <p></p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#v3-policy-execution-engine-mode_5","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"New V4 BETA policy execution engine mode","text":"<p>The new V4 BETA policy execution engine ensures that platform flows are always executed (except in case of an irrecoverable error). This allows the API to fail without skipping important steps in the flow occurring at a higher level.</p> <p>The example below shows the new behavior:</p> <p></p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#new-v4-beta-policy-execution-engine-mode_5","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"Access-Control-Allowed-Origin","text":"","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#access-control-allowed-origin","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"V3 policy execution engine mode","text":"<p>In V3 mode, when configuring Cross-Origin Resource Sharing (CORS) to allow some origin, the Gateway properly validates the origin but returns <code>Access-Control-Allowed-Origin: *</code> in the response header.</p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#v3-policy-execution-engine-mode_6","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"New V4 BETA policy execution engine mode","text":"<p>In V4 mode, the allowed origin is returned instead of <code>*</code> - for example, <code>Access-Control-Allowed-Origin: https://test.gravitee.io</code>.</p> <p>The example below shows the new behavior:</p> <p></p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#new-v4-beta-policy-execution-engine-mode_6","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"Expression Language (EL) expression parsing","text":"","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#expression-language-el-expression-parsing","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"V3 policy execution engine mode","text":"<p>In V3 mode, an EL expression is parsed each time it is evaluated.</p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#v3-policy-execution-engine-mode_7","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"New V4 BETA policy execution engine mode","text":"<p>In V4 mode, a new caching mechanism allows to cache the parsed EL expression for later reuse and therefore to avoid useless parsing of the same expression multiple times.</p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#new-v4-beta-policy-execution-engine-mode_7","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"Potential impact","text":"<p>The caching of parsed EL expressions provides for enhanced performance.</p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#potential-impact_4","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"EL expression based on the body","text":"","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#el-expression-based-on-the-body","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"V3 policy execution engine mode","text":"<p>In V3 mode, using an EL expression such as <code>{#request.content == 'something'}</code> is limited to a few policies working at <code>REQUEST_CONTENT</code> or <code>RESPONSE_CONTENT</code> - for example, assign metrics, assign content, request validation.</p> <p>Defining a policy or a flow condition based on request or response body is not supported.</p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#v3-policy-execution-engine-mode_8","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"New V4 BETA policy execution engine mode","text":"<p>When V4 BETA mode is enabled on an API, it is possible to define a condition based on the body.</p> <p>It is now possible to execute a complete flow or a policy by applying a condition on the body such as <code>{#request.content == 'something'}</code>.</p> <p>Depending on the expected content type, it is also possible to define a condition based on JSON or XML content such as <code>{#request.jsonContent.foo.bar == 'something'}</code> where the request content looks like this:</p> <pre><code>  {\n    \"foo\": {\n      \"bar\": \"something\"\n    }\n  }\n</code></pre> <p>The same applies for XML content using <code>{#request.xmlContent.foo.bar == 'something'}</code>:</p> <pre><code>  &lt;foo&gt;\n    &lt;bar&gt;something&lt;/bar&gt;\n  &lt;/foo&gt;\n</code></pre>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#new-v4-beta-policy-execution-engine-mode_8","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"Potential impact","text":"<p>Use with caution - using an EL body-based expression is resource-heavy and should be avoided as much as possible. Working with request or response content can significantly degrade performance and consumes substantially more memory on the Gateway.</p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#potential-impact_5","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"Policy support","text":"","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#policy-support","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"V3 policy execution engine mode","text":"<p>In V3 mode, all existing supported policies will continue to work as before without a change.</p> <p>Over time, all policies will be migrated to support the new V4 BETA policy execution engine mode. The migration will ensure that all policies are backward compatible with the V3 execution mode throughout the V3 mode\u2019s normal product support life cycle.</p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#v3-policy-execution-engine-mode_9","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"New V4 BETA policy execution engine mode","text":"<p>The new V4 BETA policy execution engine mode comes with a new Policy interface, which allows you to execute all existing V3-mode policies without the need for any changes.</p> <p>All policies related to security have already been migrated to support both V3 and V4 execution engine modes, as follows:</p> <ul> <li>Keyless</li> <li>ApiKey</li> <li>JWT</li> <li>OAuth2</li> </ul> <p>Custom policies developed by community users or customers using V3 mode should be perfectly compatible with the new V$ BETA mode, however we strongly recommend switching to the new V4 BETA mode for custom policy implementation (a developer guide will be published soon).</p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#new-v4-beta-policy-execution-engine-mode_9","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"Timeout Management","text":"","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#timeout-management","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"V3 policy execution engine mode","text":"<p>In V3 mode, when a timeout is configured (<code>http.requestTimeout</code>) and triggered due to a request that is too slow (or a policy taking too much time to execute, such as an HTTP callout policy), the API platform flows are skipped and a 504 status is sent as a response to the client.</p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#v3-policy-execution-engine-mode_10","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"New V4 BETA policy execution engine mode","text":"<p>In V4 BETA mode, values of <code>0</code> and less are treated as meaning no timeout (like in V3 mode). If you configure the timeout with a positive value, then it will act normally.</p> <p>If no configuration is provided, a default configuration is set to default to 30000 ms timeout.</p> <p>A timeout can now be triggered on two places in the chain, as follows:</p> <ul> <li>The flow can be interrupted between the beginning of the request and the end of response API flow. In this case, a platform response flow will be executed.</li> <li>The flow can be interrupted during the platform response flow because the overall request time is too big, causing a 504 response and getting the platform response flow interrupted.</li> </ul> <p>Two properties are available to address this:</p> <ul> <li><code>http.requestTimeout</code> - the duration used to configure the timeout of the request.</li> <li><code>http.requestTimeoutGraceDelay</code> - an additional time used to give the platform response flow a chance to execute.</li> </ul> <p>The timeout value is calculated from the following two properties: - <code>Timeout = Max(http.requestTimeoutGraceDelay, http.requestTimeout - apiElapsedTime)</code> - With <code>apiElapsedTime = System.currentTimeMillis() - request().timestamp()</code>.</p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#new-v4-beta-policy-execution-engine-mode_10","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"Examples","text":"<p>In the following examples we assume that there is no timeout defined for the backend in the API\u2019s endpoint configuration. In real life, those timeout values should be shorter than <code>http.requestTimeout</code>, and should interrupt the flow at invoker level.</p> <p>We will use <code>http.requestTimeout=2000ms</code> and <code>http.requestTimeoutGraceDelay=30ms</code>.</p> <p>The example below shows timelines indicating when a timeout should occur depending on the duration of the API flow and the response platform flows:</p> <p></p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#examples","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"Plan selection","text":"","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#plan-selection","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"Common behavior","text":"<p>The plan selection workflow parses all the published plans in the following order: JWT, Oauth2, ApiKey, Keyless.</p> <p>The parsed plan is selected for execution if all the following conditions are met: - The request contains a token corresponding to this plan type (api-key header, authorization header). - The plan condition rule is either not set or is set incorrectly. - There is an active subscription matching the incoming request.</p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#common-behavior","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"V3 policy execution engine mode","text":"<p>In V3 mode, the OAuth2 plan is selected even if the incoming request does not match a subscription.</p> <p>No JWT token introspection is done during OAuth2 plan selection.</p> <p>If there are multiple Oauth2 plans, that would lead to the selection of an irrelevant one.</p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#v3-policy-execution-engine-mode_11","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"New V4 BETA policy execution engine mode","text":"<p>In V4 BETA mode, the OAuth2 plan is not selected if the incoming request does not match a subscription.</p> <p>During the OAuth2 plan selection, a token introspection is released in order to retrieve the <code>client_id</code>, which allows searching for a subscription.</p> <p>Due to concerns about performance, a cache system is available to avoid doing the same token introspection multiple times.</p> <p>Where possible, it is recommended to use selection rules if there are multiple Oauth2 plans, in order to avoid any unnecessary token introspection.</p> <p>The policy has been changed for the Keyless plan - its activation is now prevented in case a security token has been detected in the incoming request by one of the previous plans. Therefore, if an API has multiple plans (JWT, Oauth2, Apikey, Keyless) and the incoming request contains a token or an ApiKey that does not match any of the existing plans, then the Keyless plan will not be activated and the user will receive a generic 401 response without any details.</p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-evolution/#new-v4-beta-policy-execution-engine-mode_11","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"V4 policy execution engine (V4 BETA)","text":"<p>Introduced in release 3.19.0 of the Gravitee API Management platform, there is a beta version of a new policy execution engine that enables an improved execution flow for synchronous APIs and supports event-driven policy execution for asynchronous APIs. It is based on a modern and fully reactive architecture designed to address a number of challenges Gravitee users have been facing with the existing policy execution engine, available with the Gravitee\u2019s V2 API definition specification used in versions prior to APIM 3.19.x.</p> <p>The new policy execution engine builds on the new V4 BETA API definition of Gravitee\u2019s event-native platform. This adds features such as native support for Pub/Sub (Publish-Subscribe) design and enabling policies at message level. The new V4 BETA event-native API definition makes it possible for the Gateway to handle asynchronous API use cases.</p> <p>The new engine provides the following capabilities:</p> <ul> <li>The ability to execute policies in the exact order in which they have been placed in Design Studio (see Create and configure an API flow and Configure plan flows and policies This addresses some issues experienced by users related to the order in which policies are executed by the V3 engine where policies interacting with the Head part of the request are always executed first, even when placed in a different order in the Design Studio during the design phase. With the new execution engine, it is possible to apply logic on a head policy based on the payload of the request - for example, to apply dynamic routing based on the request payload.</li> <li>Proper isolation between platform-level policies and API-level policies during policy execution. This ensures that platform-level policies are always executed prior to any API-level policies during the request stage, and after any API-level policies during the response stage.</li> <li>Removal of the need to define a scope for policies (<code>onRequest</code>, <code>onRequestContent</code>, <code>onResponse</code>, <code>onResponseContent</code>).</li> <li>The introduction of new API types to better differentiate REST APIs from Async APIs (Websocket, SSE, Webhook), as a foundation to fully support the execution of Async APIs.</li> </ul> <p>This BETA release does not provide GUI support for these capabilities. You can check out the new engine behaviour with the V4 BETA event-native API Management example use cases.</p> <p>This new policy execution engine has been released as a BETA version: it should not be used in production. The production-ready GA release, due in 2023, will come with additional features - contact us if you want to know more about it and what new capabilities and improvements we are bringing to event-native API Management regarding synchronous and asynchronous APIs.</p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-introduction/","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"How to enable and disable the new engine","text":"<p>To enable the new V4 BETA policy execution engine, create a new environment variable called <code>gravitee_api_jupiterMode_enabled</code> and set it to <code>true</code> on the Management API and the API Gateway.</p> <p>To disable the new engine and revert to using the V3 engine mode, set this environment variable to <code>false</code>.</p> <p>See Environment variables on the Management API and Environment variables on the API Gateway for more detail about setting environment variables.</p>","location":"apim/v4-beta/v4-beta-new-policy-execution-engine-introduction/#how-to-enable-and-disable-the-new-engine","tags":["Event-native API Management","New V4 BETA Policy Execution Engine","Introduced in version 3.19.0","BETA release"]},{"title":"Examples and best practices","text":"<p>Coming soon!</p>","location":"best-practice/"},{"title":"Gravitee.io Cockpit","text":"","location":"cockpit/"},{"title":"Overview","text":"<p>Gravitee Cockpit is a centralized, multi-environment tool for managing all your Gravitee API Management and Access Management installations in a single place.</p> <p>image::{% link images/cockpit/cockpit-dashboard.png %}[]</p>","location":"cockpit/#overview"},{"title":"Cockpit hierarchy","text":"<p>Cockpit is based on a hierarchy of the following entity types:</p> <p>image::{% link images/cockpit/entity-hierarchy.png %}[]</p>         <p>Entity</p> <p>Description</p> <p>Additional information</p>   <p>Account</p> <p>The top level entity, your company. One user can have multiple accounts.</p>    <p>Organization</p> <p>A logical part of your company in the way that makes most sense in your setup, for example a region or business unit. There can be multiple organizations linked to one account.</p> <p>The organization and environment entities defined in Cockpit are equivalent to the same entities in APIM and AM, including the roles you can define for them (for example, the <code>ORGNIZATION_OWNER</code> role exists in both APIM and AM).</p> <p>Learn more about organizations and environments in link:{{ /apim/3.x/apim_adminguide_organizations_and_environments.html</p>   <p>relative_url }}[APIM^] and link:{{ /am/current/am_adminguide_organizations_and_environments.html</p> <p>relative_url }}[AM^].</p>    <p>Environment</p> <p>An environment in an IT infrastructure, such as development or production. There can be multiple environments linked to one organization.</p> <p>Installation</p> <p>Node</p>   <p>APIM and AM installations, linked to environments in Cockpit. Each linked APIM and AM installation automatically reports its REST API and Gateway nodes to Cockpit.</p> <p>Nodes can belong to multiple environments. You can configure the organizations and environments associated with Gateway nodes in APIM and AM, by updating the Gateway configuration files.</p> <p>Only Gateway nodes are configurable in this way, not REST API nodes.</p> <p>Learn more about updating a Gateway configuration in the <code>gravitee.yml</code> file in link:{{ /apim/3.x/apim_installguide_gateway_configuration.html</p> <p>relative_url }}[APIM^] and link:{{ /am/current/am_installguide_gateway_configuration.html</p>    <p>Each entity managed in Cockpit has some common properties:</p> <ul> <li> <p>ID: an internal ID that is never shown in the Cockpit UI, but that     you can find if you look at the API responses.</p> </li> <li> <p>HRID: a human readable ID of the entity. This ID is unique (no two     environments in the same organization can have the same HRID), and     they are used to provide readable URLs.</p> </li> <li> <p>Name: the name of the entity.</p> </li> <li> <p>Description: a description of the entity.</p> </li> </ul>","location":"cockpit/#cockpit-hierarchy"},{"title":"Example hierarchy","text":"<p>The Cockpit hierarchy pictured below has the following setup:</p> <ul> <li> <p>One APIM installation, with two Gateway nodes and one REST API node.</p> </li> <li> <p>One AM installation, with one Gateway node and one REST API node.</p> </li> </ul> <p>image::{% link images/cockpit/apim-am-nodes.png %}[]</p>","location":"cockpit/#example-hierarchy"},{"title":"Gravitee Developer Community Forum","text":"<p>The Gravitee Developer Community Forum brings together our developer community, clients, and partners, providing a platform for discussions, collaboration, sharing best practices, and learning about the Gravitee products in an interactive and engaging way.</p> <p>Check it out at community.gravitee.io!</p>","location":"dev-community/","tags":["Gravitee","Community","Forum","Developer community"]},{"title":"Gravitee Platform Enterprise Edition","text":"<p>Gravitee\u2019s open source roots are what make us great - we own our entire stack, and we believe that our code powers the best open source API Management and API Access Management products on the market.</p> <p>The Community Edition (CE) of the Gravitee API Management platform is built on these open source foundations.</p> <p>The Enterprise Edition (EE) of the platform builds on top of that to enable organizations to fully manage, secure, monitor, and govern their entire API ecosystem. The EE includes everything from the CE, and offers additional features that bring many new benefits and exciting capabilities to help you enable effortless control over every aspect of your organization\u2019s API ecosystem.</p> <p>The capability matrix below outlines the differences between the CE and the EE in order to help clients to make the most educated buying decision.</p>","location":"ee/","tags":["Enterprise Edition","EE"]},{"title":"Community Edition vs Enterprise Edition - capability matrix","text":"<p>The Gravitee Enterprise Edition includes everything from the Community Edition plus additional modules, plugins, capabilities, and unlocked use options, as indicated below.</p>          Functional area Capability Community Edition Enterprise Edition     <p>GRAVITEE API MANAGEMENT</p> <p>Gravitee API Gateway</p> <p>Yes</p> <p>Yes</p>   <p>GRAVITEE API MANAGEMENT</p> <p>Gravitee API Management UI</p> <p>Yes</p> <p>Yes</p>   <p>GRAVITEE API MANAGEMENT</p> <p>Gravitee Service Management Ecosystem</p> <p>Yes - with limited future AsyncAPI connectors</p> <p>Yes - with unlimited future AsyncAPI connectors</p>   <p>GRAVITEE API MANAGEMENT</p> <p>Protocol mediation</p> <p>Limited</p> <p>Unlimited</p>   <p>GRAVITEE API MANAGEMENT</p> <p>A large set of baked-in policies</p> <p>Yes</p> <p>Yes</p>   <p>GRAVITEE API MANAGEMENT</p> <p>A large set of Gravitee plugins</p> <p>Yes</p> <p>Yes</p>   <p>GRAVITEE API MANAGEMENT</p> <p>Gravitee Developer Portal</p> <p>Yes</p> <p>Yes</p>   <p>GRAVITEE API MANAGEMENT</p> <p>Environments per installation</p> <p>Limited to one environment per installation</p> <p>Multiple depending on plan</p>   <p>GRAVITEE API MANAGEMENT</p> <p>Support for API Management</p> <p>Community support for API Management</p> <p>Enterprise-grade 24/7 API Management support</p>   <p>GRAVITEE API MANAGEMENT</p> <p>Basic Kafka connector</p> <p>Yes</p> <p>Yes</p>   <p>GRAVITEE API MANAGEMENT</p> <p>Advanced Kafka connector (coming in v3.20)</p> <p>No</p> <p>Yes (coming in v3.20)</p>   <p>GRAVITEE API MANAGEMENT</p> <p>Subscription message filtering for Kafka use cases (coming in v3.20)</p> <p>No</p> <p>Yes (coming in v3.20)</p>   <p>GRAVITEE API MANAGEMENT</p> <p>Engineer-to-engineer support for production and non-production Gateways</p> <p>No</p> <p>Yes</p>   <p>GRAVITEE API MANAGEMENT</p> <p>The ability to mask data captured in logs via the Data masking plugin and policy</p> <p>No</p> <p>Yes</p>   <p>GRAVITEE API MANAGEMENT</p> <p>The ability to push extra metrics in addition to the natively provided request metrics using the Assign metrics policy</p> <p>No</p> <p>Yes</p>   <p>GRAVITEE API MANAGEMENT</p> <p>Full future support for asynchronous APIs and protocols and event-driven APIs, which includes (but may not be limited to) support for MQTT (coming in v3.20), Webhook, Websocket, and SSE</p> <p>No</p> <p>Yes</p>   <p>GRAVITEE API MANAGEMENT</p> <p>Support for policy application at the message level for asynchronous APIs and event-driven APIs (coming in v3.20)</p> <p>No</p> <p>Yes (some features coming in v3.20)</p>   <p>GRAVITEE API MANAGEMENT</p> <p>Customer Success Services</p> <p>No</p> <p>Yes</p>   <p>GRAVITEE ACCESS MANAGEMENT</p> <p>Gravitee Access Management (AM)</p> <p>Yes</p> <p>Yes</p>   <p>GRAVITEE ACCESS MANAGEMENT</p> <p>A large set of Gravitee AM plugins</p> <p>Yes</p> <p>Yes</p>   <p>GRAVITEE ACCESS MANAGEMENT</p> <p>Basic MFA</p> <p>Yes</p> <p>Yes</p>   <p>GRAVITEE ACCESS MANAGEMENT</p> <p>MFA with FIDO2</p> <p>No</p> <p>Yes</p>   <p>GRAVITEE ACCESS MANAGEMENT</p> <p>Adaptive, risk-based MFA</p> <p>No</p> <p>Yes</p>   <p>GRAVITEE ACCESS MANAGEMENT</p> <p>Support</p> <p>Community AM support</p> <p>Enterprise-grade 24/7 AM support</p>   <p>GRAVITEE ACCESS MANAGEMENT</p> <p>The ability to authenticate users and retrieve their information from your Enterprise CAS server via the CAS Identity Provider plugin</p> <p>No</p> <p>Yes</p>   <p>GRAVITEE ACCESS MANAGEMENT</p> <p>The ability to identify a user using a Kerberos login/password form or using the SPENGO protocol via the Kerberos Identity plugin</p> <p>No</p> <p>Yes</p>   <p>GRAVITEE ACCESS MANAGEMENT</p> <p>Full support for SAML 2.0 via the SAML 2.0 Identity Provider plugin</p> <p>No</p> <p>Yes</p>   <p>GRAVITEE ALERT ENGINE^ - an EE module you can use to monitor, analyze, and prevent incidents such as SLA breaches or spikes in traffic happening in the future</p> <p>Implement true, API-level observability and monitoring</p> <p>No</p> <p>Yes (to activate AE in APIM and/or AM, you need to apply an link:{{ /ee/ee_licensing.html</p>   <p>relative_url }}[EE license] to your APIM/AM installation)</p> <p>GRAVITEE ALERT ENGINE^</p> <p>Configure custom alerting mechanisms</p> <p>No</p>   <p>Yes (requires an link:{{ /ee/ee_licensing.html</p> <p>relative_url }}[EE license])</p> <p>GRAVITEE ALERT ENGINE^</p> <p>Adaptive alerting that is triggered whenever</p>   <p>No</p> <p>Yes (requires an link:{{ /ee/ee_licensing.html</p> <p>relative_url }}[EE license])</p> <p>GRAVITEE ALERT ENGINE^</p>   <p>Adaptive MFA (an EE AM feature) is triggered for more pin-point alerting</p> <p>No</p> <p>Yes (requires an link:{{ /ee/ee_licensing.html</p> <p>relative_url }}[EE license])</p>   <p>GRAVITEE API DESIGNER^ - our no-code graphical drag-and-drop tool that enables you to build scalable API designs quickly and elegantly with a design-first approach that reduces time spent translating business requirements into high-quality API definitions</p> <p>Drag-and-drop API Design tool</p> <p>Free to use with CE, with a limitation of one active design at any given time</p> <p>Options to remove the one-design limitation with EE - contact us^ for more info</p>   <p>GRAVITEE API DESIGNER^</p> <p>One-click publishing</p> <p>Free to use with CE, with a limitation of one active design at any given time</p> <p>Options to remove the one-design limitation with EE - contact us^ for more info</p>   <p>GRAVITEE COCKPIT^</p> <p>Cockpit is a centralized, multi-environment tool for managing all your Gravitee API Management and Access Management installations in a single place</p> <p>Free to trial with CE, with a limitation of up to two environments per user</p> <p>Options to remove the two-environments limitation with EE - contact us^ for more info</p>   <p>GRAVITEE ADVANCED ENVIRONMENT MANAGEMENT</p> <p>The ability to connect unlimited Gravitee APIM environments and installations under one umbrella</p> <p>No</p> <p>Yes</p>   <p>GRAVITEE ADVANCED ENVIRONMENT MANAGEMENT</p> <p>Connect unlimited Gravitee APIM environments and installations under one umbrella</p> <p>No</p> <p>Yes</p>   <p>GRAVITEE ADVANCED ENVIRONMENT MANAGEMENT</p> <p>Promote APIs across various environments</p> <p>No</p> <p>Yes</p>   <p>GRAVITEE ADVANCED ENVIRONMENT MANAGEMENT</p> <p>Keep oversight around availability and health of Gravitee deployments and Gateways</p> <p>No</p> <p>Yes</p>   <p>GRAVITEE API SECURITY</p> <p>Advanced anomaly detection (coming in v3.20)</p> <p>No</p> <p>Yes (coming in v3.20)</p>   <p>GRAVITEE API SECURITY</p> <p>OpenAPI spec compliance (coming in v3.20)</p> <p>No</p> <p>Yes (coming in v3.20)</p>   <p>GRAVITEE API SECURITY</p> <p>API inventory and lineage (coming in v3.20)</p> <p>No</p> <p>Yes (coming in v3.20)</p>   <p>GRAVITEE API SECURITY</p> <p>Security ratings (coming in v3.20)</p> <p>No</p> <p>Yes (coming in v3.20)</p>   <p>EE PLUGINS FOR APIM</p> <p>Data Logging Masking Policy^</p> <p>No</p> <p>Yes (requires an link:{{ /ee/ee_licensing.html</p>   <p>relative_url }}[EE license])</p> <p>EE PLUGINS FOR APIM</p> <p>Assign Metrics Policy^</p> <p>No</p>   <p>Yes (requires an link:{{ /ee/ee_licensing.html</p> <p>relative_url }}[EE license])</p> <p>EE PLUGINS FOR AM</p> <p>HTTP Flow Identity Provider</p>   <p>No</p> <p>Yes (requires an link:{{ /ee/ee_licensing.html</p> <p>relative_url }}[EE license])</p> <p>EE PLUGINS FOR AM</p>   <p>CAS Identity Provider^ (now shipped separately like all other EE plugins)</p> <p>No</p> <p>Yes (requires an link:{{ /ee/ee_licensing.html</p> <p>relative_url }}[EE license])</p>   <p>EE PLUGINS FOR AM</p> <p>Kerberos Identity Provider^ (now shipped separately like all other EE plugins)</p> <p>No</p> <p>Yes (requires an link:{{ /ee/ee_licensing.html</p>   <p>relative_url }}[EE license])</p> <p>EE PLUGINS FOR AM</p> <p>SAML 2.0 Identity Provider^</p> <p>No</p>   <p>Yes (requires an link:{{ /ee/ee_licensing.html</p> <p>relative_url }}[EE license])</p> <p>EE PLUGINS FOR AM</p> <p>Gateway Handler SAML IDP - Enable SAML 2.0 Identity Provider support^</p>   <p>No</p> <p>Yes (requires an link:{{ /ee/ee_licensing.html</p> <p>relative_url }}[EE license])</p> <p>EE PLUGINS FOR AM</p>   <p>MFA with FIDO2^</p> <p>No</p> <p>Yes (requires an link:{{ /ee/ee_licensing.html</p> <p>relative_url }}[EE license])</p>   <p>EE PLUGINS FOR AM</p> <p>Risk-based MFA^</p> <p>No</p> <p>Yes (requires an link:{{ /ee/ee_licensing.html</p>   <p>relative_url }}[EE license])</p> <p>EE PLUGINS FOR AM</p> <p>Resource HTTP Factor^ (no public documentation available yet - you need an link:{{ /ee/ee_licensing.html</p> <p>relative_url }}[EE license] to access this private repository)</p>   <p>No</p> <p>Yes (requires an link:{{ /ee/ee_licensing.html</p> <p>relative_url }}[EE license])</p> <p>EE PLUGINS FOR AM</p>   <p>Factor OTP Sender^ (no public documentation available yet - you need an link:{{ /ee/ee_licensing.html</p> <p>relative_url }}[EE license] to access this private repository)</p> <p>No</p> <p>Yes (requires an link:{{ /ee/ee_licensing.html</p>    <p>Any EE capabilities, modules, and plugins that require an EE license must be downloaded separately as they are not part of the main distribution bundles for APIM and AM. See the link:{{ /ee/ee_installation.html | relative_url }}[EE Installation page] for details.</p> <p>APIM and AM documentation pages describing EE features are marked with an orange \"Enterprise feature\" label at the top of the page.</p> <p>Read more about EE link:{{ /ee/ee_versioning.html | relative_url }}[versioning], link:{{ /ee/ee_installation.html | relative_url }}[installation], and link:{{ /ee/ee_licensing.html | relative_url }}[licensing].</p> <p>Get in touch^ with us to learn more!</p>","location":"ee/#community-edition-vs-enterprise-edition-capability-matrix","tags":["Enterprise Edition","EE"]},{"title":"EE Installation","text":"","location":"ee/installation/","tags":["Enterprise Edition","EE","Installation"]},{"title":"API Management (APIM) and Access Management (AM)","text":"<p>Version 3.18.x of the Gravitee Platform (APIM and AM 3.18.0 were released at the beginning of July 2022) has introduced a unified, single distribution bundles for all features available in the Community Edition (CE) and the Enterprise Edition (EE) of Gravitee.io for the APIM and AM products respectively.</p> <p>Previously, the two editions used to be distributed as separate bundles (CE and EE) per product, and any migration to EE required full re-installation. This change allows for a smooth transition from CE to EE functionality, and enables you to trial EE features in APIM and AM without the need for a standalone EE installation when migrating from CE.</p> <p>If you are a Gravitee CE user and you want to try out EE features, just install the unified bundle, request an EE license, add it to the installation, and restart. You no longer need to download and install a new, standalone EE version of APIM or AM!</p> <p>NOTE: You can now sign up for a free, time-limited, full EE-grade API Management trial with included Alert Engine, as part of the free Cockpit trial registration. The Cockpit trial also allows you to try Gravitee API Designer.</p>","location":"ee/installation/#api-management-apim-and-access-management-am","tags":["Enterprise Edition","EE","Installation"]},{"title":"Alert Engine (AE)","text":"<p>AE is not part of the Community Edition - it is an Enterprise feature and requires an EE license. It is distributed separately and can be installed via Docker, Kubernetes, or manually using a Zip File.</p>","location":"ee/installation/#alert-engine-ae","tags":["Enterprise Edition","EE","Installation"]},{"title":"Installation steps for APIM, AM, AE, and other EE modules","text":"Installing as a new instanceMigrating from an existing CE installation   <p>To perform a new EE installation:</p> <ol> <li>Download the full bundles of the desired products (APIM, AM, AE) from the Gravitee platform downloads page.</li> <li>Install the relevant product bundles by following the APIM and AM installation guides respectively.</li> <li>Download/install the desired EE modules. 3.1. To install AE, consult the Alert Engine section on the Gravitee downloads web page and/or follow AE installation guide. 3.2. EE plugins are installed from their respective repositories in GitHub. Gravitee's EE plugin repositories are private and their names are prefixed as <code>gravitee-io/gravitee-policy-&lt;plugin-name&gt;</code>. For example, the Data Logging Masking Policy repository is at https://github.com/gravitee-io/gravitee-policy-data-logging-masking. To request access to private EE plugin repositories, email contact@graviteesource.com in case you have not been granted such access already as part of your EE license request process.</li> <li>Request an EE license.</li> <li>Apply the EE license to the relevant existing product instances.</li> <li>Restart.</li> </ol>  <p>Docker installation option for EE removed</p> <p>We have removed the option to install EE bundles and EE licenses using Docker as we have simplified the installation process for EE through the use of unified platform distribution bundles for each product, as described below. The process for EE license requests, installation, and support is described in the EE Licensing section.</p>     <p>Ensure you are running a LTS version</p>  <p>Before you proceed, please ensure that you are running a long-term support (LTS) version of the respective product(s).</p> <p>To migrate from an existing Community Edition (CE) installation to EE:</p> <ol> <li>Download/install the desired EE modules.</li> <li>Request an EE license.</li> <li>Apply the EE license to the relevant existing product instances.</li> <li>Restart.</li> </ol>","location":"ee/installation/#installation-steps-for-apim-am-ae-and-other-ee-modules","tags":["Enterprise Edition","EE","Installation"]},{"title":"Cockpit","text":"<p>Gravitee Cockpit is a centralized, multi-environment tool for managing all your Gravitee API Management and Access Management installations in a single place.</p> <p>After version 3.15.0, Cockpit became a SaaS product, meaning that you do not need to install it as a self-hosted solution anymore. You can register and use Cockpit for free as part of the Community Edition, enabling you to also access a full, time-limited, EE-grade API Management trial (with Alert Engine included), manage Gravitee environments and installations, and design APIs with the Gravitee API Designer also included in the trial.</p> <p>When used for free, Cockpit has a limitation of up to two environments per user. However, you can upgrade to a paid Enterprise Edition plan to unlock more environments and use Cockpit as an Enterprise-grade tool for production.</p>  <p>Older, self-hosted Cockpit versions</p> <p>While this is not recommended, you can still install an older version of Cockpit (3.15.0 and below) as a self-hosted instance - see the legacy Cockpit installation guide for details.</p>","location":"ee/installation/#cockpit","tags":["Enterprise Edition","EE","Installation"]},{"title":"API Designer","text":"<p>Gravitee API Designer is free to use with the Community Edition, with a limitation of one active design at any given time. Contact us if you need to remove this limitation by upgrading to a paid Enterprise Edition plan.</p> <p>To try Gravitee API Designer, sign up for a Cockpit trial here - API Designer is part of the trial.</p>","location":"ee/installation/#api-designer","tags":["Enterprise Edition","EE","Installation"]},{"title":"EE Licensing","text":"<p>To run a Gravitee Enterprise Edition (EE) node, you must have a valid license file.</p>","location":"ee/license/","tags":["Enterprise Edition","EE","License"]},{"title":"Getting an EE license","text":"<p>To get an EE license, email contact@graviteesource.com requesting a license.</p>","location":"ee/license/#getting-an-ee-license","tags":["Enterprise Edition","EE","License"]},{"title":"Applying an EE license","text":"<p>You can provide the EE license data for a Gravitee EE product in two ways:</p> <ol> <li>Using an environmental variable.</li> <li>Using a file.</li> </ol> <p>It is possible to add an EE license in Kubernetes by using any of these two approaches to provide the license information.</p>","location":"ee/license/#applying-an-ee-license","tags":["Enterprise Edition","EE","License"]},{"title":"Applying an EE license using an environment variable","text":"<p>Provide the content of the license file directly in <code>Base64</code> format using an environmental variable called \"license.key\":</p> <ol> <li> <p>Create a new secret from your Gravitee license data.</p> </li> <li> <p>Update your deployment description and provide a new ENV with the     license data from a Kubernetes secret, as shown in the example     below.</p> </li> </ol>  <pre><code>spec:\n  containers:\n  - name: ONE_OF_GRAVITEE_EE_PRODUCTS\n    image: GRAVITEE_IMAGE\n    env:\n    - name: license.key\n      valueFrom:\n        secretKeyRef:\n          name: graviteeio-license\n          key: license.key\n          optional: false # same as default; \"mysecret\" must exist\n</code></pre> <p>For more information, see the Kubernetes documentation^.</p>","location":"ee/license/#applying-an-ee-license-using-an-environment-variable","tags":["Enterprise Edition","EE","License"]},{"title":"Applying an EE license using a file","text":"<p>Gravitee looks for the EE license file inside the <code>GRAVITEE_HOME/license/license.key</code> folder by default. You can override this by using another property called <code>gravitee.license</code>.</p> <p>How it works:</p> <ol> <li> <p>Gravitee will first look for the <code>license.key</code> environmental     variable.</p> </li> <li> <p>If it cannot find it, Gravitee will look into the <code>gravitee.license</code>     property.</p> </li> <li> <p>If the <code>gravitee.license</code> property is not set, Gravitee will try to     retrieve the key from the <code>GRAVITEE_HOME</code> folder.</p> </li> </ol>","location":"ee/license/#applying-an-ee-license-using-a-file","tags":["Enterprise Edition","EE","License"]},{"title":"Using Kubernetes","text":"<p>Kubernetes allows you to mount the content of a special Secret^ inside your pod. You can use this solution to provide the EE license file to Gravitee.</p> <p>To do so:</p> <ol> <li> <p>Create a <code>Secret</code> containing the EE license data. Make sure to name     the key \"license.key\".</p> </li> <li> <p>Mount this content into your pod using <code>Volumes</code>. Note that the     <code>mountPath</code> is not unique and is different for each product, as     follows:</p> <p>AM:</p> <ul> <li> <p>Gateway: <code>/opt/graviteeio-am-gateway/license</code></p> </li> <li> <p>API: <code>/opt/graviteeio-am-management-api/license</code></p> </li> </ul> <p>APIM:</p> <ul> <li> <p>Gateway: <code>/opt/graviteeio-gateway/license</code></p> </li> <li> <p>API: <code>/opt/graviteeio-management-api/license</code></p> </li> </ul> <p>AE:</p> <ul> <li><code>/opt/graviteeio-alert-engine/license</code></li> </ul> </li> </ol> <p>For example:</p> <pre><code>spec:\n  containers:\n\n# ...\n\n    volumeMounts:\n    - name: graviteeio-license\n      mountPath: \"/opt/graviteeio-am-management-api/license\"\n      readOnly: true\n  volumes:\n  - name: graviteeio-license\n    secret:\n      secretName: graviteeio-license\n      optional: false # default setting; \"mysecret\" must exist\n</code></pre>","location":"ee/license/#using-kubernetes","tags":["Enterprise Edition","EE","License"]},{"title":"Using Helm","text":"<p>You can use the solutions described above if you want to modify existing resources that have already been deployed in the cluster. Alternatively, you can also provide the license information using Helm^ and when installing or updating existing installations.</p> <p>The example below shows the contents of a simple <code>values.yaml</code> file that you can use to provide the EE license data using Helm.</p> <pre><code>api:\n\n# ...\n\n    env:\n    - name: gravitee_services_notifier_enabled\n      value: \"true\"\n# ...\n\n    extraVolumeMounts: |\n      - name: graviteeio-license\n        mountPath: /opt/graviteeio-am-management-api/license\n        readOnly: true\n        extraVolumes: |\n      - name: graviteeio-license\n        secret:\n          secretName: graviteeio-license\n\ngateway:\n\n# ...\n\n    env:\n    - name: GIO_MIN_MEM\n      value: 256m\n\n# ...\n\n    extraVolumeMounts: |\n      - name: graviteeio-license\n        mountPath: /opt/graviteeio-am-gateway/license\n        readOnly: true\n        extraVolumes: |\n      - name: graviteeio-license\n        secret:\n          secretName: graviteeio-license\n</code></pre>","location":"ee/license/#using-helm","tags":["Enterprise Edition","EE","License"]},{"title":"My license is ending","text":"<p>Thirty days before the end of the license, a daily <code>WARN</code> log is printed in the log file of the node to inform you that the license is ending.</p> <p>To keep the nodes running, you must provide an updated license file. This file will be reloaded silently by the node.</p>","location":"ee/license/#my-license-is-ending","tags":["Enterprise Edition","EE","License"]},{"title":"License support","text":"<p>When running an enterprise node, a license file must be supplied to bootstrap the node.</p> <p>When running the node within Docker, the license file must be passed with a volume as follows:</p> <pre><code>$ docker run  \\\n        -v license.key:/opt/graviteeio-gateway/license \\\n        --name api-gateway  \\\n        --detach  \\\n        graviteeio/apim-gateway:{{ site.products.apim.ee.version }}-ee\n</code></pre>","location":"ee/license/#license-support","tags":["Enterprise Edition","EE","License"]},{"title":"EE Versioning","text":"","location":"ee/version/","tags":["Enterprise Edition","EE","Versioning","Support Model"]},{"title":"Support policy model","text":"","location":"ee/version/#support-policy-model","tags":["Enterprise Edition","EE","Versioning","Support Model"]},{"title":"From version 3.18.0 and above: 12-month support model for all minor versions","text":"<p>As of version 3.18.0 (released on 7th July 2022), we have changed the model of support we provide for released versions of the Gravitee Platform.</p> <p>We now provide 12 months of support for each minor version. A minor version is considered a quarterly release version with a second-digit increment in the version cadence, for example 3.18.x (but not 3.18.1 - this is a maintenance release version).</p> <p>We no longer support STS and LTS versions (see the next section for more information).</p>","location":"ee/version/#from-version-3180-and-above-12-month-support-model-for-all-minor-versions","tags":["Enterprise Edition","EE","Versioning","Support Model"]},{"title":"Prior to version 3.18.0: STS &amp; LTS support model","text":"<p>Prior to the release of version 3.18.0, when you subscribed to support services provided by Gravitee.io, you could choose between two support options:</p> <ol> <li> <p>Short-Term Support (STS).</p> </li> <li> <p>Long-Term Support (LTS).</p> </li> </ol> <p>LTS applied to versions ending with 0 or 5 (for example: 1.25, 1.30, 1.35). STS applied to all non-LTS versions.</p> <p>An LTS version was supported for around 1 year, whereas a STS version was supported for 3 months.</p> <p>When moving to an enterprise version, this was not the case: all LTS versions were considered to be enterprise versions.</p> <p>This model aimed to ensure that our customers would be running the most well-tested and production-ready versions.</p>","location":"ee/version/#prior-to-version-3180-sts-lts-support-model","tags":["Enterprise Edition","EE","Versioning","Support Model"]},{"title":"Supported product versions and EOL dates","text":"<p>The tables below provide information about product versions and their release and EOL (end of life) dates, as well as the support model used for each.</p> <p>Note that the Table 1 and Table 2 reflect the entire Gravitee platform whereas Table 3 and Table 4 show breakdowns for individual products - API Management (APIM) and Access Management (AM).</p>  Gravitee.io current latest platform version         Version Support model Release Date EOL Date      <p>Gravitee.io current latest platform version</p>  Gravitee.io platform version 3.0.x and above         Version Support model Release Date EOL Date     <p>3.0.x</p> <p>LTS</p> <p>2020-05-20</p> <p>2021-06-15</p>   <p>3.1.x</p> <p>STS</p> <p>2020-07-17</p> <p>2020-10-22</p>   <p>3.2.x</p> <p>STS</p> <p>2020-09-22</p> <p>2020-11-15</p>   <p>3.3.x</p> <p>STS</p> <p>2020-10-15</p> <p>2020-12-24</p>   <p>3.4.x</p> <p>STS</p> <p>2020-11-24</p> <p>2021-01-15</p>   <p>3.5.x</p> <p>LTS</p> <p>2020-12-15</p> <p>2021-12-15</p>   <p>3.6.x</p> <p>STS</p> <p>2021-02-16</p> <p>2021-04-16</p>   <p>3.7.x</p> <p>STS</p> <p>2021-03-16</p> <p>2021-05-13</p>   <p>3.8.x</p> <p>STS</p> <p>2021-04-13</p> <p>2021-06-18</p>   <p>3.9.x</p> <p>STS</p> <p>2021-05-18</p> <p>2021-07-15</p>   <p>3.10.x</p> <p>LTS</p> <p>2021-06-15</p> <p>2022-07-31</p>   <p>3.11.x</p> <p>STS</p> <p>2021-08-31</p> <p>2021-10-31</p>   <p>3.12.x</p> <p>STS</p> <p>2021-09-30</p> <p>2021-12-19</p>   <p>3.13.x</p> <p>STS</p> <p>2021-11-19</p> <p>2022-01-27</p>   <p>3.14.x</p> <p>STS</p> <p>2022-01-12</p> <p>2022-03-30</p>   <p>3.15.x</p> <p>LTS</p> <p>2021-01-27</p> <p>2023-01-31</p>   <p>3.16.x</p> <p>STS</p> <p>2022-02-28</p> <p>2022-04-30</p>   <p>3.17.x</p> <p>STS</p> <p>2022-03-30</p> <p>2022-07-31</p>   <p>3.18.x</p> <p>12 months</p> <p>2022-07-07</p> <p>2023-07-07</p>    <p>Gravitee.io platform version 3.0.x and above</p>  Gravitee.io API Management (APIM) versions 1.15.x to 1.30.x         Version Support model Release Date EOL Date     <p>1.15.x</p> <p>LTS</p> <p>2018-04-04</p> <p>2019-04-18</p>   <p>1.16.x</p> <p>STS</p> <p>2018-05-10</p> <p>2018-07-15</p>   <p>1.17.x</p> <p>STS</p> <p>2018-06-15</p> <p>2018-08-11</p>   <p>1.18.x</p> <p>STS</p> <p>2018-07-11</p> <p>2018-10-11</p>   <p>1.19.x</p> <p>STS</p> <p>2018-09-11</p> <p>2018-11-18</p>   <p>1.20.x</p> <p>LTS</p> <p>2018-10-18</p> <p>2019-10-24</p>   <p>1.21.x</p> <p>STS</p> <p>2018-11-28</p> <p>2019-02-16</p>   <p>1.22.x</p> <p>STS</p> <p>2019-01-16</p> <p>2019-03-25</p>   <p>1.23.x</p> <p>STS</p> <p>2019-02-25</p> <p>2019-04-22</p>   <p>1.24.x</p> <p>STS</p> <p>2019-03-22</p> <p>2019-05-24</p>   <p>1.25.x</p> <p>LTS</p> <p>2019-04-24</p> <p>2020-05-17</p>   <p>1.26.x</p> <p>STS</p> <p>2019-05-21</p> <p>2019-07-19</p>   <p>1.27.x</p> <p>STS</p> <p>2019-06-19</p> <p>2019-08-18</p>   <p>1.28.x</p> <p>STS</p> <p>2019-07-18</p> <p>2019-10-18</p>   <p>1.29.x</p> <p>STS</p> <p>2019-09-18</p> <p>2019-12-17</p>    <p>Gravitee.io API Management (APIM) versions 1.15.x to 1.30.x</p>  Gravitee.io Access Management (AM) versions 2.0.x to 2.10.x         Version Support model Release Date EOL Date     <p>2.0.x</p> <p>LTS</p> <p>2018-07-13</p> <p>2019-10-24</p>   <p>2.1.x</p> <p>STS</p> <p>2018-11-28</p> <p>2019-02-24</p>   <p>2.2.x</p> <p>STS</p> <p>2019-01-24</p> <p>2019-03-25</p>   <p>2.3.x</p> <p>STS</p> <p>2019-02-25</p> <p>2019-04-20</p>   <p>2.4.x</p> <p>STS</p> <p>2019-03-20</p> <p>2019-05-24</p>   <p>2.5.x</p> <p>LTS</p> <p>2019-04-24</p> <p>2020-05-05</p>   <p>2.6.x</p> <p>STS</p> <p>2019-05-24</p> <p>2019-07-15</p>   <p>2.7.x</p> <p>STS</p> <p>2019-06-15</p> <p>2019-08-17</p>   <p>2.8.x</p> <p>STS</p> <p>2019-07-17</p> <p>2019-10-18</p>   <p>2.9.x</p> <p>STS</p> <p>2019-09-18</p> <p>2019-12-05</p>    <p>Gravitee.io Access Management (AM) versions 2.0.x to 2.10.x</p>","location":"ee/version/#supported-product-versions-and-eol-dates","tags":["Enterprise Edition","EE","Versioning","Support Model"]},{"title":"Get started","text":"<p>placeholder</p>","location":"get-started/"},{"title":"Gravitee.io Platform Overview","text":"<p>The Gravitee platform is an event-native platform for \"API everything\".</p> <p>Creation in progress.</p>","location":"platform-overview/"},{"title":"Key Concepts","text":"<p>to do</p>","location":"platform-overview/concepts/"},{"title":"Release notes","text":"<p>Coming soon!</p> <p>A placeholder for release announcements, release overviews, release notes, and generally a hub for referencing release-related resources such as changelogs and all the above.</p>","location":"releases/"},{"title":"I want to learn about...","text":"<p>Coming soon in V2!</p> <p>A placeholder for pre-defined documentation user journey navigation routes, to serve as a starting hub for task-based documentation user journeys and use scenarios following (and continuously applied in sync with) documentation user research to be carried out in 2023 and early 2024.</p>","location":"user-journeys/"}]}